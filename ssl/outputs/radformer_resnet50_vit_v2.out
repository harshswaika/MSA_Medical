nohup: ignoring input
[2024-02-26 13:07:17,628 INFO] Use GPU: None for training
[2024-02-26 13:07:17,628 INFO] 

[2024-02-26 13:07:18,946 INFO] Total params: 109.04M
[2024-02-26 13:07:27,867 INFO] acc: 0.90
[2024-02-26 13:07:27,882 INFO] Victim model accuracy = 0.9016, spec = 0.90, sens = 0.93
[2024-02-26 13:07:27,882 INFO] Loading thief dataset ...
[2024-02-26 13:07:27,887 INFO] 
Initializing thief model ...


Loaded supervised labeled set of length  4500
Labeled set expanded to length  4500 , unique indices  4500
dataset root /home/ankita/mnt/data_msa_medical/GBUSV-Shared
Num of videos 64 frames 15800
15800
15800
Num of videos 64 frames 15800
  0%|          | 0/36 [00:00<?, ?it/s]  3%|â–Ž         | 1/36 [00:06<04:01,  6.90s/it]  6%|â–Œ         | 2/36 [00:08<02:16,  4.01s/it]  8%|â–Š         | 3/36 [00:10<01:40,  3.04s/it] 11%|â–ˆ         | 4/36 [00:12<01:22,  2.59s/it] 14%|â–ˆâ–        | 5/36 [00:14<01:13,  2.36s/it] 17%|â–ˆâ–‹        | 6/36 [00:16<01:06,  2.22s/it] 19%|â–ˆâ–‰        | 7/36 [00:18<01:01,  2.11s/it] 22%|â–ˆâ–ˆâ–       | 8/36 [00:20<00:57,  2.06s/it] 25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:22<00:51,  1.91s/it] 28%|â–ˆâ–ˆâ–Š       | 10/36 [00:23<00:46,  1.80s/it] 31%|â–ˆâ–ˆâ–ˆ       | 11/36 [00:25<00:43,  1.72s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 12/36 [00:26<00:40,  1.69s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 13/36 [00:28<00:37,  1.63s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 14/36 [00:29<00:35,  1.62s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 15/36 [00:31<00:35,  1.68s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 16/36 [00:33<00:34,  1.71s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 17/36 [00:34<00:31,  1.65s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:36<00:29,  1.63s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 19/36 [00:38<00:27,  1.61s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 20/36 [00:39<00:24,  1.56s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 21/36 [00:41<00:23,  1.58s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 22/36 [00:43<00:24,  1.73s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 23/36 [00:45<00:23,  1.80s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 24/36 [00:46<00:20,  1.73s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 25/36 [00:48<00:18,  1.69s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 26/36 [00:50<00:17,  1.76s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:51<00:15,  1.70s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 28/36 [00:53<00:13,  1.74s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 29/36 [00:55<00:12,  1.81s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 30/36 [00:57<00:10,  1.78s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 31/36 [00:58<00:08,  1.73s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 32/36 [01:00<00:06,  1.75s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 33/36 [01:02<00:05,  1.69s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 34/36 [01:04<00:03,  1.72s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 35/36 [01:05<00:01,  1.73s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [01:07<00:00,  1.77s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [01:07<00:00,  1.88s/it]
Num of videos 64 frames 15800
  0%|          | 0/4 [00:00<?, ?it/s] 25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:02<00:08,  2.90s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:04<00:04,  2.31s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:06<00:02,  2.02s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:10<00:00,  2.92s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:10<00:00,  2.72s/it]
[2024-02-26 13:08:46,595 INFO] unlabeled data number: 15800, labeled data number 4500
[2024-02-26 13:08:46,595 INFO] Create train and test data loaders
[2024-02-26 13:08:46,595 INFO] [!] data loader keys: dict_keys(['train_lb', 'train_ulb', 'eval', 'test'])
[2024-02-26 13:08:48,415 INFO] Create optimizer and scheduler
Num of videos 64 frames 15800
[2024-02-26 13:08:57,184 INFO] Number of Trainable Params: 85800963
logit adjustments:  tensor([-2.0471, -1.4649, -0.4466], device='cuda:0')
Load pretrained model for initializing the thief from  /home/ankita/mnt/data_msa_medical/ckpts/vit_b_16-imagenet1k.pth
key not found heads.head.weight
key not found heads.head.bias
Common keys pretrained model:  150
Load anchor model /home/ankita/mnt/data_msa_medical/results_ankita/gbusg_radformer/GBUSV_vit/SGD/5000_val500/random_v1/trial_1_cycle_1_best.pth
thief state:  ['class_token', 'conv_proj.weight', 'conv_proj.bias', 'encoder.pos_embedding', 'encoder.layers.encoder_layer_0.ln_1.weight']
pretrained state:  ['class_token', 'conv_proj.weight', 'conv_proj.bias', 'encoder.pos_embedding', 'encoder.layers.encoder_layer_0.ln_1.weight']
Common keys anchor model:  152
[2024-02-26 13:09:05,736 INFO] Anchor model on target dataset: acc = 0.6639, spec = 0.80, sens = 0.69
[2024-02-26 13:09:06,149 INFO] Arguments: Namespace(T=0.5, algorithm='selfkd', amp=False, batch_size=8, c='configs/gbc/selfkd_vit.yaml', clip=0.0, clip_grad=0, crop_ratio=0.875, data_dir='./data', dataset='GBUSV', device=device(type='cuda'), dist_backend='nccl', dist_url='tcp://127.0.0.1:18142', distributed=False, ds_seed=123, ema_m=0.999, epoch=100, eval_batch_size=16, eval_step=234, expand_labels=True, gpu=None, hard_label=True, imb_algorithm=None, img_size=224, include_lb_to_ulb=True, kd_alpha=0.4, kd_alpha_ulb=0.5, kd_temp=1.5, kd_temp_ulb=1.5, la=True, labeled_set_path='/home/ankita/mnt/data_msa_medical/results_ankita/gbusg_radformer/GBUSV_vit/SGD/5000_val500/random_v1/X_trial_1_cycle_1_labeled_set.npy', layer_decay=0.5, lb_dest_len=4500, lb_imb_ratio=1, load_labeled_set=True, load_path=None, local_rank=-1, lr=0.01, max_length=512, max_length_seconds=4.0, momentum=0.9, multiprocessing_distributed=False, net='vit_b_16', net_from_name=False, no_progress=True, num_classes=3, num_eval_iter=234, num_labels=5000, num_log_iter=234, num_train_iter=900000, num_warmup_iter=5120, num_workers=4, optim='SGD', overwrite=True, p_cutoff=0.95, pretrain_path='', pretrained_dir='/home/ankita/mnt/data_msa_medical/ckpts/vit_b_16-imagenet1k.pth', rank=0, resume=False, sample_rate=16000, save_dir='saved_models/radformer', save_name='selfkd_vit_v2', scheduler_type='cosine', seed=5, subset=128116, thief_root='/home/ankita/mnt/data_msa_medical/GBUSV-Shared', train_sampler='RandomSampler', tro=1, ulb_dest_len=15800, ulb_imb_ratio=1, ulb_loss_ratio=1.0, ulb_num_labels=None, uratio=7, use_aim=False, use_cat=True, use_pretrain=True, use_tensorboard=True, use_wandb=True, val_set_path='/home/ankita/mnt/data_msa_medical/results_ankita/gbusg_radformer/GBUSV_vit/SGD/5000_val500/random_v1/X_trial_1_cycle_1_val_set.npy', victim_arch='radformer', victim_data_root='/home/ankita/mnt/data_msa_medical/GBCU-Shared', victim_dataset='gbusg', victim_model_path='/home/ankita/mnt/data_msa_medical/victim_models/radformer/radformer.pkl', warmstart=False, warmstart_dir='/home/ankita/mnt/data_msa_medical/results_ankita/gbusg_radformer/GBUSV_vit/SGD/5000_val500/random_v1/trial_1_cycle_1_best.pth', warmup=0, warmup_epoch=10, weight_decay=0.0005, world_size=1)
[2024-02-26 13:09:06,149 INFO] Validation set distribution: 
anchor model temp =  1.0
Number of samples  500
[2024-02-26 13:09:07,602 INFO] {0: 74, 1: 123, 2: 303}
[2024-02-26 13:09:07,602 INFO] Labeled set distribution: 
Number of samples  4500
[2024-02-26 13:09:16,176 INFO] {0: 581, 1: 1037, 2: 2878}
[2024-02-26 13:09:20,021 INFO] Initial model on target dataset (without EMA): acc = 0.2541, agreement = 0.2377, spec = 1.00, sens = 0.00
[2024-02-26 13:09:20,021 INFO] Resume load path None does not exist
[2024-02-26 13:09:20,021 INFO] 
Model training
wandb: Currently logged in as: raj-ankita92. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in saved_models/radformer/wandb/selfkd_vit_v2/wandb/run-20240226_130922-cm0wzwau
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run selfkd_vit_v2
wandb: â­ï¸ View project at https://wandb.ai/raj-ankita92/radformer
wandb: ðŸš€ View run at https://wandb.ai/raj-ankita92/radformer/runs/cm0wzwau
[2024-02-26 13:09:25,789 INFO] 

epoch 0
[2024-02-26 13:16:53,386 INFO] validating...
[2024-02-26 13:16:59,795 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 13:17:01,209 INFO] model saved: saved_models/radformer/selfkd_vit_v2/model_best.pth
[2024-02-26 13:17:01,209 INFO] 283 iteration, USE_EMA: True, train/sup_loss: 1.03113, train/unsup_loss: 0.84227, train/total_loss: 1.87340, train/util_ratio: 0.73214, train/run_time: 1.54633, lr: 0.00000, train/prefecth_time: 0.01195, eval/loss: 1.09861, eval/top-1-acc: 0.14800, eval/balanced_acc: 0.33333, eval/precision: 0.04933, eval/recall: 0.33333, eval/F1: 0.08595, eval/spec: 1.00000, eval/sens: 0.00000, test/loss: 1.09861, test/top-1-acc: 0.25410, test/balanced_acc: 0.33333, test/precision: 0.08470, test/recall: 0.33333, test/F1: 0.13508, test/spec: 1.00000, test/sens: 0.00000 BEST_EVAL_ACC: 0.1480, at 283 iters BEST_TEST_ACC: 0.2541, at 283 iters
[2024-02-26 13:17:01,213 INFO] 

epoch 1
[2024-02-26 13:24:34,045 INFO] validating...
[2024-02-26 13:24:41,282 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 13:24:43,429 INFO] model saved: saved_models/radformer/selfkd_vit_v2/model_best.pth
[2024-02-26 13:24:43,430 INFO] 565 iteration, USE_EMA: True, train/sup_loss: 0.59665, train/unsup_loss: 0.45323, train/total_loss: 1.04988, train/util_ratio: 0.75000, train/run_time: 1.55869, lr: 0.00100, train/prefecth_time: 0.01176, eval/loss: 0.83301, eval/top-1-acc: 0.71000, eval/balanced_acc: 0.58008, eval/precision: 0.71820, eval/recall: 0.58008, eval/F1: 0.55134, eval/spec: 0.42640, eval/sens: 0.96700, test/loss: 1.04523, test/top-1-acc: 0.50820, test/balanced_acc: 0.48292, test/precision: 0.58802, test/recall: 0.48292, test/F1: 0.43304, test/spec: 0.40000, test/sens: 0.95238 BEST_EVAL_ACC: 0.7100, at 565 iters BEST_TEST_ACC: 0.5082, at 565 iters
[2024-02-26 13:24:43,432 INFO] 

epoch 2
[2024-02-26 13:32:14,308 INFO] validating...
[2024-02-26 13:32:21,264 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 13:32:23,189 INFO] model saved: saved_models/radformer/selfkd_vit_v2/model_best.pth
[2024-02-26 13:32:23,190 INFO] 847 iteration, USE_EMA: True, train/sup_loss: 0.58014, train/unsup_loss: 0.41424, train/total_loss: 0.99438, train/util_ratio: 0.75000, train/run_time: 1.55453, lr: 0.00200, train/prefecth_time: 0.01360, eval/loss: 0.67319, eval/top-1-acc: 0.75400, eval/balanced_acc: 0.66643, eval/precision: 0.75587, eval/recall: 0.66643, eval/F1: 0.62893, eval/spec: 0.56853, eval/sens: 0.96370, test/loss: 0.96749, test/top-1-acc: 0.57377, test/balanced_acc: 0.55870, test/precision: 0.60777, test/recall: 0.55870, test/F1: 0.57101, test/spec: 0.81250, test/sens: 0.57143 BEST_EVAL_ACC: 0.7540, at 847 iters BEST_TEST_ACC: 0.5738, at 847 iters
[2024-02-26 13:32:23,194 INFO] 

epoch 3
[2024-02-26 13:39:55,891 INFO] validating...
[2024-02-26 13:40:03,340 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 13:40:05,630 INFO] model saved: saved_models/radformer/selfkd_vit_v2/model_best.pth
[2024-02-26 13:40:05,632 INFO] 1129 iteration, USE_EMA: True, train/sup_loss: 0.55198, train/unsup_loss: 0.37236, train/total_loss: 0.92435, train/util_ratio: 0.73214, train/run_time: 1.56920, lr: 0.00300, train/prefecth_time: 0.01440, eval/loss: 0.57636, eval/top-1-acc: 0.76800, eval/balanced_acc: 0.70132, eval/precision: 0.73816, eval/recall: 0.70132, eval/F1: 0.67787, eval/spec: 0.67513, eval/sens: 0.92739, test/loss: 0.88428, test/top-1-acc: 0.57377, test/balanced_acc: 0.57278, test/precision: 0.59615, test/recall: 0.57278, test/F1: 0.57420, test/spec: 0.88750, test/sens: 0.45238 BEST_EVAL_ACC: 0.7680, at 1129 iters BEST_TEST_ACC: 0.5738, at 1129 iters
[2024-02-26 13:40:05,636 INFO] 

epoch 4
[2024-02-26 13:47:39,614 INFO] validating...
[2024-02-26 13:47:47,105 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 13:47:49,548 INFO] model saved: saved_models/radformer/selfkd_vit_v2/model_best.pth
[2024-02-26 13:47:49,549 INFO] 1411 iteration, USE_EMA: True, train/sup_loss: 0.49779, train/unsup_loss: 0.41893, train/total_loss: 0.91672, train/util_ratio: 0.76786, train/run_time: 1.55644, lr: 0.00400, train/prefecth_time: 0.01617, eval/loss: 0.51750, eval/top-1-acc: 0.79400, eval/balanced_acc: 0.73995, eval/precision: 0.75979, eval/recall: 0.73995, eval/F1: 0.71814, eval/spec: 0.76142, eval/sens: 0.92409, test/loss: 0.82034, test/top-1-acc: 0.59836, test/balanced_acc: 0.60391, test/precision: 0.62387, test/recall: 0.60391, test/F1: 0.60031, test/spec: 0.90000, test/sens: 0.42857 BEST_EVAL_ACC: 0.7940, at 1411 iters BEST_TEST_ACC: 0.5984, at 1411 iters
[2024-02-26 13:47:49,552 INFO] 

epoch 5
[2024-02-26 13:55:23,551 INFO] validating...
[2024-02-26 13:55:30,841 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 13:55:33,045 INFO] model saved: saved_models/radformer/selfkd_vit_v2/model_best.pth
[2024-02-26 13:55:33,047 INFO] 1693 iteration, USE_EMA: True, train/sup_loss: 0.42281, train/unsup_loss: 0.38468, train/total_loss: 0.80749, train/util_ratio: 0.71429, train/run_time: 1.56945, lr: 0.00500, train/prefecth_time: 0.01875, eval/loss: 0.49098, eval/top-1-acc: 0.80400, eval/balanced_acc: 0.76712, eval/precision: 0.76319, eval/recall: 0.76712, eval/F1: 0.73818, eval/spec: 0.80203, eval/sens: 0.91089, test/loss: 0.80757, test/top-1-acc: 0.60656, test/balanced_acc: 0.62256, test/precision: 0.62823, test/recall: 0.62256, test/F1: 0.61116, test/spec: 0.90000, test/sens: 0.42857 BEST_EVAL_ACC: 0.8040, at 1693 iters BEST_TEST_ACC: 0.6066, at 1693 iters
[2024-02-26 13:55:33,052 INFO] 

epoch 6
[2024-02-26 14:03:06,027 INFO] validating...
[2024-02-26 14:03:13,090 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 14:03:15,331 INFO] model saved: saved_models/radformer/selfkd_vit_v2/model_best.pth
[2024-02-26 14:03:15,332 INFO] 1975 iteration, USE_EMA: True, train/sup_loss: 0.60142, train/unsup_loss: 0.59586, train/total_loss: 1.19728, train/util_ratio: 0.75000, train/run_time: 1.55710, lr: 0.00600, train/prefecth_time: 0.01236, eval/loss: 0.47404, eval/top-1-acc: 0.82000, eval/balanced_acc: 0.78521, eval/precision: 0.77194, eval/recall: 0.78521, eval/F1: 0.76004, eval/spec: 0.84772, eval/sens: 0.91089, test/loss: 0.79578, test/top-1-acc: 0.60656, test/balanced_acc: 0.62256, test/precision: 0.61291, test/recall: 0.62256, test/F1: 0.61186, test/spec: 0.83750, test/sens: 0.42857 BEST_EVAL_ACC: 0.8200, at 1975 iters BEST_TEST_ACC: 0.6066, at 1975 iters
[2024-02-26 14:03:15,335 INFO] 

epoch 7
[2024-02-26 14:10:48,491 INFO] validating...
[2024-02-26 14:10:55,682 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 14:10:55,684 INFO] 2257 iteration, USE_EMA: True, train/sup_loss: 0.44774, train/unsup_loss: 0.28486, train/total_loss: 0.73260, train/util_ratio: 0.73214, train/run_time: 1.55703, lr: 0.00700, train/prefecth_time: 0.01546, eval/loss: 0.46357, eval/top-1-acc: 0.80600, eval/balanced_acc: 0.76104, eval/precision: 0.74811, eval/recall: 0.76104, eval/F1: 0.73928, eval/spec: 0.82234, eval/sens: 0.91419, test/loss: 0.78750, test/top-1-acc: 0.63115, test/balanced_acc: 0.65485, test/precision: 0.63211, test/recall: 0.65485, test/F1: 0.63928, test/spec: 0.81250, test/sens: 0.59524 BEST_EVAL_ACC: 0.8200, at 1975 iters BEST_TEST_ACC: 0.6066, at 1975 iters
[2024-02-26 14:10:55,686 INFO] 

epoch 8
[2024-02-26 14:18:28,206 INFO] validating...
[2024-02-26 14:18:36,088 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 14:18:38,490 INFO] model saved: saved_models/radformer/selfkd_vit_v2/model_best.pth
[2024-02-26 14:18:38,492 INFO] 2539 iteration, USE_EMA: True, train/sup_loss: 0.91274, train/unsup_loss: 0.36644, train/total_loss: 1.27918, train/util_ratio: 0.73214, train/run_time: 1.55760, lr: 0.00800, train/prefecth_time: 0.01405, eval/loss: 0.46177, eval/top-1-acc: 0.82000, eval/balanced_acc: 0.79146, eval/precision: 0.76479, eval/recall: 0.79146, eval/F1: 0.76945, eval/spec: 0.85279, eval/sens: 0.89439, test/loss: 0.80769, test/top-1-acc: 0.60656, test/balanced_acc: 0.63445, test/precision: 0.60913, test/recall: 0.63445, test/F1: 0.61729, test/spec: 0.76250, test/sens: 0.59524 BEST_EVAL_ACC: 0.8200, at 2539 iters BEST_TEST_ACC: 0.6066, at 2539 iters
[2024-02-26 14:18:38,498 INFO] 

epoch 9
[2024-02-26 14:26:12,673 INFO] validating...
[2024-02-26 14:26:20,142 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 14:26:20,145 INFO] 2821 iteration, USE_EMA: True, train/sup_loss: 0.53198, train/unsup_loss: 0.43783, train/total_loss: 0.96982, train/util_ratio: 0.78571, train/run_time: 1.56715, lr: 0.00900, train/prefecth_time: 0.01365, eval/loss: 0.47124, eval/top-1-acc: 0.81600, eval/balanced_acc: 0.77942, eval/precision: 0.75840, eval/recall: 0.77942, eval/F1: 0.75972, eval/spec: 0.84264, eval/sens: 0.90429, test/loss: 0.85175, test/top-1-acc: 0.60656, test/balanced_acc: 0.63503, test/precision: 0.62019, test/recall: 0.63503, test/F1: 0.61844, test/spec: 0.68750, test/sens: 0.69048 BEST_EVAL_ACC: 0.8200, at 2539 iters BEST_TEST_ACC: 0.6066, at 2539 iters
[2024-02-26 14:26:20,149 INFO] 

epoch 10
[2024-02-26 14:33:53,541 INFO] validating...
[2024-02-26 14:34:00,120 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 14:34:00,121 INFO] 3103 iteration, USE_EMA: True, train/sup_loss: 1.00374, train/unsup_loss: 0.44385, train/total_loss: 1.44758, train/util_ratio: 0.73214, train/run_time: 1.56523, lr: 0.01000, train/prefecth_time: 0.01216, eval/loss: 0.46015, eval/top-1-acc: 0.81800, eval/balanced_acc: 0.78572, eval/precision: 0.76481, eval/recall: 0.78572, eval/F1: 0.76349, eval/spec: 0.83756, eval/sens: 0.90429, test/loss: 0.90915, test/top-1-acc: 0.61475, test/balanced_acc: 0.64297, test/precision: 0.63788, test/recall: 0.64297, test/F1: 0.62917, test/spec: 0.66250, test/sens: 0.71429 BEST_EVAL_ACC: 0.8200, at 2539 iters BEST_TEST_ACC: 0.6066, at 2539 iters
[2024-02-26 14:34:00,124 INFO] 

epoch 11
[2024-02-26 14:41:32,190 INFO] validating...
[2024-02-26 14:41:39,508 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 14:41:41,558 INFO] model saved: saved_models/radformer/selfkd_vit_v2/model_best.pth
[2024-02-26 14:41:41,558 INFO] 3385 iteration, USE_EMA: True, train/sup_loss: 0.19944, train/unsup_loss: 0.36234, train/total_loss: 0.56177, train/util_ratio: 0.75000, train/run_time: 1.55301, lr: 0.01000, train/prefecth_time: 0.01175, eval/loss: 0.43748, eval/top-1-acc: 0.82600, eval/balanced_acc: 0.78740, eval/precision: 0.77353, eval/recall: 0.78740, eval/F1: 0.77763, eval/spec: 0.84264, eval/sens: 0.90099, test/loss: 0.96500, test/top-1-acc: 0.59836, test/balanced_acc: 0.62823, test/precision: 0.62740, test/recall: 0.62823, test/F1: 0.61662, test/spec: 0.63750, test/sens: 0.69048 BEST_EVAL_ACC: 0.8260, at 3385 iters BEST_TEST_ACC: 0.5984, at 3385 iters
[2024-02-26 14:41:41,561 INFO] 

epoch 12
[2024-02-26 14:49:15,282 INFO] validating...
[2024-02-26 14:49:22,372 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 14:49:22,373 INFO] 3667 iteration, USE_EMA: True, train/sup_loss: 0.59696, train/unsup_loss: 0.45739, train/total_loss: 1.05435, train/util_ratio: 0.75000, train/run_time: 1.56257, lr: 0.01000, train/prefecth_time: 0.02021, eval/loss: 0.44876, eval/top-1-acc: 0.82800, eval/balanced_acc: 0.79228, eval/precision: 0.77053, eval/recall: 0.79228, eval/F1: 0.77623, eval/spec: 0.86294, eval/sens: 0.90759, test/loss: 1.02970, test/top-1-acc: 0.57377, test/balanced_acc: 0.60555, test/precision: 0.60942, test/recall: 0.60555, test/F1: 0.59780, test/spec: 0.61250, test/sens: 0.64286 BEST_EVAL_ACC: 0.8260, at 3385 iters BEST_TEST_ACC: 0.5984, at 3385 iters
[2024-02-26 14:49:22,377 INFO] 

epoch 13
[2024-02-26 14:56:56,009 INFO] validating...
[2024-02-26 14:57:03,461 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 14:57:03,463 INFO] 3949 iteration, USE_EMA: True, train/sup_loss: 0.44109, train/unsup_loss: 0.31438, train/total_loss: 0.75547, train/util_ratio: 0.73214, train/run_time: 1.55785, lr: 0.00999, train/prefecth_time: 0.01953, eval/loss: 0.47645, eval/top-1-acc: 0.81400, eval/balanced_acc: 0.78117, eval/precision: 0.75281, eval/recall: 0.78117, eval/F1: 0.76095, eval/spec: 0.86294, eval/sens: 0.88779, test/loss: 1.05409, test/top-1-acc: 0.55738, test/balanced_acc: 0.58913, test/precision: 0.59498, test/recall: 0.58913, test/F1: 0.57680, test/spec: 0.57500, test/sens: 0.66667 BEST_EVAL_ACC: 0.8260, at 3385 iters BEST_TEST_ACC: 0.5984, at 3385 iters
[2024-02-26 14:57:03,467 INFO] 

epoch 14
[2024-02-26 15:04:38,076 INFO] validating...
[2024-02-26 15:04:45,402 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 15:04:45,404 INFO] 4231 iteration, USE_EMA: True, train/sup_loss: 0.24169, train/unsup_loss: 0.31356, train/total_loss: 0.55525, train/util_ratio: 0.76786, train/run_time: 1.56721, lr: 0.00998, train/prefecth_time: 0.02339, eval/loss: 0.46164, eval/top-1-acc: 0.82200, eval/balanced_acc: 0.78755, eval/precision: 0.76469, eval/recall: 0.78755, eval/F1: 0.76918, eval/spec: 0.85279, eval/sens: 0.90429, test/loss: 1.07035, test/top-1-acc: 0.51639, test/balanced_acc: 0.55003, test/precision: 0.54784, test/recall: 0.55003, test/F1: 0.53391, test/spec: 0.55000, test/sens: 0.64286 BEST_EVAL_ACC: 0.8260, at 3385 iters BEST_TEST_ACC: 0.5984, at 3385 iters
[2024-02-26 15:04:45,408 INFO] 

epoch 15
wandb: Network error (ProxyError), entering retry loop.
[2024-02-26 15:12:18,770 INFO] validating...
[2024-02-26 15:12:26,354 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 15:12:28,488 INFO] model saved: saved_models/radformer/selfkd_vit_v2/model_best.pth
[2024-02-26 15:12:28,490 INFO] 4513 iteration, USE_EMA: True, train/sup_loss: 0.69016, train/unsup_loss: 0.36411, train/total_loss: 1.05427, train/util_ratio: 0.73214, train/run_time: 1.56250, lr: 0.00997, train/prefecth_time: 0.01353, eval/loss: 0.44461, eval/top-1-acc: 0.83200, eval/balanced_acc: 0.81094, eval/precision: 0.78405, eval/recall: 0.81094, eval/F1: 0.79414, eval/spec: 0.85787, eval/sens: 0.88779, test/loss: 1.04650, test/top-1-acc: 0.52459, test/balanced_acc: 0.55570, test/precision: 0.54315, test/recall: 0.55570, test/F1: 0.54042, test/spec: 0.61250, test/sens: 0.61905 BEST_EVAL_ACC: 0.8320, at 4513 iters BEST_TEST_ACC: 0.5246, at 4513 iters
[2024-02-26 15:12:28,493 INFO] 

epoch 16
[2024-02-26 15:20:01,139 INFO] validating...
[2024-02-26 15:20:08,307 INFO] model saved: saved_models/radformer/selfkd_vit_v2/latest_model.pth
[2024-02-26 15:20:10,628 INFO] model saved: saved_models/radformer/selfkd_vit_v2/model_best.pth
[2024-02-26 15:20:10,629 INFO] 4795 iteration, USE_EMA: True, train/sup_loss: 0.67601, train/unsup_loss: 0.45724, train/total_loss: 1.13326, train/util_ratio: 0.76786, train/run_time: 1.56000, lr: 0.00996, train/prefecth_time: 0.01275, eval/loss: 0.44217, eval/top-1-acc: 0.83800, eval/balanced_acc: 0.80923, eval/precision: 0.78947, eval/recall: 0.80923, eval/F1: 0.79586, eval/spec: 0.85787, eval/sens: 0.90429, test/loss: 1.04845, test/top-1-acc: 0.53279, test/balanced_acc: 0.55574, test/precision: 0.55525, test/recall: 0.55574, test/F1: 0.54879, test/spec: 0.63750, test/sens: 0.64286 BEST_EVAL_ACC: 0.8380, at 4795 iters BEST_TEST_ACC: 0.5328, at 4795 iters
[2024-02-26 15:20:10,633 INFO] 

epoch 17
