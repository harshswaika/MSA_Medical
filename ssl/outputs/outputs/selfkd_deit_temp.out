[2024-03-04 12:07:04,524 INFO] Use GPU: None for training
[2024-03-04 12:07:04,524 INFO] 

[2024-03-04 12:07:05,495 INFO] Total params: 109.04M
[2024-03-04 12:07:13,805 INFO] acc: 0.90
[2024-03-04 12:07:13,816 INFO] Victim model accuracy = 0.9016, spec = 0.90, sens = 0.93
[2024-03-04 12:07:13,816 INFO] Loading thief dataset ...
[2024-03-04 12:07:13,822 INFO] 
Initializing thief model ...


Loaded supervised labeled set of length  900
Labeled set expanded to length  3600 , unique indices  900
dataset root /home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBUSV-Shared
Num of videos 64 frames 15800
15800
15800
Num of videos 64 frames 15800
  0%|          | 0/29 [00:00<?, ?it/s]  3%|â–Ž         | 1/29 [00:06<03:06,  6.67s/it]  7%|â–‹         | 2/29 [00:08<01:41,  3.76s/it] 10%|â–ˆ         | 3/29 [00:09<01:10,  2.71s/it] 14%|â–ˆâ–        | 4/29 [00:11<00:59,  2.39s/it] 17%|â–ˆâ–‹        | 5/29 [00:13<00:53,  2.23s/it] 21%|â–ˆâ–ˆ        | 6/29 [00:15<00:49,  2.14s/it] 24%|â–ˆâ–ˆâ–       | 7/29 [00:17<00:45,  2.06s/it] 28%|â–ˆâ–ˆâ–Š       | 8/29 [00:19<00:42,  2.03s/it] 31%|â–ˆâ–ˆâ–ˆ       | 9/29 [00:21<00:39,  2.00s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 10/29 [00:23<00:36,  1.95s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 11/29 [00:24<00:33,  1.85s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 12/29 [00:26<00:31,  1.88s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 13/29 [00:28<00:27,  1.75s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 14/29 [00:30<00:27,  1.81s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 15/29 [00:32<00:25,  1.84s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 16/29 [00:34<00:24,  1.87s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 17/29 [00:36<00:22,  1.90s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 18/29 [00:38<00:21,  1.92s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 19/29 [00:39<00:18,  1.86s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 20/29 [00:41<00:15,  1.73s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 21/29 [00:42<00:13,  1.69s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 22/29 [00:44<00:11,  1.63s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 23/29 [00:45<00:09,  1.58s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 24/29 [00:47<00:07,  1.55s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 25/29 [00:48<00:06,  1.59s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 26/29 [00:50<00:05,  1.69s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 27/29 [00:52<00:03,  1.76s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 28/29 [00:54<00:01,  1.80s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [00:56<00:00,  1.84s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [00:56<00:00,  1.95s/it]
Num of videos 64 frames 15800
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.45s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.56s/it]
[2024-03-04 12:08:15,110 INFO] unlabeled data number: 15800, labeled data number 3600
[2024-03-04 12:08:15,110 INFO] Create train and test data loaders
[2024-03-04 12:08:15,110 INFO] [!] data loader keys: dict_keys(['train_lb', 'train_ulb', 'eval', 'test'])
[2024-03-04 12:08:17,431 INFO] Create optimizer and scheduler
Num of videos 64 frames 15800
[2024-03-04 12:08:23,465 INFO] Number of Trainable Params: 85800963
logit adjustments:  tensor([-2.2174, -1.4318, -0.4274], device='cuda:0')
Load pretrained model for initializing the thief from  /home/deepankar/scratch/MSA_Medical/activethief/pretrained/deit_base_patch16_224-b5f2ef4d.pth
key not found head.weight
key not found head.bias
Common keys pretrained model:  150
Load anchor model /home/deepankar/mnt/vision1_outputs/gbusg_radformer/GBUSV_deit/SGD/1000_val100/random_v1_transforms/trial_3_cycle_1_best.pth
thief state:  ['cls_token', 'pos_embed', 'patch_embed.proj.weight', 'patch_embed.proj.bias', 'blocks.0.norm1.weight']
pretrained state:  ['cls_token', 'pos_embed', 'patch_embed.proj.weight', 'patch_embed.proj.bias', 'blocks.0.norm1.weight']
Common keys anchor model:  152
[2024-03-04 12:08:32,624 INFO] Anchor model on target dataset: acc = 0.8033, spec = 0.86, sens = 0.88
[2024-03-04 12:08:33,014 INFO] Arguments: Namespace(T=0.5, algorithm='selfkd', amp=False, batch_size=16, c='configs/gbc/selfkd_deit.yaml', clip=0.0, clip_grad=0, crop_ratio=0.875, data_dir='./data', dataset='GBUSV', device=device(type='cuda'), dist_backend='nccl', dist_url='tcp://127.0.0.1:29906', distributed=False, ds_seed=123, ema_m=0.999, epoch=100, eval_batch_size=16, eval_step=234, expand_labels=True, gpu=None, hard_label=True, imb_algorithm=None, img_size=224, include_lb_to_ulb=True, kd_alpha=0.4, kd_alpha_ulb=0.5, kd_temp=1.5, kd_temp_ulb=1.5, la=True, labeled_set_path='/home/deepankar/mnt/vision1_outputs/gbusg_radformer/GBUSV_deit/SGD/1000_val100/random_v1_transforms/X_trial_3_cycle_1_labeled_set.npy', layer_decay=0.5, lb_dest_len=3600, lb_imb_ratio=1, load_labeled_set=True, load_path=None, local_rank=-1, lr=0.01, max_length=512, max_length_seconds=4.0, momentum=0.9, multiprocessing_distributed=False, net='deit_base_patch16_224', net_from_name=False, no_progress=True, num_classes=3, num_eval_iter=234, num_labels=1000, num_log_iter=234, num_train_iter=900000, num_warmup_iter=5120, num_workers=4, optim='SGD', overwrite=True, p_cutoff=0.95, pretrain_path='', pretrained_dir='/home/deepankar/scratch/MSA_Medical/activethief/pretrained/deit_base_patch16_224-b5f2ef4d.pth', rank=0, resume=False, sample_rate=16000, save_dir='saved_models/radformer', save_name='selfkd_deit_temp', scheduler_type='cosine', seed=5, subset=128116, thief_root='/home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBUSV-Shared', train_sampler='RandomSampler', tro=1, ulb_dest_len=15800, ulb_imb_ratio=1, ulb_loss_ratio=1.0, ulb_num_labels=None, uratio=2, use_aim=False, use_cat=True, use_pretrain=True, use_tensorboard=True, use_wandb=True, val_set_path='/home/deepankar/mnt/vision1_outputs/gbusg_radformer/GBUSV_deit/SGD/1000_val100/random_v1_transforms/X_trial_3_cycle_1_val_set.npy', victim_arch='radformer', victim_data_root='/home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBCU-Shared', victim_dataset='gbusg', victim_model_path='/home/deepankar/mnt/vision3_data_ckpts_msa_medical/victim_models/radformer/radformer.pkl', warmstart=False, warmstart_dir='/home/deepankar/mnt/vision1_outputs/gbusg_radformer/GBUSV_deit/SGD/1000_val100/random_v1_transforms/trial_3_cycle_1_best.pth', warmup=0, warmup_epoch=10, weight_decay=0.0005, world_size=1)
[2024-03-04 12:08:33,014 INFO] Validation set distribution: 
anchor model temp =  1.0
Number of samples  100
[2024-03-04 12:08:33,960 INFO] {0: 13, 1: 19, 2: 68}
[2024-03-04 12:08:33,960 INFO] Labeled set distribution: 
Number of samples  3600
[2024-03-04 12:08:40,150 INFO] {0: 392, 1: 860, 2: 2348}
[2024-03-04 12:08:44,023 INFO] Initial model on target dataset (without EMA): acc = 0.3934, agreement = 0.3689, spec = 0.74, sens = 0.31
[2024-03-04 12:08:44,023 INFO] Resume load path None does not exist
[2024-03-04 12:08:44,023 INFO] 
Model training
[2024-03-04 12:08:49,186 INFO] Retry attempt failed:
Traceback (most recent call last):
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/urllib3/connectionpool.py", line 712, in urlopen
    self._prepare_proxy(conn)
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1012, in _prepare_proxy
    conn.connect()
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/urllib3/connection.py", line 374, in connect
    self._tunnel()
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/http/client.py", line 905, in _tunnel
    raise OSError("Tunnel connection failed: %d %s" % (code,
OSError: Tunnel connection failed: 302 Moved Temporarily

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/requests/adapters.py", line 440, in send
    resp = conn.urlopen(
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.wandb.ai', port=443): Max retries exceeded with url: /graphql (Caused by ProxyError('Cannot connect to proxy.', OSError('Tunnel connection failed: 302 Moved Temporarily')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/wandb/sdk/lib/retry.py", line 131, in __call__
    result = self._call_fn(*args, **kwargs)
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/wandb/sdk/internal/internal_api.py", line 369, in execute
    return self.client.execute(*args, **kwargs)  # type: ignore
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/wandb/vendor/gql-0.2.0/wandb_gql/client.py", line 52, in execute
    result = self._get_result(document, *args, **kwargs)
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/wandb/vendor/gql-0.2.0/wandb_gql/client.py", line 60, in _get_result
    return self.transport.execute(document, *args, **kwargs)
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/wandb/sdk/lib/gql_request.py", line 58, in execute
    request = self.session.post(self.url, **post_args)
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/requests/adapters.py", line 513, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: HTTPSConnectionPool(host='api.wandb.ai', port=443): Max retries exceeded with url: /graphql (Caused by ProxyError('Cannot connect to proxy.', OSError('Tunnel connection failed: 302 Moved Temporarily')))
wandb: Network error (ProxyError), entering retry loop.
wandb: W&B API key is configured. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: Network error (ProxyError), entering retry loop.
wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in saved_models/radformer/wandb/selfkd_deit_temp/wandb/run-20240304_120850-ob9jaxcy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run selfkd_deit_temp
wandb: â­ï¸ View project at https://wandb.ai/satwikdpshrit/radformer
wandb: ðŸš€ View run at https://wandb.ai/satwikdpshrit/radformer/runs/ob9jaxcy
[2024-03-04 12:09:11,963 INFO] 

epoch 0
wandb: Network error resolved after 0:00:18.345790, resuming normal operation.
[2024-03-04 12:13:12,094 INFO] validating...
[2024-03-04 12:13:17,210 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:13:18,510 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 12:13:18,511 INFO] 226 iteration, USE_EMA: True, train/sup_loss: 0.56807, train/unsup_loss: 0.42743, train/total_loss: 0.99550, train/util_ratio: 0.46875, train/run_time: 1.03073, lr: 0.00000, train/prefecth_time: 0.00911, eval/loss: 1.13683, eval/top-1-acc: 0.34000, eval/balanced_acc: 0.38968, eval/precision: 0.45815, eval/recall: 0.38968, eval/F1: 0.27953, eval/spec: 1.00000, eval/sens: 0.25000, test/loss: 1.04015, test/top-1-acc: 0.39344, test/balanced_acc: 0.34522, test/precision: 0.42590, test/recall: 0.34522, test/F1: 0.30214, test/spec: 0.73750, test/sens: 0.30952 BEST_EVAL_ACC: 0.3400, at 226 iters BEST_TEST_ACC: 0.3934, at 226 iters
[2024-03-04 12:13:18,514 INFO] 

epoch 1
[2024-03-04 12:17:19,460 INFO] validating...
[2024-03-04 12:17:25,423 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:17:27,413 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 12:17:27,414 INFO] 451 iteration, USE_EMA: True, train/sup_loss: 0.57241, train/unsup_loss: 0.29920, train/total_loss: 0.87161, train/util_ratio: 0.53125, train/run_time: 1.03011, lr: 0.00100, train/prefecth_time: 0.00971, eval/loss: 0.99626, eval/top-1-acc: 0.48000, eval/balanced_acc: 0.54481, eval/precision: 0.56453, eval/recall: 0.54481, eval/F1: 0.47931, eval/spec: 0.96875, eval/sens: 0.41176, test/loss: 0.99725, test/top-1-acc: 0.45082, test/balanced_acc: 0.39792, test/precision: 0.64130, test/recall: 0.39792, test/F1: 0.35813, test/spec: 0.82500, test/sens: 0.33333 BEST_EVAL_ACC: 0.4800, at 451 iters BEST_TEST_ACC: 0.4508, at 451 iters
[2024-03-04 12:17:27,417 INFO] 

epoch 2
[2024-03-04 12:21:28,578 INFO] validating...
[2024-03-04 12:21:34,450 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:21:36,424 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 12:21:36,424 INFO] 676 iteration, USE_EMA: True, train/sup_loss: 0.36689, train/unsup_loss: 0.19289, train/total_loss: 0.55978, train/util_ratio: 0.43750, train/run_time: 1.03122, lr: 0.00200, train/prefecth_time: 0.00866, eval/loss: 0.95294, eval/top-1-acc: 0.53000, eval/balanced_acc: 0.56932, eval/precision: 0.54922, eval/recall: 0.56932, eval/F1: 0.49869, eval/spec: 0.96875, eval/sens: 0.48529, test/loss: 0.94962, test/top-1-acc: 0.51639, test/balanced_acc: 0.46931, test/precision: 0.58009, test/recall: 0.46931, test/F1: 0.45132, test/spec: 0.82500, test/sens: 0.52381 BEST_EVAL_ACC: 0.5300, at 676 iters BEST_TEST_ACC: 0.5164, at 676 iters
[2024-03-04 12:21:36,426 INFO] 

epoch 3
[2024-03-04 12:25:37,416 INFO] validating...
[2024-03-04 12:25:43,385 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:25:45,312 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 12:25:45,313 INFO] 901 iteration, USE_EMA: True, train/sup_loss: 0.21060, train/unsup_loss: 0.17427, train/total_loss: 0.38487, train/util_ratio: 0.40625, train/run_time: 1.02981, lr: 0.00300, train/prefecth_time: 0.01031, eval/loss: 0.83888, eval/top-1-acc: 0.64000, eval/balanced_acc: 0.63134, eval/precision: 0.58683, eval/recall: 0.63134, eval/F1: 0.58184, eval/spec: 0.90625, eval/sens: 0.64706, test/loss: 0.89549, test/top-1-acc: 0.58197, test/balanced_acc: 0.54294, test/precision: 0.63399, test/recall: 0.54294, test/F1: 0.54600, test/spec: 0.88750, test/sens: 0.59524 BEST_EVAL_ACC: 0.6400, at 901 iters BEST_TEST_ACC: 0.5820, at 901 iters
[2024-03-04 12:25:45,317 INFO] 

epoch 4
[2024-03-04 12:29:45,937 INFO] validating...
[2024-03-04 12:29:51,885 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:29:54,015 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 12:29:54,016 INFO] 1126 iteration, USE_EMA: True, train/sup_loss: 0.28952, train/unsup_loss: 0.09657, train/total_loss: 0.38608, train/util_ratio: 0.28125, train/run_time: 1.02777, lr: 0.00400, train/prefecth_time: 0.00920, eval/loss: 0.76541, eval/top-1-acc: 0.72000, eval/balanced_acc: 0.69130, eval/precision: 0.62692, eval/recall: 0.69130, eval/F1: 0.64015, eval/spec: 0.96875, eval/sens: 0.75000, test/loss: 0.84412, test/top-1-acc: 0.60656, test/balanced_acc: 0.57691, test/precision: 0.64501, test/recall: 0.57691, test/F1: 0.58227, test/spec: 0.83750, test/sens: 0.71429 BEST_EVAL_ACC: 0.7200, at 1126 iters BEST_TEST_ACC: 0.6066, at 1126 iters
[2024-03-04 12:29:54,019 INFO] 

epoch 5
[2024-03-04 12:33:54,296 INFO] validating...
[2024-03-04 12:34:00,360 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:34:02,352 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 12:34:02,353 INFO] 1351 iteration, USE_EMA: True, train/sup_loss: 0.29455, train/unsup_loss: 0.11975, train/total_loss: 0.41430, train/util_ratio: 0.50000, train/run_time: 1.02582, lr: 0.00500, train/prefecth_time: 0.00949, eval/loss: 0.71082, eval/top-1-acc: 0.72000, eval/balanced_acc: 0.72922, eval/precision: 0.66286, eval/recall: 0.72922, eval/F1: 0.67066, eval/spec: 0.93750, eval/sens: 0.70588, test/loss: 0.79840, test/top-1-acc: 0.63934, test/balanced_acc: 0.61429, test/precision: 0.67077, test/recall: 0.61429, test/F1: 0.62059, test/spec: 0.82500, test/sens: 0.76190 BEST_EVAL_ACC: 0.7200, at 1351 iters BEST_TEST_ACC: 0.6393, at 1351 iters
[2024-03-04 12:34:02,356 INFO] 

epoch 6
[2024-03-04 12:38:02,987 INFO] validating...
[2024-03-04 12:38:09,015 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:38:11,164 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 12:38:11,165 INFO] 1576 iteration, USE_EMA: True, train/sup_loss: 0.19792, train/unsup_loss: 0.08891, train/total_loss: 0.28683, train/util_ratio: 0.40625, train/run_time: 1.02898, lr: 0.00600, train/prefecth_time: 0.00864, eval/loss: 0.66675, eval/top-1-acc: 0.75000, eval/balanced_acc: 0.71864, eval/precision: 0.65814, eval/recall: 0.71864, eval/F1: 0.67471, eval/spec: 0.93750, eval/sens: 0.77941, test/loss: 0.76927, test/top-1-acc: 0.62295, test/balanced_acc: 0.60577, test/precision: 0.63102, test/recall: 0.60577, test/F1: 0.60855, test/spec: 0.81250, test/sens: 0.78571 BEST_EVAL_ACC: 0.7500, at 1576 iters BEST_TEST_ACC: 0.6230, at 1576 iters
[2024-03-04 12:38:11,168 INFO] 

epoch 7
[2024-03-04 12:42:12,583 INFO] validating...
[2024-03-04 12:42:18,686 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:42:20,909 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 12:42:20,914 INFO] 1801 iteration, USE_EMA: True, train/sup_loss: 0.24292, train/unsup_loss: 0.06821, train/total_loss: 0.31113, train/util_ratio: 0.43750, train/run_time: 1.03195, lr: 0.00700, train/prefecth_time: 0.00921, eval/loss: 0.60708, eval/top-1-acc: 0.78000, eval/balanced_acc: 0.76673, eval/precision: 0.69653, eval/recall: 0.76673, eval/F1: 0.71701, eval/spec: 0.96875, eval/sens: 0.79412, test/loss: 0.74786, test/top-1-acc: 0.63934, test/balanced_acc: 0.62446, test/precision: 0.64582, test/recall: 0.62446, test/F1: 0.62659, test/spec: 0.81250, test/sens: 0.80952 BEST_EVAL_ACC: 0.7800, at 1801 iters BEST_TEST_ACC: 0.6393, at 1801 iters
[2024-03-04 12:42:20,917 INFO] 

epoch 8
[2024-03-04 12:46:21,667 INFO] validating...
[2024-03-04 12:46:27,773 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:46:27,774 INFO] 2026 iteration, USE_EMA: True, train/sup_loss: 0.27895, train/unsup_loss: 0.05569, train/total_loss: 0.33464, train/util_ratio: 0.40625, train/run_time: 1.02577, lr: 0.00800, train/prefecth_time: 0.00904, eval/loss: 0.62066, eval/top-1-acc: 0.76000, eval/balanced_acc: 0.72355, eval/precision: 0.66369, eval/recall: 0.72355, eval/F1: 0.68162, eval/spec: 0.93750, eval/sens: 0.79412, test/loss: 0.73567, test/top-1-acc: 0.63115, test/balanced_acc: 0.61652, test/precision: 0.64007, test/recall: 0.61652, test/F1: 0.62001, test/spec: 0.81250, test/sens: 0.78571 BEST_EVAL_ACC: 0.7800, at 1801 iters BEST_TEST_ACC: 0.6393, at 1801 iters
[2024-03-04 12:46:27,777 INFO] 

epoch 9
[2024-03-04 12:50:28,625 INFO] validating...
[2024-03-04 12:50:34,368 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:50:36,361 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 12:50:36,362 INFO] 2251 iteration, USE_EMA: True, train/sup_loss: 0.19112, train/unsup_loss: 0.06249, train/total_loss: 0.25361, train/util_ratio: 0.50000, train/run_time: 1.03276, lr: 0.00900, train/prefecth_time: 0.01966, eval/loss: 0.60224, eval/top-1-acc: 0.79000, eval/balanced_acc: 0.75089, eval/precision: 0.71353, eval/recall: 0.75089, eval/F1: 0.72151, eval/spec: 0.93750, eval/sens: 0.82353, test/loss: 0.72143, test/top-1-acc: 0.66393, test/balanced_acc: 0.65558, test/precision: 0.67277, test/recall: 0.65558, test/F1: 0.65992, test/spec: 0.82500, test/sens: 0.78571 BEST_EVAL_ACC: 0.7900, at 2251 iters BEST_TEST_ACC: 0.6639, at 2251 iters
[2024-03-04 12:50:36,366 INFO] 

epoch 10
[2024-03-04 12:54:36,752 INFO] validating...
[2024-03-04 12:54:42,460 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:54:42,461 INFO] 2476 iteration, USE_EMA: True, train/sup_loss: 0.26630, train/unsup_loss: 0.03634, train/total_loss: 0.30264, train/util_ratio: 0.37500, train/run_time: 1.02944, lr: 0.01000, train/prefecth_time: 0.00988, eval/loss: 0.55665, eval/top-1-acc: 0.80000, eval/balanced_acc: 0.74315, eval/precision: 0.69028, eval/recall: 0.74315, eval/F1: 0.71053, eval/spec: 0.93750, eval/sens: 0.85294, test/loss: 0.70670, test/top-1-acc: 0.68033, test/balanced_acc: 0.67709, test/precision: 0.68939, test/recall: 0.67709, test/F1: 0.68098, test/spec: 0.83750, test/sens: 0.78571 BEST_EVAL_ACC: 0.7900, at 2251 iters BEST_TEST_ACC: 0.6639, at 2251 iters
[2024-03-04 12:54:42,465 INFO] 

epoch 11
[2024-03-04 12:58:42,972 INFO] validating...
[2024-03-04 12:58:48,886 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 12:58:50,845 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 12:58:50,846 INFO] 2701 iteration, USE_EMA: True, train/sup_loss: 0.22040, train/unsup_loss: 0.03456, train/total_loss: 0.25496, train/util_ratio: 0.43750, train/run_time: 1.03101, lr: 0.01000, train/prefecth_time: 0.00898, eval/loss: 0.54992, eval/top-1-acc: 0.82000, eval/balanced_acc: 0.76560, eval/precision: 0.71685, eval/recall: 0.76560, eval/F1: 0.73625, eval/spec: 0.93750, eval/sens: 0.86765, test/loss: 0.69955, test/top-1-acc: 0.69672, test/balanced_acc: 0.69860, test/precision: 0.70441, test/recall: 0.69860, test/F1: 0.70035, test/spec: 0.83750, test/sens: 0.78571 BEST_EVAL_ACC: 0.8200, at 2701 iters BEST_TEST_ACC: 0.6967, at 2701 iters
[2024-03-04 12:58:50,850 INFO] 

epoch 12
[2024-03-04 13:02:51,368 INFO] validating...
[2024-03-04 13:02:57,180 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 13:02:59,287 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 13:02:59,288 INFO] 2926 iteration, USE_EMA: True, train/sup_loss: 0.15386, train/unsup_loss: 0.01945, train/total_loss: 0.17331, train/util_ratio: 0.43750, train/run_time: 1.03060, lr: 0.01000, train/prefecth_time: 0.01063, eval/loss: 0.55011, eval/top-1-acc: 0.81000, eval/balanced_acc: 0.76070, eval/precision: 0.72720, eval/recall: 0.76070, eval/F1: 0.73792, eval/spec: 0.90625, eval/sens: 0.85294, test/loss: 0.69566, test/top-1-acc: 0.69672, test/balanced_acc: 0.70028, test/precision: 0.70652, test/recall: 0.70028, test/F1: 0.70307, test/spec: 0.85000, test/sens: 0.73810 BEST_EVAL_ACC: 0.8100, at 2926 iters BEST_TEST_ACC: 0.6967, at 2926 iters
[2024-03-04 13:02:59,292 INFO] 

epoch 13
[2024-03-04 13:06:59,835 INFO] validating...
[2024-03-04 13:07:05,550 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 13:07:07,532 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 13:07:07,533 INFO] 3151 iteration, USE_EMA: True, train/sup_loss: 0.19274, train/unsup_loss: 0.01996, train/total_loss: 0.21270, train/util_ratio: 0.40625, train/run_time: 1.03364, lr: 0.00999, train/prefecth_time: 0.00847, eval/loss: 0.56984, eval/top-1-acc: 0.82000, eval/balanced_acc: 0.76560, eval/precision: 0.72935, eval/recall: 0.76560, eval/F1: 0.74470, eval/spec: 0.87500, eval/sens: 0.86765, test/loss: 0.70149, test/top-1-acc: 0.68852, test/balanced_acc: 0.69121, test/precision: 0.69765, test/recall: 0.69121, test/F1: 0.69403, test/spec: 0.86250, test/sens: 0.69048 BEST_EVAL_ACC: 0.8200, at 3151 iters BEST_TEST_ACC: 0.6885, at 3151 iters
[2024-03-04 13:07:07,536 INFO] 

epoch 14
[2024-03-04 13:11:08,135 INFO] validating...
[2024-03-04 13:11:13,537 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 13:11:13,538 INFO] 3376 iteration, USE_EMA: True, train/sup_loss: 0.12970, train/unsup_loss: 0.01567, train/total_loss: 0.14537, train/util_ratio: 0.37500, train/run_time: 1.03301, lr: 0.00998, train/prefecth_time: 0.00902, eval/loss: 0.57392, eval/top-1-acc: 0.80000, eval/balanced_acc: 0.75580, eval/precision: 0.71947, eval/recall: 0.75580, eval/F1: 0.72856, eval/spec: 0.93750, eval/sens: 0.83824, test/loss: 0.70174, test/top-1-acc: 0.68033, test/balanced_acc: 0.68440, test/precision: 0.68738, test/recall: 0.68440, test/F1: 0.68566, test/spec: 0.86250, test/sens: 0.69048 BEST_EVAL_ACC: 0.8200, at 3151 iters BEST_TEST_ACC: 0.6885, at 3151 iters
[2024-03-04 13:11:13,541 INFO] 

epoch 15
[2024-03-04 13:15:13,885 INFO] validating...
[2024-03-04 13:15:19,737 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 13:15:21,999 INFO] model saved: saved_models/radformer/selfkd_deit_temp/model_best.pth
[2024-03-04 13:15:22,000 INFO] 3601 iteration, USE_EMA: True, train/sup_loss: 0.22221, train/unsup_loss: 0.01511, train/total_loss: 0.23732, train/util_ratio: 0.40625, train/run_time: 1.03071, lr: 0.00997, train/prefecth_time: 0.00890, eval/loss: 0.56378, eval/top-1-acc: 0.83000, eval/balanced_acc: 0.77860, eval/precision: 0.74396, eval/recall: 0.77860, eval/F1: 0.75861, eval/spec: 0.90625, eval/sens: 0.88235, test/loss: 0.70140, test/top-1-acc: 0.68033, test/balanced_acc: 0.68949, test/precision: 0.68456, test/recall: 0.68949, test/F1: 0.68673, test/spec: 0.86250, test/sens: 0.71429 BEST_EVAL_ACC: 0.8300, at 3601 iters BEST_TEST_ACC: 0.6803, at 3601 iters
[2024-03-04 13:15:22,004 INFO] 

epoch 16
[2024-03-04 13:19:22,709 INFO] validating...
[2024-03-04 13:19:28,350 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 13:19:28,351 INFO] 3826 iteration, USE_EMA: True, train/sup_loss: 0.22308, train/unsup_loss: 0.02058, train/total_loss: 0.24366, train/util_ratio: 0.40625, train/run_time: 1.03059, lr: 0.00996, train/prefecth_time: 0.00963, eval/loss: 0.58875, eval/top-1-acc: 0.78000, eval/balanced_acc: 0.74599, eval/precision: 0.69704, eval/recall: 0.74599, eval/F1: 0.71181, eval/spec: 0.90625, eval/sens: 0.80882, test/loss: 0.69870, test/top-1-acc: 0.68033, test/balanced_acc: 0.69344, test/precision: 0.68262, test/recall: 0.69344, test/F1: 0.68690, test/spec: 0.86250, test/sens: 0.71429 BEST_EVAL_ACC: 0.8300, at 3601 iters BEST_TEST_ACC: 0.6803, at 3601 iters
[2024-03-04 13:19:28,353 INFO] 

epoch 17
[2024-03-04 13:23:29,582 INFO] validating...
[2024-03-04 13:23:35,320 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 13:23:35,321 INFO] 4051 iteration, USE_EMA: True, train/sup_loss: 0.14942, train/unsup_loss: 0.00871, train/total_loss: 0.15814, train/util_ratio: 0.40625, train/run_time: 1.02399, lr: 0.00994, train/prefecth_time: 0.01029, eval/loss: 0.54001, eval/top-1-acc: 0.81000, eval/balanced_acc: 0.77334, eval/precision: 0.73262, eval/recall: 0.77334, eval/F1: 0.74504, eval/spec: 0.90625, eval/sens: 0.83824, test/loss: 0.69915, test/top-1-acc: 0.68033, test/balanced_acc: 0.69344, test/precision: 0.68262, test/recall: 0.69344, test/F1: 0.68690, test/spec: 0.86250, test/sens: 0.71429 BEST_EVAL_ACC: 0.8300, at 3601 iters BEST_TEST_ACC: 0.6803, at 3601 iters
[2024-03-04 13:23:35,324 INFO] 

epoch 18
[2024-03-04 13:27:36,318 INFO] validating...
[2024-03-04 13:27:42,056 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 13:27:42,058 INFO] 4276 iteration, USE_EMA: True, train/sup_loss: 0.17627, train/unsup_loss: 0.00615, train/total_loss: 0.18243, train/util_ratio: 0.34375, train/run_time: 1.03204, lr: 0.00993, train/prefecth_time: 0.01006, eval/loss: 0.58175, eval/top-1-acc: 0.80000, eval/balanced_acc: 0.74315, eval/precision: 0.70317, eval/recall: 0.74315, eval/F1: 0.71690, eval/spec: 0.93750, eval/sens: 0.85294, test/loss: 0.69995, test/top-1-acc: 0.68033, test/balanced_acc: 0.69625, test/precision: 0.68329, test/recall: 0.69625, test/F1: 0.68804, test/spec: 0.86250, test/sens: 0.69048 BEST_EVAL_ACC: 0.8300, at 3601 iters BEST_TEST_ACC: 0.6803, at 3601 iters
[2024-03-04 13:27:42,061 INFO] 

epoch 19
[2024-03-04 13:31:43,296 INFO] validating...
[2024-03-04 13:31:49,082 INFO] model saved: saved_models/radformer/selfkd_deit_temp/latest_model.pth
[2024-03-04 13:31:49,083 INFO] 4501 iteration, USE_EMA: True, train/sup_loss: 0.15928, train/unsup_loss: 0.00635, train/total_loss: 0.16564, train/util_ratio: 0.37500, train/run_time: 1.02758, lr: 0.00991, train/prefecth_time: 0.00889, eval/loss: 0.56821, eval/top-1-acc: 0.81000, eval/balanced_acc: 0.76070, eval/precision: 0.72720, eval/recall: 0.76070, eval/F1: 0.73792, eval/spec: 0.90625, eval/sens: 0.85294, test/loss: 0.70480, test/top-1-acc: 0.68852, test/balanced_acc: 0.70306, test/precision: 0.69054, test/recall: 0.70306, test/F1: 0.69505, test/spec: 0.86250, test/sens: 0.69048 BEST_EVAL_ACC: 0.8300, at 3601 iters BEST_TEST_ACC: 0.6803, at 3601 iters
[2024-03-04 13:31:49,086 INFO] 

epoch 20
