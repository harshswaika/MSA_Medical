[2024-03-05 10:37:20,075 INFO] Use GPU: None for training
[2024-03-05 10:37:20,075 INFO] 

[2024-03-05 10:37:21,069 INFO] Total params: 109.04M
[2024-03-05 10:37:29,465 INFO] acc: 0.90
[2024-03-05 10:37:29,476 INFO] Victim model accuracy = 0.9016, spec = 0.90, sens = 0.93
[2024-03-05 10:37:29,477 INFO] Loading thief dataset ...
[2024-03-05 10:37:29,481 INFO] 
Initializing thief model ...


Loaded supervised labeled set of length  900
Labeled set expanded to length  3600 , unique indices  900
dataset root /home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBUSV-Shared
Num of videos 64 frames 15800
15800
15800
Num of videos 64 frames 15800
  0%|          | 0/29 [00:00<?, ?it/s]  3%|â–Ž         | 1/29 [00:06<03:10,  6.81s/it]  7%|â–‹         | 2/29 [00:08<01:46,  3.94s/it] 10%|â–ˆ         | 3/29 [00:10<01:19,  3.05s/it] 14%|â–ˆâ–        | 4/29 [00:12<01:05,  2.61s/it] 17%|â–ˆâ–‹        | 5/29 [00:14<00:59,  2.49s/it] 21%|â–ˆâ–ˆ        | 6/29 [00:17<00:59,  2.58s/it] 24%|â–ˆâ–ˆâ–       | 7/29 [00:19<00:53,  2.44s/it] 28%|â–ˆâ–ˆâ–Š       | 8/29 [00:21<00:48,  2.32s/it] 31%|â–ˆâ–ˆâ–ˆ       | 9/29 [00:23<00:44,  2.24s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 10/29 [00:25<00:40,  2.15s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 11/29 [00:27<00:38,  2.12s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 12/29 [00:30<00:36,  2.15s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 13/29 [00:32<00:33,  2.12s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 14/29 [00:34<00:31,  2.08s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 15/29 [00:36<00:28,  2.06s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 16/29 [00:38<00:26,  2.02s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 17/29 [00:40<00:25,  2.10s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 18/29 [00:42<00:23,  2.11s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 19/29 [00:44<00:20,  2.07s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 20/29 [00:46<00:18,  2.03s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 21/29 [00:48<00:15,  2.00s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 22/29 [00:50<00:13,  1.91s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 23/29 [00:52<00:11,  1.90s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 24/29 [00:53<00:09,  1.83s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 25/29 [00:55<00:06,  1.72s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 26/29 [00:56<00:04,  1.64s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 27/29 [00:58<00:03,  1.60s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 28/29 [00:59<00:01,  1.55s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [01:01<00:00,  1.54s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [01:01<00:00,  2.11s/it]
Num of videos 64 frames 15800
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.80s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.91s/it]
[2024-03-05 10:38:35,584 INFO] unlabeled data number: 15800, labeled data number 3600
[2024-03-05 10:38:35,585 INFO] Create train and test data loaders
[2024-03-05 10:38:35,585 INFO] [!] data loader keys: dict_keys(['train_lb', 'train_ulb', 'eval', 'test'])
[2024-03-05 10:38:37,365 INFO] Create optimizer and scheduler
Num of videos 64 frames 15800
[2024-03-05 10:38:43,074 INFO] Number of Trainable Params: 85800963
logit adjustments:  tensor([-2.1774, -1.4088, -0.4428], device='cuda:0')
Load pretrained model for initializing the thief from  /home/deepankar/mnt/vision3_ckpts/vit_b_16-imagenet1k.pth
key not found heads.head.weight
key not found heads.head.bias
Common keys pretrained model:  150
Load anchor model /home/deepankar/mnt/vision1_outputs/gbusg_radformer/GBUSV_vit/SGD/1000_val100/random_v1_transforms/trial_2_cycle_1_best.pth
thief state:  ['class_token', 'conv_proj.weight', 'conv_proj.bias', 'encoder.pos_embedding', 'encoder.layers.encoder_layer_0.ln_1.weight']
pretrained state:  ['class_token', 'conv_proj.weight', 'conv_proj.bias', 'encoder.pos_embedding', 'encoder.layers.encoder_layer_0.ln_1.weight']
Common keys anchor model:  152
[2024-03-05 10:38:51,656 INFO] Anchor model on target dataset: acc = 0.4344, spec = 0.68, sens = 0.43
[2024-03-05 10:38:52,084 INFO] Arguments: Namespace(T=0.5, algorithm='selfkd', amp=False, batch_size=16, c='configs/gbc/selfkd_vit.yaml', clip=0.0, clip_grad=0, crop_ratio=0.875, data_dir='./data', dataset='GBUSV', device=device(type='cuda'), dist_backend='nccl', dist_url='tcp://127.0.0.1:29829', distributed=False, ds_seed=123, ema_m=0.999, epoch=100, eval_batch_size=16, eval_step=234, expand_labels=True, gpu=None, hard_label=True, imb_algorithm=None, img_size=224, include_lb_to_ulb=True, kd_alpha=0.4, kd_alpha_ulb=0.5, kd_temp=1.5, kd_temp_ulb=1.5, la=True, labeled_set_path='/home/deepankar/mnt/vision1_outputs/gbusg_radformer/GBUSV_vit/SGD/1000_val100/random_v1_transforms/X_trial_2_cycle_1_labeled_set.npy', layer_decay=0.5, lb_dest_len=3600, lb_imb_ratio=1, load_labeled_set=True, load_path=None, local_rank=-1, lr=0.01, max_length=512, max_length_seconds=4.0, momentum=0.9, multiprocessing_distributed=False, net='vit_b_16', net_from_name=False, no_progress=True, num_classes=3, num_eval_iter=234, num_labels=1000, num_log_iter=234, num_train_iter=900000, num_warmup_iter=5120, num_workers=4, optim='SGD', overwrite=True, p_cutoff=0.95, pretrain_path='', pretrained_dir='/home/deepankar/mnt/vision3_ckpts/vit_b_16-imagenet1k.pth', rank=0, resume=False, sample_rate=16000, save_dir='saved_models/radformer', save_name='selfkd_vit_v8_exp4_2_ur3', scheduler_type='cosine', seed=5, subset=128116, thief_root='/home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBUSV-Shared', train_sampler='RandomSampler', tro=1, ulb_dest_len=15800, ulb_imb_ratio=1, ulb_loss_ratio=1.0, ulb_num_labels=None, uratio=3, use_aim=False, use_cat=True, use_pretrain=True, use_tensorboard=True, use_wandb=True, val_set_path='/home/deepankar/mnt/vision1_outputs/gbusg_radformer/GBUSV_vit/SGD/1000_val100/random_v1_transforms/X_trial_2_cycle_1_val_set.npy', victim_arch='radformer', victim_data_root='/home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBCU-Shared', victim_dataset='gbusg', victim_model_path='/home/deepankar/mnt/vision3_data_ckpts_msa_medical/victim_models/radformer/radformer.pkl', warmstart=False, warmstart_dir='/home/deepankar/mnt/vision1_outputs/gbusg_radformer/GBUSV_vit/SGD/1000_val100/random_v1_transforms/trial_2_cycle_1_best.pth', warmup=0, warmup_epoch=10, weight_decay=0.0005, world_size=1)
[2024-03-05 10:38:52,084 INFO] Validation set distribution: 
anchor model temp =  1.0
Number of samples  100
[2024-03-05 10:38:52,999 INFO] {0: 16, 1: 21, 2: 63}
[2024-03-05 10:38:53,000 INFO] Labeled set distribution: 
Number of samples  3600
[2024-03-05 10:38:59,436 INFO] {0: 408, 1: 880, 2: 2312}
[2024-03-05 10:39:03,628 INFO] Initial model on target dataset (without EMA): acc = 0.2541, agreement = 0.2377, spec = 1.00, sens = 0.00
[2024-03-05 10:39:03,628 INFO] Resume load path None does not exist
[2024-03-05 10:39:03,628 INFO] 
Model training
wandb: Currently logged in as: satwikdpshrit. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in saved_models/radformer/wandb/selfkd_vit_v8_exp4_2_ur3/wandb/run-20240305_103905-kwnjismy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run selfkd_vit_v8_exp4_2_ur3
wandb: â­ï¸ View project at https://wandb.ai/satwikdpshrit/radformer
wandb: ðŸš€ View run at https://wandb.ai/satwikdpshrit/radformer/runs/kwnjismy
[2024-03-05 10:39:09,114 INFO] 

epoch 0
[2024-03-05 10:44:54,252 INFO] validating...
[2024-03-05 10:44:59,341 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 10:45:00,810 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/model_best.pth
[2024-03-05 10:45:00,811 INFO] 226 iteration, USE_EMA: True, train/sup_loss: 1.17119, train/unsup_loss: 0.30631, train/total_loss: 1.47750, train/util_ratio: 0.31250, train/run_time: 1.49301, lr: 0.00000, train/prefecth_time: 0.01065, eval/loss: 1.09861, eval/top-1-acc: 0.16000, eval/balanced_acc: 0.33333, eval/precision: 0.05333, eval/recall: 0.33333, eval/F1: 0.09195, eval/spec: 1.00000, eval/sens: 0.00000, test/loss: 1.09861, test/top-1-acc: 0.25410, test/balanced_acc: 0.33333, test/precision: 0.08470, test/recall: 0.33333, test/F1: 0.13508, test/spec: 1.00000, test/sens: 0.00000 BEST_EVAL_ACC: 0.1600, at 226 iters BEST_TEST_ACC: 0.2541, at 226 iters
[2024-03-05 10:45:00,814 INFO] 

epoch 1
[2024-03-05 10:50:49,394 INFO] validating...
[2024-03-05 10:50:55,064 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 10:50:57,170 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/model_best.pth
[2024-03-05 10:50:57,170 INFO] 451 iteration, USE_EMA: True, train/sup_loss: 0.41582, train/unsup_loss: 0.16377, train/total_loss: 0.57959, train/util_ratio: 0.33333, train/run_time: 1.50770, lr: 0.00100, train/prefecth_time: 0.01013, eval/loss: 0.88432, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.54365, eval/precision: 0.59489, eval/recall: 0.54365, eval/F1: 0.55653, eval/spec: 0.62162, eval/sens: 0.95238, test/loss: 1.06083, test/top-1-acc: 0.36066, test/balanced_acc: 0.34354, test/precision: 0.22681, test/recall: 0.34354, test/F1: 0.22696, test/spec: 0.16250, test/sens: 0.92857 BEST_EVAL_ACC: 0.7300, at 451 iters BEST_TEST_ACC: 0.3607, at 451 iters
[2024-03-05 10:50:57,173 INFO] 

epoch 2
[2024-03-05 10:56:46,612 INFO] validating...
[2024-03-05 10:56:52,951 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 10:56:55,042 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/model_best.pth
[2024-03-05 10:56:55,043 INFO] 676 iteration, USE_EMA: True, train/sup_loss: 0.48358, train/unsup_loss: 0.16585, train/total_loss: 0.64944, train/util_ratio: 0.33333, train/run_time: 1.51119, lr: 0.00200, train/prefecth_time: 0.01176, eval/loss: 0.73631, eval/top-1-acc: 0.75000, eval/balanced_acc: 0.63194, eval/precision: 0.63544, eval/recall: 0.63194, eval/F1: 0.63254, eval/spec: 0.78378, eval/sens: 0.90476, test/loss: 1.01001, test/top-1-acc: 0.52459, test/balanced_acc: 0.47670, test/precision: 0.51190, test/recall: 0.47670, test/F1: 0.45117, test/spec: 0.81250, test/sens: 0.61905 BEST_EVAL_ACC: 0.7500, at 676 iters BEST_TEST_ACC: 0.5246, at 676 iters
[2024-03-05 10:56:55,047 INFO] 

epoch 3
[2024-03-05 11:02:44,430 INFO] validating...
[2024-03-05 11:02:50,572 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 11:02:52,949 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/model_best.pth
[2024-03-05 11:02:52,950 INFO] 901 iteration, USE_EMA: True, train/sup_loss: 0.39335, train/unsup_loss: 0.16147, train/total_loss: 0.55481, train/util_ratio: 0.39583, train/run_time: 1.51335, lr: 0.00300, train/prefecth_time: 0.01166, eval/loss: 0.64566, eval/top-1-acc: 0.79000, eval/balanced_acc: 0.71098, eval/precision: 0.68998, eval/recall: 0.71098, eval/F1: 0.69906, eval/spec: 0.91892, eval/sens: 0.88889, test/loss: 0.96064, test/top-1-acc: 0.45082, test/balanced_acc: 0.41200, test/precision: 0.51925, test/recall: 0.41200, test/F1: 0.39266, test/spec: 0.93750, test/sens: 0.21429 BEST_EVAL_ACC: 0.7900, at 901 iters BEST_TEST_ACC: 0.4508, at 901 iters
[2024-03-05 11:02:52,953 INFO] 

epoch 4
[2024-03-05 11:08:43,077 INFO] validating...
[2024-03-05 11:08:49,395 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 11:08:49,396 INFO] 1126 iteration, USE_EMA: True, train/sup_loss: 0.30586, train/unsup_loss: 0.11254, train/total_loss: 0.41841, train/util_ratio: 0.35417, train/run_time: 1.51294, lr: 0.00400, train/prefecth_time: 0.01163, eval/loss: 0.56428, eval/top-1-acc: 0.78000, eval/balanced_acc: 0.71065, eval/precision: 0.68534, eval/recall: 0.71065, eval/F1: 0.69387, eval/spec: 0.89189, eval/sens: 0.87302, test/loss: 0.93440, test/top-1-acc: 0.50000, test/balanced_acc: 0.47652, test/precision: 0.57868, test/recall: 0.47652, test/F1: 0.46686, test/spec: 0.93750, test/sens: 0.21429 BEST_EVAL_ACC: 0.7900, at 901 iters BEST_TEST_ACC: 0.4508, at 901 iters
[2024-03-05 11:08:49,399 INFO] 

epoch 5
[2024-03-05 11:14:40,938 INFO] validating...
[2024-03-05 11:14:47,141 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 11:14:49,610 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/model_best.pth
[2024-03-05 11:14:49,613 INFO] 1351 iteration, USE_EMA: True, train/sup_loss: 0.40406, train/unsup_loss: 0.08771, train/total_loss: 0.49177, train/util_ratio: 0.33333, train/run_time: 1.50776, lr: 0.00500, train/prefecth_time: 0.01129, eval/loss: 0.49805, eval/top-1-acc: 0.81000, eval/balanced_acc: 0.73710, eval/precision: 0.72112, eval/recall: 0.73710, eval/F1: 0.72736, eval/spec: 0.89189, eval/sens: 0.90476, test/loss: 0.89893, test/top-1-acc: 0.57377, test/balanced_acc: 0.56090, test/precision: 0.63889, test/recall: 0.56090, test/F1: 0.55823, test/spec: 0.92500, test/sens: 0.28571 BEST_EVAL_ACC: 0.8100, at 1351 iters BEST_TEST_ACC: 0.5738, at 1351 iters
[2024-03-05 11:14:49,616 INFO] 

epoch 6
[2024-03-05 11:20:40,653 INFO] validating...
[2024-03-05 11:20:46,743 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 11:20:46,744 INFO] 1576 iteration, USE_EMA: True, train/sup_loss: 0.23961, train/unsup_loss: 0.15031, train/total_loss: 0.38992, train/util_ratio: 0.31250, train/run_time: 1.51064, lr: 0.00600, train/prefecth_time: 0.01176, eval/loss: 0.47027, eval/top-1-acc: 0.78000, eval/balanced_acc: 0.71065, eval/precision: 0.68901, eval/recall: 0.71065, eval/F1: 0.69810, eval/spec: 0.86486, eval/sens: 0.87302, test/loss: 0.87211, test/top-1-acc: 0.60656, test/balanced_acc: 0.59714, test/precision: 0.66995, test/recall: 0.59714, test/F1: 0.59539, test/spec: 0.92500, test/sens: 0.30952 BEST_EVAL_ACC: 0.8100, at 1351 iters BEST_TEST_ACC: 0.5738, at 1351 iters
[2024-03-05 11:20:46,747 INFO] 

epoch 7
[2024-03-05 11:26:37,696 INFO] validating...
[2024-03-05 11:26:43,870 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 11:26:43,873 INFO] 1801 iteration, USE_EMA: True, train/sup_loss: 0.31926, train/unsup_loss: 0.09617, train/total_loss: 0.41543, train/util_ratio: 0.33333, train/run_time: 1.51303, lr: 0.00700, train/prefecth_time: 0.01092, eval/loss: 0.45654, eval/top-1-acc: 0.82000, eval/balanced_acc: 0.73181, eval/precision: 0.72737, eval/recall: 0.73181, eval/F1: 0.72682, eval/spec: 0.89189, eval/sens: 0.93651, test/loss: 0.82097, test/top-1-acc: 0.65574, test/balanced_acc: 0.64249, test/precision: 0.71708, test/recall: 0.64249, test/F1: 0.64981, test/spec: 0.91250, test/sens: 0.40476 BEST_EVAL_ACC: 0.8100, at 1351 iters BEST_TEST_ACC: 0.5738, at 1351 iters
[2024-03-05 11:26:43,877 INFO] 

epoch 8
[2024-03-05 11:32:34,314 INFO] validating...
[2024-03-05 11:32:40,158 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 11:32:40,159 INFO] 2026 iteration, USE_EMA: True, train/sup_loss: 0.35715, train/unsup_loss: 0.06719, train/total_loss: 0.42434, train/util_ratio: 0.33333, train/run_time: 1.51710, lr: 0.00800, train/prefecth_time: 0.01290, eval/loss: 0.42220, eval/top-1-acc: 0.81000, eval/balanced_acc: 0.72156, eval/precision: 0.72156, eval/recall: 0.72156, eval/F1: 0.72156, eval/spec: 0.86486, eval/sens: 0.92063, test/loss: 0.79826, test/top-1-acc: 0.65574, test/balanced_acc: 0.64589, test/precision: 0.70531, test/recall: 0.64589, test/F1: 0.65809, test/spec: 0.87500, test/sens: 0.47619 BEST_EVAL_ACC: 0.8100, at 1351 iters BEST_TEST_ACC: 0.5738, at 1351 iters
[2024-03-05 11:32:40,162 INFO] 

epoch 9
[2024-03-05 11:38:30,473 INFO] validating...
[2024-03-05 11:38:36,109 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 11:38:36,110 INFO] 2251 iteration, USE_EMA: True, train/sup_loss: 0.37934, train/unsup_loss: 0.02695, train/total_loss: 0.40629, train/util_ratio: 0.25000, train/run_time: 1.51460, lr: 0.00900, train/prefecth_time: 0.01688, eval/loss: 0.45559, eval/top-1-acc: 0.79000, eval/balanced_acc: 0.70536, eval/precision: 0.68779, eval/recall: 0.70536, eval/F1: 0.69349, eval/spec: 0.89189, eval/sens: 0.90476, test/loss: 0.80531, test/top-1-acc: 0.65574, test/balanced_acc: 0.65266, test/precision: 0.69447, test/recall: 0.65266, test/F1: 0.65985, test/spec: 0.87500, test/sens: 0.45238 BEST_EVAL_ACC: 0.8100, at 1351 iters BEST_TEST_ACC: 0.5738, at 1351 iters
[2024-03-05 11:38:36,114 INFO] 

epoch 10
[2024-03-05 11:44:27,031 INFO] validating...
[2024-03-05 11:44:32,949 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 11:44:35,387 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/model_best.pth
[2024-03-05 11:44:35,388 INFO] 2476 iteration, USE_EMA: True, train/sup_loss: 0.40957, train/unsup_loss: 0.08723, train/total_loss: 0.49680, train/util_ratio: 0.33333, train/run_time: 1.51046, lr: 0.01000, train/prefecth_time: 0.01205, eval/loss: 0.41369, eval/top-1-acc: 0.84000, eval/balanced_acc: 0.76356, eval/precision: 0.75424, eval/recall: 0.76356, eval/F1: 0.75800, eval/spec: 0.91892, eval/sens: 0.93651, test/loss: 0.80440, test/top-1-acc: 0.66393, test/balanced_acc: 0.66060, test/precision: 0.70124, test/recall: 0.66060, test/F1: 0.66858, test/spec: 0.87500, test/sens: 0.47619 BEST_EVAL_ACC: 0.8400, at 2476 iters BEST_TEST_ACC: 0.6639, at 2476 iters
[2024-03-05 11:44:35,393 INFO] 

epoch 11
[2024-03-05 11:50:26,450 INFO] validating...
[2024-03-05 11:50:32,139 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 11:50:32,140 INFO] 2701 iteration, USE_EMA: True, train/sup_loss: 0.28676, train/unsup_loss: 0.01897, train/total_loss: 0.30573, train/util_ratio: 0.29167, train/run_time: 1.51156, lr: 0.01000, train/prefecth_time: 0.01330, eval/loss: 0.43682, eval/top-1-acc: 0.82000, eval/balanced_acc: 0.75298, eval/precision: 0.73928, eval/recall: 0.75298, eval/F1: 0.74573, eval/spec: 0.89189, eval/sens: 0.90476, test/loss: 0.80935, test/top-1-acc: 0.66393, test/balanced_acc: 0.66173, test/precision: 0.69872, test/recall: 0.66173, test/F1: 0.67069, test/spec: 0.86250, test/sens: 0.50000 BEST_EVAL_ACC: 0.8400, at 2476 iters BEST_TEST_ACC: 0.6639, at 2476 iters
[2024-03-05 11:50:32,142 INFO] 

epoch 12
[2024-03-05 11:56:23,317 INFO] validating...
[2024-03-05 11:56:29,141 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 11:56:29,142 INFO] 2926 iteration, USE_EMA: True, train/sup_loss: 0.37211, train/unsup_loss: 0.06323, train/total_loss: 0.43534, train/util_ratio: 0.33333, train/run_time: 1.52065, lr: 0.01000, train/prefecth_time: 0.01439, eval/loss: 0.42708, eval/top-1-acc: 0.81000, eval/balanced_acc: 0.73710, eval/precision: 0.71667, eval/recall: 0.73710, eval/F1: 0.72403, eval/spec: 0.91892, eval/sens: 0.90476, test/loss: 0.83232, test/top-1-acc: 0.61475, test/balanced_acc: 0.61978, test/precision: 0.64323, test/recall: 0.61978, test/F1: 0.62752, test/spec: 0.80000, test/sens: 0.47619 BEST_EVAL_ACC: 0.8400, at 2476 iters BEST_TEST_ACC: 0.6639, at 2476 iters
[2024-03-05 11:56:29,145 INFO] 

epoch 13
[2024-03-05 12:02:21,713 INFO] validating...
[2024-03-05 12:02:27,783 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 12:02:27,785 INFO] 3151 iteration, USE_EMA: True, train/sup_loss: 0.19986, train/unsup_loss: 0.03803, train/total_loss: 0.23789, train/util_ratio: 0.35417, train/run_time: 1.51853, lr: 0.00999, train/prefecth_time: 0.01552, eval/loss: 0.44223, eval/top-1-acc: 0.82000, eval/balanced_acc: 0.76356, eval/precision: 0.73748, eval/recall: 0.76356, eval/F1: 0.74897, eval/spec: 0.91892, eval/sens: 0.88889, test/loss: 0.82992, test/top-1-acc: 0.63934, test/balanced_acc: 0.64359, test/precision: 0.67675, test/recall: 0.64359, test/F1: 0.65617, test/spec: 0.77500, test/sens: 0.54762 BEST_EVAL_ACC: 0.8400, at 2476 iters BEST_TEST_ACC: 0.6639, at 2476 iters
[2024-03-05 12:02:27,787 INFO] 

epoch 14
[2024-03-05 12:08:20,133 INFO] validating...
[2024-03-05 12:08:26,436 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 12:08:26,437 INFO] 3376 iteration, USE_EMA: True, train/sup_loss: 0.31407, train/unsup_loss: 0.02284, train/total_loss: 0.33691, train/util_ratio: 0.35417, train/run_time: 1.51262, lr: 0.00998, train/prefecth_time: 0.01241, eval/loss: 0.45158, eval/top-1-acc: 0.80000, eval/balanced_acc: 0.74735, eval/precision: 0.71823, eval/recall: 0.74735, eval/F1: 0.73067, eval/spec: 0.89189, eval/sens: 0.87302, test/loss: 0.83163, test/top-1-acc: 0.63115, test/balanced_acc: 0.63397, test/precision: 0.67165, test/recall: 0.63397, test/F1: 0.64791, test/spec: 0.76250, test/sens: 0.57143 BEST_EVAL_ACC: 0.8400, at 2476 iters BEST_TEST_ACC: 0.6639, at 2476 iters
[2024-03-05 12:08:26,440 INFO] 

epoch 15
[2024-03-05 12:14:19,248 INFO] validating...
[2024-03-05 12:14:26,214 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 12:14:26,215 INFO] 3601 iteration, USE_EMA: True, train/sup_loss: 0.20555, train/unsup_loss: 0.03067, train/total_loss: 0.23621, train/util_ratio: 0.27083, train/run_time: 1.51422, lr: 0.00997, train/prefecth_time: 0.03317, eval/loss: 0.44601, eval/top-1-acc: 0.82000, eval/balanced_acc: 0.75298, eval/precision: 0.73187, eval/recall: 0.75298, eval/F1: 0.74069, eval/spec: 0.91892, eval/sens: 0.90476, test/loss: 0.84213, test/top-1-acc: 0.60656, test/balanced_acc: 0.60566, test/precision: 0.66469, test/recall: 0.60566, test/F1: 0.62460, test/spec: 0.75000, test/sens: 0.57143 BEST_EVAL_ACC: 0.8400, at 2476 iters BEST_TEST_ACC: 0.6639, at 2476 iters
[2024-03-05 12:14:26,218 INFO] 

epoch 16
[2024-03-05 12:20:19,019 INFO] validating...
[2024-03-05 12:20:24,798 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 12:20:24,800 INFO] 3826 iteration, USE_EMA: True, train/sup_loss: 0.17578, train/unsup_loss: 0.01511, train/total_loss: 0.19089, train/util_ratio: 0.39583, train/run_time: 1.51227, lr: 0.00996, train/prefecth_time: 0.01280, eval/loss: 0.44921, eval/top-1-acc: 0.82000, eval/balanced_acc: 0.75298, eval/precision: 0.74774, eval/recall: 0.75298, eval/F1: 0.75022, eval/spec: 0.86486, eval/sens: 0.90476, test/loss: 0.84922, test/top-1-acc: 0.61475, test/balanced_acc: 0.61360, test/precision: 0.67130, test/recall: 0.61360, test/F1: 0.63199, test/spec: 0.75000, test/sens: 0.59524 BEST_EVAL_ACC: 0.8400, at 2476 iters BEST_TEST_ACC: 0.6639, at 2476 iters
[2024-03-05 12:20:24,803 INFO] 

epoch 17
[2024-03-05 12:26:18,527 INFO] validating...
[2024-03-05 12:26:25,691 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 12:26:25,693 INFO] 4051 iteration, USE_EMA: True, train/sup_loss: 0.29223, train/unsup_loss: 0.01013, train/total_loss: 0.30236, train/util_ratio: 0.31250, train/run_time: 1.51848, lr: 0.00994, train/prefecth_time: 0.01328, eval/loss: 0.46049, eval/top-1-acc: 0.79000, eval/balanced_acc: 0.71594, eval/precision: 0.69099, eval/recall: 0.71594, eval/F1: 0.69933, eval/spec: 0.91892, eval/sens: 0.88889, test/loss: 0.85271, test/top-1-acc: 0.62295, test/balanced_acc: 0.62435, test/precision: 0.67609, test/recall: 0.62435, test/F1: 0.64186, test/spec: 0.75000, test/sens: 0.59524 BEST_EVAL_ACC: 0.8400, at 2476 iters BEST_TEST_ACC: 0.6639, at 2476 iters
[2024-03-05 12:26:25,697 INFO] 

epoch 18
[2024-03-05 12:32:19,285 INFO] validating...
[2024-03-05 12:32:27,010 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 12:32:31,458 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/model_best.pth
[2024-03-05 12:32:31,459 INFO] 4276 iteration, USE_EMA: True, train/sup_loss: 0.18146, train/unsup_loss: 0.00558, train/total_loss: 0.18704, train/util_ratio: 0.25000, train/run_time: 1.51406, lr: 0.00993, train/prefecth_time: 0.01362, eval/loss: 0.41468, eval/top-1-acc: 0.86000, eval/balanced_acc: 0.79530, eval/precision: 0.78880, eval/recall: 0.79530, eval/F1: 0.79190, eval/spec: 0.91892, eval/sens: 0.93651, test/loss: 0.86589, test/top-1-acc: 0.63934, test/balanced_acc: 0.64304, test/precision: 0.68772, test/recall: 0.64304, test/F1: 0.65884, test/spec: 0.75000, test/sens: 0.61905 BEST_EVAL_ACC: 0.8600, at 4276 iters BEST_TEST_ACC: 0.6393, at 4276 iters
[2024-03-05 12:32:31,463 INFO] 

epoch 19
[2024-03-05 12:38:26,690 INFO] validating...
[2024-03-05 12:38:34,511 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 12:38:34,512 INFO] 4501 iteration, USE_EMA: True, train/sup_loss: 0.33880, train/unsup_loss: 0.01157, train/total_loss: 0.35037, train/util_ratio: 0.20833, train/run_time: 1.51410, lr: 0.00991, train/prefecth_time: 0.01798, eval/loss: 0.42593, eval/top-1-acc: 0.85000, eval/balanced_acc: 0.80060, eval/precision: 0.78778, eval/recall: 0.80060, eval/F1: 0.79188, eval/spec: 0.91892, eval/sens: 0.90476, test/loss: 0.87784, test/top-1-acc: 0.62295, test/balanced_acc: 0.62943, test/precision: 0.67445, test/recall: 0.62943, test/F1: 0.64519, test/spec: 0.72500, test/sens: 0.61905 BEST_EVAL_ACC: 0.8600, at 4276 iters BEST_TEST_ACC: 0.6393, at 4276 iters
[2024-03-05 12:38:34,516 INFO] 

epoch 20
[2024-03-05 12:44:31,802 INFO] validating...
[2024-03-05 12:44:37,405 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 12:44:37,406 INFO] 4726 iteration, USE_EMA: True, train/sup_loss: 0.24843, train/unsup_loss: 0.01309, train/total_loss: 0.26152, train/util_ratio: 0.33333, train/run_time: 1.51426, lr: 0.00988, train/prefecth_time: 0.01203, eval/loss: 0.42426, eval/top-1-acc: 0.81000, eval/balanced_acc: 0.73214, eval/precision: 0.72271, eval/recall: 0.73214, eval/F1: 0.72691, eval/spec: 0.89189, eval/sens: 0.90476, test/loss: 0.88866, test/top-1-acc: 0.62295, test/balanced_acc: 0.62830, test/precision: 0.66513, test/recall: 0.62830, test/F1: 0.64196, test/spec: 0.73750, test/sens: 0.59524 BEST_EVAL_ACC: 0.8600, at 4276 iters BEST_TEST_ACC: 0.6393, at 4276 iters
[2024-03-05 12:44:37,410 INFO] 

epoch 21
[2024-03-05 12:50:29,387 INFO] validating...
[2024-03-05 12:50:36,175 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 12:50:36,176 INFO] 4951 iteration, USE_EMA: True, train/sup_loss: 0.39419, train/unsup_loss: 0.00513, train/total_loss: 0.39932, train/util_ratio: 0.27083, train/run_time: 1.51447, lr: 0.00986, train/prefecth_time: 0.01654, eval/loss: 0.42738, eval/top-1-acc: 0.84000, eval/balanced_acc: 0.79530, eval/precision: 0.77222, eval/recall: 0.79530, eval/F1: 0.78155, eval/spec: 0.91892, eval/sens: 0.88889, test/loss: 0.90458, test/top-1-acc: 0.59836, test/balanced_acc: 0.59999, test/precision: 0.64739, test/recall: 0.59999, test/F1: 0.61560, test/spec: 0.71250, test/sens: 0.59524 BEST_EVAL_ACC: 0.8600, at 4276 iters BEST_TEST_ACC: 0.6393, at 4276 iters
[2024-03-05 12:50:36,179 INFO] 

epoch 22
[2024-03-05 12:56:30,281 INFO] validating...
[2024-03-05 12:56:37,976 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 12:56:37,977 INFO] 5176 iteration, USE_EMA: True, train/sup_loss: 0.19331, train/unsup_loss: 0.00852, train/total_loss: 0.20183, train/util_ratio: 0.31250, train/run_time: 1.51941, lr: 0.00983, train/prefecth_time: 0.01928, eval/loss: 0.46352, eval/top-1-acc: 0.82000, eval/balanced_acc: 0.75298, eval/precision: 0.73249, eval/recall: 0.75298, eval/F1: 0.74168, eval/spec: 0.91892, eval/sens: 0.90476, test/loss: 0.91645, test/top-1-acc: 0.59836, test/balanced_acc: 0.59999, test/precision: 0.64739, test/recall: 0.59999, test/F1: 0.61560, test/spec: 0.71250, test/sens: 0.59524 BEST_EVAL_ACC: 0.8600, at 4276 iters BEST_TEST_ACC: 0.6393, at 4276 iters
[2024-03-05 12:56:37,980 INFO] 

epoch 23
[2024-03-05 13:02:33,649 INFO] validating...
[2024-03-05 13:02:40,052 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 13:02:40,053 INFO] 5401 iteration, USE_EMA: True, train/sup_loss: 0.24159, train/unsup_loss: 0.01685, train/total_loss: 0.25844, train/util_ratio: 0.33333, train/run_time: 1.51390, lr: 0.00980, train/prefecth_time: 0.02000, eval/loss: 0.42059, eval/top-1-acc: 0.83000, eval/balanced_acc: 0.78439, eval/precision: 0.76380, eval/recall: 0.78439, eval/F1: 0.77322, eval/spec: 0.89189, eval/sens: 0.88889, test/loss: 0.93072, test/top-1-acc: 0.60656, test/balanced_acc: 0.60680, test/precision: 0.65380, test/recall: 0.60680, test/F1: 0.62220, test/spec: 0.71250, test/sens: 0.59524 BEST_EVAL_ACC: 0.8600, at 4276 iters BEST_TEST_ACC: 0.6393, at 4276 iters
[2024-03-05 13:02:40,056 INFO] 

epoch 24
[2024-03-05 13:08:34,169 INFO] validating...
[2024-03-05 13:08:40,293 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 13:08:42,585 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/model_best.pth
[2024-03-05 13:08:42,586 INFO] 5626 iteration, USE_EMA: True, train/sup_loss: 0.23077, train/unsup_loss: 0.05489, train/total_loss: 0.28566, train/util_ratio: 0.39583, train/run_time: 1.51158, lr: 0.00977, train/prefecth_time: 0.01598, eval/loss: 0.41605, eval/top-1-acc: 0.85000, eval/balanced_acc: 0.81052, eval/precision: 0.79031, eval/recall: 0.81052, eval/F1: 0.79945, eval/spec: 0.89189, eval/sens: 0.90476, test/loss: 0.94735, test/top-1-acc: 0.59016, test/balanced_acc: 0.58924, test/precision: 0.64172, test/recall: 0.58924, test/F1: 0.60550, test/spec: 0.71250, test/sens: 0.59524 BEST_EVAL_ACC: 0.8500, at 5626 iters BEST_TEST_ACC: 0.5902, at 5626 iters
[2024-03-05 13:08:42,589 INFO] 

epoch 25
[2024-03-05 13:14:36,276 INFO] validating...
[2024-03-05 13:14:42,600 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 13:14:42,601 INFO] 5851 iteration, USE_EMA: True, train/sup_loss: 0.32461, train/unsup_loss: 0.01210, train/total_loss: 0.33670, train/util_ratio: 0.33333, train/run_time: 1.51113, lr: 0.00974, train/prefecth_time: 0.01461, eval/loss: 0.40524, eval/top-1-acc: 0.84000, eval/balanced_acc: 0.78406, eval/precision: 0.76168, eval/recall: 0.78406, eval/F1: 0.76924, eval/spec: 0.91892, eval/sens: 0.92063, test/loss: 0.95693, test/top-1-acc: 0.60656, test/balanced_acc: 0.60680, test/precision: 0.65422, test/recall: 0.60680, test/F1: 0.62256, test/spec: 0.73750, test/sens: 0.59524 BEST_EVAL_ACC: 0.8500, at 5626 iters BEST_TEST_ACC: 0.5902, at 5626 iters
[2024-03-05 13:14:42,604 INFO] 

epoch 26
[2024-03-05 13:20:36,975 INFO] validating...
[2024-03-05 13:20:44,918 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 13:20:44,923 INFO] 6076 iteration, USE_EMA: True, train/sup_loss: 0.19726, train/unsup_loss: 0.00996, train/total_loss: 0.20722, train/util_ratio: 0.33333, train/run_time: 1.52541, lr: 0.00970, train/prefecth_time: 0.02872, eval/loss: 0.42384, eval/top-1-acc: 0.79000, eval/balanced_acc: 0.73148, eval/precision: 0.70308, eval/recall: 0.73148, eval/F1: 0.71107, eval/spec: 0.89189, eval/sens: 0.87302, test/loss: 0.96989, test/top-1-acc: 0.63934, test/balanced_acc: 0.63909, test/precision: 0.68897, test/recall: 0.63909, test/F1: 0.65566, test/spec: 0.75000, test/sens: 0.61905 BEST_EVAL_ACC: 0.8500, at 5626 iters BEST_TEST_ACC: 0.5902, at 5626 iters
[2024-03-05 13:20:44,927 INFO] 

epoch 27
[2024-03-05 13:26:38,966 INFO] validating...
[2024-03-05 13:26:45,680 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 13:26:45,681 INFO] 6301 iteration, USE_EMA: True, train/sup_loss: 0.21482, train/unsup_loss: 0.03819, train/total_loss: 0.25300, train/util_ratio: 0.33333, train/run_time: 1.51649, lr: 0.00966, train/prefecth_time: 0.01306, eval/loss: 0.40383, eval/top-1-acc: 0.85000, eval/balanced_acc: 0.75827, eval/precision: 0.77867, eval/recall: 0.75827, eval/F1: 0.76554, eval/spec: 0.86486, eval/sens: 0.96825, test/loss: 0.98545, test/top-1-acc: 0.62295, test/balanced_acc: 0.62548, test/precision: 0.67589, test/recall: 0.62548, test/F1: 0.64218, test/spec: 0.72500, test/sens: 0.61905 BEST_EVAL_ACC: 0.8500, at 5626 iters BEST_TEST_ACC: 0.5902, at 5626 iters
[2024-03-05 13:26:45,684 INFO] 

epoch 28
[2024-03-05 13:32:40,971 INFO] validating...
[2024-03-05 13:32:47,175 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 13:32:47,176 INFO] 6526 iteration, USE_EMA: True, train/sup_loss: 0.22280, train/unsup_loss: 0.01095, train/total_loss: 0.23375, train/util_ratio: 0.25000, train/run_time: 1.51832, lr: 0.00962, train/prefecth_time: 0.01860, eval/loss: 0.39584, eval/top-1-acc: 0.86000, eval/balanced_acc: 0.80026, eval/precision: 0.79746, eval/recall: 0.80026, eval/F1: 0.79850, eval/spec: 0.89189, eval/sens: 0.93651, test/loss: 0.99296, test/top-1-acc: 0.62295, test/balanced_acc: 0.62548, test/precision: 0.67589, test/recall: 0.62548, test/F1: 0.64218, test/spec: 0.72500, test/sens: 0.61905 BEST_EVAL_ACC: 0.8500, at 5626 iters BEST_TEST_ACC: 0.5902, at 5626 iters
[2024-03-05 13:32:47,181 INFO] 

epoch 29
[2024-03-05 13:38:41,618 INFO] validating...
[2024-03-05 13:38:47,981 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 13:38:47,982 INFO] 6751 iteration, USE_EMA: True, train/sup_loss: 0.37144, train/unsup_loss: 0.01746, train/total_loss: 0.38890, train/util_ratio: 0.33333, train/run_time: 1.50924, lr: 0.00958, train/prefecth_time: 0.01547, eval/loss: 0.43079, eval/top-1-acc: 0.84000, eval/balanced_acc: 0.77910, eval/precision: 0.76738, eval/recall: 0.77910, eval/F1: 0.77227, eval/spec: 0.89189, eval/sens: 0.92063, test/loss: 0.98752, test/top-1-acc: 0.61475, test/balanced_acc: 0.61868, test/precision: 0.66944, test/recall: 0.61868, test/F1: 0.63538, test/spec: 0.71250, test/sens: 0.61905 BEST_EVAL_ACC: 0.8500, at 5626 iters BEST_TEST_ACC: 0.5902, at 5626 iters
[2024-03-05 13:38:47,985 INFO] 

epoch 30
[2024-03-05 13:44:42,505 INFO] validating...
[2024-03-05 13:44:50,730 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 13:44:53,339 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/model_best.pth
[2024-03-05 13:44:53,341 INFO] 6976 iteration, USE_EMA: True, train/sup_loss: 0.28531, train/unsup_loss: 0.02218, train/total_loss: 0.30749, train/util_ratio: 0.37500, train/run_time: 1.51259, lr: 0.00954, train/prefecth_time: 0.01944, eval/loss: 0.35225, eval/top-1-acc: 0.86000, eval/balanced_acc: 0.82639, eval/precision: 0.80345, eval/recall: 0.82639, eval/F1: 0.81399, eval/spec: 0.91892, eval/sens: 0.90476, test/loss: 0.99815, test/top-1-acc: 0.60656, test/balanced_acc: 0.61075, test/precision: 0.65301, test/recall: 0.61075, test/F1: 0.62543, test/spec: 0.71250, test/sens: 0.59524 BEST_EVAL_ACC: 0.8600, at 6976 iters BEST_TEST_ACC: 0.6066, at 6976 iters
[2024-03-05 13:44:53,344 INFO] 

epoch 31
[2024-03-05 13:50:48,663 INFO] validating...
[2024-03-05 13:50:56,368 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 13:50:56,383 INFO] 7201 iteration, USE_EMA: True, train/sup_loss: 0.20059, train/unsup_loss: 0.02183, train/total_loss: 0.22242, train/util_ratio: 0.37500, train/run_time: 1.51858, lr: 0.00949, train/prefecth_time: 0.01910, eval/loss: 0.41772, eval/top-1-acc: 0.80000, eval/balanced_acc: 0.74239, eval/precision: 0.71734, eval/recall: 0.74239, eval/F1: 0.72835, eval/spec: 0.89189, eval/sens: 0.87302, test/loss: 0.99857, test/top-1-acc: 0.60656, test/balanced_acc: 0.61075, test/precision: 0.66254, test/recall: 0.61075, test/F1: 0.62818, test/spec: 0.71250, test/sens: 0.59524 BEST_EVAL_ACC: 0.8600, at 6976 iters BEST_TEST_ACC: 0.6066, at 6976 iters
[2024-03-05 13:50:56,388 INFO] 

epoch 32
[2024-03-05 13:56:52,917 INFO] validating...
[2024-03-05 13:56:59,311 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 13:56:59,312 INFO] 7426 iteration, USE_EMA: True, train/sup_loss: 0.37507, train/unsup_loss: 0.03195, train/total_loss: 0.40702, train/util_ratio: 0.33333, train/run_time: 1.51688, lr: 0.00944, train/prefecth_time: 0.01889, eval/loss: 0.40734, eval/top-1-acc: 0.84000, eval/balanced_acc: 0.78472, eval/precision: 0.77814, eval/recall: 0.78472, eval/F1: 0.78005, eval/spec: 0.89189, eval/sens: 0.90476, test/loss: 1.00237, test/top-1-acc: 0.60656, test/balanced_acc: 0.61075, test/precision: 0.66254, test/recall: 0.61075, test/F1: 0.62818, test/spec: 0.71250, test/sens: 0.59524 BEST_EVAL_ACC: 0.8600, at 6976 iters BEST_TEST_ACC: 0.6066, at 6976 iters
[2024-03-05 13:56:59,314 INFO] 

epoch 33
[2024-03-05 14:02:54,954 INFO] validating...
[2024-03-05 14:03:01,646 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 14:03:01,648 INFO] 7651 iteration, USE_EMA: True, train/sup_loss: 0.36427, train/unsup_loss: 0.01110, train/total_loss: 0.37537, train/util_ratio: 0.27083, train/run_time: 1.51988, lr: 0.00939, train/prefecth_time: 0.01880, eval/loss: 0.44270, eval/top-1-acc: 0.81000, eval/balanced_acc: 0.74769, eval/precision: 0.72694, eval/recall: 0.74769, eval/F1: 0.73626, eval/spec: 0.89189, eval/sens: 0.88889, test/loss: 1.00276, test/top-1-acc: 0.59836, test/balanced_acc: 0.60281, test/precision: 0.63753, test/recall: 0.60281, test/F1: 0.61553, test/spec: 0.71250, test/sens: 0.57143 BEST_EVAL_ACC: 0.8600, at 6976 iters BEST_TEST_ACC: 0.6066, at 6976 iters
[2024-03-05 14:03:01,651 INFO] 

epoch 34
[2024-03-05 14:08:57,182 INFO] validating...
[2024-03-05 14:09:04,742 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 14:09:04,743 INFO] 7876 iteration, USE_EMA: True, train/sup_loss: 0.26379, train/unsup_loss: 0.01430, train/total_loss: 0.27809, train/util_ratio: 0.37500, train/run_time: 1.51961, lr: 0.00934, train/prefecth_time: 0.01467, eval/loss: 0.41232, eval/top-1-acc: 0.83000, eval/balanced_acc: 0.76323, eval/precision: 0.74501, eval/recall: 0.76323, eval/F1: 0.75072, eval/spec: 0.91892, eval/sens: 0.92063, test/loss: 1.01576, test/top-1-acc: 0.61475, test/balanced_acc: 0.61868, test/precision: 0.65193, test/recall: 0.61868, test/F1: 0.63018, test/spec: 0.71250, test/sens: 0.61905 BEST_EVAL_ACC: 0.8600, at 6976 iters BEST_TEST_ACC: 0.6066, at 6976 iters
[2024-03-05 14:09:04,746 INFO] 

epoch 35
[2024-03-05 14:15:02,223 INFO] validating...
[2024-03-05 14:15:10,082 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 14:15:10,085 INFO] 8101 iteration, USE_EMA: True, train/sup_loss: 0.23635, train/unsup_loss: 0.02336, train/total_loss: 0.25972, train/util_ratio: 0.35417, train/run_time: 1.51978, lr: 0.00928, train/prefecth_time: 0.02203, eval/loss: 0.36712, eval/top-1-acc: 0.83000, eval/balanced_acc: 0.77877, eval/precision: 0.75000, eval/recall: 0.77877, eval/F1: 0.76107, eval/spec: 0.91892, eval/sens: 0.90476, test/loss: 1.03019, test/top-1-acc: 0.59836, test/balanced_acc: 0.60394, test/precision: 0.64700, test/recall: 0.60394, test/F1: 0.61855, test/spec: 0.68750, test/sens: 0.59524 BEST_EVAL_ACC: 0.8600, at 6976 iters BEST_TEST_ACC: 0.6066, at 6976 iters
[2024-03-05 14:15:10,093 INFO] 

epoch 36
[2024-03-05 14:21:04,810 INFO] validating...
[2024-03-05 14:21:10,519 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 14:21:10,520 INFO] 8326 iteration, USE_EMA: True, train/sup_loss: 0.16446, train/unsup_loss: 0.01270, train/total_loss: 0.17716, train/util_ratio: 0.33333, train/run_time: 1.51966, lr: 0.00922, train/prefecth_time: 0.01131, eval/loss: 0.37663, eval/top-1-acc: 0.86000, eval/balanced_acc: 0.80026, eval/precision: 0.79746, eval/recall: 0.80026, eval/F1: 0.79850, eval/spec: 0.89189, eval/sens: 0.93651, test/loss: 1.04240, test/top-1-acc: 0.57377, test/balanced_acc: 0.58240, test/precision: 0.61904, test/recall: 0.58240, test/F1: 0.59502, test/spec: 0.66250, test/sens: 0.57143 BEST_EVAL_ACC: 0.8600, at 6976 iters BEST_TEST_ACC: 0.6066, at 6976 iters
[2024-03-05 14:21:10,524 INFO] 

epoch 37
[2024-03-05 14:27:06,094 INFO] validating...
[2024-03-05 14:27:12,679 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 14:27:12,681 INFO] 8551 iteration, USE_EMA: True, train/sup_loss: 0.20372, train/unsup_loss: 0.03216, train/total_loss: 0.23589, train/util_ratio: 0.33333, train/run_time: 1.51593, lr: 0.00916, train/prefecth_time: 0.01700, eval/loss: 0.38739, eval/top-1-acc: 0.86000, eval/balanced_acc: 0.80026, eval/precision: 0.80729, eval/recall: 0.80026, eval/F1: 0.80361, eval/spec: 0.86486, eval/sens: 0.93651, test/loss: 1.04240, test/top-1-acc: 0.59016, test/balanced_acc: 0.59432, test/precision: 0.64205, test/recall: 0.59432, test/F1: 0.60896, test/spec: 0.67500, test/sens: 0.61905 BEST_EVAL_ACC: 0.8600, at 6976 iters BEST_TEST_ACC: 0.6066, at 6976 iters
[2024-03-05 14:27:12,685 INFO] 

epoch 38
[2024-03-05 14:33:06,840 INFO] validating...
[2024-03-05 14:33:14,638 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 14:33:17,328 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/model_best.pth
[2024-03-05 14:33:17,330 INFO] 8776 iteration, USE_EMA: True, train/sup_loss: 0.22670, train/unsup_loss: 0.04057, train/total_loss: 0.26727, train/util_ratio: 0.43750, train/run_time: 1.52722, lr: 0.00910, train/prefecth_time: 0.02170, eval/loss: 0.34758, eval/top-1-acc: 0.88000, eval/balanced_acc: 0.82143, eval/precision: 0.81942, eval/recall: 0.82143, eval/F1: 0.82005, eval/spec: 0.91892, eval/sens: 0.95238, test/loss: 1.04128, test/top-1-acc: 0.59016, test/balanced_acc: 0.59432, test/precision: 0.64149, test/recall: 0.59432, test/F1: 0.60905, test/spec: 0.68750, test/sens: 0.61905 BEST_EVAL_ACC: 0.8800, at 8776 iters BEST_TEST_ACC: 0.5902, at 8776 iters
[2024-03-05 14:33:17,335 INFO] 

epoch 39
[2024-03-05 14:39:11,969 INFO] validating...
[2024-03-05 14:39:20,165 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 14:39:20,167 INFO] 9001 iteration, USE_EMA: True, train/sup_loss: 0.16482, train/unsup_loss: 0.01788, train/total_loss: 0.18269, train/util_ratio: 0.33333, train/run_time: 1.52698, lr: 0.00904, train/prefecth_time: 0.01963, eval/loss: 0.35526, eval/top-1-acc: 0.87000, eval/balanced_acc: 0.82110, eval/precision: 0.80795, eval/recall: 0.82110, eval/F1: 0.81347, eval/spec: 0.91892, eval/sens: 0.93651, test/loss: 1.03519, test/top-1-acc: 0.59836, test/balanced_acc: 0.59944, test/precision: 0.64931, test/recall: 0.59944, test/F1: 0.61283, test/spec: 0.68750, test/sens: 0.66667 BEST_EVAL_ACC: 0.8800, at 8776 iters BEST_TEST_ACC: 0.5902, at 8776 iters
[2024-03-05 14:39:20,171 INFO] 

epoch 40
[2024-03-05 14:45:14,935 INFO] validating...
[2024-03-05 14:45:21,077 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 14:45:23,251 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/model_best.pth
[2024-03-05 14:45:23,252 INFO] 9226 iteration, USE_EMA: True, train/sup_loss: 0.22490, train/unsup_loss: 0.01039, train/total_loss: 0.23530, train/util_ratio: 0.22917, train/run_time: 1.50970, lr: 0.00897, train/prefecth_time: 0.01172, eval/loss: 0.36912, eval/top-1-acc: 0.89000, eval/balanced_acc: 0.83730, eval/precision: 0.84901, eval/recall: 0.83730, eval/F1: 0.84287, eval/spec: 0.89189, eval/sens: 0.95238, test/loss: 1.02640, test/top-1-acc: 0.59836, test/balanced_acc: 0.59944, test/precision: 0.64931, test/recall: 0.59944, test/F1: 0.61283, test/spec: 0.68750, test/sens: 0.66667 BEST_EVAL_ACC: 0.8900, at 9226 iters BEST_TEST_ACC: 0.5984, at 9226 iters
[2024-03-05 14:45:23,255 INFO] 

epoch 41
[2024-03-05 14:51:19,272 INFO] validating...
[2024-03-05 14:51:27,843 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 14:51:27,844 INFO] 9451 iteration, USE_EMA: True, train/sup_loss: 0.14923, train/unsup_loss: 0.00271, train/total_loss: 0.15194, train/util_ratio: 0.27083, train/run_time: 1.51587, lr: 0.00890, train/prefecth_time: 0.01998, eval/loss: 0.43123, eval/top-1-acc: 0.84000, eval/balanced_acc: 0.78968, eval/precision: 0.77179, eval/recall: 0.78968, eval/F1: 0.77984, eval/spec: 0.89189, eval/sens: 0.90476, test/loss: 1.01987, test/top-1-acc: 0.59016, test/balanced_acc: 0.59151, test/precision: 0.64246, test/recall: 0.59151, test/F1: 0.60593, test/spec: 0.68750, test/sens: 0.64286 BEST_EVAL_ACC: 0.8900, at 9226 iters BEST_TEST_ACC: 0.5984, at 9226 iters
[2024-03-05 14:51:27,846 INFO] 

epoch 42
[2024-03-05 14:57:23,003 INFO] validating...
[2024-03-05 14:57:30,951 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 14:57:30,953 INFO] 9676 iteration, USE_EMA: True, train/sup_loss: 0.16624, train/unsup_loss: 0.01517, train/total_loss: 0.18141, train/util_ratio: 0.31250, train/run_time: 1.51784, lr: 0.00883, train/prefecth_time: 0.01943, eval/loss: 0.42906, eval/top-1-acc: 0.85000, eval/balanced_acc: 0.76885, eval/precision: 0.76678, eval/recall: 0.76885, eval/F1: 0.76648, eval/spec: 0.91892, eval/sens: 0.95238, test/loss: 1.02931, test/top-1-acc: 0.59016, test/balanced_acc: 0.59151, test/precision: 0.65308, test/recall: 0.59151, test/F1: 0.60860, test/spec: 0.68750, test/sens: 0.64286 BEST_EVAL_ACC: 0.8900, at 9226 iters BEST_TEST_ACC: 0.5984, at 9226 iters
[2024-03-05 14:57:30,956 INFO] 

epoch 43
[2024-03-05 15:03:26,300 INFO] validating...
[2024-03-05 15:03:33,985 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 15:03:33,986 INFO] 9901 iteration, USE_EMA: True, train/sup_loss: 0.32174, train/unsup_loss: 0.03926, train/total_loss: 0.36100, train/util_ratio: 0.33333, train/run_time: 1.54197, lr: 0.00876, train/prefecth_time: 0.02831, eval/loss: 0.36424, eval/top-1-acc: 0.87000, eval/balanced_acc: 0.81614, eval/precision: 0.80647, eval/recall: 0.81614, eval/F1: 0.81106, eval/spec: 0.91892, eval/sens: 0.93651, test/loss: 1.03144, test/top-1-acc: 0.58197, test/balanced_acc: 0.58584, test/precision: 0.64700, test/recall: 0.58584, test/F1: 0.60135, test/spec: 0.66250, test/sens: 0.66667 BEST_EVAL_ACC: 0.8900, at 9226 iters BEST_TEST_ACC: 0.5984, at 9226 iters
[2024-03-05 15:03:33,994 INFO] 

epoch 44
[2024-03-05 15:09:30,760 INFO] validating...
[2024-03-05 15:09:37,034 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 15:09:37,035 INFO] 10126 iteration, USE_EMA: True, train/sup_loss: 0.13459, train/unsup_loss: 0.01568, train/total_loss: 0.15027, train/util_ratio: 0.31250, train/run_time: 1.51407, lr: 0.00868, train/prefecth_time: 0.02073, eval/loss: 0.38404, eval/top-1-acc: 0.85000, eval/balanced_acc: 0.79001, eval/precision: 0.78816, eval/recall: 0.79001, eval/F1: 0.78832, eval/spec: 0.89189, eval/sens: 0.92063, test/loss: 1.01365, test/top-1-acc: 0.58197, test/balanced_acc: 0.58584, test/precision: 0.64700, test/recall: 0.58584, test/F1: 0.60135, test/spec: 0.66250, test/sens: 0.66667 BEST_EVAL_ACC: 0.8900, at 9226 iters BEST_TEST_ACC: 0.5984, at 9226 iters
[2024-03-05 15:09:37,039 INFO] 

epoch 45
[2024-03-05 15:15:33,956 INFO] validating...
[2024-03-05 15:15:42,132 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 15:15:42,133 INFO] 10351 iteration, USE_EMA: True, train/sup_loss: 0.29009, train/unsup_loss: 0.01799, train/total_loss: 0.30808, train/util_ratio: 0.37500, train/run_time: 1.51606, lr: 0.00861, train/prefecth_time: 0.01181, eval/loss: 0.35571, eval/top-1-acc: 0.88000, eval/balanced_acc: 0.81085, eval/precision: 0.83586, eval/recall: 0.81085, eval/F1: 0.82166, eval/spec: 0.86486, eval/sens: 0.96825, test/loss: 1.01080, test/top-1-acc: 0.58197, test/balanced_acc: 0.58584, test/precision: 0.64783, test/recall: 0.58584, test/F1: 0.60121, test/spec: 0.65000, test/sens: 0.66667 BEST_EVAL_ACC: 0.8900, at 9226 iters BEST_TEST_ACC: 0.5984, at 9226 iters
[2024-03-05 15:15:42,136 INFO] 

epoch 46
[2024-03-05 15:21:38,242 INFO] validating...
[2024-03-05 15:21:46,212 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 15:21:46,214 INFO] 10576 iteration, USE_EMA: True, train/sup_loss: 0.19540, train/unsup_loss: 0.02528, train/total_loss: 0.22068, train/util_ratio: 0.33333, train/run_time: 1.51634, lr: 0.00853, train/prefecth_time: 0.01347, eval/loss: 0.39460, eval/top-1-acc: 0.87000, eval/balanced_acc: 0.80556, eval/precision: 0.81095, eval/recall: 0.80556, eval/F1: 0.80738, eval/spec: 0.89189, eval/sens: 0.95238, test/loss: 1.01416, test/top-1-acc: 0.56557, test/balanced_acc: 0.57110, test/precision: 0.63463, test/recall: 0.57110, test/F1: 0.58739, test/spec: 0.63750, test/sens: 0.64286 BEST_EVAL_ACC: 0.8900, at 9226 iters BEST_TEST_ACC: 0.5984, at 9226 iters
[2024-03-05 15:21:46,217 INFO] 

epoch 47
[2024-03-05 15:27:42,958 INFO] validating...
[2024-03-05 15:27:49,025 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 15:27:49,026 INFO] 10801 iteration, USE_EMA: True, train/sup_loss: 0.20245, train/unsup_loss: 0.01573, train/total_loss: 0.21819, train/util_ratio: 0.31250, train/run_time: 1.51341, lr: 0.00845, train/prefecth_time: 0.01449, eval/loss: 0.34965, eval/top-1-acc: 0.85000, eval/balanced_acc: 0.77877, eval/precision: 0.77381, eval/recall: 0.77877, eval/F1: 0.76791, eval/spec: 0.91892, eval/sens: 0.95238, test/loss: 1.00875, test/top-1-acc: 0.57377, test/balanced_acc: 0.58185, test/precision: 0.64008, test/recall: 0.58185, test/F1: 0.59748, test/spec: 0.63750, test/sens: 0.64286 BEST_EVAL_ACC: 0.8900, at 9226 iters BEST_TEST_ACC: 0.5984, at 9226 iters
[2024-03-05 15:27:49,029 INFO] 

epoch 48
[2024-03-05 15:33:45,796 INFO] validating...
[2024-03-05 15:33:53,702 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 15:33:53,706 INFO] 11026 iteration, USE_EMA: True, train/sup_loss: 0.19752, train/unsup_loss: 0.02816, train/total_loss: 0.22569, train/util_ratio: 0.31250, train/run_time: 1.51151, lr: 0.00836, train/prefecth_time: 0.01859, eval/loss: 0.40369, eval/top-1-acc: 0.87000, eval/balanced_acc: 0.79497, eval/precision: 0.81788, eval/recall: 0.79497, eval/F1: 0.80328, eval/spec: 0.86486, eval/sens: 0.96825, test/loss: 1.03334, test/top-1-acc: 0.54918, test/balanced_acc: 0.55749, test/precision: 0.61143, test/recall: 0.55749, test/F1: 0.57019, test/spec: 0.61250, test/sens: 0.64286 BEST_EVAL_ACC: 0.8900, at 9226 iters BEST_TEST_ACC: 0.5984, at 9226 iters
[2024-03-05 15:33:53,713 INFO] 

epoch 49
[2024-03-05 15:39:49,042 INFO] validating...
[2024-03-05 15:39:56,615 INFO] model saved: saved_models/radformer/selfkd_vit_v8_exp4_2_ur3/latest_model.pth
[2024-03-05 15:39:56,616 INFO] 11251 iteration, USE_EMA: True, train/sup_loss: 0.15479, train/unsup_loss: 0.01733, train/total_loss: 0.17211, train/util_ratio: 0.33333, train/run_time: 1.51887, lr: 0.00828, train/prefecth_time: 0.01759, eval/loss: 0.43107, eval/top-1-acc: 0.82000, eval/balanced_acc: 0.74735, eval/precision: 0.73405, eval/recall: 0.74735, eval/F1: 0.73668, eval/spec: 0.89189, eval/sens: 0.92063, test/loss: 1.05238, test/top-1-acc: 0.54098, test/balanced_acc: 0.55464, test/precision: 0.59314, test/recall: 0.55464, test/F1: 0.56272, test/spec: 0.61250, test/sens: 0.64286 BEST_EVAL_ACC: 0.8900, at 9226 iters BEST_TEST_ACC: 0.5984, at 9226 iters
[2024-03-05 15:39:56,619 INFO] 

epoch 50
