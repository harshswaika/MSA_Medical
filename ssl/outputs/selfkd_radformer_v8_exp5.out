[2024-03-01 17:10:33,162 INFO] Use GPU: None for training
[2024-03-01 17:10:33,162 INFO] 

[2024-03-01 17:10:34,134 INFO] Total params: 109.04M
[2024-03-01 17:10:40,862 INFO] acc: 0.90
[2024-03-01 17:10:40,877 INFO] Victim model accuracy = 0.9016, spec = 0.90, sens = 0.93
[2024-03-01 17:10:40,877 INFO] Loading thief dataset ...
[2024-03-01 17:10:40,879 INFO] 
Initializing thief model ...


Loaded supervised labeled set of length  900
Labeled set expanded to length  3600 , unique indices  900
dataset root /home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBUSV-Shared
Num of videos 64 frames 15800
15800
15800
Num of videos 64 frames 15800
  0%|          | 0/29 [00:00<?, ?it/s]  3%|â–Ž         | 1/29 [00:06<02:55,  6.26s/it]  7%|â–‹         | 2/29 [00:08<01:39,  3.69s/it] 10%|â–ˆ         | 3/29 [00:09<01:09,  2.67s/it] 14%|â–ˆâ–        | 4/29 [00:11<00:54,  2.19s/it] 17%|â–ˆâ–‹        | 5/29 [00:12<00:46,  1.95s/it] 21%|â–ˆâ–ˆ        | 6/29 [00:14<00:41,  1.79s/it] 24%|â–ˆâ–ˆâ–       | 7/29 [00:15<00:37,  1.72s/it] 28%|â–ˆâ–ˆâ–Š       | 8/29 [00:17<00:34,  1.64s/it] 31%|â–ˆâ–ˆâ–ˆ       | 9/29 [00:19<00:34,  1.72s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 10/29 [00:20<00:31,  1.64s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 11/29 [00:21<00:28,  1.59s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 12/29 [00:23<00:26,  1.56s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 13/29 [00:25<00:25,  1.56s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 14/29 [00:26<00:23,  1.55s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 15/29 [00:28<00:22,  1.62s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 16/29 [00:30<00:22,  1.72s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 17/29 [00:32<00:21,  1.79s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 18/29 [00:34<00:20,  1.84s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 19/29 [00:36<00:18,  1.86s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 20/29 [00:37<00:16,  1.88s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 21/29 [00:39<00:15,  1.90s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 22/29 [00:41<00:13,  1.91s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 23/29 [00:43<00:11,  1.91s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 24/29 [00:45<00:09,  1.85s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 25/29 [00:47<00:07,  1.87s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 26/29 [00:49<00:05,  1.90s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 27/29 [00:51<00:03,  1.84s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 28/29 [00:52<00:01,  1.72s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [00:54<00:00,  1.65s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 29/29 [00:54<00:00,  1.87s/it]
Num of videos 64 frames 15800
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.64s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.72s/it]
[2024-03-01 17:11:39,776 INFO] unlabeled data number: 15800, labeled data number 3600
[2024-03-01 17:11:39,776 INFO] Create train and test data loaders
[2024-03-01 17:11:39,776 INFO] [!] data loader keys: dict_keys(['train_lb', 'train_ulb', 'eval', 'test'])
[2024-03-01 17:11:42,345 INFO] Create optimizer and scheduler
[2024-03-01 17:11:42,352 INFO] Number of Trainable Params: 109043337
Num of videos 64 frames 15800
Load pretrained model for initializing the thief from  /home/deepankar/mnt/vision3_ckpts/vit_b_16-imagenet1k.pth
key not found class_token
key not found conv_proj.weight
key not found conv_proj.bias
key not found encoder.pos_embedding
key not found encoder.layers.encoder_layer_0.ln_1.weight
key not found encoder.layers.encoder_layer_0.ln_1.bias
key not found encoder.layers.encoder_layer_0.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_0.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_0.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_0.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_0.ln_2.weight
key not found encoder.layers.encoder_layer_0.ln_2.bias
key not found encoder.layers.encoder_layer_0.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_0.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_0.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_0.mlp.linear_2.bias
key not found encoder.layers.encoder_layer_1.ln_1.weight
key not found encoder.layers.encoder_layer_1.ln_1.bias
key not found encoder.layers.encoder_layer_1.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_1.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_1.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_1.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_1.ln_2.weight
key not found encoder.layers.encoder_layer_1.ln_2.bias
key not found encoder.layers.encoder_layer_1.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_1.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_1.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_1.mlp.linear_2.bias
key not found encoder.layers.encoder_layer_2.ln_1.weight
key not found encoder.layers.encoder_layer_2.ln_1.bias
key not found encoder.layers.encoder_layer_2.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_2.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_2.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_2.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_2.ln_2.weight
key not found encoder.layers.encoder_layer_2.ln_2.bias
key not found encoder.layers.encoder_layer_2.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_2.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_2.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_2.mlp.linear_2.bias
key not found encoder.layers.encoder_layer_3.ln_1.weight
key not found encoder.layers.encoder_layer_3.ln_1.bias
key not found encoder.layers.encoder_layer_3.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_3.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_3.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_3.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_3.ln_2.weight
key not found encoder.layers.encoder_layer_3.ln_2.bias
key not found encoder.layers.encoder_layer_3.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_3.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_3.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_3.mlp.linear_2.bias
key not found encoder.layers.encoder_layer_4.ln_1.weight
key not found encoder.layers.encoder_layer_4.ln_1.bias
key not found encoder.layers.encoder_layer_4.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_4.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_4.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_4.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_4.ln_2.weight
key not found encoder.layers.encoder_layer_4.ln_2.bias
key not found encoder.layers.encoder_layer_4.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_4.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_4.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_4.mlp.linear_2.bias
key not found encoder.layers.encoder_layer_5.ln_1.weight
key not found encoder.layers.encoder_layer_5.ln_1.bias
key not found encoder.layers.encoder_layer_5.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_5.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_5.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_5.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_5.ln_2.weight
key not found encoder.layers.encoder_layer_5.ln_2.bias
key not found encoder.layers.encoder_layer_5.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_5.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_5.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_5.mlp.linear_2.bias
key not found encoder.layers.encoder_layer_6.ln_1.weight
key not found encoder.layers.encoder_layer_6.ln_1.bias
key not found encoder.layers.encoder_layer_6.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_6.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_6.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_6.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_6.ln_2.weight
key not found encoder.layers.encoder_layer_6.ln_2.bias
key not found encoder.layers.encoder_layer_6.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_6.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_6.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_6.mlp.linear_2.bias
key not found encoder.layers.encoder_layer_7.ln_1.weight
key not found encoder.layers.encoder_layer_7.ln_1.bias
key not found encoder.layers.encoder_layer_7.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_7.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_7.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_7.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_7.ln_2.weight
key not found encoder.layers.encoder_layer_7.ln_2.bias
key not found encoder.layers.encoder_layer_7.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_7.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_7.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_7.mlp.linear_2.bias
key not found encoder.layers.encoder_layer_8.ln_1.weight
key not found encoder.layers.encoder_layer_8.ln_1.bias
key not found encoder.layers.encoder_layer_8.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_8.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_8.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_8.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_8.ln_2.weight
key not found encoder.layers.encoder_layer_8.ln_2.bias
key not found encoder.layers.encoder_layer_8.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_8.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_8.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_8.mlp.linear_2.bias
key not found encoder.layers.encoder_layer_9.ln_1.weight
key not found encoder.layers.encoder_layer_9.ln_1.bias
key not found encoder.layers.encoder_layer_9.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_9.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_9.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_9.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_9.ln_2.weight
key not found encoder.layers.encoder_layer_9.ln_2.bias
key not found encoder.layers.encoder_layer_9.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_9.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_9.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_9.mlp.linear_2.bias
key not found encoder.layers.encoder_layer_10.ln_1.weight
key not found encoder.layers.encoder_layer_10.ln_1.bias
key not found encoder.layers.encoder_layer_10.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_10.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_10.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_10.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_10.ln_2.weight
key not found encoder.layers.encoder_layer_10.ln_2.bias
key not found encoder.layers.encoder_layer_10.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_10.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_10.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_10.mlp.linear_2.bias
key not found encoder.layers.encoder_layer_11.ln_1.weight
key not found encoder.layers.encoder_layer_11.ln_1.bias
key not found encoder.layers.encoder_layer_11.self_attention.in_proj_weight
key not found encoder.layers.encoder_layer_11.self_attention.in_proj_bias
key not found encoder.layers.encoder_layer_11.self_attention.out_proj.weight
key not found encoder.layers.encoder_layer_11.self_attention.out_proj.bias
key not found encoder.layers.encoder_layer_11.ln_2.weight
key not found encoder.layers.encoder_layer_11.ln_2.bias
key not found encoder.layers.encoder_layer_11.mlp.linear_1.weight
key not found encoder.layers.encoder_layer_11.mlp.linear_1.bias
key not found encoder.layers.encoder_layer_11.mlp.linear_2.weight
key not found encoder.layers.encoder_layer_11.mlp.linear_2.bias
key not found encoder.ln.weight
key not found encoder.ln.bias
key not found heads.head.weight
key not found heads.head.bias
Common keys pretrained model:  0
Load anchor model /home/deepankar/scratch/MSA_Medical/results_1k/gbusg_radformer/GBUSV_radformer/SGD/1000_val100/random_v1/trial_1_cycle_1_best.pth
thief state:  ['global_branch.net.conv1.weight', 'global_branch.net.bn1.weight', 'global_branch.net.bn1.bias', 'global_branch.net.bn1.running_mean', 'global_branch.net.bn1.running_var']
pretrained state:  ['global_branch.net.conv1.weight', 'global_branch.net.bn1.weight', 'global_branch.net.bn1.bias', 'global_branch.net.bn1.running_mean', 'global_branch.net.bn1.running_var']
Common keys anchor model:  695
[2024-03-01 17:11:52,973 INFO] Anchor model on target dataset: acc = 0.7787, spec = 0.72, sens = 0.90
[2024-03-01 17:11:53,604 INFO] Arguments: Namespace(T=0.5, algorithm='selfkd', amp=False, batch_size=16, c='configs/gbc/selfkd_radformer.yaml', clip=0.0, clip_grad=0, crop_ratio=0.875, data_dir='./data', dataset='GBUSV', device=device(type='cuda'), dist_backend='nccl', dist_url='tcp://127.0.0.1:21214', distributed=False, ds_seed=123, ema_m=0.999, epoch=100, eval_batch_size=16, eval_step=234, expand_labels=True, gpu=None, hard_label=True, imb_algorithm=None, img_size=224, include_lb_to_ulb=True, kd_alpha=0.4, kd_alpha_ulb=0.5, kd_temp=1.5, kd_temp_ulb=1.5, la=False, labeled_set_path='/home/deepankar/scratch/MSA_Medical/results_1k/gbusg_radformer/GBUSV_radformer/SGD/1000_val100/random_v1/X_trial_1_cycle_1_labeled_set.npy', layer_decay=0.5, lb_dest_len=3600, lb_imb_ratio=1, load_labeled_set=True, load_path=None, local_rank=-1, lr=0.02, max_length=512, max_length_seconds=4.0, momentum=0.9, multiprocessing_distributed=False, net='radformer', net_from_name=False, no_progress=True, num_classes=3, num_eval_iter=234, num_labels=1000, num_log_iter=234, num_train_iter=900000, num_warmup_iter=5120, num_workers=4, optim='SGD', overwrite=True, p_cutoff=0.95, pretrain_path='', pretrained_dir='/home/deepankar/mnt/vision3_ckpts/vit_b_16-imagenet1k.pth', rank=0, resume=False, sample_rate=16000, save_dir='saved_models/radformer', save_name='selfkd_radformer_v8', scheduler_type='cosine', seed=5, subset=128116, thief_root='/home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBUSV-Shared', train_sampler='RandomSampler', tro=1, ulb_dest_len=15800, ulb_imb_ratio=1, ulb_loss_ratio=1.0, ulb_num_labels=None, uratio=1, use_aim=False, use_cat=True, use_pretrain=True, use_tensorboard=True, use_wandb=True, val_set_path='/home/deepankar/scratch/MSA_Medical/results_1k/gbusg_radformer/GBUSV_radformer/SGD/1000_val100/random_v1/X_trial_1_cycle_1_val_set.npy', victim_arch='radformer', victim_data_root='/home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBCU-Shared', victim_dataset='gbusg', victim_model_path='/home/deepankar/mnt/vision3_data_ckpts_msa_medical/victim_models/radformer/radformer.pkl', warmstart=False, warmstart_dir='/home/deepankar/scratch/MSA_Medical/results_1k/gbusg_radformer/GBUSV_radformer/SGD/1000_val100/random_v1/trial_1_cycle_1_best.pth', warmup=0, warmup_epoch=10, weight_decay=0.0005, world_size=1)
[2024-03-01 17:11:53,604 INFO] Validation set distribution: 
anchor model temp =  1.0
Number of samples  100
[2024-03-01 17:11:54,415 INFO] {0: 9, 1: 18, 2: 73}
[2024-03-01 17:11:54,415 INFO] Labeled set distribution: 
Number of samples  3600
[2024-03-01 17:12:01,350 INFO] {0: 444, 1: 800, 2: 2356}
[2024-03-01 17:12:07,269 INFO] Initial model on target dataset (without EMA): acc = 0.3607, agreement = 0.3361, spec = 1.00, sens = 0.00
[2024-03-01 17:12:07,270 INFO] Resume load path None does not exist
[2024-03-01 17:12:07,270 INFO] 
Model training
wandb: Currently logged in as: satwikdpshrit. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in saved_models/radformer/wandb/selfkd_radformer_v8/wandb/run-20240301_171209-i47wpd9o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run selfkd_radformer_v8
wandb: â­ï¸ View project at https://wandb.ai/satwikdpshrit/radformer
wandb: ðŸš€ View run at https://wandb.ai/satwikdpshrit/radformer/runs/i47wpd9o
[2024-03-01 17:12:12,562 INFO] 

epoch 0
[2024-03-01 17:21:47,688 INFO] validating...
[2024-03-01 17:21:58,803 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 17:22:01,104 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/model_best.pth
[2024-03-01 17:22:01,106 INFO] 226 iteration, USE_EMA: True, train/sup_loss: 0.69362, train/unsup_loss: 0.00000, train/total_loss: 0.69362, train/util_ratio: 0.00000, train/run_time: 2.65865, lr: 0.00000, train/prefecth_time: 0.00865, eval/loss: 1.07628, eval/top-1-acc: 0.43000, eval/balanced_acc: 0.40081, eval/precision: 0.37243, eval/recall: 0.40081, eval/F1: 0.34551, eval/spec: 0.62963, eval/sens: 0.42466, test/loss: 1.06828, test/top-1-acc: 0.43443, test/balanced_acc: 0.38995, test/precision: 0.40630, test/recall: 0.38995, test/F1: 0.36964, test/spec: 0.58750, test/sens: 0.28571 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 17:22:01,109 INFO] 

epoch 1
[2024-03-01 17:32:07,935 INFO] validating...
[2024-03-01 17:32:17,944 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 17:32:17,947 INFO] 451 iteration, USE_EMA: True, train/sup_loss: 0.46073, train/unsup_loss: 0.00000, train/total_loss: 0.46073, train/util_ratio: 0.00000, train/run_time: 2.62308, lr: 0.00200, train/prefecth_time: 0.00708, eval/loss: 0.82142, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20707, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 17:32:17,949 INFO] 

epoch 2
[2024-03-01 17:41:46,790 INFO] validating...
[2024-03-01 17:41:56,469 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 17:41:56,472 INFO] 676 iteration, USE_EMA: True, train/sup_loss: 0.46189, train/unsup_loss: 0.00000, train/total_loss: 0.46189, train/util_ratio: 0.00000, train/run_time: 2.26434, lr: 0.00400, train/prefecth_time: 0.00664, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 17:41:56,475 INFO] 

epoch 3
[2024-03-01 17:51:09,434 INFO] validating...
[2024-03-01 17:51:21,234 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 17:51:21,236 INFO] 901 iteration, USE_EMA: True, train/sup_loss: 0.45927, train/unsup_loss: 0.00000, train/total_loss: 0.45927, train/util_ratio: 0.00000, train/run_time: 2.42815, lr: 0.00600, train/prefecth_time: 0.00763, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 17:51:21,239 INFO] 

epoch 4
[2024-03-01 18:00:38,932 INFO] validating...
[2024-03-01 18:00:49,208 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 18:00:49,211 INFO] 1126 iteration, USE_EMA: True, train/sup_loss: 0.45989, train/unsup_loss: 0.00000, train/total_loss: 0.45989, train/util_ratio: 0.00000, train/run_time: 2.11520, lr: 0.00800, train/prefecth_time: 0.00684, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 18:00:49,214 INFO] 

epoch 5
[2024-03-01 18:10:57,087 INFO] validating...
[2024-03-01 18:11:07,379 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 18:11:07,382 INFO] 1351 iteration, USE_EMA: True, train/sup_loss: 0.46393, train/unsup_loss: 0.00000, train/total_loss: 0.46393, train/util_ratio: 0.00000, train/run_time: 2.27707, lr: 0.01000, train/prefecth_time: 0.00704, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 18:11:07,386 INFO] 

epoch 6
[2024-03-01 18:20:59,028 INFO] validating...
[2024-03-01 18:21:10,093 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 18:21:10,095 INFO] 1576 iteration, USE_EMA: True, train/sup_loss: 0.46143, train/unsup_loss: 0.00000, train/total_loss: 0.46143, train/util_ratio: 0.00000, train/run_time: 2.83627, lr: 0.01200, train/prefecth_time: 0.00960, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 18:21:10,098 INFO] 

epoch 7
[2024-03-01 18:30:42,520 INFO] validating...
[2024-03-01 18:30:53,719 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 18:30:53,721 INFO] 1801 iteration, USE_EMA: True, train/sup_loss: 0.46592, train/unsup_loss: 0.00000, train/total_loss: 0.46592, train/util_ratio: 0.00000, train/run_time: 2.45590, lr: 0.01400, train/prefecth_time: 0.00793, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 18:30:53,725 INFO] 

epoch 8
[2024-03-01 18:40:16,735 INFO] validating...
[2024-03-01 18:40:27,565 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 18:40:27,567 INFO] 2026 iteration, USE_EMA: True, train/sup_loss: 0.46250, train/unsup_loss: 0.00000, train/total_loss: 0.46250, train/util_ratio: 0.00000, train/run_time: 2.42771, lr: 0.01600, train/prefecth_time: 0.00712, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 18:40:27,570 INFO] 

epoch 9
[2024-03-01 18:49:32,023 INFO] validating...
[2024-03-01 18:49:42,701 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 18:49:42,703 INFO] 2251 iteration, USE_EMA: True, train/sup_loss: 0.44977, train/unsup_loss: 0.00000, train/total_loss: 0.44977, train/util_ratio: 0.00000, train/run_time: 2.25922, lr: 0.01800, train/prefecth_time: 0.00731, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 18:49:42,706 INFO] 

epoch 10
[2024-03-01 18:59:53,044 INFO] validating...
[2024-03-01 19:00:03,294 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 19:00:03,297 INFO] 2476 iteration, USE_EMA: True, train/sup_loss: 0.45333, train/unsup_loss: 0.00000, train/total_loss: 0.45333, train/util_ratio: 0.00000, train/run_time: 2.41316, lr: 0.02000, train/prefecth_time: 0.00783, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 19:00:03,301 INFO] 

epoch 11
[2024-03-01 19:09:46,397 INFO] validating...
[2024-03-01 19:09:57,386 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 19:09:57,388 INFO] 2701 iteration, USE_EMA: True, train/sup_loss: 0.45962, train/unsup_loss: 0.00000, train/total_loss: 0.45962, train/util_ratio: 0.00000, train/run_time: 2.16854, lr: 0.02000, train/prefecth_time: 0.00811, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 19:09:57,392 INFO] 

epoch 12
--- Logging error ---
Traceback (most recent call last):
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/logging/__init__.py", line 1089, in emit
    self.flush()
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/logging/__init__.py", line 1069, in flush
    self.stream.flush()
OSError: [Errno 28] No space left on device
Call stack:
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/wandb/sdk/internal/internal_util.py", line 49, in run
    self._run()
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/wandb/sdk/internal/internal_util.py", line 101, in _run
    self._finish()
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/wandb/sdk/internal/internal.py", line 282, in _finish
    self._hm.finish()
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/wandb/sdk/internal/handler.py", line 871, in finish
    self._system_monitor.finish()
  File "/home/deepankar/scratch/miniconda3/[2024-03-01 19:18:53,821 INFO] validating...
[2024-03-01 19:19:03,544 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 19:19:03,547 INFO] 2926 iteration, USE_EMA: True, train/sup_loss: 0.46497, train/unsup_loss: 0.00000, train/total_loss: 0.46497, train/util_ratio: 0.00000, train/run_time: 2.17370, lr: 0.01999, train/prefecth_time: 0.00644, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 19:19:03,551 INFO] 

epoch 13
[2024-03-01 19:27:41,510 INFO] validating...
[2024-03-01 19:27:50,138 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 19:27:50,140 INFO] 3151 iteration, USE_EMA: True, train/sup_loss: 0.46174, train/unsup_loss: 0.00000, train/total_loss: 0.46174, train/util_ratio: 0.00000, train/run_time: 2.17667, lr: 0.01998, train/prefecth_time: 0.00615, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 19:27:50,144 INFO] 

epoch 14
[2024-03-01 19:36:24,524 INFO] validating...
[2024-03-01 19:36:35,018 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 19:36:35,021 INFO] 3376 iteration, USE_EMA: True, train/sup_loss: 0.46219, train/unsup_loss: 0.00000, train/total_loss: 0.46219, train/util_ratio: 0.00000, train/run_time: 2.38742, lr: 0.01996, train/prefecth_time: 0.00762, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 19:36:35,024 INFO] 

epoch 15
[2024-03-01 19:45:25,728 INFO] validating...
[2024-03-01 19:45:34,623 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 19:45:34,626 INFO] 3601 iteration, USE_EMA: True, train/sup_loss: 0.46684, train/unsup_loss: 0.00000, train/total_loss: 0.46684, train/util_ratio: 0.00000, train/run_time: 2.19695, lr: 0.01994, train/prefecth_time: 0.00731, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 19:45:34,630 INFO] 

epoch 16
[2024-03-01 19:54:16,643 INFO] validating...
[2024-03-01 19:54:25,739 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 19:54:25,741 INFO] 3826 iteration, USE_EMA: True, train/sup_loss: 0.46864, train/unsup_loss: 0.00000, train/total_loss: 0.46864, train/util_ratio: 0.00000, train/run_time: 2.21321, lr: 0.01992, train/prefecth_time: 0.00673, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 19:54:25,746 INFO] 

epoch 17
[2024-03-01 20:03:07,242 INFO] validating...
[2024-03-01 20:03:16,364 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 20:03:16,366 INFO] 4051 iteration, USE_EMA: True, train/sup_loss: 0.46301, train/unsup_loss: 0.00000, train/total_loss: 0.46301, train/util_ratio: 0.00000, train/run_time: 2.22143, lr: 0.01989, train/prefecth_time: 0.00639, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 20:03:16,370 INFO] 

epoch 18
[2024-03-01 20:11:52,321 INFO] validating...
[2024-03-01 20:12:01,557 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 20:12:01,560 INFO] 4276 iteration, USE_EMA: True, train/sup_loss: 0.45838, train/unsup_loss: 0.00000, train/total_loss: 0.45838, train/util_ratio: 0.00000, train/run_time: 2.19477, lr: 0.01985, train/prefecth_time: 0.00742, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 20:12:01,564 INFO] 

epoch 19
[2024-03-01 20:20:38,562 INFO] validating...
[2024-03-01 20:20:47,950 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 20:20:47,952 INFO] 4501 iteration, USE_EMA: True, train/sup_loss: 0.45791, train/unsup_loss: 0.00000, train/total_loss: 0.45791, train/util_ratio: 0.00000, train/run_time: 2.38447, lr: 0.01981, train/prefecth_time: 0.00789, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 20:20:47,955 INFO] 

epoch 20
[2024-03-01 20:29:33,753 INFO] validating...
[2024-03-01 20:29:43,078 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 20:29:43,079 INFO] 4726 iteration, USE_EMA: True, train/sup_loss: 0.46503, train/unsup_loss: 0.00000, train/total_loss: 0.46503, train/util_ratio: 0.00000, train/run_time: 2.49628, lr: 0.01977, train/prefecth_time: 0.00732, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 20:29:43,083 INFO] 

epoch 21
[2024-03-01 20:38:25,348 INFO] validating...
[2024-03-01 20:38:36,353 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 20:38:36,356 INFO] 4951 iteration, USE_EMA: True, train/sup_loss: 0.46424, train/unsup_loss: 0.00000, train/total_loss: 0.46424, train/util_ratio: 0.00000, train/run_time: 3.04267, lr: 0.01972, train/prefecth_time: 0.00720, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 20:38:36,359 INFO] 

epoch 22
[2024-03-01 20:47:45,019 INFO] validating...
[2024-03-01 20:47:54,306 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 20:47:54,308 INFO] 5176 iteration, USE_EMA: True, train/sup_loss: 0.46196, train/unsup_loss: 0.00000, train/total_loss: 0.46196, train/util_ratio: 0.00000, train/run_time: 2.35475, lr: 0.01967, train/prefecth_time: 0.00633, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 20:47:54,312 INFO] 

epoch 23
[2024-03-01 20:56:32,133 INFO] validating...
[2024-03-01 20:56:41,227 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 20:56:41,230 INFO] 5401 iteration, USE_EMA: True, train/sup_loss: 0.46626, train/unsup_loss: 0.00000, train/total_loss: 0.46626, train/util_ratio: 0.00000, train/run_time: 2.20026, lr: 0.01961, train/prefecth_time: 0.00644, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 20:56:41,233 INFO] 

epoch 24
[2024-03-01 21:05:08,476 INFO] validating...
[2024-03-01 21:05:17,659 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 21:05:17,661 INFO] 5626 iteration, USE_EMA: True, train/sup_loss: 0.46046, train/unsup_loss: 0.00000, train/total_loss: 0.46046, train/util_ratio: 0.00000, train/run_time: 2.20757, lr: 0.01954, train/prefecth_time: 0.00553, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 21:05:17,666 INFO] 

epoch 25
[2024-03-01 21:13:37,705 INFO] validating...
[2024-03-01 21:13:47,428 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 21:13:47,430 INFO] 5851 iteration, USE_EMA: True, train/sup_loss: 0.46208, train/unsup_loss: 0.00000, train/total_loss: 0.46208, train/util_ratio: 0.00000, train/run_time: 1.81217, lr: 0.01948, train/prefecth_time: 0.01427, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 21:13:47,433 INFO] 

epoch 26
[2024-03-01 21:22:16,726 INFO] validating...
[2024-03-01 21:22:26,946 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 21:22:26,948 INFO] 6076 iteration, USE_EMA: True, train/sup_loss: 0.45695, train/unsup_loss: 0.00000, train/total_loss: 0.45695, train/util_ratio: 0.00000, train/run_time: 2.29229, lr: 0.01941, train/prefecth_time: 0.00660, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 21:22:26,952 INFO] 

epoch 27
[2024-03-01 21:31:33,595 INFO] validating...
[2024-03-01 21:31:43,361 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 21:31:43,363 INFO] 6301 iteration, USE_EMA: True, train/sup_loss: 0.45886, train/unsup_loss: 0.00000, train/total_loss: 0.45886, train/util_ratio: 0.00000, train/run_time: 2.45935, lr: 0.01933, train/prefecth_time: 0.00693, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 21:31:43,366 INFO] 

epoch 28
[2024-03-01 21:40:38,998 INFO] validating...
[2024-03-01 21:40:49,263 INFO] model saved: saved_models/radformer/selfkd_radformer_v8/latest_model.pth
[2024-03-01 21:40:49,265 INFO] 6526 iteration, USE_EMA: True, train/sup_loss: 0.45732, train/unsup_loss: 0.00000, train/total_loss: 0.45732, train/util_ratio: 0.00000, train/run_time: 1.78813, lr: 0.01925, train/prefecth_time: 0.00714, eval/loss: 0.82144, eval/top-1-acc: 0.73000, eval/balanced_acc: 0.33333, eval/precision: 0.24333, eval/recall: 0.33333, eval/F1: 0.28131, eval/spec: 0.00000, eval/sens: 1.00000, test/loss: 1.20718, test/top-1-acc: 0.34426, test/balanced_acc: 0.33333, test/precision: 0.11475, test/recall: 0.33333, test/F1: 0.17073, test/spec: 0.00000, test/sens: 1.00000 BEST_EVAL_ACC: 0.4300, at 226 iters BEST_TEST_ACC: 0.4344, at 226 iters
[2024-03-01 21:40:49,267 INFO] 

epoch 29
Exception in thread StreamThr:
Traceback (most recent call last):
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/wandb/sdk/service/streams.py", line 48, in run
    self._target(**self._kwargs)
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/site-packages/wandb/sdk/internal/internal.py", line 176, in wandb_internal
    traceback.print_exception(*exc_info)
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/traceback.py", line 105, in print_exception
    print(line, file=file, end="")
OSError: [Errno 28] No space left on device
Exception in threading.excepthook:
Exception ignored in thread started by: <bound method Thread._bootstrap of <StreamThread(StreamThr, started daemon 139924992943872)>>
Traceback (most recent call last):
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/threading.py", line 934, in _bootstrap_inner
    self._invoke_excepthook(self)
  File "/home/deepankar/scratch/miniconda3/envs/msa_medical/lib/python3.8/threading.py", line 1212, in invoke_excepthook
    local_print("Exception in threading.excepthook:",
OSError: [Errno 28] No space left on device
Exception ignored in sys.unraisablehook: <built-in function unraisablehook>
OSError: [Errno 28] No space left on device
