nohup: ignoring input
[24/03/07 03:00:33] [conf.py:  298]: PyTorch Version: torch=1.11.0, cuda=11.3, cudnn=8200
[24/03/07 03:00:33] [conf.py:  300]: ACTIVE:
  ADDENDUM: 180
  ALPHA: 0.2
  AUGMENT: None
  BETA: 1.0
  BUDGET: 1000
  CUTMIX_PROB: 0.0
  CYCLES: 5
  INITIAL: 180
  LA: False
  METHOD: kcenter
  PRETRAINED_PATH: /home/ankita/scratch/data_msa_medical/ckpts/resnet50-imagenet1k.pth
  TEMP: 1.0
  TRO: 1.0
  USE_PRETRAINED: True
  VAL: 100
AM:
  SGR: 1000
  THRESHOLD: 0.5
CUDNN_BENCHMARK: True
DS_SEED: 123
EDM:
  HASH: /home/harsh_s/scratch/msacopy/exp/hash/alpha.pt
  NUM_MODELS: 5
  PATH1: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T0.pt
  PATH2: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T1.pt
  PATH3: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T2.pt
  PATH4: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T3.pt
  PATH5: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T4.pt
GR:
  EPSILON: 0.1
  SUR_PATH: /home/harsh_s/scratch/msacopy/GRAD2/batch_training/outputs/trained_models/imagenet_cifar10_to_cifar10_surrogate_10epochs.pt
LOG_DEST: resnet18_resnet50_pocus_240307_030033.txt
LOG_TIME: 240307_030033
METHOD_NAME: v3
OUT_DIR: /home/ankita/scratch/data_msa_medical/results_ankita/
PL:
  CLASS_BLNC: 10
  ITERATIONS: 20
  KAPPA_N: 0.005
  KAPPA_P: 0.05
  NO_PROGRESS: False
  NO_UNCERTAINTY: False
  TAU_N: 0.05
  TAU_P: 0.7
  TEMP_NL: 2.0
RNG_SEED: 5
SAVE_DIR: /home/ankita/scratch/data_msa_medical/results_ankita//pocus_resnet18/butterfly_resnet50/SGD/1000_val100/kcenter_v3
THIEF:
  ARCH: resnet50
  DATASET: butterfly
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/Butte
  HARD_LABELS: True
  NUM_TRAIN: 1281167
  SUBSET: 128116
TRAIN:
  BATCH: 16
  EPOCH: 100
  GAMMA: 0.1
  LR: 0.02
  MILESTONES: [20, 40, 60, 80]
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  WDECAY: 0.0005
VICTIM:
  ARCH: resnet18
  DATASET: pocus
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/covid_5_fold
  HEIGHT: 224
  PATH: /home/ankita/scratch/data_msa_medical/victim_models/pocus_resnet18.pth.tar
  PATHIN: /home/harsh_s/scratch/msacopy/ckpts/cifar10-resnet32-inaccurate/checkpoint.pth.tar
  WIDTH: 224
Loaded target dataset of size 476 with 3 classes
target model keys:  122
checkpoint keys:  122

Target model acc = 0.8991596638655462
Val-Acc: 0.8992 Val-Spec: 0.9795 Val-Sens: 0.9224 Class Acc: [0.8343949  0.95402299 0.92241379]
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.60it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.85it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.47it/s]100%|██████████| 12/12 [00:01<00:00,  9.77it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.60it/s] 71%|███████▏  | 5/7 [00:00<00:00,  7.84it/s]100%|██████████| 7/7 [00:00<00:00,  7.13it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2152, -1.2309, -1.2074]), tensor([0.8543, 0.8499, 0.8570]))
Val set stats: mean/std =  (tensor([-1.2078, -1.2208, -1.2012]), tensor([0.8407, 0.8375, 0.8429]))
Validation set distribution: 
Number of samples  100
{0: 15, 1: 43, 2: 42}
Labeled set distribution: 
Number of samples  180
{0: 38, 1: 72, 2: 70}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.3466, agreement = 0.3487, f1 = 0.2606, spec = 0.2295, sens = 0.5776 Class Acc: [0.         0.35632184 0.57758621]
Initial model on validation dataset: acc = 0.1900, agreement = 0.1900, f1 = 0.1848, spec = 0.6207, sens = 0.0952 Class Acc: [0.26666667 0.25581395 0.0952381 ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:19,  1.41s/it]  2%|▏         | 2/100 [00:04<03:34,  2.19s/it]  3%|▎         | 3/100 [00:05<02:55,  1.80s/it]  4%|▍         | 4/100 [00:08<03:27,  2.17s/it]  5%|▌         | 5/100 [00:11<04:17,  2.71s/it]Epoch 5: Train acc/f1 = 0.8111 / 0.7690 / 0.9182 / 0.7857/ [0.55263158 0.97222222 0.78571429] 
                Val acc/f1/spec/sens = 0.6800 / 0.5530 / 1.0000 / 0.5714/ [0.13333333 0.97674419 0.57142857]
                Test acc/f1/spec/sens = 0.1912 / 0.1566 / 0.8402 / 0.0776/ [0.03184713 0.7816092  0.07758621]
  6%|▌         | 6/100 [00:14<04:12,  2.69s/it]  7%|▋         | 7/100 [00:15<03:28,  2.25s/it]  8%|▊         | 8/100 [00:18<03:42,  2.42s/it]  9%|▉         | 9/100 [00:20<03:13,  2.13s/it] 10%|█         | 10/100 [00:25<04:46,  3.19s/it]Epoch 10: Train acc/f1 = 0.9500 / 0.9372 / 0.9364 / 0.9857/ [0.81578947 0.98611111 0.98571429] 
                Val acc/f1/spec/sens = 0.9100 / 0.8919 / 0.8793 / 1.0000/ [0.8        0.86046512 1.        ]
                Test acc/f1/spec/sens = 0.5714 / 0.4494 / 0.7377 / 0.8578/ [0.05095541 0.74712644 0.85775862]
 11%|█         | 11/100 [00:27<03:56,  2.66s/it] 12%|█▏        | 12/100 [00:29<03:46,  2.57s/it] 13%|█▎        | 13/100 [00:30<03:12,  2.21s/it] 14%|█▍        | 14/100 [00:33<03:14,  2.26s/it] 15%|█▌        | 15/100 [00:37<03:49,  2.70s/it]Epoch 15: Train acc/f1 = 0.8778 / 0.8721 / 0.9909 / 0.7286/ [1.         0.95833333 0.72857143] 
                Val acc/f1/spec/sens = 0.9000 / 0.8582 / 0.9483 / 0.9286/ [0.66666667 0.95348837 0.92857143]
                Test acc/f1/spec/sens = 0.2101 / 0.1660 / 0.9631 / 0.0431/ [0.06369427 0.91954023 0.04310345]
 16%|█▌        | 16/100 [00:39<03:40,  2.63s/it] 17%|█▋        | 17/100 [00:40<03:06,  2.25s/it] 18%|█▊        | 18/100 [00:43<03:14,  2.38s/it] 19%|█▉        | 19/100 [00:44<02:47,  2.06s/it] 20%|██        | 20/100 [00:49<03:48,  2.86s/it]Epoch 20: Train acc/f1 = 0.9889 / 0.9866 / 1.0000 / 1.0000/ [0.97368421 0.98611111 1.        ] 
                Val acc/f1/spec/sens = 0.9000 / 0.8819 / 0.9138 / 0.9524/ [0.86666667 0.86046512 0.95238095]
                Test acc/f1/spec/sens = 0.1828 / 0.1416 / 0.8934 / 0.0216/ [0.05732484 0.83908046 0.02155172]
 21%|██        | 21/100 [00:50<03:10,  2.42s/it] 22%|██▏       | 22/100 [00:53<03:13,  2.47s/it] 23%|██▎       | 23/100 [00:54<02:46,  2.16s/it] 24%|██▍       | 24/100 [00:57<02:49,  2.23s/it] 25%|██▌       | 25/100 [01:01<03:22,  2.70s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8945 / 0.8793 / 0.9762/ [0.93333333 0.81395349 0.97619048]
                Test acc/f1/spec/sens = 0.3214 / 0.2869 / 0.8730 / 0.3017/ [0.05732484 0.85057471 0.30172414]
 26%|██▌       | 26/100 [01:03<03:15,  2.65s/it] 27%|██▋       | 27/100 [01:05<02:47,  2.29s/it] 28%|██▊       | 28/100 [01:07<02:50,  2.36s/it] 29%|██▉       | 29/100 [01:09<02:27,  2.08s/it] 30%|███       | 30/100 [01:13<03:24,  2.92s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8945 / 0.8793 / 0.9762/ [0.93333333 0.81395349 0.97619048]
                Test acc/f1/spec/sens = 0.2521 / 0.2144 / 0.9180 / 0.1293/ [0.05732484 0.93103448 0.12931034]
 31%|███       | 31/100 [01:15<02:50,  2.47s/it] 32%|███▏      | 32/100 [01:17<02:44,  2.43s/it] 33%|███▎      | 33/100 [01:19<02:21,  2.11s/it] 34%|███▍      | 34/100 [01:21<02:24,  2.19s/it] 35%|███▌      | 35/100 [01:25<02:53,  2.67s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8945 / 0.8793 / 0.9762/ [0.93333333 0.81395349 0.97619048]
                Test acc/f1/spec/sens = 0.2752 / 0.2457 / 0.8811 / 0.1940/ [0.06369427 0.87356322 0.19396552]
 36%|███▌      | 36/100 [01:27<02:48,  2.63s/it] 37%|███▋      | 37/100 [01:29<02:25,  2.32s/it] 38%|███▊      | 38/100 [01:31<02:29,  2.40s/it] 39%|███▉      | 39/100 [01:33<02:09,  2.12s/it] 40%|████      | 40/100 [01:38<02:58,  2.98s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8864 / 0.8621 / 0.9762/ [0.93333333 0.79069767 0.97619048]
                Test acc/f1/spec/sens = 0.2962 / 0.2640 / 0.8893 / 0.2284/ [0.06369427 0.89655172 0.22844828]
 41%|████      | 41/100 [01:39<02:28,  2.52s/it] 42%|████▏     | 42/100 [01:42<02:31,  2.61s/it] 43%|████▎     | 43/100 [01:44<02:08,  2.26s/it] 44%|████▍     | 44/100 [01:46<02:14,  2.40s/it] 45%|████▌     | 45/100 [01:50<02:40,  2.91s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.9026 / 0.8966 / 0.9762/ [0.93333333 0.8372093  0.97619048]
                Test acc/f1/spec/sens = 0.2542 / 0.2219 / 0.8893 / 0.1466/ [0.06369427 0.88505747 0.14655172]
 46%|████▌     | 46/100 [01:53<02:31,  2.81s/it] 47%|████▋     | 47/100 [01:55<02:08,  2.42s/it] 48%|████▊     | 48/100 [01:57<02:09,  2.49s/it] 49%|████▉     | 49/100 [01:59<01:52,  2.20s/it] 50%|█████     | 50/100 [02:04<02:36,  3.13s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8735 / 0.8621 / 0.9524/ [0.93333333 0.79069767 0.95238095]
                Test acc/f1/spec/sens = 0.2584 / 0.2257 / 0.8934 / 0.1466/ [0.06369427 0.90804598 0.14655172]
 51%|█████     | 51/100 [02:06<02:09,  2.65s/it] 52%|█████▏    | 52/100 [02:08<02:05,  2.62s/it] 53%|█████▎    | 53/100 [02:10<01:48,  2.30s/it] 54%|█████▍    | 54/100 [02:12<01:50,  2.40s/it] 55%|█████▌    | 55/100 [02:16<02:08,  2.86s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8897 / 0.8966 / 0.9524/ [0.93333333 0.8372093  0.95238095]
                Test acc/f1/spec/sens = 0.2563 / 0.2242 / 0.8934 / 0.1509/ [0.06369427 0.88505747 0.15086207]
 56%|█████▌    | 56/100 [02:19<02:02,  2.79s/it] 57%|█████▋    | 57/100 [02:20<01:43,  2.40s/it] 58%|█████▊    | 58/100 [02:23<01:43,  2.46s/it] 59%|█████▉    | 59/100 [02:24<01:28,  2.15s/it] 60%|██████    | 60/100 [02:29<02:00,  3.02s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8735 / 0.8621 / 0.9524/ [0.93333333 0.79069767 0.95238095]
                Test acc/f1/spec/sens = 0.2731 / 0.2439 / 0.8730 / 0.1983/ [0.06369427 0.85057471 0.19827586]
 61%|██████    | 61/100 [02:31<01:40,  2.58s/it] 62%|██████▏   | 62/100 [02:33<01:36,  2.55s/it] 63%|██████▎   | 63/100 [02:35<01:22,  2.24s/it] 64%|██████▍   | 64/100 [02:38<01:24,  2.35s/it] 65%|██████▌   | 65/100 [02:42<01:39,  2.85s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8897 / 0.8966 / 0.9524/ [0.93333333 0.8372093  0.95238095]
                Test acc/f1/spec/sens = 0.2647 / 0.2299 / 0.9016 / 0.1638/ [0.05732484 0.90804598 0.1637931 ]
 66%|██████▌   | 66/100 [02:44<01:34,  2.78s/it] 67%|██████▋   | 67/100 [02:46<01:19,  2.40s/it] 68%|██████▊   | 68/100 [02:48<01:18,  2.44s/it] 69%|██████▉   | 69/100 [02:50<01:07,  2.16s/it] 70%|███████   | 70/100 [02:55<01:32,  3.09s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8816 / 0.8793 / 0.9524/ [0.93333333 0.81395349 0.95238095]
                Test acc/f1/spec/sens = 0.2647 / 0.2315 / 0.9016 / 0.1552/ [0.06369427 0.91954023 0.15517241]
 71%|███████   | 71/100 [02:57<01:16,  2.63s/it] 72%|███████▏  | 72/100 [02:59<01:13,  2.63s/it] 73%|███████▎  | 73/100 [03:01<01:01,  2.27s/it] 74%|███████▍  | 74/100 [03:03<01:00,  2.34s/it] 75%|███████▌  | 75/100 [03:07<01:11,  2.85s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8816 / 0.8793 / 0.9524/ [0.93333333 0.81395349 0.95238095]
                Test acc/f1/spec/sens = 0.2605 / 0.2296 / 0.8811 / 0.1638/ [0.06369427 0.87356322 0.1637931 ]
 76%|███████▌  | 76/100 [03:10<01:06,  2.77s/it] 77%|███████▋  | 77/100 [03:11<00:54,  2.38s/it] 78%|███████▊  | 78/100 [03:14<00:53,  2.42s/it] 79%|███████▉  | 79/100 [03:15<00:44,  2.12s/it] 80%|████████  | 80/100 [03:20<00:58,  2.92s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8897 / 0.8966 / 0.9524/ [0.93333333 0.8372093  0.95238095]
                Test acc/f1/spec/sens = 0.2374 / 0.2012 / 0.9016 / 0.1121/ [0.05732484 0.89655172 0.11206897]
 81%|████████  | 81/100 [03:21<00:47,  2.48s/it] 82%|████████▏ | 82/100 [03:24<00:44,  2.49s/it] 83%|████████▎ | 83/100 [03:25<00:37,  2.19s/it] 84%|████████▍ | 84/100 [03:28<00:36,  2.28s/it] 85%|████████▌ | 85/100 [03:32<00:41,  2.77s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8897 / 0.8966 / 0.9524/ [0.93333333 0.8372093  0.95238095]
                Test acc/f1/spec/sens = 0.2353 / 0.1966 / 0.9139 / 0.0991/ [0.05732484 0.91954023 0.09913793]
 86%|████████▌ | 86/100 [03:34<00:37,  2.69s/it] 87%|████████▋ | 87/100 [03:36<00:30,  2.33s/it] 88%|████████▊ | 88/100 [03:38<00:28,  2.42s/it] 89%|████████▉ | 89/100 [03:40<00:23,  2.13s/it] 90%|█████████ | 90/100 [03:45<00:30,  3.01s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.9026 / 0.8966 / 0.9762/ [0.93333333 0.8372093  0.97619048]
                Test acc/f1/spec/sens = 0.2563 / 0.2232 / 0.8975 / 0.1466/ [0.06369427 0.89655172 0.14655172]
 91%|█████████ | 91/100 [03:46<00:22,  2.54s/it] 92%|█████████▏| 92/100 [03:49<00:20,  2.55s/it] 93%|█████████▎| 93/100 [03:50<00:15,  2.24s/it] 94%|█████████▍| 94/100 [03:53<00:14,  2.33s/it] 95%|█████████▌| 95/100 [03:57<00:14,  2.83s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8816 / 0.8793 / 0.9524/ [0.93333333 0.81395349 0.95238095]
                Test acc/f1/spec/sens = 0.2542 / 0.2220 / 0.8893 / 0.1466/ [0.06369427 0.88505747 0.14655172]
 96%|█████████▌| 96/100 [04:00<00:10,  2.72s/it] 97%|█████████▋| 97/100 [04:01<00:07,  2.34s/it] 98%|█████████▊| 98/100 [04:04<00:04,  2.40s/it] 99%|█████████▉| 99/100 [04:05<00:02,  2.12s/it]100%|██████████| 100/100 [04:10<00:00,  3.03s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8897 / 0.8966 / 0.9524/ [0.93333333 0.8372093  0.95238095]
                Test acc/f1/spec/sens = 0.2353 / 0.1999 / 0.8893 / 0.1121/ [0.05732484 0.88505747 0.11206897]
Trial 1, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9000 / 0.8897 / 0.8966 / 0.9524/ [0.93333333 0.8372093  0.95238095]
Test acc/f1/spec/sens = 0.2353 / 0.1999 / 0.8893 / 0.1121/ [0.05732484 0.88505747 0.11206897]
>> Finished.
Acc, agreement for latest model:  0.23529411764705882 0.30462184873949577 [0.05732484 0.88505747 0.11206897]
Load best checkpoint for thief model
Acc, agreement for best model:  0.17436974789915966 0.23949579831932774 [0.04458599 0.79310345 0.03017241]
Trial 0/5 || Cycle 1/5 || Label set size 180 || Test acc 0.1744 || Test agreement 0.2395 || Spec 0.9221 || Sens 0.0302 Class Acc: [0.04458599 0.79310345 0.03017241]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.26s/it]100%|██████████| 2/2 [00:13<00:00,  5.53s/it]100%|██████████| 2/2 [00:13<00:00,  6.82s/it]
Maximum distance from cluster centers is 0.42
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.73it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.71it/s] 67%|██████▋   | 8/12 [00:00<00:00, 11.96it/s]100%|██████████| 12/12 [00:01<00:00,  9.92it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 25, 1: 70, 2: 85}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 43, 2: 42}
Labeled set distribution: 
Number of samples  360
{0: 63, 1: 142, 2: 155}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.2941, agreement = 0.3088, f1 = 0.2644, spec = 0.9959, sens = 0.0000 Class Acc: [0.54140127 0.63218391 0.        ]
Initial model on validation dataset: acc = 0.2600, agreement = 0.2600, f1 = 0.2141, spec = 0.9655, sens = 0.0000 Class Acc: [0.53333333 0.41860465 0.        ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<03:11,  1.93s/it]  2%|▏         | 2/100 [00:05<04:42,  2.88s/it]  3%|▎         | 3/100 [00:07<04:06,  2.54s/it]  4%|▍         | 4/100 [00:11<04:39,  2.91s/it]  5%|▌         | 5/100 [00:16<05:46,  3.64s/it]Epoch 5: Train acc/f1 = 0.8333 / 0.7341 / 0.7854 / 0.9935/ [0.28571429 0.90140845 0.99354839] 
                Val acc/f1/spec/sens = 0.8900 / 0.8454 / 0.9138 / 0.8810/ [0.66666667 0.97674419 0.88095238]
                Test acc/f1/spec/sens = 0.6366 / 0.5351 / 0.4221 / 0.9957/ [0.13375796 0.5862069  0.99568966]
  6%|▌         | 6/100 [00:19<05:33,  3.55s/it]  7%|▋         | 7/100 [00:21<04:46,  3.08s/it]  8%|▊         | 8/100 [00:24<04:41,  3.06s/it]  9%|▉         | 9/100 [00:26<04:12,  2.78s/it] 10%|█         | 10/100 [00:32<05:38,  3.76s/it]Epoch 10: Train acc/f1 = 0.6389 / 0.5643 / 1.0000 / 0.4774/ [0.22222222 1.         0.47741935] 
                Val acc/f1/spec/sens = 0.6100 / 0.5353 / 0.9828 / 0.3333/ [0.26666667 1.         0.33333333]
                Test acc/f1/spec/sens = 0.1891 / 0.1154 / 0.9139 / 0.0129/ [0.         1.         0.01293103]
 11%|█         | 11/100 [00:34<04:48,  3.24s/it] 12%|█▏        | 12/100 [00:37<04:39,  3.18s/it] 13%|█▎        | 13/100 [00:39<04:06,  2.83s/it] 14%|█▍        | 14/100 [00:42<04:09,  2.90s/it] 15%|█▌        | 15/100 [00:47<04:56,  3.49s/it]Epoch 15: Train acc/f1 = 0.8167 / 0.7958 / 1.0000 / 0.8839/ [0.96825397 0.67605634 0.88387097] 
                Val acc/f1/spec/sens = 0.8500 / 0.7125 / 0.8103 / 0.9524/ [0.2        0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.5000 / 0.4750 / 0.9672 / 0.3922/ [0.76433121 0.31034483 0.39224138]
 16%|█▌        | 16/100 [00:50<04:41,  3.35s/it] 17%|█▋        | 17/100 [00:52<04:03,  2.93s/it] 18%|█▊        | 18/100 [00:55<04:05,  3.00s/it] 19%|█▉        | 19/100 [00:57<03:40,  2.72s/it] 20%|██        | 20/100 [01:03<04:52,  3.66s/it]Epoch 20: Train acc/f1 = 0.9667 / 0.9573 / 0.9610 / 0.9935/ [0.88888889 0.97183099 0.99354839] 
                Val acc/f1/spec/sens = 0.9100 / 0.8512 / 0.8966 / 1.0000/ [0.53333333 0.95348837 1.        ]
                Test acc/f1/spec/sens = 0.2479 / 0.2677 / 0.7295 / 0.1422/ [0.11464968 0.77011494 0.14224138]
 21%|██        | 21/100 [01:05<04:12,  3.19s/it] 22%|██▏       | 22/100 [01:09<04:15,  3.27s/it] 23%|██▎       | 23/100 [01:11<03:42,  2.88s/it] 24%|██▍       | 24/100 [01:14<03:48,  3.01s/it] 25%|██▌       | 25/100 [01:19<04:27,  3.57s/it]Epoch 25: Train acc/f1 = 0.9972 / 0.9978 / 0.9951 / 1.0000/ [1.         0.99295775 1.        ] 
                Val acc/f1/spec/sens = 0.9300 / 0.8976 / 0.9483 / 0.9762/ [0.73333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2353 / 0.2487 / 0.7910 / 0.1767/ [0.05732484 0.71264368 0.17672414]
 26%|██▌       | 26/100 [01:22<04:14,  3.44s/it] 27%|██▋       | 27/100 [01:24<03:42,  3.04s/it] 28%|██▊       | 28/100 [01:27<03:38,  3.03s/it] 29%|██▉       | 29/100 [01:29<03:16,  2.77s/it] 30%|███       | 30/100 [01:36<04:24,  3.77s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8976 / 0.9483 / 0.9762/ [0.73333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.3067 / 0.3100 / 0.7623 / 0.3147/ [0.06369427 0.72413793 0.31465517]
 31%|███       | 31/100 [01:38<03:44,  3.26s/it] 32%|███▏      | 32/100 [01:41<03:36,  3.19s/it] 33%|███▎      | 33/100 [01:43<03:11,  2.86s/it] 34%|███▍      | 34/100 [01:46<03:10,  2.89s/it] 35%|███▌      | 35/100 [01:51<03:47,  3.50s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8976 / 0.9483 / 0.9762/ [0.73333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2437 / 0.2564 / 0.7787 / 0.1940/ [0.06369427 0.70114943 0.19396552]
 36%|███▌      | 36/100 [01:54<03:37,  3.39s/it] 37%|███▋      | 37/100 [01:56<03:08,  3.00s/it] 38%|███▊      | 38/100 [01:59<03:07,  3.02s/it] 39%|███▉      | 39/100 [02:01<02:46,  2.73s/it] 40%|████      | 40/100 [02:07<03:40,  3.67s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2563 / 0.2745 / 0.7336 / 0.2112/ [0.07643312 0.70114943 0.2112069 ]
 41%|████      | 41/100 [02:09<03:08,  3.20s/it] 42%|████▏     | 42/100 [02:12<03:06,  3.22s/it] 43%|████▎     | 43/100 [02:14<02:44,  2.88s/it] 44%|████▍     | 44/100 [02:17<02:45,  2.96s/it] 45%|████▌     | 45/100 [02:22<03:16,  3.58s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8976 / 0.9483 / 0.9762/ [0.73333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2353 / 0.2517 / 0.7459 / 0.1681/ [0.07006369 0.71264368 0.16810345]
 46%|████▌     | 46/100 [02:25<03:04,  3.42s/it] 47%|████▋     | 47/100 [02:27<02:38,  3.00s/it] 48%|████▊     | 48/100 [02:30<02:36,  3.01s/it] 49%|████▉     | 49/100 [02:33<02:19,  2.74s/it] 50%|█████     | 50/100 [02:39<03:04,  3.69s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2437 / 0.2595 / 0.7500 / 0.1853/ [0.07643312 0.70114943 0.18534483]
 51%|█████     | 51/100 [02:41<02:37,  3.22s/it] 52%|█████▏    | 52/100 [02:44<02:33,  3.19s/it] 53%|█████▎    | 53/100 [02:46<02:13,  2.83s/it] 54%|█████▍    | 54/100 [02:49<02:13,  2.90s/it] 55%|█████▌    | 55/100 [02:54<02:37,  3.51s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2332 / 0.2589 / 0.6926 / 0.1595/ [0.08917197 0.68965517 0.15948276]
 56%|█████▌    | 56/100 [02:57<02:28,  3.37s/it] 57%|█████▋    | 57/100 [02:59<02:07,  2.97s/it] 58%|█████▊    | 58/100 [03:02<02:05,  2.98s/it] 59%|█████▉    | 59/100 [03:04<01:50,  2.70s/it] 60%|██████    | 60/100 [03:10<02:28,  3.71s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2479 / 0.2626 / 0.7377 / 0.1940/ [0.06369427 0.72413793 0.19396552]
 61%|██████    | 61/100 [03:12<02:05,  3.22s/it] 62%|██████▏   | 62/100 [03:15<02:01,  3.19s/it] 63%|██████▎   | 63/100 [03:17<01:44,  2.82s/it] 64%|██████▍   | 64/100 [03:20<01:44,  2.90s/it] 65%|██████▌   | 65/100 [03:25<02:03,  3.52s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2458 / 0.2645 / 0.7418 / 0.1897/ [0.07643312 0.70114943 0.18965517]
 66%|██████▌   | 66/100 [03:28<01:55,  3.40s/it] 67%|██████▋   | 67/100 [03:30<01:38,  2.99s/it] 68%|██████▊   | 68/100 [03:33<01:35,  3.00s/it] 69%|██████▉   | 69/100 [03:35<01:23,  2.71s/it] 70%|███████   | 70/100 [03:42<01:53,  3.77s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8976 / 0.9483 / 0.9762/ [0.73333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2878 / 0.3012 / 0.7090 / 0.2802/ [0.07006369 0.70114943 0.28017241]
 71%|███████   | 71/100 [03:44<01:34,  3.24s/it] 72%|███████▏  | 72/100 [03:47<01:29,  3.20s/it] 73%|███████▎  | 73/100 [03:49<01:15,  2.81s/it] 74%|███████▍  | 74/100 [03:52<01:14,  2.87s/it] 75%|███████▌  | 75/100 [03:56<01:26,  3.46s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2248 / 0.2428 / 0.7582 / 0.1466/ [0.07643312 0.70114943 0.14655172]
 76%|███████▌  | 76/100 [04:00<01:20,  3.33s/it] 77%|███████▋  | 77/100 [04:01<01:07,  2.92s/it] 78%|███████▊  | 78/100 [04:05<01:05,  2.96s/it] 79%|███████▉  | 79/100 [04:07<00:56,  2.69s/it] 80%|████████  | 80/100 [04:12<01:12,  3.60s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2899 / 0.3041 / 0.7049 / 0.2759/ [0.07006369 0.72413793 0.27586207]
 81%|████████  | 81/100 [04:14<00:59,  3.11s/it] 82%|████████▏ | 82/100 [04:17<00:55,  3.09s/it] 83%|████████▎ | 83/100 [04:19<00:47,  2.77s/it] 84%|████████▍ | 84/100 [04:22<00:45,  2.87s/it] 85%|████████▌ | 85/100 [04:27<00:50,  3.38s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2227 / 0.2385 / 0.7828 / 0.1422/ [0.07006369 0.71264368 0.14224138]
 86%|████████▌ | 86/100 [04:30<00:45,  3.28s/it] 87%|████████▋ | 87/100 [04:32<00:38,  2.93s/it] 88%|████████▊ | 88/100 [04:35<00:35,  2.96s/it] 89%|████████▉ | 89/100 [04:37<00:29,  2.68s/it] 90%|█████████ | 90/100 [04:43<00:37,  3.70s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2290 / 0.2492 / 0.7336 / 0.1552/ [0.07643312 0.70114943 0.15517241]
 91%|█████████ | 91/100 [04:45<00:28,  3.20s/it] 92%|█████████▏| 92/100 [04:48<00:25,  3.16s/it] 93%|█████████▎| 93/100 [04:51<00:19,  2.85s/it] 94%|█████████▍| 94/100 [04:54<00:17,  2.94s/it] 95%|█████████▌| 95/100 [04:59<00:17,  3.51s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2374 / 0.2538 / 0.7664 / 0.1724/ [0.07643312 0.70114943 0.17241379]
 96%|█████████▌| 96/100 [05:02<00:13,  3.38s/it] 97%|█████████▋| 97/100 [05:04<00:08,  2.99s/it] 98%|█████████▊| 98/100 [05:07<00:05,  2.98s/it] 99%|█████████▉| 99/100 [05:09<00:02,  2.73s/it]100%|██████████| 100/100 [05:15<00:00,  3.66s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2332 / 0.2475 / 0.7705 / 0.1638/ [0.06369427 0.72413793 0.1637931 ]
Trial 1, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9200 / 0.8844 / 0.9483 / 0.9524/ [0.73333333 0.95348837 0.95238095]
Test acc/f1/spec/sens = 0.2332 / 0.2475 / 0.7705 / 0.1638/ [0.06369427 0.72413793 0.1637931 ]
>> Finished.
Acc, agreement for latest model:  0.23319327731092437 0.25630252100840334 [0.06369427 0.72413793 0.1637931 ]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3403361344537815 0.3697478991596639 [0.08280255 0.71264368 0.375     ]
Trial 0/5 || Cycle 2/5 || Label set size 360 || Test acc 0.3403 || Test agreement 0.3697 || Spec 0.7746 || Sens 0.3750 Class Acc: [0.08280255 0.71264368 0.375     ]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.09s/it]100%|██████████| 2/2 [00:12<00:00,  5.05s/it]100%|██████████| 2/2 [00:12<00:00,  6.20s/it]
Maximum distance from cluster centers is 0.49
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.77it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.12it/s] 67%|██████▋   | 8/12 [00:00<00:00, 12.17it/s]100%|██████████| 12/12 [00:01<00:00, 10.34it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 28, 1: 81, 2: 71}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 43, 2: 42}
Labeled set distribution: 
Number of samples  540
{0: 91, 1: 223, 2: 226}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.5021, agreement = 0.5504, f1 = 0.3662, spec = 0.4795, sens = 0.8103 Class Acc: [0.         0.5862069  0.81034483]
Initial model on validation dataset: acc = 0.4300, agreement = 0.4300, f1 = 0.2137, spec = 0.0172, sens = 1.0000 Class Acc: [0.         0.02325581 1.        ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:09,  2.52s/it]  2%|▏         | 2/100 [00:06<05:44,  3.52s/it]  3%|▎         | 3/100 [00:09<04:59,  3.08s/it]  4%|▍         | 4/100 [00:13<05:30,  3.44s/it]  5%|▌         | 5/100 [00:19<06:57,  4.39s/it]Epoch 5: Train acc/f1 = 0.8593 / 0.8134 / 0.9841 / 0.8761/ [0.57142857 0.95964126 0.87610619] 
                Val acc/f1/spec/sens = 0.9300 / 0.9040 / 0.9828 / 0.9524/ [0.73333333 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.5903 / 0.4571 / 0.6311 / 0.9095/ [0.04458599 0.72413793 0.90948276]
  6%|▌         | 6/100 [00:22<06:23,  4.08s/it]  7%|▋         | 7/100 [00:25<05:32,  3.58s/it]  8%|▊         | 8/100 [00:29<05:30,  3.59s/it]  9%|▉         | 9/100 [00:31<05:00,  3.30s/it] 10%|█         | 10/100 [00:39<06:52,  4.58s/it]Epoch 10: Train acc/f1 = 0.9463 / 0.9359 / 0.9904 / 0.9469/ [0.94505495 0.94618834 0.94690265] 
                Val acc/f1/spec/sens = 0.9500 / 0.9401 / 0.9655 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.4349 / 0.3858 / 0.9139 / 0.4871/ [0.04458599 1.         0.48706897]
 11%|█         | 11/100 [00:41<05:53,  3.97s/it] 12%|█▏        | 12/100 [00:45<05:53,  4.02s/it] 13%|█▎        | 13/100 [00:48<05:11,  3.58s/it] 14%|█▍        | 14/100 [00:52<05:09,  3.60s/it] 15%|█▌        | 15/100 [00:58<06:16,  4.43s/it]Epoch 15: Train acc/f1 = 0.9741 / 0.9640 / 0.9682 / 0.9956/ [0.87912088 0.99103139 0.99557522] 
                Val acc/f1/spec/sens = 0.9200 / 0.8901 / 0.9828 / 0.9286/ [0.73333333 0.97674419 0.92857143]
                Test acc/f1/spec/sens = 0.3529 / 0.2998 / 0.9426 / 0.3362/ [0.02547771 0.98850575 0.3362069 ]
 16%|█▌        | 16/100 [01:02<05:54,  4.22s/it] 17%|█▋        | 17/100 [01:04<05:11,  3.75s/it] 18%|█▊        | 18/100 [01:08<05:07,  3.75s/it] 19%|█▉        | 19/100 [01:11<04:41,  3.47s/it] 20%|██        | 20/100 [01:18<06:13,  4.67s/it]Epoch 20: Train acc/f1 = 0.9741 / 0.9648 / 1.0000 / 0.9912/ [0.86813187 1.         0.99115044] 
                Val acc/f1/spec/sens = 0.9200 / 0.8791 / 0.9655 / 0.9524/ [0.6        1.         0.95238095]
                Test acc/f1/spec/sens = 0.3340 / 0.2819 / 0.9754 / 0.2974/ [0.01910828 1.         0.29741379]
 21%|██        | 21/100 [01:21<05:18,  4.03s/it] 22%|██▏       | 22/100 [01:25<05:09,  3.97s/it] 23%|██▎       | 23/100 [01:27<04:37,  3.61s/it] 24%|██▍       | 24/100 [01:32<04:44,  3.75s/it] 25%|██▌       | 25/100 [01:38<05:34,  4.46s/it]Epoch 25: Train acc/f1 = 0.9981 / 0.9974 / 1.0000 / 1.0000/ [1.        0.9955157 1.       ] 
                Val acc/f1/spec/sens = 0.9600 / 0.9425 / 1.0000 / 0.9524/ [0.93333333 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3235 / 0.2791 / 0.8852 / 0.2974/ [0.03821656 0.90804598 0.29741379]
 26%|██▌       | 26/100 [01:41<05:14,  4.24s/it] 27%|██▋       | 27/100 [01:44<04:33,  3.75s/it] 28%|██▊       | 28/100 [01:48<04:27,  3.71s/it] 29%|██▉       | 29/100 [01:50<03:59,  3.37s/it] 30%|███       | 30/100 [01:57<05:13,  4.48s/it]Epoch 30: Train acc/f1 = 0.9981 / 0.9974 / 1.0000 / 1.0000/ [1.        0.9955157 1.       ] 
                Val acc/f1/spec/sens = 0.9600 / 0.9425 / 1.0000 / 0.9524/ [0.93333333 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3256 / 0.2808 / 0.8934 / 0.2931/ [0.03821656 0.93103448 0.29310345]
 31%|███       | 31/100 [02:00<04:30,  3.92s/it] 32%|███▏      | 32/100 [02:04<04:21,  3.84s/it] 33%|███▎      | 33/100 [02:06<03:52,  3.47s/it] 34%|███▍      | 34/100 [02:10<03:52,  3.52s/it] 35%|███▌      | 35/100 [02:15<04:31,  4.17s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9187 / 1.0000 / 0.9286/ [0.86666667 0.97674419 0.92857143]
                Test acc/f1/spec/sens = 0.3172 / 0.2731 / 0.9303 / 0.2629/ [0.03821656 0.96551724 0.26293103]
 36%|███▌      | 36/100 [02:19<04:18,  4.03s/it] 37%|███▋      | 37/100 [02:22<03:45,  3.58s/it] 38%|███▊      | 38/100 [02:25<03:42,  3.59s/it] 39%|███▉      | 39/100 [02:28<03:22,  3.32s/it] 40%|████      | 40/100 [02:35<04:22,  4.37s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9266 / 1.0000 / 0.9524/ [0.86666667 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3214 / 0.2793 / 0.8975 / 0.2845/ [0.03821656 0.93103448 0.28448276]
 41%|████      | 41/100 [02:37<03:45,  3.83s/it] 42%|████▏     | 42/100 [02:41<03:37,  3.75s/it] 43%|████▎     | 43/100 [02:44<03:14,  3.42s/it] 44%|████▍     | 44/100 [02:47<03:13,  3.46s/it] 45%|████▌     | 45/100 [02:53<03:50,  4.20s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9266 / 1.0000 / 0.9524/ [0.86666667 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3172 / 0.2764 / 0.8443 / 0.3017/ [0.04458599 0.85057471 0.30172414]
 46%|████▌     | 46/100 [02:57<03:38,  4.05s/it] 47%|████▋     | 47/100 [02:59<03:11,  3.62s/it] 48%|████▊     | 48/100 [03:03<03:07,  3.61s/it] 49%|████▉     | 49/100 [03:06<02:47,  3.28s/it] 50%|█████     | 50/100 [03:12<03:39,  4.39s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9266 / 1.0000 / 0.9524/ [0.86666667 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3193 / 0.2744 / 0.9467 / 0.2586/ [0.03821656 0.98850575 0.25862069]
 51%|█████     | 51/100 [03:15<03:09,  3.86s/it] 52%|█████▏    | 52/100 [03:19<02:59,  3.74s/it] 53%|█████▎    | 53/100 [03:21<02:40,  3.42s/it] 54%|█████▍    | 54/100 [03:25<02:42,  3.53s/it] 55%|█████▌    | 55/100 [03:31<03:10,  4.23s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9266 / 1.0000 / 0.9524/ [0.86666667 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3235 / 0.2788 / 0.9057 / 0.2845/ [0.03821656 0.94252874 0.28448276]
 56%|█████▌    | 56/100 [03:34<02:55,  4.00s/it] 57%|█████▋    | 57/100 [03:37<02:33,  3.56s/it] 58%|█████▊    | 58/100 [03:41<02:31,  3.61s/it] 59%|█████▉    | 59/100 [03:43<02:15,  3.29s/it] 60%|██████    | 60/100 [03:50<02:57,  4.44s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9266 / 1.0000 / 0.9524/ [0.86666667 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3214 / 0.2800 / 0.8238 / 0.3147/ [0.04458599 0.83908046 0.31465517]
 61%|██████    | 61/100 [03:53<02:30,  3.87s/it] 62%|██████▏   | 62/100 [03:57<02:25,  3.82s/it] 63%|██████▎   | 63/100 [03:59<02:07,  3.45s/it] 64%|██████▍   | 64/100 [04:03<02:05,  3.48s/it] 65%|██████▌   | 65/100 [04:09<02:27,  4.21s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9266 / 1.0000 / 0.9524/ [0.86666667 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3340 / 0.2905 / 0.7746 / 0.3578/ [0.04458599 0.79310345 0.35775862]
 66%|██████▌   | 66/100 [04:12<02:18,  4.09s/it] 67%|██████▋   | 67/100 [04:15<02:01,  3.67s/it] 68%|██████▊   | 68/100 [04:19<01:58,  3.70s/it] 69%|██████▉   | 69/100 [04:21<01:44,  3.37s/it] 70%|███████   | 70/100 [04:28<02:12,  4.43s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9266 / 1.0000 / 0.9524/ [0.86666667 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3235 / 0.2787 / 0.8934 / 0.2888/ [0.03821656 0.93103448 0.2887931 ]
 71%|███████   | 71/100 [04:31<01:52,  3.88s/it] 72%|███████▏  | 72/100 [04:35<01:46,  3.80s/it] 73%|███████▎  | 73/100 [04:37<01:31,  3.41s/it] 74%|███████▍  | 74/100 [04:41<01:29,  3.44s/it] 75%|███████▌  | 75/100 [04:47<01:45,  4.23s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9266 / 1.0000 / 0.9524/ [0.86666667 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3235 / 0.2815 / 0.9016 / 0.2845/ [0.04458599 0.93103448 0.28448276]
 76%|███████▌  | 76/100 [04:50<01:37,  4.04s/it] 77%|███████▋  | 77/100 [04:53<01:22,  3.59s/it] 78%|███████▊  | 78/100 [04:56<01:19,  3.62s/it] 79%|███████▉  | 79/100 [04:59<01:09,  3.31s/it] 80%|████████  | 80/100 [05:06<01:29,  4.48s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9266 / 1.0000 / 0.9524/ [0.86666667 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3151 / 0.2720 / 0.8689 / 0.2888/ [0.03821656 0.88505747 0.2887931 ]
 81%|████████  | 81/100 [05:09<01:14,  3.92s/it] 82%|████████▏ | 82/100 [05:13<01:09,  3.85s/it] 83%|████████▎ | 83/100 [05:15<00:58,  3.47s/it] 84%|████████▍ | 84/100 [05:19<00:55,  3.49s/it] 85%|████████▌ | 85/100 [05:25<01:03,  4.22s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9425 / 1.0000 / 0.9524/ [0.93333333 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3172 / 0.2742 / 0.8811 / 0.2931/ [0.03821656 0.88505747 0.29310345]
 86%|████████▌ | 86/100 [05:28<00:56,  4.04s/it] 87%|████████▋ | 87/100 [05:31<00:46,  3.60s/it] 88%|████████▊ | 88/100 [05:34<00:43,  3.63s/it] 89%|████████▉ | 89/100 [05:37<00:36,  3.30s/it] 90%|█████████ | 90/100 [05:44<00:44,  4.45s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9425 / 1.0000 / 0.9524/ [0.93333333 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3277 / 0.2851 / 0.8648 / 0.3103/ [0.04458599 0.88505747 0.31034483]
 91%|█████████ | 91/100 [05:47<00:34,  3.89s/it] 92%|█████████▏| 92/100 [05:50<00:30,  3.82s/it] 93%|█████████▎| 93/100 [05:53<00:24,  3.45s/it] 94%|█████████▍| 94/100 [05:57<00:21,  3.51s/it] 95%|█████████▌| 95/100 [06:02<00:20,  4.20s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9187 / 1.0000 / 0.9286/ [0.86666667 0.97674419 0.92857143]
                Test acc/f1/spec/sens = 0.3193 / 0.2753 / 0.9098 / 0.2759/ [0.03821656 0.94252874 0.27586207]
 96%|█████████▌| 96/100 [06:06<00:16,  4.06s/it] 97%|█████████▋| 97/100 [06:09<00:10,  3.62s/it] 98%|█████████▊| 98/100 [06:12<00:07,  3.59s/it] 99%|█████████▉| 99/100 [06:15<00:03,  3.30s/it]100%|██████████| 100/100 [06:22<00:00,  4.49s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9266 / 1.0000 / 0.9524/ [0.86666667 0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.3214 / 0.2798 / 0.8852 / 0.2888/ [0.04458599 0.90804598 0.2887931 ]
Trial 1, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9500 / 0.9266 / 1.0000 / 0.9524/ [0.86666667 0.97674419 0.95238095]
Test acc/f1/spec/sens = 0.3214 / 0.2798 / 0.8852 / 0.2888/ [0.04458599 0.90804598 0.2887931 ]
>> Finished.
Acc, agreement for latest model:  0.32142857142857145 0.36764705882352944 [0.04458599 0.90804598 0.2887931 ]
Load best checkpoint for thief model
Acc, agreement for best model:  0.31512605042016806 0.35714285714285715 [0.03821656 0.95402299 0.26293103]
Trial 0/5 || Cycle 3/5 || Label set size 540 || Test acc 0.3151 || Test agreement 0.3571 || Spec 0.9344 || Sens 0.2629 Class Acc: [0.03821656 0.95402299 0.26293103]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.09s/it]100%|██████████| 2/2 [00:12<00:00,  5.05s/it]100%|██████████| 2/2 [00:12<00:00,  6.20s/it]
Maximum distance from cluster centers is 0.44
labeled set:  720
unlabeled set:  713
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.77it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.10it/s] 67%|██████▋   | 8/12 [00:00<00:00, 12.35it/s]100%|██████████| 12/12 [00:01<00:00, 10.82it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 30, 1: 88, 2: 62}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 43, 2: 42}
Labeled set distribution: 
Number of samples  720
{0: 121, 1: 311, 2: 288}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.3971, agreement = 0.3613, f1 = 0.2569, spec = 0.1803, sens = 0.6897 Class Acc: [0.17834395 0.01149425 0.68965517]
Initial model on validation dataset: acc = 0.4100, agreement = 0.4100, f1 = 0.2408, spec = 0.1552, sens = 0.9286 Class Acc: [0.06666667 0.02325581 0.92857143]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:12,  3.16s/it]  2%|▏         | 2/100 [00:07<06:24,  3.92s/it]  3%|▎         | 3/100 [00:10<05:46,  3.57s/it]  4%|▍         | 4/100 [00:15<06:17,  3.93s/it]  5%|▌         | 5/100 [00:22<07:56,  5.02s/it]Epoch 5: Train acc/f1 = 0.8986 / 0.8598 / 0.9699 / 0.9201/ [0.65289256 0.97427653 0.92013889] 
                Val acc/f1/spec/sens = 0.9200 / 0.8996 / 0.9483 / 0.9286/ [0.8        0.95348837 0.92857143]
                Test acc/f1/spec/sens = 0.2920 / 0.2809 / 0.9426 / 0.1940/ [0.04458599 1.         0.19396552]
  6%|▌         | 6/100 [00:26<07:19,  4.68s/it]  7%|▋         | 7/100 [00:29<06:28,  4.18s/it]  8%|▊         | 8/100 [00:33<06:25,  4.19s/it]  9%|▉         | 9/100 [00:36<05:52,  3.87s/it] 10%|█         | 10/100 [00:45<07:53,  5.26s/it]Epoch 10: Train acc/f1 = 0.8694 / 0.8450 / 1.0000 / 0.7326/ [0.95867769 0.96141479 0.73263889] 
                Val acc/f1/spec/sens = 0.8800 / 0.8496 / 1.0000 / 0.8095/ [0.86666667 0.95348837 0.80952381]
                Test acc/f1/spec/sens = 0.2584 / 0.2570 / 0.9672 / 0.0474/ [0.2611465  0.81609195 0.04741379]
 11%|█         | 11/100 [00:48<06:52,  4.63s/it] 12%|█▏        | 12/100 [00:52<06:38,  4.53s/it] 13%|█▎        | 13/100 [00:55<05:58,  4.12s/it] 14%|█▍        | 14/100 [00:59<05:54,  4.13s/it] 15%|█▌        | 15/100 [01:06<07:00,  4.94s/it]Epoch 15: Train acc/f1 = 0.7611 / 0.6902 / 0.6088 / 1.0000/ [0.30578512 0.7170418  1.        ] 
                Val acc/f1/spec/sens = 0.8700 / 0.8618 / 0.8793 / 0.9524/ [1.         0.74418605 0.95238095]
                Test acc/f1/spec/sens = 0.6113 / 0.4760 / 0.3770 / 0.9957/ [0.01273885 0.66666667 0.99568966]
 16%|█▌        | 16/100 [01:11<06:37,  4.73s/it] 17%|█▋        | 17/100 [01:14<05:54,  4.27s/it] 18%|█▊        | 18/100 [01:18<05:50,  4.27s/it] 19%|█▉        | 19/100 [01:21<05:18,  3.93s/it] 20%|██        | 20/100 [01:29<07:00,  5.26s/it]Epoch 20: Train acc/f1 = 0.9681 / 0.9615 / 1.0000 / 0.9375/ [1.         0.98392283 0.9375    ] 
                Val acc/f1/spec/sens = 0.9000 / 0.8770 / 1.0000 / 0.8571/ [0.93333333 0.93023256 0.85714286]
                Test acc/f1/spec/sens = 0.2227 / 0.2158 / 0.9754 / 0.0690/ [0.07643312 0.89655172 0.06896552]
 21%|██        | 21/100 [01:33<06:04,  4.61s/it] 22%|██▏       | 22/100 [01:37<06:00,  4.63s/it] 23%|██▎       | 23/100 [01:40<05:21,  4.17s/it] 24%|██▍       | 24/100 [01:45<05:22,  4.25s/it] 25%|██▌       | 25/100 [01:52<06:22,  5.09s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9108 / 0.9828 / 0.9286/ [0.86666667 0.95348837 0.92857143]
                Test acc/f1/spec/sens = 0.2626 / 0.2673 / 0.9221 / 0.1422/ [0.11464968 0.85057471 0.14224138]
 26%|██▌       | 26/100 [01:56<06:04,  4.93s/it] 27%|██▋       | 27/100 [01:59<05:18,  4.36s/it] 28%|██▊       | 28/100 [02:03<05:07,  4.27s/it] 29%|██▉       | 29/100 [02:07<04:40,  3.95s/it] 30%|███       | 30/100 [02:15<06:12,  5.32s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9426 / 1.0000 / 0.9762/ [0.93333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2605 / 0.2732 / 0.8770 / 0.1552/ [0.15286624 0.73563218 0.15517241]
 31%|███       | 31/100 [02:18<05:20,  4.65s/it] 32%|███▏      | 32/100 [02:23<05:15,  4.63s/it] 33%|███▎      | 33/100 [02:26<04:41,  4.20s/it] 34%|███▍      | 34/100 [02:30<04:38,  4.21s/it] 35%|███▌      | 35/100 [02:37<05:30,  5.08s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9480 / 0.9828 / 0.9762/ [0.93333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2689 / 0.2763 / 0.9057 / 0.1509/ [0.11464968 0.86206897 0.15086207]
 36%|███▌      | 36/100 [02:42<05:08,  4.82s/it] 37%|███▋      | 37/100 [02:45<04:34,  4.36s/it] 38%|███▊      | 38/100 [02:49<04:31,  4.39s/it] 39%|███▉      | 39/100 [02:52<04:04,  4.01s/it] 40%|████      | 40/100 [03:00<05:10,  5.17s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9480 / 0.9828 / 0.9762/ [0.93333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2689 / 0.2766 / 0.9221 / 0.1336/ [0.14012739 0.86206897 0.13362069]
 41%|████      | 41/100 [03:04<04:29,  4.57s/it] 42%|████▏     | 42/100 [03:08<04:19,  4.48s/it] 43%|████▎     | 43/100 [03:11<03:53,  4.10s/it] 44%|████▍     | 44/100 [03:15<03:51,  4.14s/it] 45%|████▌     | 45/100 [03:22<04:36,  5.02s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9480 / 0.9828 / 0.9762/ [0.93333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2584 / 0.2650 / 0.9180 / 0.1293/ [0.10828025 0.87356322 0.12931034]
 46%|████▌     | 46/100 [03:27<04:20,  4.83s/it] 47%|████▋     | 47/100 [03:30<03:50,  4.35s/it] 48%|████▊     | 48/100 [03:34<03:49,  4.41s/it] 49%|████▉     | 49/100 [03:38<03:26,  4.05s/it] 50%|█████     | 50/100 [03:46<04:32,  5.44s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9216 / 1.0000 / 0.9286/ [0.93333333 0.95348837 0.92857143]
                Test acc/f1/spec/sens = 0.2563 / 0.2607 / 0.9262 / 0.1121/ [0.11464968 0.89655172 0.11206897]
 51%|█████     | 51/100 [03:50<03:54,  4.79s/it] 52%|█████▏    | 52/100 [03:54<03:43,  4.65s/it] 53%|█████▎    | 53/100 [03:57<03:17,  4.21s/it] 54%|█████▍    | 54/100 [04:01<03:13,  4.21s/it] 55%|█████▌    | 55/100 [04:08<03:45,  5.00s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9480 / 0.9828 / 0.9762/ [0.93333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2878 / 0.2968 / 0.8975 / 0.1853/ [0.14012739 0.82758621 0.18534483]
 56%|█████▌    | 56/100 [04:13<03:31,  4.81s/it] 57%|█████▋    | 57/100 [04:16<03:04,  4.30s/it] 58%|█████▊    | 58/100 [04:20<03:00,  4.30s/it] 59%|█████▉    | 59/100 [04:23<02:41,  3.95s/it] 60%|██████    | 60/100 [04:31<03:27,  5.20s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9480 / 0.9828 / 0.9762/ [0.93333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2647 / 0.2687 / 0.9262 / 0.1336/ [0.0955414  0.91954023 0.13362069]
 61%|██████    | 61/100 [04:34<02:59,  4.59s/it] 62%|██████▏   | 62/100 [04:39<02:51,  4.52s/it] 63%|██████▎   | 63/100 [04:42<02:34,  4.19s/it] 64%|██████▍   | 64/100 [04:47<02:32,  4.25s/it] 65%|██████▌   | 65/100 [04:54<03:00,  5.16s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9426 / 1.0000 / 0.9762/ [0.93333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2521 / 0.2567 / 0.9262 / 0.1121/ [0.10828025 0.88505747 0.11206897]
 66%|██████▌   | 66/100 [04:58<02:45,  4.86s/it] 67%|██████▋   | 67/100 [05:01<02:23,  4.34s/it] 68%|██████▊   | 68/100 [05:05<02:18,  4.34s/it] 69%|██████▉   | 69/100 [05:09<02:03,  3.97s/it] 70%|███████   | 70/100 [05:17<02:37,  5.26s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9426 / 1.0000 / 0.9762/ [0.93333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2479 / 0.2521 / 0.9303 / 0.1078/ [0.10828025 0.87356322 0.10775862]
 71%|███████   | 71/100 [05:20<02:15,  4.66s/it] 72%|███████▏  | 72/100 [05:24<02:07,  4.55s/it] 73%|███████▎  | 73/100 [05:28<01:52,  4.16s/it] 74%|███████▍  | 74/100 [05:32<01:47,  4.13s/it] 75%|███████▌  | 75/100 [05:39<02:07,  5.10s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9480 / 0.9828 / 0.9762/ [0.93333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2584 / 0.2681 / 0.9016 / 0.1336/ [0.13375796 0.81609195 0.13362069]
 76%|███████▌  | 76/100 [05:43<01:56,  4.86s/it] 77%|███████▋  | 77/100 [05:47<01:40,  4.38s/it] 78%|███████▊  | 78/100 [05:51<01:33,  4.26s/it] 79%|███████▉  | 79/100 [05:54<01:22,  3.93s/it] 80%|████████  | 80/100 [06:02<01:42,  5.14s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9347 / 1.0000 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2605 / 0.2663 / 0.9180 / 0.1336/ [0.10828025 0.87356322 0.13362069]
 81%|████████  | 81/100 [06:05<01:26,  4.53s/it] 82%|████████▏ | 82/100 [06:09<01:20,  4.45s/it] 83%|████████▎ | 83/100 [06:12<01:08,  4.05s/it] 84%|████████▍ | 84/100 [06:16<01:05,  4.09s/it] 85%|████████▌ | 85/100 [06:23<01:14,  4.97s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9480 / 0.9828 / 0.9762/ [0.93333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2395 / 0.2436 / 0.9385 / 0.0948/ [0.10828025 0.86206897 0.09482759]
 86%|████████▌ | 86/100 [06:28<01:06,  4.77s/it] 87%|████████▋ | 87/100 [06:31<00:55,  4.25s/it] 88%|████████▊ | 88/100 [06:35<00:51,  4.25s/it] 89%|████████▉ | 89/100 [06:38<00:43,  3.92s/it] 90%|█████████ | 90/100 [06:46<00:51,  5.13s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9600 / 0.9480 / 0.9828 / 0.9762/ [0.93333333 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2542 / 0.2615 / 0.9180 / 0.1121/ [0.12101911 0.87356322 0.11206897]
 91%|█████████ | 91/100 [06:49<00:40,  4.54s/it] 92%|█████████▏| 92/100 [06:54<00:35,  4.48s/it] 93%|█████████▎| 93/100 [06:57<00:28,  4.10s/it] 94%|█████████▍| 94/100 [07:01<00:24,  4.15s/it] 95%|█████████▌| 95/100 [07:08<00:25,  5.05s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9700 / 0.9633 / 0.9828 / 0.9762/ [1.         0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2584 / 0.2608 / 0.9303 / 0.1164/ [0.10828025 0.90804598 0.11637931]
 96%|█████████▌| 96/100 [07:13<00:19,  4.84s/it] 97%|█████████▋| 97/100 [07:16<00:13,  4.39s/it] 98%|█████████▊| 98/100 [07:20<00:08,  4.33s/it] 99%|█████████▉| 99/100 [07:23<00:03,  3.97s/it]100%|██████████| 100/100 [07:32<00:00,  5.27s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9320 / 0.9655 / 0.9762/ [0.86666667 0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2794 / 0.2826 / 0.9180 / 0.1595/ [0.10828025 0.90804598 0.15948276]
Trial 1, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9500 / 0.9320 / 0.9655 / 0.9762/ [0.86666667 0.95348837 0.97619048]
Test acc/f1/spec/sens = 0.2794 / 0.2826 / 0.9180 / 0.1595/ [0.10828025 0.90804598 0.15948276]
>> Finished.
Acc, agreement for latest model:  0.27941176470588236 0.3382352941176471 [0.10828025 0.90804598 0.15948276]
Load best checkpoint for thief model
Acc, agreement for best model:  0.2647058823529412 0.31932773109243695 [0.14649682 0.81609195 0.13793103]
Trial 0/5 || Cycle 4/5 || Label set size 720 || Test acc 0.2647 || Test agreement 0.3193 || Spec 0.9057 || Sens 0.1379 Class Acc: [0.14649682 0.81609195 0.13793103]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.36s/it]100%|██████████| 2/2 [00:12<00:00,  5.16s/it]100%|██████████| 2/2 [00:12<00:00,  6.37s/it]
Maximum distance from cluster centers is 0.38
labeled set:  900
unlabeled set:  533
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.66it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.92it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.66it/s] 92%|█████████▏| 11/12 [00:01<00:00, 13.79it/s]100%|██████████| 12/12 [00:01<00:00,  9.51it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 41, 1: 84, 2: 55}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 43, 2: 42}
Labeled set distribution: 
Number of samples  900
{0: 162, 1: 395, 2: 343}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.1345, agreement = 0.1870, f1 = 0.1149, spec = 0.7295, sens = 0.0733 Class Acc: [0.01910828 0.50574713 0.07327586]
Initial model on validation dataset: acc = 0.4200, agreement = 0.4200, f1 = 0.3176, spec = 0.1897, sens = 0.8095 Class Acc: [0.13333333 0.13953488 0.80952381]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:10,  3.74s/it]  2%|▏         | 2/100 [00:09<07:40,  4.70s/it]  3%|▎         | 3/100 [00:12<06:54,  4.27s/it]  4%|▍         | 4/100 [00:18<07:25,  4.64s/it]  5%|▌         | 5/100 [00:26<09:23,  5.93s/it]Epoch 5: Train acc/f1 = 0.8656 / 0.8150 / 0.8582 / 0.9621/ [0.51234568 0.92658228 0.96209913] 
                Val acc/f1/spec/sens = 0.8900 / 0.8393 / 0.8793 / 0.9524/ [0.6        0.93023256 0.95238095]
                Test acc/f1/spec/sens = 0.4664 / 0.4014 / 0.7664 / 0.6379/ [0.04458599 0.77011494 0.63793103]
  6%|▌         | 6/100 [00:31<08:55,  5.69s/it]  7%|▋         | 7/100 [00:35<07:58,  5.14s/it]  8%|▊         | 8/100 [00:40<07:58,  5.20s/it]  9%|▉         | 9/100 [00:44<07:18,  4.82s/it] 10%|█         | 10/100 [00:54<09:33,  6.37s/it]Epoch 10: Train acc/f1 = 0.8744 / 0.8587 / 0.9785 / 0.9038/ [0.94444444 0.82025316 0.90379009] 
                Val acc/f1/spec/sens = 0.8600 / 0.8385 / 0.9828 / 0.8810/ [0.93333333 0.81395349 0.88095238]
                Test acc/f1/spec/sens = 0.3235 / 0.3262 / 0.8893 / 0.1207/ [0.54140127 0.47126437 0.12068966]
 11%|█         | 11/100 [00:58<08:17,  5.59s/it] 12%|█▏        | 12/100 [01:03<07:52,  5.37s/it] 13%|█▎        | 13/100 [01:07<07:08,  4.92s/it] 14%|█▍        | 14/100 [01:12<07:03,  4.92s/it] 15%|█▌        | 15/100 [01:20<08:28,  5.99s/it]Epoch 15: Train acc/f1 = 0.9322 / 0.9106 / 0.9210 / 0.9971/ [0.7345679  0.95696203 0.99708455] 
                Val acc/f1/spec/sens = 0.8800 / 0.8571 / 0.9310 / 0.8571/ [0.86666667 0.90697674 0.85714286]
                Test acc/f1/spec/sens = 0.5189 / 0.4111 / 0.8402 / 0.7371/ [0.01910828 0.83908046 0.73706897]
 16%|█▌        | 16/100 [01:26<08:10,  5.83s/it] 17%|█▋        | 17/100 [01:30<07:15,  5.25s/it] 18%|█▊        | 18/100 [01:35<07:08,  5.22s/it] 19%|█▉        | 19/100 [01:39<06:32,  4.85s/it] 20%|██        | 20/100 [01:48<08:24,  6.31s/it]Epoch 20: Train acc/f1 = 0.9800 / 0.9746 / 1.0000 / 0.9621/ [0.97530864 0.99746835 0.96209913] 
                Val acc/f1/spec/sens = 0.9100 / 0.8902 / 1.0000 / 0.8810/ [0.86666667 0.95348837 0.88095238]
                Test acc/f1/spec/sens = 0.3067 / 0.3073 / 0.9139 / 0.1940/ [0.13375796 0.91954023 0.19396552]
 21%|██        | 21/100 [01:52<07:18,  5.55s/it] 22%|██▏       | 22/100 [01:58<07:09,  5.51s/it] 23%|██▎       | 23/100 [02:01<06:25,  5.00s/it] 24%|██▍       | 24/100 [02:07<06:24,  5.06s/it] 25%|██▌       | 25/100 [02:15<07:39,  6.12s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.4181 / 0.3905 / 0.8975 / 0.4569/ [0.0955414  0.89655172 0.45689655]
 26%|██▌       | 26/100 [02:20<07:08,  5.79s/it] 27%|██▋       | 27/100 [02:24<06:21,  5.23s/it] 28%|██▊       | 28/100 [02:29<06:09,  5.13s/it] 29%|██▉       | 29/100 [02:33<05:34,  4.71s/it] 30%|███       | 30/100 [02:43<07:15,  6.23s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3866 / 0.3735 / 0.9385 / 0.3491/ [0.10828025 0.98850575 0.34913793]
 31%|███       | 31/100 [02:46<06:17,  5.47s/it] 32%|███▏      | 32/100 [02:51<06:03,  5.34s/it] 33%|███▎      | 33/100 [02:55<05:24,  4.85s/it] 34%|███▍      | 34/100 [03:00<05:21,  4.87s/it] 35%|███▌      | 35/100 [03:09<06:31,  6.02s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3445 / 0.3363 / 0.9221 / 0.2802/ [0.10191083 0.95402299 0.28017241]
 36%|███▌      | 36/100 [03:14<06:09,  5.77s/it] 37%|███▋      | 37/100 [03:18<05:29,  5.23s/it] 38%|███▊      | 38/100 [03:23<05:18,  5.14s/it] 39%|███▉      | 39/100 [03:27<04:50,  4.77s/it] 40%|████      | 40/100 [03:36<06:12,  6.21s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3803 / 0.3684 / 0.9180 / 0.3578/ [0.10191083 0.94252874 0.35775862]
 41%|████      | 41/100 [03:40<05:22,  5.47s/it] 42%|████▏     | 42/100 [03:45<05:08,  5.32s/it] 43%|████▎     | 43/100 [03:49<04:36,  4.86s/it] 44%|████▍     | 44/100 [03:54<04:33,  4.88s/it] 45%|████▌     | 45/100 [04:02<05:27,  5.96s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3739 / 0.3584 / 0.9139 / 0.3491/ [0.0955414  0.94252874 0.34913793]
 46%|████▌     | 46/100 [04:07<05:06,  5.68s/it] 47%|████▋     | 47/100 [04:11<04:32,  5.14s/it] 48%|████▊     | 48/100 [04:16<04:26,  5.12s/it] 49%|████▉     | 49/100 [04:20<04:01,  4.74s/it] 50%|█████     | 50/100 [04:30<05:11,  6.23s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3950 / 0.3802 / 0.9098 / 0.3966/ [0.0955414  0.93103448 0.39655172]
 51%|█████     | 51/100 [04:33<04:29,  5.49s/it] 52%|█████▏    | 52/100 [04:38<04:17,  5.36s/it] 53%|█████▎    | 53/100 [04:42<03:49,  4.89s/it] 54%|█████▍    | 54/100 [04:47<03:46,  4.91s/it] 55%|█████▌    | 55/100 [04:56<04:33,  6.07s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3866 / 0.3770 / 0.9016 / 0.3793/ [0.11464968 0.89655172 0.37931034]
 56%|█████▌    | 56/100 [05:01<04:16,  5.84s/it] 57%|█████▋    | 57/100 [05:05<03:43,  5.20s/it] 58%|█████▊    | 58/100 [05:10<03:38,  5.21s/it] 59%|█████▉    | 59/100 [05:14<03:18,  4.84s/it] 60%|██████    | 60/100 [05:24<04:13,  6.33s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3655 / 0.3572 / 0.9180 / 0.3276/ [0.10191083 0.94252874 0.32758621]
 61%|██████    | 61/100 [05:28<03:37,  5.58s/it] 62%|██████▏   | 62/100 [05:33<03:25,  5.40s/it] 63%|██████▎   | 63/100 [05:37<03:01,  4.92s/it] 64%|██████▍   | 64/100 [05:42<02:58,  4.95s/it] 65%|██████▌   | 65/100 [05:50<03:30,  6.01s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3761 / 0.3618 / 0.9221 / 0.3448/ [0.10191083 0.95402299 0.34482759]
 66%|██████▌   | 66/100 [05:55<03:13,  5.69s/it] 67%|██████▋   | 67/100 [05:59<02:47,  5.09s/it] 68%|██████▊   | 68/100 [06:04<02:41,  5.06s/it] 69%|██████▉   | 69/100 [06:07<02:25,  4.69s/it] 70%|███████   | 70/100 [06:17<03:05,  6.17s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.4139 / 0.3952 / 0.9057 / 0.4353/ [0.10191083 0.91954023 0.43534483]
 71%|███████   | 71/100 [06:21<02:38,  5.46s/it] 72%|███████▏  | 72/100 [06:26<02:29,  5.35s/it] 73%|███████▎  | 73/100 [06:30<02:11,  4.87s/it] 74%|███████▍  | 74/100 [06:35<02:08,  4.95s/it] 75%|███████▌  | 75/100 [06:44<02:31,  6.05s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3466 / 0.3407 / 0.9262 / 0.2759/ [0.11464968 0.95402299 0.27586207]
 76%|███████▌  | 76/100 [06:49<02:18,  5.78s/it] 77%|███████▋  | 77/100 [06:53<01:59,  5.20s/it] 78%|███████▊  | 78/100 [06:57<01:52,  5.13s/it] 79%|███████▉  | 79/100 [07:01<01:38,  4.70s/it] 80%|████████  | 80/100 [07:11<02:05,  6.26s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3466 / 0.3395 / 0.9221 / 0.2845/ [0.10191083 0.95402299 0.28448276]
 81%|████████  | 81/100 [07:15<01:45,  5.58s/it] 82%|████████▏ | 82/100 [07:20<01:37,  5.43s/it] 83%|████████▎ | 83/100 [07:24<01:24,  4.96s/it] 84%|████████▍ | 84/100 [07:29<01:20,  5.03s/it] 85%|████████▌ | 85/100 [07:38<01:30,  6.05s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3761 / 0.3655 / 0.9180 / 0.3491/ [0.10191083 0.94252874 0.34913793]
 86%|████████▌ | 86/100 [07:43<01:20,  5.74s/it] 87%|████████▋ | 87/100 [07:47<01:07,  5.17s/it] 88%|████████▊ | 88/100 [07:52<01:01,  5.16s/it] 89%|████████▉ | 89/100 [07:55<00:52,  4.73s/it] 90%|█████████ | 90/100 [08:05<01:02,  6.26s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3676 / 0.3569 / 0.9221 / 0.3276/ [0.10191083 0.95402299 0.32758621]
 91%|█████████ | 91/100 [08:09<00:49,  5.52s/it] 92%|█████████▏| 92/100 [08:14<00:43,  5.38s/it] 93%|█████████▎| 93/100 [08:18<00:34,  4.91s/it] 94%|█████████▍| 94/100 [08:23<00:29,  4.95s/it] 95%|█████████▌| 95/100 [08:32<00:30,  6.09s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8954 / 0.9828 / 0.9048/ [0.86666667 0.93023256 0.9047619 ]
                Test acc/f1/spec/sens = 0.3424 / 0.3399 / 0.9221 / 0.2845/ [0.10828025 0.91954023 0.28448276]
 96%|█████████▌| 96/100 [08:37<00:23,  5.78s/it] 97%|█████████▋| 97/100 [08:41<00:15,  5.25s/it] 98%|█████████▊| 98/100 [08:46<00:10,  5.17s/it] 99%|█████████▉| 99/100 [08:50<00:04,  4.78s/it]100%|██████████| 100/100 [08:59<00:00,  6.31s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
                Test acc/f1/spec/sens = 0.3571 / 0.3478 / 0.9467 / 0.2888/ [0.10191083 1.         0.2887931 ]
Trial 1, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9200 / 0.9032 / 0.9828 / 0.9286/ [0.86666667 0.93023256 0.92857143]
Test acc/f1/spec/sens = 0.3571 / 0.3478 / 0.9467 / 0.2888/ [0.10191083 1.         0.2887931 ]
>> Finished.
Acc, agreement for latest model:  0.35714285714285715 0.4096638655462185 [0.10191083 1.         0.2887931 ]
Load best checkpoint for thief model
Acc, agreement for best model:  0.38235294117647056 0.43067226890756305 [0.11464968 0.90804598 0.36637931]
Trial 0/5 || Cycle 5/5 || Label set size 900 || Test acc 0.3824 || Test agreement 0.4307 || Spec 0.9098 || Sens 0.3664 Class Acc: [0.11464968 0.90804598 0.36637931]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.52it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.18it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.02it/s] 75%|███████▌  | 9/12 [00:01<00:00, 11.61it/s] 92%|█████████▏| 11/12 [00:01<00:00, 13.16it/s]100%|██████████| 12/12 [00:01<00:00,  8.39it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:04,  1.45it/s] 57%|█████▋    | 4/7 [00:00<00:00,  6.02it/s]100%|██████████| 7/7 [00:01<00:00,  6.05it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2387, -1.2535, -1.2316]), tensor([0.8427, 0.8391, 0.8453]))
Val set stats: mean/std =  (tensor([-1.2302, -1.2481, -1.2211]), tensor([0.8397, 0.8347, 0.8430]))
Validation set distribution: 
Number of samples  100
{0: 15, 1: 48, 2: 37}
Labeled set distribution: 
Number of samples  180
{0: 28, 1: 70, 2: 82}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.3193, agreement = 0.3529, f1 = 0.2719, spec = 0.4918, sens = 0.4397 Class Acc: [0.07006369 0.44827586 0.43965517]
Initial model on validation dataset: acc = 0.3800, agreement = 0.3800, f1 = 0.2950, spec = 0.2381, sens = 0.8108 Class Acc: [0.13333333 0.125      0.81081081]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:36,  1.58s/it]  2%|▏         | 2/100 [00:04<03:52,  2.37s/it]  3%|▎         | 3/100 [00:06<03:13,  1.99s/it]  4%|▍         | 4/100 [00:09<03:51,  2.41s/it]  5%|▌         | 5/100 [00:13<04:49,  3.04s/it]Epoch 5: Train acc/f1 = 0.6222 / 0.5408 / 0.9796 / 0.4390/ [0.25       0.98571429 0.43902439] 
                Val acc/f1/spec/sens = 0.5800 / 0.3737 / 1.0000 / 0.2703/ [0.         1.         0.27027027]
                Test acc/f1/spec/sens = 0.2122 / 0.1469 / 0.9918 / 0.0517/ [0.01273885 1.         0.05172414]
  6%|▌         | 6/100 [00:16<04:46,  3.04s/it]  7%|▋         | 7/100 [00:17<04:00,  2.58s/it]  8%|▊         | 8/100 [00:21<04:12,  2.74s/it]  9%|▉         | 9/100 [00:22<03:34,  2.35s/it] 10%|█         | 10/100 [00:27<04:56,  3.29s/it]Epoch 10: Train acc/f1 = 0.8500 / 0.7076 / 0.7653 / 1.0000/ [0.17857143 0.94285714 1.        ] 
                Val acc/f1/spec/sens = 0.8200 / 0.6276 / 0.7619 / 1.0000/ [0.06666667 0.91666667 1.        ]
                Test acc/f1/spec/sens = 0.6134 / 0.4551 / 0.5984 / 0.9741/ [0.         0.75862069 0.97413793]
 11%|█         | 11/100 [00:29<04:04,  2.75s/it] 12%|█▏        | 12/100 [00:32<04:13,  2.88s/it] 13%|█▎        | 13/100 [00:34<03:34,  2.46s/it] 14%|█▍        | 14/100 [00:37<03:49,  2.67s/it] 15%|█▌        | 15/100 [00:41<04:26,  3.14s/it]Epoch 15: Train acc/f1 = 0.4389 / 0.3348 / 1.0000 / 0.0366/ [0.21428571 1.         0.03658537] 
                Val acc/f1/spec/sens = 0.8800 / 0.8127 / 0.9365 / 0.9189/ [0.53333333 0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.1828 / 0.1030 / 1.0000 / 0.0000/ [0. 1. 0.]
 16%|█▌        | 16/100 [00:44<04:15,  3.04s/it] 17%|█▋        | 17/100 [00:45<03:35,  2.59s/it] 18%|█▊        | 18/100 [00:49<03:46,  2.76s/it] 19%|█▉        | 19/100 [00:50<03:16,  2.43s/it] 20%|██        | 20/100 [00:56<04:25,  3.32s/it]Epoch 20: Train acc/f1 = 0.9833 / 0.9744 / 0.9898 / 1.0000/ [0.89285714 1.         1.        ] 
                Val acc/f1/spec/sens = 0.8500 / 0.7613 / 0.9048 / 0.8649/ [0.4        0.97916667 0.86486486]
                Test acc/f1/spec/sens = 0.4307 / 0.3834 / 0.9221 / 0.5302/ [0.02547771 0.89655172 0.53017241]
 21%|██        | 21/100 [00:57<03:40,  2.80s/it] 22%|██▏       | 22/100 [01:00<03:39,  2.81s/it] 23%|██▎       | 23/100 [01:02<03:07,  2.44s/it] 24%|██▍       | 24/100 [01:05<03:23,  2.67s/it] 25%|██▌       | 25/100 [01:09<03:58,  3.18s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8715 / 0.9365 / 0.9459/ [0.66666667 0.97916667 0.94594595]
                Test acc/f1/spec/sens = 0.4517 / 0.4279 / 0.9139 / 0.5172/ [0.14012739 0.83908046 0.51724138]
 26%|██▌       | 26/100 [01:12<03:45,  3.04s/it] 27%|██▋       | 27/100 [01:13<03:11,  2.62s/it] 28%|██▊       | 28/100 [01:16<03:10,  2.64s/it] 29%|██▉       | 29/100 [01:18<02:44,  2.32s/it] 30%|███       | 30/100 [01:24<03:54,  3.35s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8989 / 0.9841 / 0.8919/ [0.86666667 0.97916667 0.89189189]
                Test acc/f1/spec/sens = 0.4307 / 0.4152 / 0.9016 / 0.4698/ [0.15286624 0.82758621 0.46982759]
 31%|███       | 31/100 [01:25<03:14,  2.82s/it] 32%|███▏      | 32/100 [01:28<03:09,  2.78s/it] 33%|███▎      | 33/100 [01:29<02:42,  2.43s/it] 34%|███▍      | 34/100 [01:32<02:47,  2.54s/it] 35%|███▌      | 35/100 [01:36<03:18,  3.05s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8600 / 0.9683 / 0.8919/ [0.8        0.9375     0.89189189]
                Test acc/f1/spec/sens = 0.4517 / 0.4310 / 0.8934 / 0.5043/ [0.15923567 0.83908046 0.50431034]
 36%|███▌      | 36/100 [01:39<03:09,  2.97s/it] 37%|███▋      | 37/100 [01:41<02:41,  2.57s/it] 38%|███▊      | 38/100 [01:44<02:41,  2.61s/it] 39%|███▉      | 39/100 [01:45<02:20,  2.30s/it] 40%|████      | 40/100 [01:51<03:15,  3.27s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.4622 / 0.4359 / 0.8770 / 0.5302/ [0.14649682 0.85057471 0.53017241]
 41%|████      | 41/100 [01:52<02:42,  2.75s/it] 42%|████▏     | 42/100 [01:55<02:37,  2.72s/it] 43%|████▎     | 43/100 [01:56<02:15,  2.37s/it] 44%|████▍     | 44/100 [01:59<02:19,  2.49s/it] 45%|████▌     | 45/100 [02:03<02:46,  3.02s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8962 / 0.9683 / 0.9459/ [0.8        0.95833333 0.94594595]
                Test acc/f1/spec/sens = 0.4685 / 0.4435 / 0.9180 / 0.5216/ [0.15286624 0.89655172 0.52155172]
 46%|████▌     | 46/100 [02:06<02:38,  2.94s/it] 47%|████▋     | 47/100 [02:08<02:14,  2.54s/it] 48%|████▊     | 48/100 [02:11<02:16,  2.63s/it] 49%|████▉     | 49/100 [02:12<01:55,  2.27s/it] 50%|█████     | 50/100 [02:17<02:35,  3.11s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8708 / 0.9683 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4559 / 0.4341 / 0.9139 / 0.5000/ [0.15286624 0.88505747 0.5       ]
 51%|█████     | 51/100 [02:19<02:07,  2.60s/it] 52%|█████▏    | 52/100 [02:21<02:02,  2.55s/it] 53%|█████▎    | 53/100 [02:23<01:46,  2.26s/it] 54%|█████▍    | 54/100 [02:25<01:49,  2.38s/it] 55%|█████▌    | 55/100 [02:29<02:10,  2.91s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8708 / 0.9683 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4853 / 0.4502 / 0.9057 / 0.5647/ [0.13375796 0.90804598 0.56465517]
 56%|█████▌    | 56/100 [02:32<02:04,  2.83s/it] 57%|█████▋    | 57/100 [02:34<01:45,  2.46s/it] 58%|█████▊    | 58/100 [02:36<01:45,  2.52s/it] 59%|█████▉    | 59/100 [02:38<01:32,  2.24s/it] 60%|██████    | 60/100 [02:43<02:08,  3.21s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8708 / 0.9683 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4685 / 0.4384 / 0.8975 / 0.5345/ [0.13375796 0.89655172 0.53448276]
 61%|██████    | 61/100 [02:45<01:47,  2.75s/it] 62%|██████▏   | 62/100 [02:48<01:44,  2.75s/it] 63%|██████▎   | 63/100 [02:49<01:30,  2.44s/it] 64%|██████▍   | 64/100 [02:52<01:31,  2.54s/it] 65%|██████▌   | 65/100 [02:56<01:45,  3.01s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8708 / 0.9683 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4433 / 0.4305 / 0.9221 / 0.4569/ [0.17197452 0.89655172 0.45689655]
 66%|██████▌   | 66/100 [02:59<01:39,  2.94s/it] 67%|██████▋   | 67/100 [03:01<01:23,  2.53s/it] 68%|██████▊   | 68/100 [03:03<01:23,  2.61s/it] 69%|██████▉   | 69/100 [03:05<01:10,  2.28s/it] 70%|███████   | 70/100 [03:10<01:37,  3.23s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8708 / 0.9683 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4265 / 0.4151 / 0.8730 / 0.4440/ [0.1656051  0.85057471 0.44396552]
 71%|███████   | 71/100 [03:12<01:19,  2.74s/it] 72%|███████▏  | 72/100 [03:15<01:17,  2.76s/it] 73%|███████▎  | 73/100 [03:16<01:05,  2.41s/it] 74%|███████▍  | 74/100 [03:19<01:05,  2.51s/it] 75%|███████▌  | 75/100 [03:24<01:16,  3.06s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8533 / 0.9524 / 0.8919/ [0.73333333 0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4643 / 0.4426 / 0.8648 / 0.5216/ [0.1656051  0.85057471 0.52155172]
 76%|███████▌  | 76/100 [03:26<01:11,  2.97s/it] 77%|███████▋  | 77/100 [03:28<00:58,  2.53s/it] 78%|███████▊  | 78/100 [03:30<00:56,  2.57s/it] 79%|███████▉  | 79/100 [03:32<00:48,  2.30s/it] 80%|████████  | 80/100 [03:38<01:04,  3.24s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8708 / 0.9683 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4559 / 0.4307 / 0.9016 / 0.5086/ [0.13375796 0.89655172 0.50862069]
 81%|████████  | 81/100 [03:39<00:51,  2.74s/it] 82%|████████▏ | 82/100 [03:42<00:49,  2.74s/it] 83%|████████▎ | 83/100 [03:43<00:40,  2.37s/it] 84%|████████▍ | 84/100 [03:46<00:39,  2.49s/it] 85%|████████▌ | 85/100 [03:50<00:45,  3.02s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8876 / 0.9841 / 0.8919/ [0.86666667 0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4223 / 0.4115 / 0.9221 / 0.4181/ [0.1656051  0.89655172 0.41810345]
 86%|████████▌ | 86/100 [03:54<00:43,  3.09s/it] 87%|████████▋ | 87/100 [03:55<00:34,  2.63s/it] 88%|████████▊ | 88/100 [03:58<00:31,  2.66s/it] 89%|████████▉ | 89/100 [04:00<00:25,  2.35s/it] 90%|█████████ | 90/100 [04:05<00:32,  3.28s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8708 / 0.9683 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4286 / 0.4128 / 0.8893 / 0.4569/ [0.14012739 0.87356322 0.45689655]
 91%|█████████ | 91/100 [04:07<00:25,  2.79s/it] 92%|█████████▏| 92/100 [04:09<00:22,  2.79s/it] 93%|█████████▎| 93/100 [04:11<00:16,  2.41s/it] 94%|█████████▍| 94/100 [04:14<00:15,  2.50s/it] 95%|█████████▌| 95/100 [04:18<00:14,  3.00s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8876 / 0.9841 / 0.8919/ [0.86666667 0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4748 / 0.4474 / 0.9180 / 0.5345/ [0.15286624 0.89655172 0.53448276]
 96%|█████████▌| 96/100 [04:21<00:11,  2.95s/it] 97%|█████████▋| 97/100 [04:22<00:07,  2.54s/it] 98%|█████████▊| 98/100 [04:25<00:05,  2.65s/it] 99%|█████████▉| 99/100 [04:27<00:02,  2.34s/it]100%|██████████| 100/100 [04:32<00:00,  3.26s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8708 / 0.9683 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4370 / 0.4181 / 0.8975 / 0.4741/ [0.13375796 0.88505747 0.47413793]
Trial 2, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9100 / 0.8708 / 0.9683 / 0.8919/ [0.8        0.95833333 0.89189189]
Test acc/f1/spec/sens = 0.4370 / 0.4181 / 0.8975 / 0.4741/ [0.13375796 0.88505747 0.47413793]
>> Finished.
Acc, agreement for latest model:  0.4369747899159664 0.46638655462184875 [0.13375796 0.88505747 0.47413793]
Load best checkpoint for thief model
Acc, agreement for best model:  0.39705882352941174 0.42016806722689076 [0.1656051  0.89655172 0.36637931]
Trial 1/5 || Cycle 1/5 || Label set size 180 || Test acc 0.3971 || Test agreement 0.4202 || Spec 0.9262 || Sens 0.3664 Class Acc: [0.1656051  0.89655172 0.36637931]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.10s/it]100%|██████████| 2/2 [00:13<00:00,  5.47s/it]100%|██████████| 2/2 [00:13<00:00,  6.77s/it]
Maximum distance from cluster centers is 0.58
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.27it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.49it/s] 75%|███████▌  | 9/12 [00:01<00:00, 10.66it/s]100%|██████████| 12/12 [00:01<00:00,  8.22it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 43, 1: 79, 2: 58}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 48, 2: 37}
Labeled set distribution: 
Number of samples  360
{0: 71, 1: 149, 2: 140}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.3256, agreement = 0.2836, f1 = 0.1774, spec = 0.9795, sens = 0.0129 Class Acc: [0.96178344 0.01149425 0.01293103]
Initial model on validation dataset: acc = 0.1500, agreement = 0.1500, f1 = 0.0870, spec = 1.0000, sens = 0.0000 Class Acc: [1. 0. 0.]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<03:48,  2.31s/it]  2%|▏         | 2/100 [00:06<05:13,  3.19s/it]  3%|▎         | 3/100 [00:08<04:40,  2.89s/it]  4%|▍         | 4/100 [00:12<05:09,  3.22s/it]  5%|▌         | 5/100 [00:17<06:17,  3.98s/it]Epoch 5: Train acc/f1 = 0.8056 / 0.7811 / 0.8864 / 0.9571/ [0.74647887 0.69127517 0.95714286] 
                Val acc/f1/spec/sens = 0.9000 / 0.8607 / 0.9365 / 0.8919/ [0.66666667 0.97916667 0.89189189]
                Test acc/f1/spec/sens = 0.4580 / 0.4144 / 0.8566 / 0.5733/ [0.05095541 0.88505747 0.57327586]
  6%|▌         | 6/100 [00:21<05:54,  3.77s/it]  7%|▋         | 7/100 [00:23<05:02,  3.25s/it]  8%|▊         | 8/100 [00:26<05:03,  3.30s/it]  9%|▉         | 9/100 [00:28<04:28,  2.95s/it] 10%|█         | 10/100 [00:35<06:09,  4.10s/it]Epoch 10: Train acc/f1 = 0.9306 / 0.9112 / 0.9727 / 0.9714/ [0.76056338 0.97315436 0.97142857] 
                Val acc/f1/spec/sens = 0.8800 / 0.8313 / 0.9206 / 0.8919/ [0.66666667 0.9375     0.89189189]
                Test acc/f1/spec/sens = 0.2584 / 0.2428 / 0.9877 / 0.1164/ [0.06369427 0.98850575 0.11637931]
 11%|█         | 11/100 [00:37<05:12,  3.51s/it] 12%|█▏        | 12/100 [00:40<05:03,  3.45s/it] 13%|█▎        | 13/100 [00:43<04:25,  3.06s/it] 14%|█▍        | 14/100 [00:46<04:30,  3.15s/it] 15%|█▌        | 15/100 [00:51<05:21,  3.78s/it]Epoch 15: Train acc/f1 = 0.9722 / 0.9665 / 0.9955 / 0.9643/ [0.95774648 0.98657718 0.96428571] 
                Val acc/f1/spec/sens = 0.8700 / 0.8133 / 0.9683 / 0.8378/ [0.53333333 1.         0.83783784]
                Test acc/f1/spec/sens = 0.3508 / 0.3472 / 0.8934 / 0.3448/ [0.06369427 0.88505747 0.34482759]
 16%|█▌        | 16/100 [00:55<05:05,  3.64s/it] 17%|█▋        | 17/100 [00:57<04:24,  3.18s/it] 18%|█▊        | 18/100 [01:00<04:36,  3.37s/it] 19%|█▉        | 19/100 [01:03<04:03,  3.01s/it] 20%|██        | 20/100 [01:09<05:26,  4.08s/it]Epoch 20: Train acc/f1 = 0.8472 / 0.8289 / 0.9955 / 0.8071/ [0.6056338  1.         0.80714286] 
                Val acc/f1/spec/sens = 0.7700 / 0.7148 / 0.9841 / 0.5946/ [0.46666667 1.         0.59459459]
                Test acc/f1/spec/sens = 0.2227 / 0.1862 / 0.9262 / 0.0517/ [0.04458599 1.         0.05172414]
 21%|██        | 21/100 [01:11<04:35,  3.48s/it] 22%|██▏       | 22/100 [01:15<04:25,  3.40s/it] 23%|██▎       | 23/100 [01:17<03:54,  3.04s/it] 24%|██▍       | 24/100 [01:20<03:57,  3.12s/it] 25%|██▌       | 25/100 [01:26<04:46,  3.82s/it]Epoch 25: Train acc/f1 = 0.9972 / 0.9965 / 1.0000 / 0.9929/ [1.         1.         0.99285714] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2605 / 0.2556 / 0.9180 / 0.1336/ [0.06369427 0.95402299 0.13362069]
 26%|██▌       | 26/100 [01:29<04:30,  3.66s/it] 27%|██▋       | 27/100 [01:31<03:53,  3.20s/it] 28%|██▊       | 28/100 [01:34<03:53,  3.24s/it] 29%|██▉       | 29/100 [01:36<03:26,  2.91s/it] 30%|███       | 30/100 [01:43<04:37,  3.96s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2794 / 0.2776 / 0.9139 / 0.1767/ [0.05732484 0.95402299 0.17672414]
 31%|███       | 31/100 [01:45<03:54,  3.39s/it] 32%|███▏      | 32/100 [01:48<03:50,  3.38s/it] 33%|███▎      | 33/100 [01:50<03:21,  3.01s/it] 34%|███▍      | 34/100 [01:54<03:23,  3.09s/it] 35%|███▌      | 35/100 [01:59<04:04,  3.76s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2626 / 0.2621 / 0.9180 / 0.1379/ [0.06369427 0.95402299 0.13793103]
 36%|███▌      | 36/100 [02:02<03:52,  3.63s/it] 37%|███▋      | 37/100 [02:04<03:20,  3.19s/it] 38%|███▊      | 38/100 [02:08<03:21,  3.25s/it] 39%|███▉      | 39/100 [02:10<02:56,  2.90s/it] 40%|████      | 40/100 [02:16<03:58,  3.98s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2605 / 0.2595 / 0.9180 / 0.1336/ [0.06369427 0.95402299 0.13362069]
 41%|████      | 41/100 [02:18<03:21,  3.41s/it] 42%|████▏     | 42/100 [02:22<03:17,  3.41s/it] 43%|████▎     | 43/100 [02:24<02:52,  3.02s/it] 44%|████▍     | 44/100 [02:27<02:55,  3.13s/it] 45%|████▌     | 45/100 [02:33<03:29,  3.81s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2500 / 0.2494 / 0.9180 / 0.1121/ [0.06369427 0.95402299 0.11206897]
 46%|████▌     | 46/100 [02:36<03:19,  3.69s/it] 47%|████▋     | 47/100 [02:38<02:51,  3.23s/it] 48%|████▊     | 48/100 [02:42<02:50,  3.27s/it] 49%|████▉     | 49/100 [02:44<02:29,  2.93s/it] 50%|█████     | 50/100 [02:50<03:20,  4.01s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8629 / 0.9683 / 0.8919/ [0.73333333 0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2857 / 0.2823 / 0.9139 / 0.1897/ [0.05732484 0.95402299 0.18965517]
 51%|█████     | 51/100 [02:53<02:48,  3.44s/it] 52%|█████▏    | 52/100 [02:56<02:42,  3.39s/it] 53%|█████▎    | 53/100 [02:58<02:21,  3.00s/it] 54%|█████▍    | 54/100 [03:01<02:23,  3.12s/it] 55%|█████▌    | 55/100 [03:07<02:51,  3.80s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8677 / 0.9841 / 0.8649/ [0.8        0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2689 / 0.2665 / 0.9139 / 0.1552/ [0.05732484 0.95402299 0.15517241]
 56%|█████▌    | 56/100 [03:10<02:39,  3.63s/it] 57%|█████▋    | 57/100 [03:12<02:16,  3.17s/it] 58%|█████▊    | 58/100 [03:15<02:15,  3.21s/it] 59%|█████▉    | 59/100 [03:18<01:59,  2.92s/it] 60%|██████    | 60/100 [03:24<02:39,  4.00s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2668 / 0.2653 / 0.9139 / 0.1509/ [0.05732484 0.95402299 0.15086207]
 61%|██████    | 61/100 [03:26<02:14,  3.45s/it] 62%|██████▏   | 62/100 [03:30<02:09,  3.41s/it] 63%|██████▎   | 63/100 [03:32<01:52,  3.04s/it] 64%|██████▍   | 64/100 [03:35<01:52,  3.14s/it] 65%|██████▌   | 65/100 [03:41<02:14,  3.84s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2773 / 0.2756 / 0.9139 / 0.1724/ [0.05732484 0.95402299 0.17241379]
 66%|██████▌   | 66/100 [03:44<02:06,  3.71s/it] 67%|██████▋   | 67/100 [03:46<01:46,  3.23s/it] 68%|██████▊   | 68/100 [03:49<01:44,  3.26s/it] 69%|██████▉   | 69/100 [03:52<01:30,  2.93s/it] 70%|███████   | 70/100 [03:58<02:01,  4.04s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2815 / 0.2792 / 0.9139 / 0.1810/ [0.05732484 0.95402299 0.18103448]
 71%|███████   | 71/100 [04:00<01:40,  3.47s/it] 72%|███████▏  | 72/100 [04:04<01:36,  3.44s/it] 73%|███████▎  | 73/100 [04:06<01:22,  3.07s/it] 74%|███████▍  | 74/100 [04:09<01:22,  3.16s/it] 75%|███████▌  | 75/100 [04:15<01:35,  3.83s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2710 / 0.2640 / 0.9139 / 0.1595/ [0.05732484 0.95402299 0.15948276]
 76%|███████▌  | 76/100 [04:18<01:28,  3.70s/it] 77%|███████▋  | 77/100 [04:20<01:14,  3.24s/it] 78%|███████▊  | 78/100 [04:24<01:12,  3.28s/it] 79%|███████▉  | 79/100 [04:26<01:01,  2.94s/it] 80%|████████  | 80/100 [04:32<01:19,  3.99s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2668 / 0.2658 / 0.9139 / 0.1509/ [0.05732484 0.95402299 0.15086207]
 81%|████████  | 81/100 [04:34<01:04,  3.41s/it] 82%|████████▏ | 82/100 [04:38<01:00,  3.39s/it] 83%|████████▎ | 83/100 [04:40<00:51,  3.01s/it] 84%|████████▍ | 84/100 [04:43<00:49,  3.10s/it] 85%|████████▌ | 85/100 [04:48<00:56,  3.75s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2647 / 0.2606 / 0.9139 / 0.1466/ [0.05732484 0.95402299 0.14655172]
 86%|████████▌ | 86/100 [04:51<00:50,  3.59s/it] 87%|████████▋ | 87/100 [04:54<00:40,  3.15s/it] 88%|████████▊ | 88/100 [04:57<00:38,  3.20s/it] 89%|████████▉ | 89/100 [04:59<00:31,  2.90s/it] 90%|█████████ | 90/100 [05:06<00:39,  3.98s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9841 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2689 / 0.2631 / 0.9139 / 0.1552/ [0.05732484 0.95402299 0.15517241]
 91%|█████████ | 91/100 [05:08<00:30,  3.42s/it] 92%|█████████▏| 92/100 [05:11<00:27,  3.41s/it] 93%|█████████▎| 93/100 [05:13<00:21,  3.05s/it] 94%|█████████▍| 94/100 [05:17<00:18,  3.13s/it] 95%|█████████▌| 95/100 [05:22<00:19,  3.81s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8677 / 0.9841 / 0.8649/ [0.8        0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2626 / 0.2568 / 0.9139 / 0.1422/ [0.05732484 0.95402299 0.14224138]
 96%|█████████▌| 96/100 [05:25<00:14,  3.66s/it] 97%|█████████▋| 97/100 [05:28<00:09,  3.21s/it] 98%|█████████▊| 98/100 [05:31<00:06,  3.26s/it] 99%|█████████▉| 99/100 [05:33<00:02,  2.91s/it]100%|██████████| 100/100 [05:40<00:00,  4.00s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8677 / 0.9841 / 0.8649/ [0.8        0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2710 / 0.2690 / 0.9139 / 0.1595/ [0.05732484 0.95402299 0.15948276]
Trial 2, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9000 / 0.8677 / 0.9841 / 0.8649/ [0.8        0.95833333 0.86486486]
Test acc/f1/spec/sens = 0.2710 / 0.2690 / 0.9139 / 0.1595/ [0.05732484 0.95402299 0.15948276]
>> Finished.
Acc, agreement for latest model:  0.2710084033613445 0.3487394957983193 [0.05732484 0.95402299 0.15948276]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3382352941176471 0.4117647058823529 [0.05732484 0.93103448 0.30603448]
Trial 1/5 || Cycle 2/5 || Label set size 360 || Test acc 0.3382 || Test agreement 0.4118 || Spec 0.9385 || Sens 0.3060 Class Acc: [0.05732484 0.93103448 0.30603448]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.12s/it]100%|██████████| 2/2 [00:12<00:00,  5.06s/it]100%|██████████| 2/2 [00:12<00:00,  6.26s/it]
Maximum distance from cluster centers is 0.44
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.43it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.80it/s] 50%|█████     | 6/12 [00:00<00:00,  8.17it/s] 75%|███████▌  | 9/12 [00:01<00:00, 12.30it/s]100%|██████████| 12/12 [00:01<00:00,  8.45it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 37, 1: 94, 2: 49}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 48, 2: 37}
Labeled set distribution: 
Number of samples  540
{0: 108, 1: 243, 2: 189}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.3592, agreement = 0.3697, f1 = 0.2592, spec = 0.1844, sens = 0.5862 Class Acc: [0.22292994 0.         0.5862069 ]
Initial model on validation dataset: acc = 0.3500, agreement = 0.3500, f1 = 0.1848, spec = 0.0317, sens = 0.9189 Class Acc: [0.         0.02083333 0.91891892]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:26,  2.69s/it]  2%|▏         | 2/100 [00:06<05:35,  3.42s/it]  3%|▎         | 3/100 [00:09<04:59,  3.09s/it]  4%|▍         | 4/100 [00:13<05:28,  3.43s/it]  5%|▌         | 5/100 [00:19<07:12,  4.56s/it]Epoch 5: Train acc/f1 = 0.8056 / 0.7161 / 0.8120 / 0.9788/ [0.27777778 0.90534979 0.97883598] 
                Val acc/f1/spec/sens = 0.8700 / 0.7506 / 0.8889 / 0.9730/ [0.26666667 0.97916667 0.97297297]
                Test acc/f1/spec/sens = 0.6618 / 0.5097 / 0.7705 / 0.9871/ [0.01910828 0.95402299 0.98706897]
  6%|▌         | 6/100 [00:23<06:45,  4.32s/it]  7%|▋         | 7/100 [00:26<05:53,  3.80s/it]  8%|▊         | 8/100 [00:30<05:54,  3.85s/it]  9%|▉         | 9/100 [00:33<05:16,  3.48s/it] 10%|█         | 10/100 [00:40<07:10,  4.78s/it]Epoch 10: Train acc/f1 = 0.7907 / 0.6148 / 0.9174 / 0.9577/ [0.0462963  0.99176955 0.95767196] 
                Val acc/f1/spec/sens = 0.8200 / 0.5920 / 0.9048 / 0.9459/ [0.         0.97916667 0.94594595]
                Test acc/f1/spec/sens = 0.2374 / 0.1757 / 0.8566 / 0.1164/ [0.         0.98850575 0.11637931]
 11%|█         | 11/100 [00:43<06:10,  4.16s/it] 12%|█▏        | 12/100 [00:47<06:07,  4.18s/it] 13%|█▎        | 13/100 [00:50<05:26,  3.75s/it] 14%|█▍        | 14/100 [00:54<05:29,  3.83s/it] 15%|█▌        | 15/100 [01:01<06:37,  4.68s/it]Epoch 15: Train acc/f1 = 0.8926 / 0.8776 / 0.9573 / 0.9471/ [0.81481481 0.88477366 0.94708995] 
                Val acc/f1/spec/sens = 0.8500 / 0.8220 / 0.9683 / 0.7838/ [0.93333333 0.875      0.78378378]
                Test acc/f1/spec/sens = 0.5546 / 0.5142 / 0.7705 / 0.6940/ [0.2866242  0.66666667 0.69396552]
 16%|█▌        | 16/100 [01:05<06:14,  4.45s/it] 17%|█▋        | 17/100 [01:07<05:25,  3.92s/it] 18%|█▊        | 18/100 [01:11<05:19,  3.90s/it] 19%|█▉        | 19/100 [01:14<04:46,  3.54s/it] 20%|██        | 20/100 [01:21<06:21,  4.76s/it]Epoch 20: Train acc/f1 = 0.9870 / 0.9838 / 1.0000 / 0.9788/ [0.99074074 0.99176955 0.97883598] 
                Val acc/f1/spec/sens = 0.8700 / 0.8332 / 1.0000 / 0.8108/ [0.8        0.9375     0.81081081]
                Test acc/f1/spec/sens = 0.4958 / 0.4629 / 0.8197 / 0.5345/ [0.1656051  0.98850575 0.53448276]
 21%|██        | 21/100 [01:24<05:27,  4.15s/it] 22%|██▏       | 22/100 [01:28<05:17,  4.07s/it] 23%|██▎       | 23/100 [01:31<04:41,  3.66s/it] 24%|██▍       | 24/100 [01:35<04:42,  3.72s/it] 25%|██▌       | 25/100 [01:41<05:42,  4.56s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8384 / 0.9841 / 0.8378/ [0.73333333 0.95833333 0.83783784]
                Test acc/f1/spec/sens = 0.3697 / 0.3384 / 0.8525 / 0.3362/ [0.07006369 1.         0.3362069 ]
 26%|██▌       | 26/100 [01:45<05:22,  4.36s/it] 27%|██▋       | 27/100 [01:48<04:41,  3.85s/it] 28%|██▊       | 28/100 [01:52<04:38,  3.87s/it] 29%|██▉       | 29/100 [01:54<04:07,  3.49s/it] 30%|███       | 30/100 [02:02<05:31,  4.74s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8511 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.3866 / 0.3526 / 0.8279 / 0.3750/ [0.07006369 0.98850575 0.375     ]
 31%|███       | 31/100 [02:05<04:46,  4.15s/it] 32%|███▏      | 32/100 [02:08<04:36,  4.07s/it] 33%|███▎      | 33/100 [02:11<04:04,  3.64s/it] 34%|███▍      | 34/100 [02:15<04:05,  3.73s/it] 35%|███▌      | 35/100 [02:21<04:55,  4.54s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8384 / 0.9841 / 0.8378/ [0.73333333 0.95833333 0.83783784]
                Test acc/f1/spec/sens = 0.3592 / 0.3273 / 0.8484 / 0.3147/ [0.07006369 1.         0.31465517]
 36%|███▌      | 36/100 [02:25<04:39,  4.36s/it] 37%|███▋      | 37/100 [02:28<04:04,  3.88s/it] 38%|███▊      | 38/100 [02:32<04:01,  3.89s/it] 39%|███▉      | 39/100 [02:35<03:36,  3.55s/it] 40%|████      | 40/100 [02:42<04:44,  4.74s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8384 / 0.9841 / 0.8378/ [0.73333333 0.95833333 0.83783784]
                Test acc/f1/spec/sens = 0.3319 / 0.3008 / 0.8893 / 0.2629/ [0.06369427 1.         0.26293103]
 41%|████      | 41/100 [02:45<04:04,  4.15s/it] 42%|████▏     | 42/100 [02:49<03:55,  4.07s/it] 43%|████▎     | 43/100 [02:52<03:28,  3.65s/it] 44%|████▍     | 44/100 [02:56<03:28,  3.73s/it] 45%|████▌     | 45/100 [03:02<04:08,  4.53s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8511 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.3298 / 0.2977 / 0.8730 / 0.2586/ [0.06369427 1.         0.25862069]
 46%|████▌     | 46/100 [03:06<03:53,  4.33s/it] 47%|████▋     | 47/100 [03:09<03:24,  3.85s/it] 48%|████▊     | 48/100 [03:13<03:22,  3.89s/it] 49%|████▉     | 49/100 [03:15<03:01,  3.56s/it] 50%|█████     | 50/100 [03:23<03:58,  4.76s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8511 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.3088 / 0.2729 / 0.8811 / 0.2155/ [0.06369427 1.         0.21551724]
 51%|█████     | 51/100 [03:26<03:23,  4.16s/it] 52%|█████▏    | 52/100 [03:30<03:16,  4.09s/it] 53%|█████▎    | 53/100 [03:32<02:53,  3.69s/it] 54%|█████▍    | 54/100 [03:36<02:52,  3.75s/it] 55%|█████▌    | 55/100 [03:43<03:25,  4.57s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8511 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.3025 / 0.2682 / 0.8975 / 0.2026/ [0.06369427 1.         0.20258621]
 56%|█████▌    | 56/100 [03:47<03:12,  4.39s/it] 57%|█████▋    | 57/100 [03:49<02:46,  3.88s/it] 58%|█████▊    | 58/100 [03:53<02:43,  3.89s/it] 59%|█████▉    | 59/100 [03:56<02:24,  3.52s/it] 60%|██████    | 60/100 [04:04<03:10,  4.76s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8511 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.3361 / 0.3028 / 0.8689 / 0.2716/ [0.06369427 1.         0.27155172]
 61%|██████    | 61/100 [04:06<02:41,  4.15s/it] 62%|██████▏   | 62/100 [04:10<02:34,  4.06s/it] 63%|██████▎   | 63/100 [04:13<02:14,  3.65s/it] 64%|██████▍   | 64/100 [04:17<02:12,  3.69s/it] 65%|██████▌   | 65/100 [04:23<02:38,  4.53s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8384 / 0.9841 / 0.8378/ [0.73333333 0.95833333 0.83783784]
                Test acc/f1/spec/sens = 0.3214 / 0.2884 / 0.8689 / 0.2414/ [0.06369427 1.         0.24137931]
 66%|██████▌   | 66/100 [04:27<02:26,  4.31s/it] 67%|██████▋   | 67/100 [04:30<02:05,  3.81s/it] 68%|██████▊   | 68/100 [04:33<02:02,  3.83s/it] 69%|██████▉   | 69/100 [04:36<01:47,  3.46s/it] 70%|███████   | 70/100 [04:44<02:22,  4.74s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8511 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.3508 / 0.3142 / 0.8689 / 0.3017/ [0.06369427 1.         0.30172414]
 71%|███████   | 71/100 [04:46<01:59,  4.11s/it] 72%|███████▏  | 72/100 [04:50<01:53,  4.04s/it] 73%|███████▎  | 73/100 [04:53<01:37,  3.62s/it] 74%|███████▍  | 74/100 [04:57<01:39,  3.82s/it] 75%|███████▌  | 75/100 [05:04<01:55,  4.62s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8641 / 0.9841 / 0.8919/ [0.73333333 0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.3403 / 0.3050 / 0.8607 / 0.2802/ [0.06369427 1.         0.28017241]
 76%|███████▌  | 76/100 [05:08<01:45,  4.39s/it] 77%|███████▋  | 77/100 [05:10<01:29,  3.87s/it] 78%|███████▊  | 78/100 [05:14<01:25,  3.89s/it] 79%|███████▉  | 79/100 [05:17<01:13,  3.51s/it] 80%|████████  | 80/100 [05:24<01:35,  4.76s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8384 / 0.9841 / 0.8378/ [0.73333333 0.95833333 0.83783784]
                Test acc/f1/spec/sens = 0.3403 / 0.3076 / 0.8770 / 0.2802/ [0.06369427 1.         0.28017241]
 81%|████████  | 81/100 [05:27<01:18,  4.11s/it] 82%|████████▏ | 82/100 [05:31<01:12,  4.02s/it] 83%|████████▎ | 83/100 [05:34<01:01,  3.62s/it] 84%|████████▍ | 84/100 [05:38<00:59,  3.72s/it] 85%|████████▌ | 85/100 [05:44<01:08,  4.54s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8384 / 0.9841 / 0.8378/ [0.73333333 0.95833333 0.83783784]
                Test acc/f1/spec/sens = 0.3340 / 0.3015 / 0.8689 / 0.2672/ [0.06369427 1.         0.26724138]
 86%|████████▌ | 86/100 [05:48<01:00,  4.33s/it] 87%|████████▋ | 87/100 [05:50<00:49,  3.83s/it] 88%|████████▊ | 88/100 [05:54<00:46,  3.83s/it] 89%|████████▉ | 89/100 [05:57<00:38,  3.47s/it] 90%|█████████ | 90/100 [06:05<00:47,  4.74s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8384 / 0.9841 / 0.8378/ [0.73333333 0.95833333 0.83783784]
                Test acc/f1/spec/sens = 0.3550 / 0.3252 / 0.8607 / 0.3103/ [0.06369427 1.         0.31034483]
 91%|█████████ | 91/100 [06:07<00:37,  4.11s/it] 92%|█████████▏| 92/100 [06:11<00:32,  4.05s/it] 93%|█████████▎| 93/100 [06:14<00:25,  3.63s/it] 94%|█████████▍| 94/100 [06:18<00:22,  3.74s/it] 95%|█████████▌| 95/100 [06:24<00:22,  4.54s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8384 / 0.9841 / 0.8378/ [0.73333333 0.95833333 0.83783784]
                Test acc/f1/spec/sens = 0.3256 / 0.2918 / 0.8689 / 0.2500/ [0.06369427 1.         0.25      ]
 96%|█████████▌| 96/100 [06:28<00:17,  4.36s/it] 97%|█████████▋| 97/100 [06:31<00:11,  3.83s/it] 98%|█████████▊| 98/100 [06:35<00:07,  3.85s/it] 99%|█████████▉| 99/100 [06:37<00:03,  3.49s/it]100%|██████████| 100/100 [06:45<00:00,  4.74s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8384 / 0.9841 / 0.8378/ [0.73333333 0.95833333 0.83783784]
                Test acc/f1/spec/sens = 0.2962 / 0.2617 / 0.9139 / 0.1897/ [0.06369427 1.         0.18965517]
Trial 2, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8800 / 0.8384 / 0.9841 / 0.8378/ [0.73333333 0.95833333 0.83783784]
Test acc/f1/spec/sens = 0.2962 / 0.2617 / 0.9139 / 0.1897/ [0.06369427 1.         0.18965517]
>> Finished.
Acc, agreement for latest model:  0.296218487394958 0.3550420168067227 [0.06369427 1.         0.18965517]
Load best checkpoint for thief model
Acc, agreement for best model:  0.36134453781512604 0.4180672268907563 [0.06369427 1.         0.32327586]
Trial 1/5 || Cycle 3/5 || Label set size 540 || Test acc 0.3613 || Test agreement 0.4181 || Spec 0.8607 || Sens 0.3233 Class Acc: [0.06369427 1.         0.32327586]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.34s/it]100%|██████████| 2/2 [00:12<00:00,  5.15s/it]100%|██████████| 2/2 [00:12<00:00,  6.38s/it]
Maximum distance from cluster centers is 0.49
labeled set:  720
unlabeled set:  713
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.30it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.28it/s] 67%|██████▋   | 8/12 [00:01<00:00, 10.19it/s]100%|██████████| 12/12 [00:01<00:00,  8.36it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 41, 1: 65, 2: 74}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 48, 2: 37}
Labeled set distribution: 
Number of samples  720
{0: 149, 1: 308, 2: 263}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.4265, agreement = 0.3992, f1 = 0.2573, spec = 0.2008, sens = 0.8147 Class Acc: [0.         0.16091954 0.81465517]
Initial model on validation dataset: acc = 0.4800, agreement = 0.4800, f1 = 0.4028, spec = 0.4762, sens = 0.7027 Class Acc: [0.13333333 0.41666667 0.7027027 ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:21,  3.25s/it]  2%|▏         | 2/100 [00:07<06:41,  4.10s/it]  3%|▎         | 3/100 [00:11<06:05,  3.77s/it]  4%|▍         | 4/100 [00:16<06:38,  4.15s/it]  5%|▌         | 5/100 [00:23<08:34,  5.42s/it]Epoch 5: Train acc/f1 = 0.8681 / 0.8360 / 0.9344 / 0.9278/ [0.58389262 0.95454545 0.92775665] 
                Val acc/f1/spec/sens = 0.8900 / 0.8465 / 0.9683 / 0.9189/ [0.66666667 0.9375     0.91891892]
                Test acc/f1/spec/sens = 0.3803 / 0.3334 / 0.8320 / 0.3621/ [0.06369427 1.         0.36206897]
  6%|▌         | 6/100 [00:28<07:56,  5.07s/it]  7%|▋         | 7/100 [00:31<06:55,  4.46s/it]  8%|▊         | 8/100 [00:35<06:54,  4.50s/it]  9%|▉         | 9/100 [00:39<06:17,  4.15s/it] 10%|█         | 10/100 [00:48<08:34,  5.72s/it]Epoch 10: Train acc/f1 = 0.9097 / 0.8945 / 0.9387 / 0.9582/ [0.76510067 0.93831169 0.9581749 ] 
                Val acc/f1/spec/sens = 0.9100 / 0.8655 / 0.9683 / 0.9459/ [0.6        0.97916667 0.94594595]
                Test acc/f1/spec/sens = 0.3319 / 0.3053 / 0.8770 / 0.2888/ [0.06369427 0.93103448 0.2887931 ]
 11%|█         | 11/100 [00:51<07:23,  4.98s/it] 12%|█▏        | 12/100 [00:56<07:04,  4.83s/it] 13%|█▎        | 13/100 [00:59<06:18,  4.35s/it] 14%|█▍        | 14/100 [01:03<06:16,  4.38s/it] 15%|█▌        | 15/100 [01:11<07:35,  5.36s/it]Epoch 15: Train acc/f1 = 0.9097 / 0.8987 / 0.9912 / 0.8175/ [0.93959732 0.97402597 0.81749049] 
                Val acc/f1/spec/sens = 0.8800 / 0.8265 / 0.9683 / 0.8919/ [0.6        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2416 / 0.2093 / 0.9754 / 0.0647/ [0.08280255 1.         0.06465517]
 16%|█▌        | 16/100 [01:15<07:03,  5.04s/it] 17%|█▋        | 17/100 [01:19<06:14,  4.51s/it] 18%|█▊        | 18/100 [01:23<06:08,  4.49s/it] 19%|█▉        | 19/100 [01:26<05:31,  4.10s/it] 20%|██        | 20/100 [01:35<07:25,  5.57s/it]Epoch 20: Train acc/f1 = 0.9306 / 0.9263 / 0.9300 / 0.9924/ [0.91275168 0.88636364 0.99239544] 
                Val acc/f1/spec/sens = 0.9000 / 0.8736 / 0.9683 / 0.9189/ [0.86666667 0.89583333 0.91891892]
                Test acc/f1/spec/sens = 0.4937 / 0.4471 / 0.6598 / 0.6293/ [0.05732484 0.91954023 0.62931034]
 21%|██        | 21/100 [01:39<06:23,  4.85s/it] 22%|██▏       | 22/100 [01:43<06:07,  4.71s/it] 23%|██▎       | 23/100 [01:46<05:28,  4.26s/it] 24%|██▍       | 24/100 [01:50<05:24,  4.27s/it] 25%|██▌       | 25/100 [01:58<06:30,  5.21s/it]Epoch 25: Train acc/f1 = 0.9986 / 0.9983 / 1.0000 / 1.0000/ [0.99328859 1.         1.        ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2752 / 0.2510 / 0.9057 / 0.1466/ [0.06369427 1.         0.14655172]
 26%|██▌       | 26/100 [02:02<06:08,  4.98s/it] 27%|██▋       | 27/100 [02:06<05:26,  4.47s/it] 28%|██▊       | 28/100 [02:10<05:20,  4.45s/it] 29%|██▉       | 29/100 [02:13<04:50,  4.10s/it] 30%|███       | 30/100 [02:22<06:25,  5.51s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2731 / 0.2513 / 0.9098 / 0.1379/ [0.07006369 1.         0.13793103]
 31%|███       | 31/100 [02:25<05:33,  4.83s/it] 32%|███▏      | 32/100 [02:30<05:21,  4.73s/it] 33%|███▎      | 33/100 [02:33<04:48,  4.31s/it] 34%|███▍      | 34/100 [02:38<04:47,  4.35s/it] 35%|███▌      | 35/100 [02:45<05:47,  5.34s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2857 / 0.2706 / 0.8811 / 0.1552/ [0.08280255 1.         0.15517241]
 36%|███▌      | 36/100 [02:50<05:25,  5.09s/it] 37%|███▋      | 37/100 [02:53<04:47,  4.56s/it] 38%|███▊      | 38/100 [02:57<04:40,  4.52s/it] 39%|███▉      | 39/100 [03:01<04:11,  4.12s/it] 40%|████      | 40/100 [03:09<05:30,  5.50s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2794 / 0.2620 / 0.9098 / 0.1336/ [0.0955414  1.         0.13362069]
 41%|████      | 41/100 [03:13<04:43,  4.80s/it] 42%|████▏     | 42/100 [03:17<04:29,  4.65s/it] 43%|████▎     | 43/100 [03:20<03:58,  4.19s/it] 44%|████▍     | 44/100 [03:24<03:58,  4.25s/it] 45%|████▌     | 45/100 [03:32<04:48,  5.24s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2689 / 0.2440 / 0.9057 / 0.1336/ [0.06369427 1.         0.13362069]
 46%|████▌     | 46/100 [03:36<04:30,  5.01s/it] 47%|████▋     | 47/100 [03:40<03:57,  4.47s/it] 48%|████▊     | 48/100 [03:44<03:52,  4.47s/it] 49%|████▉     | 49/100 [03:47<03:28,  4.10s/it] 50%|█████     | 50/100 [03:56<04:34,  5.48s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2731 / 0.2480 / 0.9180 / 0.1379/ [0.07006369 1.         0.13793103]
 51%|█████     | 51/100 [03:59<03:55,  4.80s/it] 52%|█████▏    | 52/100 [04:04<03:43,  4.67s/it] 53%|█████▎    | 53/100 [04:07<03:19,  4.24s/it] 54%|█████▍    | 54/100 [04:11<03:17,  4.29s/it] 55%|█████▌    | 55/100 [04:19<03:59,  5.33s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2752 / 0.2533 / 0.9139 / 0.1379/ [0.07643312 1.         0.13793103]
 56%|█████▌    | 56/100 [04:23<03:42,  5.05s/it] 57%|█████▋    | 57/100 [04:27<03:14,  4.51s/it] 58%|█████▊    | 58/100 [04:31<03:09,  4.52s/it] 59%|█████▉    | 59/100 [04:34<02:50,  4.15s/it] 60%|██████    | 60/100 [04:43<03:42,  5.57s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8641 / 0.9841 / 0.8919/ [0.73333333 0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2794 / 0.2621 / 0.8811 / 0.1466/ [0.07643312 1.         0.14655172]
 61%|██████    | 61/100 [04:47<03:09,  4.87s/it] 62%|██████▏   | 62/100 [04:51<02:59,  4.72s/it] 63%|██████▎   | 63/100 [04:54<02:38,  4.29s/it] 64%|██████▍   | 64/100 [04:59<02:35,  4.33s/it] 65%|██████▌   | 65/100 [05:06<03:05,  5.31s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2752 / 0.2539 / 0.9139 / 0.1379/ [0.07643312 1.         0.13793103]
 66%|██████▌   | 66/100 [05:11<02:52,  5.06s/it] 67%|██████▋   | 67/100 [05:14<02:29,  4.53s/it] 68%|██████▊   | 68/100 [05:18<02:23,  4.48s/it] 69%|██████▉   | 69/100 [05:22<02:06,  4.09s/it] 70%|███████   | 70/100 [05:30<02:44,  5.49s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8641 / 0.9841 / 0.8919/ [0.73333333 0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2710 / 0.2488 / 0.9016 / 0.1336/ [0.07006369 1.         0.13362069]
 71%|███████   | 71/100 [05:33<02:19,  4.80s/it] 72%|███████▏  | 72/100 [05:38<02:11,  4.70s/it] 73%|███████▎  | 73/100 [05:41<01:56,  4.30s/it] 74%|███████▍  | 74/100 [05:46<01:52,  4.32s/it] 75%|███████▌  | 75/100 [05:53<02:13,  5.33s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8641 / 0.9841 / 0.8919/ [0.73333333 0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2689 / 0.2466 / 0.9016 / 0.1250/ [0.07643312 1.         0.125     ]
 76%|███████▌  | 76/100 [05:58<02:01,  5.06s/it] 77%|███████▋  | 77/100 [06:01<01:43,  4.51s/it] 78%|███████▊  | 78/100 [06:05<01:38,  4.47s/it] 79%|███████▉  | 79/100 [06:09<01:26,  4.10s/it] 80%|████████  | 80/100 [06:17<01:49,  5.50s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2710 / 0.2501 / 0.9139 / 0.1293/ [0.07643312 1.         0.12931034]
 81%|████████  | 81/100 [06:21<01:31,  4.82s/it] 82%|████████▏ | 82/100 [06:25<01:24,  4.71s/it] 83%|████████▎ | 83/100 [06:28<01:12,  4.28s/it] 84%|████████▍ | 84/100 [06:33<01:09,  4.32s/it] 85%|████████▌ | 85/100 [06:41<01:20,  5.35s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2983 / 0.2894 / 0.8730 / 0.1724/ [0.0955414  1.         0.17241379]
 86%|████████▌ | 86/100 [06:45<01:10,  5.07s/it] 87%|████████▋ | 87/100 [06:48<00:58,  4.53s/it] 88%|████████▊ | 88/100 [06:53<00:53,  4.49s/it] 89%|████████▉ | 89/100 [06:56<00:45,  4.14s/it] 90%|█████████ | 90/100 [07:05<00:55,  5.55s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8641 / 0.9841 / 0.8919/ [0.73333333 0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.2794 / 0.2571 / 0.8934 / 0.1466/ [0.07643312 1.         0.14655172]
 91%|█████████ | 91/100 [07:08<00:43,  4.85s/it] 92%|█████████▏| 92/100 [07:12<00:37,  4.68s/it] 93%|█████████▎| 93/100 [07:16<00:29,  4.28s/it] 94%|█████████▍| 94/100 [07:20<00:26,  4.34s/it] 95%|█████████▌| 95/100 [07:28<00:27,  5.43s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2962 / 0.2809 / 0.8770 / 0.1724/ [0.08917197 1.         0.17241379]
 96%|█████████▌| 96/100 [07:33<00:20,  5.13s/it] 97%|█████████▋| 97/100 [07:36<00:13,  4.59s/it] 98%|█████████▊| 98/100 [07:40<00:09,  4.55s/it] 99%|█████████▉| 99/100 [07:44<00:04,  4.16s/it]100%|██████████| 100/100 [07:52<00:00,  5.60s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.2752 / 0.2561 / 0.9139 / 0.1336/ [0.08280255 1.         0.13362069]
Trial 2, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8900 / 0.8559 / 0.9841 / 0.8649/ [0.73333333 0.95833333 0.86486486]
Test acc/f1/spec/sens = 0.2752 / 0.2561 / 0.9139 / 0.1336/ [0.08280255 1.         0.13362069]
>> Finished.
Acc, agreement for latest model:  0.27521008403361347 0.2920168067226891 [0.08280255 1.         0.13362069]
Load best checkpoint for thief model
Acc, agreement for best model:  0.49369747899159666 0.4684873949579832 [0.05732484 0.91954023 0.62931034]
Trial 1/5 || Cycle 4/5 || Label set size 720 || Test acc 0.4937 || Test agreement 0.4685 || Spec 0.6598 || Sens 0.6293 Class Acc: [0.05732484 0.91954023 0.62931034]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.02s/it]100%|██████████| 2/2 [00:13<00:00,  5.43s/it]100%|██████████| 2/2 [00:13<00:00,  6.70s/it]
Maximum distance from cluster centers is 0.31
labeled set:  900
unlabeled set:  533
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.48it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.80it/s] 67%|██████▋   | 8/12 [00:00<00:00, 11.11it/s]100%|██████████| 12/12 [00:01<00:00,  9.20it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 19, 1: 118, 2: 43}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 48, 2: 37}
Labeled set distribution: 
Number of samples  900
{0: 168, 1: 426, 2: 306}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.3193, agreement = 0.3088, f1 = 0.2785, spec = 0.5861, sens = 0.3405 Class Acc: [0.40764331 0.10344828 0.34051724]
Initial model on validation dataset: acc = 0.4700, agreement = 0.4700, f1 = 0.3966, spec = 0.7143, sens = 0.5135 Class Acc: [0.13333333 0.54166667 0.51351351]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:20,  3.84s/it]  2%|▏         | 2/100 [00:08<07:28,  4.58s/it]  3%|▎         | 3/100 [00:12<06:51,  4.25s/it]  4%|▍         | 4/100 [00:17<07:21,  4.60s/it]  5%|▌         | 5/100 [00:26<09:31,  6.02s/it]Epoch 5: Train acc/f1 = 0.7467 / 0.7029 / 0.9983 / 0.4837/ [0.63690476 0.97887324 0.48366013] 
                Val acc/f1/spec/sens = 0.7300 / 0.7035 / 1.0000 / 0.6216/ [0.86666667 0.77083333 0.62162162]
                Test acc/f1/spec/sens = 0.1933 / 0.1219 / 1.0000 / 0.0216/ [0.         1.         0.02155172]
  6%|▌         | 6/100 [00:31<09:06,  5.81s/it]  7%|▋         | 7/100 [00:35<08:00,  5.16s/it]  8%|▊         | 8/100 [00:40<07:45,  5.06s/it]  9%|▉         | 9/100 [00:44<07:02,  4.64s/it] 10%|█         | 10/100 [00:53<09:18,  6.21s/it]Epoch 10: Train acc/f1 = 0.8989 / 0.8885 / 0.9175 / 0.9641/ [0.85714286 0.8685446  0.96405229] 
                Val acc/f1/spec/sens = 0.8900 / 0.8431 / 0.9206 / 0.9459/ [0.6        0.9375     0.94594595]
                Test acc/f1/spec/sens = 0.4517 / 0.4700 / 0.7828 / 0.3836/ [0.26751592 0.96551724 0.38362069]
 11%|█         | 11/100 [00:57<08:10,  5.51s/it] 12%|█▏        | 12/100 [01:03<08:02,  5.48s/it] 13%|█▎        | 13/100 [01:07<07:12,  4.97s/it] 14%|█▍        | 14/100 [01:12<07:09,  4.99s/it] 15%|█▌        | 15/100 [01:20<08:34,  6.05s/it]Epoch 15: Train acc/f1 = 0.8500 / 0.8286 / 0.9966 / 0.7124/ [0.99404762 0.89201878 0.7124183 ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8320 / 0.9206 / 0.9189/ [0.6        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.3718 / 0.3913 / 0.9180 / 0.0345/ [0.59235669 0.87356322 0.03448276]
 16%|█▌        | 16/100 [01:25<08:01,  5.74s/it] 17%|█▋        | 17/100 [01:29<07:06,  5.14s/it] 18%|█▊        | 18/100 [01:34<06:59,  5.12s/it] 19%|█▉        | 19/100 [01:38<06:22,  4.73s/it] 20%|██        | 20/100 [01:48<08:18,  6.24s/it]Epoch 20: Train acc/f1 = 0.7989 / 0.7568 / 0.7054 / 1.0000/ [0.45238095 0.79107981 1.        ] 
                Val acc/f1/spec/sens = 0.8100 / 0.7007 / 0.7460 / 1.0000/ [0.26666667 0.83333333 1.        ]
                Test acc/f1/spec/sens = 0.6239 / 0.5027 / 0.4221 / 0.9914/ [0.05732484 0.66666667 0.99137931]
 21%|██        | 21/100 [01:51<07:17,  5.53s/it] 22%|██▏       | 22/100 [01:56<06:58,  5.37s/it] 23%|██▎       | 23/100 [02:00<06:15,  4.88s/it] 24%|██▍       | 24/100 [02:05<06:13,  4.91s/it] 25%|██▌       | 25/100 [02:14<07:32,  6.03s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8639 / 1.0000 / 0.8649/ [0.73333333 0.97916667 0.86486486]
                Test acc/f1/spec/sens = 0.3424 / 0.3303 / 0.9713 / 0.0991/ [0.33757962 1.         0.09913793]
 26%|██▌       | 26/100 [02:19<07:05,  5.74s/it] 27%|██▋       | 27/100 [02:23<06:16,  5.16s/it] 28%|██▊       | 28/100 [02:28<06:07,  5.10s/it] 29%|██▉       | 29/100 [02:31<05:31,  4.67s/it] 30%|███       | 30/100 [02:41<07:16,  6.23s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8463 / 1.0000 / 0.8649/ [0.66666667 0.97916667 0.86486486]
                Test acc/f1/spec/sens = 0.3466 / 0.3390 / 0.9508 / 0.1466/ [0.28025478 1.         0.14655172]
 31%|███       | 31/100 [02:45<06:20,  5.51s/it] 32%|███▏      | 32/100 [02:50<06:03,  5.34s/it] 33%|███▎      | 33/100 [02:54<05:26,  4.87s/it] 34%|███▍      | 34/100 [02:59<05:22,  4.88s/it] 35%|███▌      | 35/100 [03:07<06:31,  6.02s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8333 / 1.0000 / 0.8378/ [0.66666667 0.97916667 0.83783784]
                Test acc/f1/spec/sens = 0.4118 / 0.4130 / 0.9631 / 0.1595/ [0.45859873 1.         0.15948276]
 36%|███▌      | 36/100 [03:13<06:12,  5.82s/it] 37%|███▋      | 37/100 [03:16<05:27,  5.19s/it] 38%|███▊      | 38/100 [03:21<05:19,  5.15s/it] 39%|███▉      | 39/100 [03:25<04:49,  4.75s/it] 40%|████      | 40/100 [03:35<06:14,  6.24s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8596 / 1.0000 / 0.8919/ [0.66666667 0.97916667 0.89189189]
                Test acc/f1/spec/sens = 0.3676 / 0.3611 / 0.9631 / 0.1207/ [0.38216561 1.         0.12068966]
 41%|████      | 41/100 [03:39<05:25,  5.52s/it] 42%|████▏     | 42/100 [03:44<05:09,  5.34s/it] 43%|████▎     | 43/100 [03:48<04:39,  4.90s/it] 44%|████▍     | 44/100 [03:53<04:38,  4.98s/it] 45%|████▌     | 45/100 [04:01<05:32,  6.05s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8464 / 0.9841 / 0.8919/ [0.66666667 0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.3782 / 0.3758 / 0.9467 / 0.1638/ [0.35031847 1.         0.1637931 ]
 46%|████▌     | 46/100 [04:06<05:08,  5.72s/it] 47%|████▋     | 47/100 [04:10<04:30,  5.11s/it] 48%|████▊     | 48/100 [04:15<04:25,  5.10s/it] 49%|████▉     | 49/100 [04:19<04:03,  4.77s/it] 50%|█████     | 50/100 [04:29<05:15,  6.31s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8278 / 0.9841 / 0.8919/ [0.6        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.4160 / 0.4192 / 0.9385 / 0.2112/ [0.39490446 1.         0.2112069 ]
 51%|█████     | 51/100 [04:33<04:30,  5.52s/it] 52%|█████▏    | 52/100 [04:38<04:18,  5.38s/it] 53%|█████▎    | 53/100 [04:42<03:52,  4.95s/it] 54%|█████▍    | 54/100 [04:47<03:48,  4.96s/it] 55%|█████▌    | 55/100 [04:55<04:31,  6.03s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8513 / 0.9841 / 0.8919/ [0.6        1.         0.89189189]
                Test acc/f1/spec/sens = 0.4013 / 0.4043 / 0.9385 / 0.1595/ [0.42675159 1.         0.15948276]
 56%|█████▌    | 56/100 [05:00<04:11,  5.73s/it] 57%|█████▋    | 57/100 [05:04<03:41,  5.15s/it] 58%|█████▊    | 58/100 [05:09<03:36,  5.15s/it] 59%|█████▉    | 59/100 [05:13<03:15,  4.76s/it] 60%|██████    | 60/100 [05:23<04:09,  6.25s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8449 / 0.9841 / 0.8649/ [0.66666667 0.97916667 0.86486486]
                Test acc/f1/spec/sens = 0.3845 / 0.3817 / 0.9590 / 0.1336/ [0.41401274 1.         0.13362069]
 61%|██████    | 61/100 [05:26<03:34,  5.50s/it] 62%|██████▏   | 62/100 [05:32<03:24,  5.39s/it] 63%|██████▎   | 63/100 [05:35<03:02,  4.93s/it] 64%|██████▍   | 64/100 [05:40<02:56,  4.91s/it] 65%|██████▌   | 65/100 [05:49<03:34,  6.13s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8262 / 0.9841 / 0.8649/ [0.6        0.97916667 0.86486486]
                Test acc/f1/spec/sens = 0.4307 / 0.4357 / 0.9221 / 0.2500/ [0.38216561 1.         0.25      ]
 66%|██████▌   | 66/100 [05:54<03:17,  5.81s/it] 67%|██████▋   | 67/100 [05:58<02:50,  5.17s/it] 68%|██████▊   | 68/100 [06:03<02:43,  5.11s/it] 69%|██████▉   | 69/100 [06:07<02:27,  4.74s/it] 70%|███████   | 70/100 [06:17<03:07,  6.25s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8337 / 0.9841 / 0.8649/ [0.66666667 0.95833333 0.86486486]
                Test acc/f1/spec/sens = 0.3950 / 0.3916 / 0.9631 / 0.1379/ [0.43949045 1.         0.13793103]
 71%|███████   | 71/100 [06:20<02:40,  5.54s/it] 72%|███████▏  | 72/100 [06:26<02:30,  5.39s/it] 73%|███████▎  | 73/100 [06:29<02:12,  4.92s/it] 74%|███████▍  | 74/100 [06:35<02:09,  5.00s/it] 75%|███████▌  | 75/100 [06:43<02:31,  6.06s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8463 / 1.0000 / 0.8649/ [0.66666667 0.97916667 0.86486486]
                Test acc/f1/spec/sens = 0.3739 / 0.3667 / 0.9672 / 0.1293/ [0.38853503 1.         0.12931034]
 76%|███████▌  | 76/100 [06:48<02:17,  5.72s/it] 77%|███████▋  | 77/100 [06:52<01:58,  5.16s/it] 78%|███████▊  | 78/100 [06:57<01:51,  5.09s/it] 79%|███████▉  | 79/100 [07:01<01:39,  4.75s/it] 80%|████████  | 80/100 [07:11<02:05,  6.26s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8449 / 0.9841 / 0.8649/ [0.66666667 0.97916667 0.86486486]
                Test acc/f1/spec/sens = 0.3866 / 0.3849 / 0.9467 / 0.1552/ [0.38853503 1.         0.15517241]
 81%|████████  | 81/100 [07:14<01:45,  5.55s/it] 82%|████████▏ | 82/100 [07:19<01:36,  5.37s/it] 83%|████████▎ | 83/100 [07:23<01:22,  4.88s/it] 84%|████████▍ | 84/100 [07:28<01:18,  4.92s/it] 85%|████████▌ | 85/100 [07:37<01:30,  6.02s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8464 / 0.9841 / 0.8919/ [0.66666667 0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.3950 / 0.3946 / 0.9508 / 0.1552/ [0.41401274 1.         0.15517241]
 86%|████████▌ | 86/100 [07:42<01:20,  5.73s/it] 87%|████████▋ | 87/100 [07:46<01:07,  5.16s/it] 88%|████████▊ | 88/100 [07:51<01:01,  5.11s/it] 89%|████████▉ | 89/100 [07:54<00:52,  4.73s/it] 90%|█████████ | 90/100 [08:04<01:02,  6.28s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8513 / 0.9841 / 0.8919/ [0.6        1.         0.89189189]
                Test acc/f1/spec/sens = 0.3761 / 0.3730 / 0.9467 / 0.1595/ [0.35031847 1.         0.15948276]
 91%|█████████ | 91/100 [08:08<00:49,  5.53s/it] 92%|█████████▏| 92/100 [08:13<00:43,  5.39s/it] 93%|█████████▎| 93/100 [08:17<00:34,  4.92s/it] 94%|█████████▍| 94/100 [08:22<00:30,  5.02s/it] 95%|█████████▌| 95/100 [08:31<00:30,  6.00s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8262 / 0.9841 / 0.8649/ [0.6        0.97916667 0.86486486]
                Test acc/f1/spec/sens = 0.4328 / 0.4397 / 0.9344 / 0.2198/ [0.43312102 1.         0.21982759]
 96%|█████████▌| 96/100 [08:36<00:22,  5.70s/it] 97%|█████████▋| 97/100 [08:39<00:15,  5.14s/it] 98%|█████████▊| 98/100 [08:44<00:10,  5.10s/it] 99%|█████████▉| 99/100 [08:48<00:04,  4.70s/it]100%|██████████| 100/100 [08:58<00:00,  6.25s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8463 / 1.0000 / 0.8649/ [0.66666667 0.97916667 0.86486486]
                Test acc/f1/spec/sens = 0.3613 / 0.3504 / 0.9672 / 0.1034/ [0.38853503 1.         0.10344828]
Trial 2, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8900 / 0.8463 / 1.0000 / 0.8649/ [0.66666667 0.97916667 0.86486486]
Test acc/f1/spec/sens = 0.3613 / 0.3504 / 0.9672 / 0.1034/ [0.38853503 1.         0.10344828]
>> Finished.
Acc, agreement for latest model:  0.36134453781512604 0.3760504201680672 [0.38853503 1.         0.10344828]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4012605042016807 0.38865546218487396 [0.40127389 1.         0.17672414]
Trial 1/5 || Cycle 5/5 || Label set size 900 || Test acc 0.4013 || Test agreement 0.3887 || Spec 0.9508 || Sens 0.1767 Class Acc: [0.40127389 1.         0.17672414]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.35it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.44it/s] 75%|███████▌  | 9/12 [00:01<00:00, 11.05it/s]100%|██████████| 12/12 [00:01<00:00,  8.67it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:04,  1.47it/s] 57%|█████▋    | 4/7 [00:00<00:00,  5.62it/s]100%|██████████| 7/7 [00:01<00:00,  6.05it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2281, -1.2479, -1.2185]), tensor([0.8520, 0.8455, 0.8562]))
Val set stats: mean/std =  (tensor([-1.1749, -1.1935, -1.1652]), tensor([0.8706, 0.8670, 0.8731]))
Validation set distribution: 
Number of samples  100
{0: 21, 1: 38, 2: 41}
Labeled set distribution: 
Number of samples  180
{0: 30, 1: 80, 2: 70}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.2437, agreement = 0.2164, f1 = 0.1478, spec = 0.9467, sens = 0.0043 Class Acc: [0.7133758  0.03448276 0.00431034]
Initial model on validation dataset: acc = 0.1700, agreement = 0.1700, f1 = 0.1355, spec = 1.0000, sens = 0.0000 Class Acc: [0.61904762 0.10526316 0.        ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:40,  1.62s/it]  2%|▏         | 2/100 [00:04<04:00,  2.45s/it]  3%|▎         | 3/100 [00:06<03:19,  2.06s/it]  4%|▍         | 4/100 [00:09<03:45,  2.35s/it]  5%|▌         | 5/100 [00:13<04:49,  3.05s/it]Epoch 5: Train acc/f1 = 0.8167 / 0.6894 / 0.8909 / 0.8857/ [0.2        0.9875     0.88571429] 
                Val acc/f1/spec/sens = 0.5000 / 0.4083 / 1.0000 / 0.0732/ [0.42857143 1.         0.07317073]
                Test acc/f1/spec/sens = 0.6071 / 0.4796 / 0.9057 / 0.8534/ [0.02547771 1.         0.85344828]
  6%|▌         | 6/100 [00:16<04:48,  3.07s/it]  7%|▋         | 7/100 [00:18<04:01,  2.60s/it]  8%|▊         | 8/100 [00:20<04:05,  2.67s/it]  9%|▉         | 9/100 [00:22<03:32,  2.33s/it] 10%|█         | 10/100 [00:27<04:57,  3.31s/it]Epoch 10: Train acc/f1 = 0.7444 / 0.6840 / 0.7182 / 0.9714/ [0.43333333 0.6625     0.97142857] 
                Val acc/f1/spec/sens = 0.7300 / 0.6601 / 0.8136 / 0.9756/ [0.33333333 0.68421053 0.97560976]
                Test acc/f1/spec/sens = 0.6261 / 0.4750 / 0.7213 / 0.9526/ [0.01273885 0.86206897 0.95258621]
 11%|█         | 11/100 [00:29<04:08,  2.79s/it] 12%|█▏        | 12/100 [00:32<04:05,  2.79s/it] 13%|█▎        | 13/100 [00:34<03:33,  2.45s/it] 14%|█▍        | 14/100 [00:36<03:37,  2.53s/it] 15%|█▌        | 15/100 [00:41<04:21,  3.08s/it]Epoch 15: Train acc/f1 = 0.5056 / 0.3697 / 1.0000 / 0.0714/ [0.2        1.         0.07142857] 
                Val acc/f1/spec/sens = 0.4900 / 0.3405 / 1.0000 / 0.2683/ [0.         1.         0.26829268]
                Test acc/f1/spec/sens = 0.1828 / 0.1066 / 0.9221 / 0.0000/ [0. 1. 0.]
 16%|█▌        | 16/100 [00:43<04:09,  2.98s/it] 17%|█▋        | 17/100 [00:45<03:33,  2.58s/it] 18%|█▊        | 18/100 [00:48<03:35,  2.63s/it] 19%|█▉        | 19/100 [00:49<03:07,  2.31s/it] 20%|██        | 20/100 [00:55<04:33,  3.41s/it]Epoch 20: Train acc/f1 = 0.9500 / 0.9327 / 0.9636 / 0.9571/ [0.86666667 0.975      0.95714286] 
                Val acc/f1/spec/sens = 0.9100 / 0.8886 / 0.9492 / 0.9512/ [0.71428571 0.97368421 0.95121951]
                Test acc/f1/spec/sens = 0.5777 / 0.4666 / 0.8689 / 0.8405/ [0.05732484 0.81609195 0.84051724]
 21%|██        | 21/100 [00:57<03:44,  2.84s/it] 22%|██▏       | 22/100 [01:00<03:48,  2.93s/it] 23%|██▎       | 23/100 [01:01<03:14,  2.52s/it] 24%|██▍       | 24/100 [01:04<03:17,  2.60s/it] 25%|██▌       | 25/100 [01:08<03:50,  3.08s/it]Epoch 25: Train acc/f1 = 0.9833 / 0.9770 / 0.9909 / 1.0000/ [0.96666667 0.975      1.        ] 
                Val acc/f1/spec/sens = 0.9100 / 0.8891 / 1.0000 / 0.9268/ [0.71428571 1.         0.92682927]
                Test acc/f1/spec/sens = 0.5462 / 0.4522 / 0.8689 / 0.7802/ [0.06369427 0.79310345 0.78017241]
 26%|██▌       | 26/100 [01:11<03:42,  3.01s/it] 27%|██▋       | 27/100 [01:13<03:06,  2.56s/it] 28%|██▊       | 28/100 [01:16<03:08,  2.62s/it] 29%|██▉       | 29/100 [01:17<02:43,  2.30s/it] 30%|███       | 30/100 [01:23<03:48,  3.27s/it]Epoch 30: Train acc/f1 = 0.9778 / 0.9701 / 1.0000 / 0.9714/ [1.         0.975      0.97142857] 
                Val acc/f1/spec/sens = 0.8800 / 0.8564 / 1.0000 / 0.9024/ [0.71428571 0.94736842 0.90243902]
                Test acc/f1/spec/sens = 0.5042 / 0.4383 / 0.9426 / 0.6466/ [0.07006369 0.90804598 0.64655172]
 31%|███       | 31/100 [01:24<03:10,  2.76s/it] 32%|███▏      | 32/100 [01:27<03:08,  2.77s/it] 33%|███▎      | 33/100 [01:29<02:41,  2.42s/it] 34%|███▍      | 34/100 [01:31<02:46,  2.53s/it] 35%|███▌      | 35/100 [01:36<03:18,  3.06s/it]Epoch 35: Train acc/f1 = 0.9889 / 0.9850 / 1.0000 / 1.0000/ [1.    0.975 1.   ] 
                Val acc/f1/spec/sens = 0.9000 / 0.8779 / 1.0000 / 0.9268/ [0.71428571 0.97368421 0.92682927]
                Test acc/f1/spec/sens = 0.5147 / 0.4444 / 0.9016 / 0.6810/ [0.07643312 0.86206897 0.68103448]
 36%|███▌      | 36/100 [01:39<03:10,  2.98s/it] 37%|███▋      | 37/100 [01:40<02:40,  2.55s/it] 38%|███▊      | 38/100 [01:43<02:41,  2.61s/it] 39%|███▉      | 39/100 [01:44<02:20,  2.30s/it] 40%|████      | 40/100 [01:50<03:14,  3.24s/it]Epoch 40: Train acc/f1 = 0.9944 / 0.9924 / 1.0000 / 1.0000/ [1.     0.9875 1.    ] 
                Val acc/f1/spec/sens = 0.9000 / 0.8774 / 0.9831 / 0.9512/ [0.71428571 0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.5315 / 0.4469 / 0.8607 / 0.7371/ [0.06369427 0.82758621 0.73706897]
 41%|████      | 41/100 [01:51<02:42,  2.75s/it] 42%|████▏     | 42/100 [01:54<02:39,  2.76s/it] 43%|████▎     | 43/100 [01:56<02:17,  2.42s/it] 44%|████▍     | 44/100 [01:59<02:21,  2.52s/it] 45%|████▌     | 45/100 [02:03<02:46,  3.03s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8806 / 0.9831 / 0.9268/ [0.71428571 0.97368421 0.92682927]
                Test acc/f1/spec/sens = 0.5336 / 0.4513 / 0.8934 / 0.7284/ [0.06369427 0.86206897 0.72844828]
 46%|████▌     | 46/100 [02:06<02:40,  2.98s/it] 47%|████▋     | 47/100 [02:07<02:16,  2.57s/it] 48%|████▊     | 48/100 [02:10<02:17,  2.64s/it] 49%|████▉     | 49/100 [02:12<01:58,  2.32s/it] 50%|█████     | 50/100 [02:17<02:45,  3.31s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8694 / 0.9831 / 0.9268/ [0.71428571 0.94736842 0.92682927]
                Test acc/f1/spec/sens = 0.5399 / 0.4543 / 0.8811 / 0.7414/ [0.06369427 0.86206897 0.74137931]
 51%|█████     | 51/100 [02:19<02:16,  2.78s/it] 52%|█████▏    | 52/100 [02:22<02:14,  2.79s/it] 53%|█████▎    | 53/100 [02:23<01:53,  2.42s/it] 54%|█████▍    | 54/100 [02:26<01:55,  2.51s/it] 55%|█████▌    | 55/100 [02:30<02:16,  3.03s/it]Epoch 55: Train acc/f1 = 0.9944 / 0.9924 / 1.0000 / 1.0000/ [1.     0.9875 1.    ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8694 / 0.9831 / 0.9268/ [0.71428571 0.94736842 0.92682927]
                Test acc/f1/spec/sens = 0.5441 / 0.4568 / 0.8811 / 0.7500/ [0.06369427 0.86206897 0.75      ]
 56%|█████▌    | 56/100 [02:33<02:11,  2.98s/it] 57%|█████▋    | 57/100 [02:35<01:50,  2.56s/it] 58%|█████▊    | 58/100 [02:37<01:51,  2.64s/it] 59%|█████▉    | 59/100 [02:39<01:35,  2.32s/it] 60%|██████    | 60/100 [02:45<02:12,  3.31s/it]Epoch 60: Train acc/f1 = 0.9944 / 0.9924 / 1.0000 / 1.0000/ [1.     0.9875 1.    ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8694 / 0.9831 / 0.9268/ [0.71428571 0.94736842 0.92682927]
                Test acc/f1/spec/sens = 0.5126 / 0.4405 / 0.8893 / 0.6810/ [0.07006369 0.86206897 0.68103448]
 61%|██████    | 61/100 [02:46<01:48,  2.77s/it] 62%|██████▏   | 62/100 [02:49<01:44,  2.76s/it] 63%|██████▎   | 63/100 [02:50<01:28,  2.40s/it] 64%|██████▍   | 64/100 [02:53<01:29,  2.49s/it] 65%|██████▌   | 65/100 [02:57<01:45,  3.02s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8694 / 0.9831 / 0.9268/ [0.71428571 0.94736842 0.92682927]
                Test acc/f1/spec/sens = 0.5294 / 0.4517 / 0.9016 / 0.6983/ [0.06369427 0.91954023 0.69827586]
 66%|██████▌   | 66/100 [03:00<01:40,  2.95s/it] 67%|██████▋   | 67/100 [03:02<01:24,  2.56s/it] 68%|██████▊   | 68/100 [03:05<01:24,  2.63s/it] 69%|██████▉   | 69/100 [03:06<01:11,  2.32s/it] 70%|███████   | 70/100 [03:12<01:37,  3.26s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8774 / 0.9831 / 0.9512/ [0.71428571 0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.5231 / 0.4444 / 0.8648 / 0.7155/ [0.07006369 0.82758621 0.71551724]
 71%|███████   | 71/100 [03:13<01:19,  2.75s/it] 72%|███████▏  | 72/100 [03:16<01:17,  2.77s/it] 73%|███████▎  | 73/100 [03:18<01:04,  2.40s/it] 74%|███████▍  | 74/100 [03:20<01:05,  2.53s/it] 75%|███████▌  | 75/100 [03:25<01:16,  3.06s/it]Epoch 75: Train acc/f1 = 0.9944 / 0.9924 / 1.0000 / 1.0000/ [1.     0.9875 1.    ] 
                Val acc/f1/spec/sens = 0.9000 / 0.8806 / 0.9831 / 0.9268/ [0.71428571 0.97368421 0.92682927]
                Test acc/f1/spec/sens = 0.5210 / 0.4455 / 0.8852 / 0.6983/ [0.07006369 0.86206897 0.69827586]
 76%|███████▌  | 76/100 [03:27<01:11,  2.96s/it] 77%|███████▋  | 77/100 [03:29<00:58,  2.54s/it] 78%|███████▊  | 78/100 [03:32<00:57,  2.60s/it] 79%|███████▉  | 79/100 [03:33<00:48,  2.31s/it] 80%|████████  | 80/100 [03:39<01:05,  3.27s/it]Epoch 80: Train acc/f1 = 0.9944 / 0.9924 / 1.0000 / 1.0000/ [1.     0.9875 1.    ] 
                Val acc/f1/spec/sens = 0.9100 / 0.8887 / 0.9831 / 0.9512/ [0.71428571 0.97368421 0.95121951]
                Test acc/f1/spec/sens = 0.5336 / 0.4486 / 0.8607 / 0.7414/ [0.06369427 0.82758621 0.74137931]
 81%|████████  | 81/100 [03:41<00:52,  2.77s/it] 82%|████████▏ | 82/100 [03:43<00:49,  2.78s/it] 83%|████████▎ | 83/100 [03:45<00:41,  2.42s/it] 84%|████████▍ | 84/100 [03:48<00:40,  2.50s/it] 85%|████████▌ | 85/100 [03:52<00:45,  3.04s/it]Epoch 85: Train acc/f1 = 0.9944 / 0.9924 / 1.0000 / 1.0000/ [1.     0.9875 1.    ] 
                Val acc/f1/spec/sens = 0.9000 / 0.8779 / 1.0000 / 0.9268/ [0.71428571 0.97368421 0.92682927]
                Test acc/f1/spec/sens = 0.5231 / 0.4480 / 0.8893 / 0.6940/ [0.07006369 0.88505747 0.69396552]
 86%|████████▌ | 86/100 [03:55<00:41,  2.97s/it] 87%|████████▋ | 87/100 [03:56<00:33,  2.55s/it] 88%|████████▊ | 88/100 [03:59<00:31,  2.59s/it] 89%|████████▉ | 89/100 [04:01<00:25,  2.30s/it] 90%|█████████ | 90/100 [04:06<00:32,  3.26s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8694 / 0.9831 / 0.9268/ [0.71428571 0.94736842 0.92682927]
                Test acc/f1/spec/sens = 0.5210 / 0.4420 / 0.8689 / 0.7069/ [0.06369427 0.85057471 0.70689655]
 91%|█████████ | 91/100 [04:08<00:24,  2.76s/it] 92%|█████████▏| 92/100 [04:11<00:22,  2.78s/it] 93%|█████████▎| 93/100 [04:12<00:16,  2.41s/it] 94%|█████████▍| 94/100 [04:15<00:15,  2.51s/it] 95%|█████████▌| 95/100 [04:19<00:15,  3.00s/it]Epoch 95: Train acc/f1 = 0.9944 / 0.9924 / 1.0000 / 1.0000/ [1.     0.9875 1.    ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8694 / 0.9831 / 0.9268/ [0.71428571 0.94736842 0.92682927]
                Test acc/f1/spec/sens = 0.5084 / 0.4355 / 0.8730 / 0.6853/ [0.07006369 0.82758621 0.68534483]
 96%|█████████▌| 96/100 [04:22<00:11,  2.94s/it] 97%|█████████▋| 97/100 [04:23<00:07,  2.53s/it] 98%|█████████▊| 98/100 [04:26<00:05,  2.63s/it] 99%|█████████▉| 99/100 [04:28<00:02,  2.31s/it]100%|██████████| 100/100 [04:33<00:00,  3.26s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8806 / 0.9831 / 0.9268/ [0.71428571 0.97368421 0.92682927]
                Test acc/f1/spec/sens = 0.5378 / 0.4538 / 0.8811 / 0.7371/ [0.06369427 0.86206897 0.73706897]
Trial 3, Cycle 1
Train acc/f1/spec/sens = 0.9944 / 0.9924 / 1.0000 / 1.0000/ [1.     0.9875 1.    ]
Val acc/f1/spec/sens = 0.9000 / 0.8806 / 0.9831 / 0.9268/ [0.71428571 0.97368421 0.92682927]
Test acc/f1/spec/sens = 0.5378 / 0.4538 / 0.8811 / 0.7371/ [0.06369427 0.86206897 0.73706897]
>> Finished.
Acc, agreement for latest model:  0.5378151260504201 0.6092436974789915 [0.06369427 0.86206897 0.73706897]
Load best checkpoint for thief model
Acc, agreement for best model:  0.5336134453781513 0.5945378151260504 [0.17197452 0.75862069 0.69396552]
Trial 2/5 || Cycle 1/5 || Label set size 180 || Test acc 0.5336 || Test agreement 0.5945 || Spec 0.8934 || Sens 0.6940 Class Acc: [0.17197452 0.75862069 0.69396552]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.63s/it]100%|██████████| 2/2 [00:12<00:00,  5.27s/it]100%|██████████| 2/2 [00:13<00:00,  6.52s/it]
Maximum distance from cluster centers is 0.41
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.44it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.99it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.29it/s] 83%|████████▎ | 10/12 [00:01<00:00, 14.07it/s]100%|██████████| 12/12 [00:01<00:00,  8.81it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 31, 1: 93, 2: 56}
Validation set distribution: 
Number of samples  100
{0: 21, 1: 38, 2: 41}
Labeled set distribution: 
Number of samples  360
{0: 61, 1: 173, 2: 126}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.1282, agreement = 0.1555, f1 = 0.1089, spec = 0.4590, sens = 0.0259 Class Acc: [0.         0.63218391 0.02586207]
Initial model on validation dataset: acc = 0.3700, agreement = 0.3700, f1 = 0.1800, spec = 0.9831, sens = 0.0000 Class Acc: [0.         0.97368421 0.        ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<03:29,  2.12s/it]  2%|▏         | 2/100 [00:05<04:43,  2.90s/it]  3%|▎         | 3/100 [00:07<04:09,  2.57s/it]  4%|▍         | 4/100 [00:11<04:46,  2.98s/it]  5%|▌         | 5/100 [00:16<06:02,  3.81s/it]Epoch 5: Train acc/f1 = 0.9028 / 0.8842 / 1.0000 / 0.8333/ [0.80327869 0.98843931 0.83333333] 
                Val acc/f1/spec/sens = 0.8700 / 0.8261 / 0.9153 / 0.9512/ [0.52380952 0.97368421 0.95121951]
                Test acc/f1/spec/sens = 0.6050 / 0.4894 / 0.9180 / 0.8362/ [0.04458599 1.         0.8362069 ]
  6%|▌         | 6/100 [00:20<05:55,  3.78s/it]  7%|▋         | 7/100 [00:22<05:01,  3.24s/it]  8%|▊         | 8/100 [00:25<05:01,  3.27s/it]  9%|▉         | 9/100 [00:27<04:24,  2.91s/it] 10%|█         | 10/100 [00:34<06:04,  4.05s/it]Epoch 10: Train acc/f1 = 0.9250 / 0.9048 / 0.9316 / 0.9762/ [0.80327869 0.93063584 0.97619048] 
                Val acc/f1/spec/sens = 0.8700 / 0.8438 / 0.8983 / 0.9756/ [0.71428571 0.84210526 0.97560976]
                Test acc/f1/spec/sens = 0.6492 / 0.5485 / 0.5410 / 0.9741/ [0.13375796 0.71264368 0.97413793]
 11%|█         | 11/100 [00:36<05:07,  3.46s/it] 12%|█▏        | 12/100 [00:39<05:00,  3.41s/it] 13%|█▎        | 13/100 [00:42<04:21,  3.01s/it] 14%|█▍        | 14/100 [00:45<04:24,  3.08s/it] 15%|█▌        | 15/100 [00:50<05:17,  3.73s/it]Epoch 15: Train acc/f1 = 0.9583 / 0.9446 / 1.0000 / 0.9524/ [0.85245902 1.         0.95238095] 
                Val acc/f1/spec/sens = 0.8500 / 0.8054 / 0.9153 / 0.9024/ [0.52380952 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4685 / 0.4112 / 0.9959 / 0.5431/ [0.06369427 1.         0.54310345]
 16%|█▌        | 16/100 [00:54<05:10,  3.70s/it] 17%|█▋        | 17/100 [00:56<04:26,  3.21s/it] 18%|█▊        | 18/100 [00:59<04:25,  3.23s/it] 19%|█▉        | 19/100 [01:01<03:53,  2.88s/it] 20%|██        | 20/100 [01:08<05:16,  3.95s/it]Epoch 20: Train acc/f1 = 0.9167 / 0.9196 / 0.8846 / 1.0000/ [0.91803279 0.85549133 1.        ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8776 / 0.8814 / 0.9756/ [0.80952381 0.84210526 0.97560976]
                Test acc/f1/spec/sens = 0.4013 / 0.3342 / 0.3852 / 0.5474/ [0.05095541 0.64367816 0.54741379]
 21%|██        | 21/100 [01:10<04:27,  3.38s/it] 22%|██▏       | 22/100 [01:13<04:30,  3.47s/it] 23%|██▎       | 23/100 [01:15<03:55,  3.06s/it] 24%|██▍       | 24/100 [01:19<03:56,  3.11s/it] 25%|██▌       | 25/100 [01:24<04:41,  3.76s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.3298 / 0.2905 / 0.7910 / 0.3319/ [0.05732484 0.81609195 0.33189655]
 26%|██▌       | 26/100 [01:27<04:28,  3.63s/it] 27%|██▋       | 27/100 [01:29<03:51,  3.17s/it] 28%|██▊       | 28/100 [01:32<03:48,  3.18s/it] 29%|██▉       | 29/100 [01:35<03:22,  2.85s/it] 30%|███       | 30/100 [01:41<04:37,  3.97s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.3824 / 0.3348 / 0.8156 / 0.4267/ [0.06369427 0.83908046 0.42672414]
 31%|███       | 31/100 [01:43<03:56,  3.42s/it] 32%|███▏      | 32/100 [01:47<03:50,  3.39s/it] 33%|███▎      | 33/100 [01:49<03:22,  3.02s/it] 34%|███▍      | 34/100 [01:52<03:23,  3.08s/it] 35%|███▌      | 35/100 [01:57<04:03,  3.74s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.3697 / 0.3258 / 0.8279 / 0.3922/ [0.06369427 0.86206897 0.39224138]
 36%|███▌      | 36/100 [02:01<03:52,  3.63s/it] 37%|███▋      | 37/100 [02:03<03:20,  3.17s/it] 38%|███▊      | 38/100 [02:06<03:19,  3.21s/it] 39%|███▉      | 39/100 [02:08<02:56,  2.90s/it] 40%|████      | 40/100 [02:15<03:58,  3.97s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.3908 / 0.3402 / 0.8402 / 0.4310/ [0.05732484 0.88505747 0.43103448]
 41%|████      | 41/100 [02:17<03:20,  3.41s/it] 42%|████▏     | 42/100 [02:20<03:16,  3.39s/it] 43%|████▎     | 43/100 [02:22<02:51,  3.00s/it] 44%|████▍     | 44/100 [02:26<02:53,  3.11s/it] 45%|████▌     | 45/100 [02:31<03:26,  3.75s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.3845 / 0.3382 / 0.9057 / 0.3966/ [0.05732484 0.94252874 0.39655172]
 46%|████▌     | 46/100 [02:34<03:16,  3.63s/it] 47%|████▋     | 47/100 [02:36<02:48,  3.17s/it] 48%|████▊     | 48/100 [02:40<02:45,  3.19s/it] 49%|████▉     | 49/100 [02:42<02:25,  2.86s/it] 50%|█████     | 50/100 [02:48<03:16,  3.93s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.4097 / 0.3542 / 0.8402 / 0.4741/ [0.05732484 0.87356322 0.47413793]
 51%|█████     | 51/100 [02:50<02:45,  3.38s/it] 52%|█████▏    | 52/100 [02:53<02:41,  3.36s/it] 53%|█████▎    | 53/100 [02:56<02:20,  2.98s/it] 54%|█████▍    | 54/100 [02:59<02:22,  3.10s/it] 55%|█████▌    | 55/100 [03:04<02:48,  3.74s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.3950 / 0.3463 / 0.9098 / 0.4181/ [0.05732484 0.94252874 0.41810345]
 56%|█████▌    | 56/100 [03:08<02:39,  3.63s/it] 57%|█████▋    | 57/100 [03:10<02:17,  3.19s/it] 58%|█████▊    | 58/100 [03:13<02:14,  3.21s/it] 59%|█████▉    | 59/100 [03:15<01:57,  2.87s/it] 60%|██████    | 60/100 [03:21<02:37,  3.93s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.4244 / 0.3654 / 0.8443 / 0.5000/ [0.05732484 0.88505747 0.5       ]
 61%|██████    | 61/100 [03:23<02:11,  3.37s/it] 62%|██████▏   | 62/100 [03:27<02:07,  3.34s/it] 63%|██████▎   | 63/100 [03:29<01:50,  2.97s/it] 64%|██████▍   | 64/100 [03:32<01:49,  3.05s/it] 65%|██████▌   | 65/100 [03:37<02:10,  3.72s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.4349 / 0.3748 / 0.8279 / 0.5216/ [0.06369427 0.87356322 0.52155172]
 66%|██████▌   | 66/100 [03:41<02:02,  3.60s/it] 67%|██████▋   | 67/100 [03:43<01:44,  3.16s/it] 68%|██████▊   | 68/100 [03:46<01:43,  3.24s/it] 69%|██████▉   | 69/100 [03:48<01:30,  2.90s/it] 70%|███████   | 70/100 [03:55<01:59,  3.97s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.4055 / 0.3509 / 0.8402 / 0.4612/ [0.05732484 0.88505747 0.4612069 ]
 71%|███████   | 71/100 [03:57<01:38,  3.40s/it] 72%|███████▏  | 72/100 [04:00<01:35,  3.40s/it] 73%|███████▎  | 73/100 [04:02<01:21,  3.01s/it] 74%|███████▍  | 74/100 [04:06<01:20,  3.10s/it] 75%|███████▌  | 75/100 [04:11<01:33,  3.75s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.3971 / 0.3440 / 0.8197 / 0.4526/ [0.05732484 0.86206897 0.45258621]
 76%|███████▌  | 76/100 [04:14<01:27,  3.64s/it] 77%|███████▋  | 77/100 [04:17<01:13,  3.19s/it] 78%|███████▊  | 78/100 [04:20<01:10,  3.21s/it] 79%|███████▉  | 79/100 [04:22<01:00,  2.88s/it] 80%|████████  | 80/100 [04:28<01:18,  3.94s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.4391 / 0.3743 / 0.8197 / 0.5388/ [0.05732484 0.86206897 0.5387931 ]
 81%|████████  | 81/100 [04:30<01:04,  3.38s/it] 82%|████████▏ | 82/100 [04:34<01:00,  3.36s/it] 83%|████████▎ | 83/100 [04:36<00:50,  2.99s/it] 84%|████████▍ | 84/100 [04:39<00:49,  3.07s/it] 85%|████████▌ | 85/100 [04:44<00:55,  3.73s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.4349 / 0.3735 / 0.8525 / 0.5129/ [0.05732484 0.90804598 0.51293103]
 86%|████████▌ | 86/100 [04:48<00:50,  3.61s/it] 87%|████████▋ | 87/100 [04:50<00:41,  3.18s/it] 88%|████████▊ | 88/100 [04:53<00:39,  3.25s/it] 89%|████████▉ | 89/100 [04:55<00:32,  2.92s/it] 90%|█████████ | 90/100 [05:02<00:39,  3.97s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9179 / 1.0000 / 0.9268/ [0.9047619  0.94736842 0.92682927]
                Test acc/f1/spec/sens = 0.3803 / 0.3344 / 0.9057 / 0.3879/ [0.05732484 0.94252874 0.38793103]
 91%|█████████ | 91/100 [05:04<00:30,  3.42s/it] 92%|█████████▏| 92/100 [05:07<00:27,  3.40s/it] 93%|█████████▎| 93/100 [05:09<00:21,  3.01s/it] 94%|█████████▍| 94/100 [05:13<00:18,  3.11s/it] 95%|█████████▌| 95/100 [05:18<00:18,  3.78s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9179 / 1.0000 / 0.9268/ [0.9047619  0.94736842 0.92682927]
                Test acc/f1/spec/sens = 0.4013 / 0.3529 / 0.8811 / 0.4353/ [0.06369427 0.91954023 0.43534483]
 96%|█████████▌| 96/100 [05:21<00:14,  3.65s/it] 97%|█████████▋| 97/100 [05:24<00:09,  3.17s/it] 98%|█████████▊| 98/100 [05:27<00:06,  3.19s/it] 99%|█████████▉| 99/100 [05:29<00:02,  2.87s/it]100%|██████████| 100/100 [05:35<00:00,  3.92s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.4286 / 0.3690 / 0.8525 / 0.5000/ [0.05732484 0.90804598 0.5       ]
Trial 3, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9400 / 0.9287 / 1.0000 / 0.9512/ [0.9047619  0.94736842 0.95121951]
Test acc/f1/spec/sens = 0.4286 / 0.3690 / 0.8525 / 0.5000/ [0.05732484 0.90804598 0.5       ]
>> Finished.
Acc, agreement for latest model:  0.42857142857142855 0.4789915966386555 [0.05732484 0.90804598 0.5       ]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3088235294117647 0.36134453781512604 [0.06369427 0.81609195 0.28448276]
Trial 2/5 || Cycle 2/5 || Label set size 360 || Test acc 0.3088 || Test agreement 0.3613 || Spec 0.7828 || Sens 0.2845 Class Acc: [0.06369427 0.81609195 0.28448276]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.28s/it]100%|██████████| 2/2 [00:12<00:00,  5.13s/it]100%|██████████| 2/2 [00:12<00:00,  6.34s/it]
Maximum distance from cluster centers is 0.55
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.34it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.14it/s] 67%|██████▋   | 8/12 [00:01<00:00,  9.88it/s]100%|██████████| 12/12 [00:01<00:00,  8.68it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 40, 1: 81, 2: 59}
Validation set distribution: 
Number of samples  100
{0: 21, 1: 38, 2: 41}
Labeled set distribution: 
Number of samples  540
{0: 101, 1: 254, 2: 185}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.2710, agreement = 0.2500, f1 = 0.1534, spec = 0.9057, sens = 0.0216 Class Acc: [0.78980892 0.         0.02155172]
Initial model on validation dataset: acc = 0.2300, agreement = 0.2300, f1 = 0.1933, spec = 0.7797, sens = 0.1220 Class Acc: [0.80952381 0.02631579 0.12195122]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:15,  2.58s/it]  2%|▏         | 2/100 [00:06<05:35,  3.43s/it]  3%|▎         | 3/100 [00:09<04:54,  3.03s/it]  4%|▍         | 4/100 [00:13<05:33,  3.48s/it]  5%|▌         | 5/100 [00:19<07:10,  4.53s/it]Epoch 5: Train acc/f1 = 0.8204 / 0.8005 / 0.9211 / 0.8486/ [0.83168317 0.79527559 0.84864865] 
                Val acc/f1/spec/sens = 0.8700 / 0.8371 / 0.9322 / 0.9268/ [0.61904762 0.94736842 0.92682927]
                Test acc/f1/spec/sens = 0.2374 / 0.2653 / 0.6967 / 0.1034/ [0.33757962 0.4137931  0.10344828]
  6%|▌         | 6/100 [00:23<06:56,  4.43s/it]  7%|▋         | 7/100 [00:26<05:57,  3.85s/it]  8%|▊         | 8/100 [00:30<05:52,  3.83s/it]  9%|▉         | 9/100 [00:33<05:16,  3.48s/it] 10%|█         | 10/100 [00:41<07:19,  4.88s/it]Epoch 10: Train acc/f1 = 0.9444 / 0.9315 / 0.9831 / 0.9243/ [0.94059406 0.96062992 0.92432432] 
                Val acc/f1/spec/sens = 0.9400 / 0.9250 / 1.0000 / 0.9512/ [0.80952381 1.         0.95121951]
                Test acc/f1/spec/sens = 0.5693 / 0.5219 / 0.8074 / 0.6983/ [0.17834395 0.93103448 0.69827586]
 11%|█         | 11/100 [00:43<06:13,  4.20s/it] 12%|█▏        | 12/100 [00:47<06:01,  4.11s/it] 13%|█▎        | 13/100 [00:50<05:17,  3.65s/it] 14%|█▍        | 14/100 [00:54<05:19,  3.71s/it] 15%|█▌        | 15/100 [01:00<06:22,  4.50s/it]Epoch 15: Train acc/f1 = 0.9537 / 0.9420 / 0.9746 / 0.9459/ [0.88118812 0.98818898 0.94594595] 
                Val acc/f1/spec/sens = 0.9000 / 0.8748 / 0.9661 / 0.9512/ [0.71428571 0.94736842 0.95121951]
                Test acc/f1/spec/sens = 0.5546 / 0.4610 / 0.7459 / 0.7414/ [0.06369427 0.94252874 0.74137931]
 16%|█▌        | 16/100 [01:04<06:02,  4.32s/it] 17%|█▋        | 17/100 [01:06<05:16,  3.81s/it] 18%|█▊        | 18/100 [01:10<05:13,  3.82s/it] 19%|█▉        | 19/100 [01:13<04:40,  3.46s/it] 20%|██        | 20/100 [01:21<06:17,  4.72s/it]Epoch 20: Train acc/f1 = 0.9833 / 0.9808 / 0.9944 / 0.9784/ [0.98019802 0.98818898 0.97837838] 
                Val acc/f1/spec/sens = 0.9100 / 0.8939 / 0.9831 / 0.9512/ [0.80952381 0.92105263 0.95121951]
                Test acc/f1/spec/sens = 0.4328 / 0.4044 / 0.8893 / 0.4828/ [0.07643312 0.94252874 0.48275862]
 21%|██        | 21/100 [01:23<05:24,  4.11s/it] 22%|██▏       | 22/100 [01:27<05:13,  4.02s/it] 23%|██▎       | 23/100 [01:30<04:35,  3.58s/it] 24%|██▍       | 24/100 [01:33<04:36,  3.64s/it] 25%|██▌       | 25/100 [01:40<05:35,  4.47s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9085 / 1.0000 / 0.9268/ [0.80952381 0.97368421 0.92682927]
                Test acc/f1/spec/sens = 0.5357 / 0.4489 / 0.7459 / 0.7672/ [0.05732484 0.7816092  0.76724138]
 26%|██▌       | 26/100 [01:44<05:18,  4.31s/it] 27%|██▋       | 27/100 [01:46<04:36,  3.78s/it] 28%|██▊       | 28/100 [01:50<04:32,  3.79s/it] 29%|██▉       | 29/100 [01:53<04:05,  3.45s/it] 30%|███       | 30/100 [02:00<05:28,  4.69s/it]Epoch 30: Train acc/f1 = 0.9981 / 0.9975 / 1.0000 / 0.9946/ [1.         1.         0.99459459] 
                Val acc/f1/spec/sens = 0.9300 / 0.9144 / 0.9831 / 0.9512/ [0.76190476 1.         0.95121951]
                Test acc/f1/spec/sens = 0.5462 / 0.4600 / 0.7869 / 0.7586/ [0.05732484 0.86206897 0.75862069]
 31%|███       | 31/100 [02:03<04:43,  4.10s/it] 32%|███▏      | 32/100 [02:07<04:34,  4.03s/it] 33%|███▎      | 33/100 [02:10<04:03,  3.64s/it] 34%|███▍      | 34/100 [02:14<04:10,  3.79s/it] 35%|███▌      | 35/100 [02:20<04:58,  4.59s/it]Epoch 35: Train acc/f1 = 0.9981 / 0.9975 / 1.0000 / 0.9946/ [1.         1.         0.99459459] 
                Val acc/f1/spec/sens = 0.9400 / 0.9284 / 1.0000 / 0.9512/ [0.80952381 1.         0.95121951]
                Test acc/f1/spec/sens = 0.5294 / 0.4507 / 0.7664 / 0.7284/ [0.05732484 0.85057471 0.72844828]
 36%|███▌      | 36/100 [02:24<04:38,  4.36s/it] 37%|███▋      | 37/100 [02:27<04:03,  3.86s/it] 38%|███▊      | 38/100 [02:31<03:59,  3.86s/it] 39%|███▉      | 39/100 [02:33<03:33,  3.50s/it] 40%|████      | 40/100 [02:41<04:46,  4.77s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.5168 / 0.4453 / 0.7828 / 0.6983/ [0.05732484 0.86206897 0.69827586]
 41%|████      | 41/100 [02:44<04:02,  4.11s/it] 42%|████▏     | 42/100 [02:48<03:53,  4.03s/it] 43%|████▎     | 43/100 [02:50<03:26,  3.62s/it] 44%|████▍     | 44/100 [02:54<03:25,  3.67s/it] 45%|████▌     | 45/100 [03:00<04:06,  4.48s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.5210 / 0.4448 / 0.7664 / 0.7198/ [0.05732484 0.82758621 0.71982759]
 46%|████▌     | 46/100 [03:04<03:52,  4.31s/it] 47%|████▋     | 47/100 [03:07<03:21,  3.81s/it] 48%|████▊     | 48/100 [03:11<03:17,  3.80s/it] 49%|████▉     | 49/100 [03:13<02:56,  3.46s/it] 50%|█████     | 50/100 [03:21<03:53,  4.67s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.4601 / 0.4145 / 0.7828 / 0.5819/ [0.05732484 0.86206897 0.58189655]
 51%|█████     | 51/100 [03:23<03:19,  4.07s/it] 52%|█████▏    | 52/100 [03:27<03:11,  3.99s/it] 53%|█████▎    | 53/100 [03:30<02:49,  3.60s/it] 54%|█████▍    | 54/100 [03:34<02:48,  3.67s/it] 55%|█████▌    | 55/100 [03:40<03:22,  4.49s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.5168 / 0.4467 / 0.7910 / 0.6897/ [0.05732484 0.88505747 0.68965517]
 56%|█████▌    | 56/100 [03:44<03:08,  4.29s/it] 57%|█████▋    | 57/100 [03:47<02:43,  3.80s/it] 58%|█████▊    | 58/100 [03:51<02:40,  3.81s/it] 59%|█████▉    | 59/100 [03:53<02:21,  3.46s/it] 60%|██████    | 60/100 [04:01<03:06,  4.67s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.5210 / 0.4448 / 0.7664 / 0.7198/ [0.05732484 0.82758621 0.71982759]
 61%|██████    | 61/100 [04:03<02:38,  4.06s/it] 62%|██████▏   | 62/100 [04:07<02:30,  3.97s/it] 63%|██████▎   | 63/100 [04:10<02:13,  3.60s/it] 64%|██████▍   | 64/100 [04:14<02:11,  3.66s/it] 65%|██████▌   | 65/100 [04:20<02:35,  4.43s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9085 / 1.0000 / 0.9268/ [0.80952381 0.97368421 0.92682927]
                Test acc/f1/spec/sens = 0.4643 / 0.4141 / 0.7623 / 0.6078/ [0.05732484 0.81609195 0.60775862]
 66%|██████▌   | 66/100 [04:24<02:24,  4.25s/it] 67%|██████▋   | 67/100 [04:26<02:05,  3.79s/it] 68%|██████▊   | 68/100 [04:30<02:01,  3.81s/it] 69%|██████▉   | 69/100 [04:33<01:46,  3.44s/it] 70%|███████   | 70/100 [04:40<02:19,  4.65s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.5378 / 0.4541 / 0.7623 / 0.7500/ [0.05732484 0.83908046 0.75      ]
 71%|███████   | 71/100 [04:43<01:57,  4.06s/it] 72%|███████▏  | 72/100 [04:47<01:53,  4.04s/it] 73%|███████▎  | 73/100 [04:50<01:37,  3.60s/it] 74%|███████▍  | 74/100 [04:53<01:35,  3.67s/it] 75%|███████▌  | 75/100 [05:00<01:53,  4.52s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.5294 / 0.4490 / 0.7664 / 0.7371/ [0.05732484 0.82758621 0.73706897]
 76%|███████▌  | 76/100 [05:04<01:43,  4.33s/it] 77%|███████▋  | 77/100 [05:07<01:28,  3.87s/it] 78%|███████▊  | 78/100 [05:10<01:24,  3.86s/it] 79%|███████▉  | 79/100 [05:13<01:13,  3.49s/it] 80%|████████  | 80/100 [05:21<01:34,  4.74s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.4580 / 0.4105 / 0.7664 / 0.5948/ [0.05732484 0.81609195 0.59482759]
 81%|████████  | 81/100 [05:23<01:18,  4.15s/it] 82%|████████▏ | 82/100 [05:27<01:12,  4.04s/it] 83%|████████▎ | 83/100 [05:30<01:02,  3.65s/it] 84%|████████▍ | 84/100 [05:34<00:58,  3.69s/it] 85%|████████▌ | 85/100 [05:40<01:08,  4.54s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.4937 / 0.4310 / 0.7623 / 0.6638/ [0.05732484 0.82758621 0.6637931 ]
 86%|████████▌ | 86/100 [05:44<01:00,  4.33s/it] 87%|████████▋ | 87/100 [05:47<00:50,  3.87s/it] 88%|████████▊ | 88/100 [05:51<00:46,  3.84s/it] 89%|████████▉ | 89/100 [05:53<00:38,  3.48s/it] 90%|█████████ | 90/100 [06:01<00:46,  4.69s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.5294 / 0.4469 / 0.7582 / 0.7457/ [0.05732484 0.8045977  0.74568966]
 91%|█████████ | 91/100 [06:04<00:36,  4.10s/it] 92%|█████████▏| 92/100 [06:07<00:32,  4.02s/it] 93%|█████████▎| 93/100 [06:10<00:25,  3.60s/it] 94%|█████████▍| 94/100 [06:14<00:22,  3.69s/it] 95%|█████████▌| 95/100 [06:20<00:22,  4.50s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.4790 / 0.4217 / 0.7623 / 0.6422/ [0.05732484 0.8045977  0.64224138]
 96%|█████████▌| 96/100 [06:24<00:17,  4.29s/it] 97%|█████████▋| 97/100 [06:27<00:11,  3.81s/it] 98%|█████████▊| 98/100 [06:31<00:07,  3.82s/it] 99%|█████████▉| 99/100 [06:33<00:03,  3.46s/it]100%|██████████| 100/100 [06:41<00:00,  4.73s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.5357 / 0.4521 / 0.7664 / 0.7500/ [0.05732484 0.82758621 0.75      ]
Trial 3, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9300 / 0.9202 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
Test acc/f1/spec/sens = 0.5357 / 0.4521 / 0.7664 / 0.7500/ [0.05732484 0.82758621 0.75      ]
>> Finished.
Acc, agreement for latest model:  0.5357142857142857 0.5609243697478992 [0.05732484 0.82758621 0.75      ]
Load best checkpoint for thief model
Acc, agreement for best model:  0.5126050420168067 0.5294117647058824 [0.05732484 0.85057471 0.69396552]
Trial 2/5 || Cycle 3/5 || Label set size 540 || Test acc 0.5126 || Test agreement 0.5294 || Spec 0.7664 || Sens 0.6940 Class Acc: [0.05732484 0.85057471 0.69396552]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.32s/it]100%|██████████| 2/2 [00:12<00:00,  5.14s/it]100%|██████████| 2/2 [00:12<00:00,  6.37s/it]
Maximum distance from cluster centers is 0.46
labeled set:  720
unlabeled set:  713
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.41it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.69it/s] 67%|██████▋   | 8/12 [00:01<00:00, 11.02it/s]100%|██████████| 12/12 [00:01<00:00,  8.98it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 35, 1: 85, 2: 60}
Validation set distribution: 
Number of samples  100
{0: 21, 1: 38, 2: 41}
Labeled set distribution: 
Number of samples  720
{0: 136, 1: 339, 2: 245}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.4601, agreement = 0.4643, f1 = 0.3336, spec = 0.5451, sens = 0.7802 Class Acc: [0.03184713 0.37931034 0.78017241]
Initial model on validation dataset: acc = 0.4600, agreement = 0.4600, f1 = 0.2785, spec = 0.0847, sens = 1.0000 Class Acc: [0.         0.13157895 1.        ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:14,  3.18s/it]  2%|▏         | 2/100 [00:07<06:25,  3.94s/it]  3%|▎         | 3/100 [00:10<05:49,  3.60s/it]  4%|▍         | 4/100 [00:15<06:30,  4.07s/it]  5%|▌         | 5/100 [00:23<08:21,  5.28s/it]Epoch 5: Train acc/f1 = 0.8708 / 0.8612 / 0.8905 / 0.9429/ [0.85294118 0.8259587  0.94285714] 
                Val acc/f1/spec/sens = 0.8600 / 0.8156 / 0.9492 / 0.9024/ [0.52380952 1.         0.90243902]
                Test acc/f1/spec/sens = 0.6050 / 0.4880 / 0.6803 / 0.9095/ [0.07006369 0.75862069 0.90948276]
  6%|▌         | 6/100 [00:27<07:42,  4.92s/it]  7%|▋         | 7/100 [00:30<06:45,  4.36s/it]  8%|▊         | 8/100 [00:35<06:50,  4.46s/it]  9%|▉         | 9/100 [00:38<06:10,  4.07s/it] 10%|█         | 10/100 [00:46<08:11,  5.46s/it]Epoch 10: Train acc/f1 = 0.9569 / 0.9493 / 0.9853 / 0.9429/ [0.97058824 0.96165192 0.94285714] 
                Val acc/f1/spec/sens = 0.9000 / 0.8836 / 1.0000 / 0.8780/ [0.80952381 0.97368421 0.87804878]
                Test acc/f1/spec/sens = 0.5756 / 0.4780 / 0.8607 / 0.7931/ [0.05732484 0.93103448 0.79310345]
 11%|█         | 11/100 [00:50<07:05,  4.78s/it] 12%|█▏        | 12/100 [00:54<06:48,  4.64s/it] 13%|█▎        | 13/100 [00:57<06:04,  4.19s/it] 14%|█▍        | 14/100 [01:02<06:09,  4.30s/it] 15%|█▌        | 15/100 [01:09<07:24,  5.22s/it]Epoch 15: Train acc/f1 = 0.9764 / 0.9704 / 0.9937 / 0.9878/ [0.94117647 0.98230088 0.9877551 ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8765 / 1.0000 / 0.8780/ [0.9047619  0.89473684 0.87804878]
                Test acc/f1/spec/sens = 0.2794 / 0.2488 / 0.9344 / 0.1638/ [0.05732484 0.98850575 0.1637931 ]
 16%|█▌        | 16/100 [01:14<07:09,  5.11s/it] 17%|█▋        | 17/100 [01:17<06:14,  4.51s/it] 18%|█▊        | 18/100 [01:21<06:06,  4.47s/it] 19%|█▉        | 19/100 [01:25<05:29,  4.07s/it] 20%|██        | 20/100 [01:33<07:12,  5.41s/it]Epoch 20: Train acc/f1 = 0.9611 / 0.9518 / 1.0000 / 0.9347/ [0.98529412 0.97050147 0.93469388] 
                Val acc/f1/spec/sens = 0.9100 / 0.8891 / 0.9831 / 0.9268/ [0.76190476 0.97368421 0.92682927]
                Test acc/f1/spec/sens = 0.2773 / 0.2856 / 0.8402 / 0.1595/ [0.19745223 0.73563218 0.15948276]
 21%|██        | 21/100 [01:36<06:15,  4.75s/it] 22%|██▏       | 22/100 [01:41<05:58,  4.60s/it] 23%|██▎       | 23/100 [01:44<05:20,  4.16s/it] 24%|██▍       | 24/100 [01:48<05:19,  4.21s/it] 25%|██▌       | 25/100 [01:55<06:26,  5.15s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9113 / 1.0000 / 0.9512/ [0.76190476 1.         0.95121951]
                Test acc/f1/spec/sens = 0.3634 / 0.3275 / 0.8607 / 0.3966/ [0.07006369 0.8045977  0.39655172]
 26%|██▌       | 26/100 [02:00<06:05,  4.94s/it] 27%|██▋       | 27/100 [02:03<05:22,  4.41s/it] 28%|██▊       | 28/100 [02:07<05:16,  4.40s/it] 29%|██▉       | 29/100 [02:11<04:45,  4.03s/it] 30%|███       | 30/100 [02:19<06:17,  5.40s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3508 / 0.3254 / 0.8443 / 0.3578/ [0.0955414  0.79310345 0.35775862]
 31%|███       | 31/100 [02:22<05:27,  4.75s/it] 32%|███▏      | 32/100 [02:27<05:16,  4.65s/it] 33%|███▎      | 33/100 [02:30<04:42,  4.22s/it] 34%|███▍      | 34/100 [02:34<04:41,  4.27s/it] 35%|███▌      | 35/100 [02:42<05:36,  5.18s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9168 / 1.0000 / 0.9268/ [0.80952381 1.         0.92682927]
                Test acc/f1/spec/sens = 0.3613 / 0.3279 / 0.8525 / 0.3966/ [0.07006369 0.79310345 0.39655172]
 36%|███▌      | 36/100 [02:46<05:17,  4.96s/it] 37%|███▋      | 37/100 [02:49<04:39,  4.43s/it] 38%|███▊      | 38/100 [02:54<04:34,  4.43s/it] 39%|███▉      | 39/100 [02:57<04:07,  4.05s/it] 40%|████      | 40/100 [03:06<05:24,  5.42s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8917 / 0.9831 / 0.9024/ [0.76190476 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3866 / 0.3482 / 0.8320 / 0.4483/ [0.07643312 0.7816092  0.44827586]
 41%|████      | 41/100 [03:09<04:39,  4.73s/it] 42%|████▏     | 42/100 [03:13<04:28,  4.63s/it] 43%|████▎     | 43/100 [03:16<03:57,  4.17s/it] 44%|████▍     | 44/100 [03:21<03:57,  4.25s/it] 45%|████▌     | 45/100 [03:28<04:44,  5.17s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3361 / 0.3103 / 0.8443 / 0.3405/ [0.07643312 0.79310345 0.34051724]
 46%|████▌     | 46/100 [03:32<04:27,  4.95s/it] 47%|████▋     | 47/100 [03:35<03:53,  4.41s/it] 48%|████▊     | 48/100 [03:40<03:47,  4.37s/it] 49%|████▉     | 49/100 [03:43<03:25,  4.03s/it] 50%|█████     | 50/100 [03:51<04:28,  5.37s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8918 / 1.0000 / 0.9024/ [0.76190476 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3340 / 0.3025 / 0.8484 / 0.3448/ [0.06369427 0.79310345 0.34482759]
 51%|█████     | 51/100 [03:55<03:49,  4.69s/it] 52%|█████▏    | 52/100 [03:59<03:40,  4.60s/it] 53%|█████▎    | 53/100 [04:02<03:15,  4.17s/it] 54%|█████▍    | 54/100 [04:07<03:21,  4.38s/it] 55%|█████▌    | 55/100 [04:14<03:58,  5.30s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9186 / 1.0000 / 0.9024/ [0.85714286 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3571 / 0.3215 / 0.8566 / 0.3922/ [0.06369427 0.79310345 0.39224138]
 56%|█████▌    | 56/100 [04:19<03:40,  5.02s/it] 57%|█████▋    | 57/100 [04:22<03:12,  4.47s/it] 58%|█████▊    | 58/100 [04:26<03:06,  4.45s/it] 59%|█████▉    | 59/100 [04:30<02:46,  4.07s/it] 60%|██████    | 60/100 [04:38<03:38,  5.47s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3235 / 0.2971 / 0.8566 / 0.3190/ [0.07006369 0.79310345 0.31896552]
 61%|██████    | 61/100 [04:42<03:06,  4.78s/it] 62%|██████▏   | 62/100 [04:46<02:58,  4.69s/it] 63%|██████▎   | 63/100 [04:49<02:36,  4.23s/it] 64%|██████▍   | 64/100 [04:54<02:35,  4.32s/it] 65%|██████▌   | 65/100 [05:01<03:02,  5.22s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3950 / 0.3549 / 0.8238 / 0.4655/ [0.07643312 0.7816092  0.46551724]
 66%|██████▌   | 66/100 [05:05<02:48,  4.96s/it] 67%|██████▋   | 67/100 [05:09<02:27,  4.46s/it] 68%|██████▊   | 68/100 [05:13<02:21,  4.44s/it] 69%|██████▉   | 69/100 [05:16<02:05,  4.05s/it] 70%|███████   | 70/100 [05:25<02:42,  5.43s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3193 / 0.2918 / 0.8566 / 0.3147/ [0.06369427 0.79310345 0.31465517]
 71%|███████   | 71/100 [05:28<02:17,  4.76s/it] 72%|███████▏  | 72/100 [05:33<02:11,  4.71s/it] 73%|███████▎  | 73/100 [05:36<01:54,  4.24s/it] 74%|███████▍  | 74/100 [05:40<01:51,  4.29s/it] 75%|███████▌  | 75/100 [05:47<02:09,  5.19s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3340 / 0.3057 / 0.8484 / 0.3405/ [0.07006369 0.79310345 0.34051724]
 76%|███████▌  | 76/100 [05:52<01:58,  4.95s/it] 77%|███████▋  | 77/100 [05:55<01:41,  4.42s/it] 78%|███████▊  | 78/100 [05:59<01:36,  4.41s/it] 79%|███████▉  | 79/100 [06:03<01:25,  4.07s/it] 80%|████████  | 80/100 [06:11<01:48,  5.43s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3193 / 0.2951 / 0.8566 / 0.3060/ [0.07643312 0.79310345 0.30603448]
 81%|████████  | 81/100 [06:15<01:30,  4.78s/it] 82%|████████▏ | 82/100 [06:19<01:23,  4.66s/it] 83%|████████▎ | 83/100 [06:22<01:12,  4.24s/it] 84%|████████▍ | 84/100 [06:27<01:08,  4.28s/it] 85%|████████▌ | 85/100 [06:34<01:18,  5.25s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3613 / 0.3301 / 0.8402 / 0.3922/ [0.07643312 0.79310345 0.39224138]
 86%|████████▌ | 86/100 [06:38<01:09,  4.99s/it] 87%|████████▋ | 87/100 [06:42<00:57,  4.40s/it] 88%|████████▊ | 88/100 [06:46<00:52,  4.40s/it] 89%|████████▉ | 89/100 [06:49<00:44,  4.07s/it] 90%|█████████ | 90/100 [06:58<00:54,  5.40s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3529 / 0.3235 / 0.8320 / 0.3793/ [0.07643312 0.7816092  0.37931034]
 91%|█████████ | 91/100 [07:01<00:42,  4.72s/it] 92%|█████████▏| 92/100 [07:05<00:36,  4.62s/it] 93%|█████████▎| 93/100 [07:08<00:29,  4.21s/it] 94%|█████████▍| 94/100 [07:13<00:25,  4.29s/it] 95%|█████████▌| 95/100 [07:20<00:26,  5.21s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3424 / 0.3136 / 0.8361 / 0.3578/ [0.07643312 0.7816092  0.35775862]
 96%|█████████▌| 96/100 [07:25<00:19,  4.93s/it] 97%|█████████▋| 97/100 [07:28<00:13,  4.42s/it] 98%|█████████▊| 98/100 [07:32<00:08,  4.42s/it] 99%|█████████▉| 99/100 [07:36<00:04,  4.09s/it]100%|██████████| 100/100 [07:44<00:00,  5.44s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
                Test acc/f1/spec/sens = 0.3529 / 0.3221 / 0.8320 / 0.3793/ [0.07643312 0.7816092  0.37931034]
Trial 3, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9200 / 0.9054 / 1.0000 / 0.9024/ [0.80952381 1.         0.90243902]
Test acc/f1/spec/sens = 0.3529 / 0.3221 / 0.8320 / 0.3793/ [0.07643312 0.7816092  0.37931034]
>> Finished.
Acc, agreement for latest model:  0.35294117647058826 0.41386554621848737 [0.07643312 0.7816092  0.37931034]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4096638655462185 0.46008403361344535 [0.08917197 0.7816092  0.48706897]
Trial 2/5 || Cycle 4/5 || Label set size 720 || Test acc 0.4097 || Test agreement 0.4601 || Spec 0.8156 || Sens 0.4871 Class Acc: [0.08917197 0.7816092  0.48706897]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.55s/it]100%|██████████| 2/2 [00:12<00:00,  5.24s/it]100%|██████████| 2/2 [00:12<00:00,  6.47s/it]
Maximum distance from cluster centers is 0.39
labeled set:  900
unlabeled set:  533
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.34it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.94it/s] 67%|██████▋   | 8/12 [00:01<00:00, 10.42it/s]100%|██████████| 12/12 [00:01<00:00,  8.87it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 31, 1: 63, 2: 86}
Validation set distribution: 
Number of samples  100
{0: 21, 1: 38, 2: 41}
Labeled set distribution: 
Number of samples  900
{0: 167, 1: 402, 2: 331}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.3550, agreement = 0.3193, f1 = 0.2318, spec = 1.0000, sens = 0.0216 Class Acc: [1.         0.08045977 0.02155172]
Initial model on validation dataset: acc = 0.2200, agreement = 0.2200, f1 = 0.1462, spec = 0.9661, sens = 0.0244 Class Acc: [0.95238095 0.02631579 0.02439024]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:07,  3.71s/it]  2%|▏         | 2/100 [00:08<07:22,  4.51s/it]  3%|▎         | 3/100 [00:12<06:49,  4.22s/it]  4%|▍         | 4/100 [00:17<07:22,  4.61s/it]  5%|▌         | 5/100 [00:26<09:30,  6.01s/it]Epoch 5: Train acc/f1 = 0.5122 / 0.3680 / 0.9912 / 0.1148/ [0.1497006  0.99004975 0.11480363] 
                Val acc/f1/spec/sens = 0.8900 / 0.8664 / 0.9153 / 0.9756/ [0.71428571 0.89473684 0.97560976]
                Test acc/f1/spec/sens = 0.1828 / 0.1078 / 0.8975 / 0.0000/ [0. 1. 0.]
  6%|▌         | 6/100 [00:31<08:49,  5.63s/it]  7%|▋         | 7/100 [00:34<07:46,  5.02s/it]  8%|▊         | 8/100 [00:39<07:35,  4.95s/it]  9%|▉         | 9/100 [00:43<06:55,  4.57s/it] 10%|█         | 10/100 [00:53<09:11,  6.12s/it]Epoch 10: Train acc/f1 = 0.9400 / 0.9295 / 0.9789 / 0.9426/ [0.93413174 0.94029851 0.94259819] 
                Val acc/f1/spec/sens = 0.8700 / 0.8372 / 0.9661 / 0.9024/ [0.61904762 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.2836 / 0.2958 / 0.8566 / 0.2155/ [0.06369427 0.86206897 0.21551724]
 11%|█         | 11/100 [00:56<07:58,  5.37s/it] 12%|█▏        | 12/100 [01:01<07:41,  5.25s/it] 13%|█▎        | 13/100 [01:05<06:56,  4.79s/it] 14%|█▍        | 14/100 [01:10<06:58,  4.86s/it] 15%|█▌        | 15/100 [01:18<08:23,  5.92s/it]Epoch 15: Train acc/f1 = 0.7622 / 0.7374 / 1.0000 / 0.6103/ [0.52095808 0.98756219 0.6102719 ] 
                Val acc/f1/spec/sens = 0.8500 / 0.8086 / 0.9831 / 0.9024/ [0.52380952 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.2038 / 0.1376 / 1.0000 / 0.0302/ [0.01910828 1.         0.03017241]
 16%|█▌        | 16/100 [01:23<07:50,  5.61s/it] 17%|█▋        | 17/100 [01:27<06:58,  5.05s/it] 18%|█▊        | 18/100 [01:32<06:54,  5.05s/it] 19%|█▉        | 19/100 [01:36<06:16,  4.65s/it] 20%|██        | 20/100 [01:45<08:10,  6.14s/it]Epoch 20: Train acc/f1 = 0.9700 / 0.9636 / 0.9684 / 0.9940/ [0.90419162 0.97761194 0.9939577 ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8448 / 0.9661 / 1.0000/ [0.52380952 0.97368421 1.        ]
                Test acc/f1/spec/sens = 0.5945 / 0.4870 / 0.8689 / 0.8103/ [0.05095541 1.         0.81034483]
 21%|██        | 21/100 [01:49<07:08,  5.42s/it] 22%|██▏       | 22/100 [01:54<06:55,  5.32s/it] 23%|██▎       | 23/100 [01:58<06:16,  4.89s/it] 24%|██▍       | 24/100 [02:03<06:13,  4.91s/it] 25%|██▌       | 25/100 [02:12<07:29,  6.00s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8401 / 0.9831 / 0.9024/ [0.61904762 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.5336 / 0.4399 / 0.8484 / 0.7026/ [0.04458599 0.96551724 0.70258621]
 26%|██▌       | 26/100 [02:17<07:00,  5.68s/it] 27%|██▋       | 27/100 [02:20<06:10,  5.08s/it] 28%|██▊       | 28/100 [02:25<06:03,  5.04s/it] 29%|██▉       | 29/100 [02:29<05:31,  4.67s/it] 30%|███       | 30/100 [02:39<07:10,  6.15s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8401 / 0.9831 / 0.9024/ [0.61904762 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4349 / 0.3729 / 0.8893 / 0.4957/ [0.04458599 0.97701149 0.49568966]
 31%|███       | 31/100 [02:43<06:20,  5.51s/it] 32%|███▏      | 32/100 [02:48<06:06,  5.40s/it] 33%|███▎      | 33/100 [02:52<05:29,  4.92s/it] 34%|███▍      | 34/100 [02:57<05:25,  4.94s/it] 35%|███▌      | 35/100 [03:05<06:29,  5.99s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8550 / 0.9831 / 0.9024/ [0.66666667 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4328 / 0.3731 / 0.9057 / 0.4957/ [0.04458599 0.96551724 0.49568966]
 36%|███▌      | 36/100 [03:10<06:03,  5.67s/it] 37%|███▋      | 37/100 [03:14<05:22,  5.12s/it] 38%|███▊      | 38/100 [03:19<05:14,  5.07s/it] 39%|███▉      | 39/100 [03:23<04:46,  4.70s/it] 40%|████      | 40/100 [03:32<06:12,  6.21s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8242 / 0.9661 / 0.9024/ [0.57142857 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4580 / 0.3930 / 0.8852 / 0.5431/ [0.05095541 0.96551724 0.54310345]
 41%|████      | 41/100 [03:36<05:24,  5.50s/it] 42%|████▏     | 42/100 [03:41<05:09,  5.34s/it] 43%|████▎     | 43/100 [03:45<04:36,  4.85s/it] 44%|████▍     | 44/100 [03:50<04:33,  4.89s/it] 45%|████▌     | 45/100 [03:58<05:26,  5.93s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8398 / 0.9661 / 0.9024/ [0.61904762 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4328 / 0.3718 / 0.9262 / 0.4957/ [0.04458599 0.96551724 0.49568966]
 46%|████▌     | 46/100 [04:03<05:03,  5.63s/it] 47%|████▋     | 47/100 [04:07<04:28,  5.06s/it] 48%|████▊     | 48/100 [04:12<04:21,  5.03s/it] 49%|████▉     | 49/100 [04:15<03:56,  4.64s/it] 50%|█████     | 50/100 [04:25<05:07,  6.15s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8398 / 0.9661 / 0.9024/ [0.61904762 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4685 / 0.3962 / 0.8566 / 0.5905/ [0.05095541 0.89655172 0.59051724]
 51%|█████     | 51/100 [04:29<04:27,  5.46s/it] 52%|█████▏    | 52/100 [04:34<04:13,  5.28s/it] 53%|█████▎    | 53/100 [04:38<03:47,  4.84s/it] 54%|█████▍    | 54/100 [04:43<03:44,  4.89s/it] 55%|█████▌    | 55/100 [04:51<04:30,  6.00s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8401 / 0.9831 / 0.9024/ [0.61904762 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4286 / 0.3712 / 0.9057 / 0.4871/ [0.04458599 0.96551724 0.48706897]
 56%|█████▌    | 56/100 [04:56<04:10,  5.69s/it] 57%|█████▋    | 57/100 [05:00<03:41,  5.15s/it] 58%|█████▊    | 58/100 [05:05<03:33,  5.09s/it] 59%|█████▉    | 59/100 [05:09<03:13,  4.71s/it] 60%|██████    | 60/100 [05:19<04:08,  6.22s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8550 / 0.9831 / 0.9024/ [0.66666667 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4265 / 0.3720 / 0.8893 / 0.4828/ [0.05095541 0.95402299 0.48275862]
 61%|██████    | 61/100 [05:22<03:34,  5.50s/it] 62%|██████▏   | 62/100 [05:27<03:21,  5.30s/it] 63%|██████▎   | 63/100 [05:31<02:59,  4.85s/it] 64%|██████▍   | 64/100 [05:36<02:55,  4.87s/it] 65%|██████▌   | 65/100 [05:44<03:26,  5.91s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8401 / 0.9831 / 0.9024/ [0.61904762 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4748 / 0.4018 / 0.8770 / 0.5819/ [0.05095541 0.95402299 0.58189655]
 66%|██████▌   | 66/100 [05:49<03:10,  5.60s/it] 67%|██████▋   | 67/100 [05:53<02:45,  5.03s/it] 68%|██████▊   | 68/100 [05:58<02:40,  5.02s/it] 69%|██████▉   | 69/100 [06:02<02:23,  4.64s/it] 70%|███████   | 70/100 [06:11<03:04,  6.14s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8242 / 0.9661 / 0.9024/ [0.57142857 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4706 / 0.4004 / 0.8893 / 0.5733/ [0.05095541 0.95402299 0.57327586]
 71%|███████   | 71/100 [06:15<02:36,  5.41s/it] 72%|███████▏  | 72/100 [06:20<02:27,  5.25s/it] 73%|███████▎  | 73/100 [06:24<02:10,  4.83s/it] 74%|███████▍  | 74/100 [06:29<02:07,  4.91s/it] 75%|███████▌  | 75/100 [06:37<02:29,  5.98s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8081 / 0.9661 / 0.9024/ [0.52380952 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4265 / 0.3682 / 0.9344 / 0.4828/ [0.04458599 0.96551724 0.48275862]
 76%|███████▌  | 76/100 [06:43<02:18,  5.79s/it] 77%|███████▋  | 77/100 [06:46<01:58,  5.15s/it] 78%|███████▊  | 78/100 [06:51<01:52,  5.12s/it] 79%|███████▉  | 79/100 [06:55<01:38,  4.71s/it] 80%|████████  | 80/100 [07:05<02:04,  6.20s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8401 / 0.9831 / 0.9024/ [0.61904762 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4328 / 0.3717 / 0.9221 / 0.4957/ [0.04458599 0.96551724 0.49568966]
 81%|████████  | 81/100 [07:09<01:43,  5.46s/it] 82%|████████▏ | 82/100 [07:14<01:35,  5.32s/it] 83%|████████▎ | 83/100 [07:17<01:21,  4.78s/it] 84%|████████▍ | 84/100 [07:22<01:18,  4.88s/it] 85%|████████▌ | 85/100 [07:31<01:29,  5.98s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8398 / 0.9661 / 0.9024/ [0.61904762 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4286 / 0.3735 / 0.9016 / 0.4828/ [0.05095541 0.96551724 0.48275862]
 86%|████████▌ | 86/100 [07:36<01:19,  5.69s/it] 87%|████████▋ | 87/100 [07:39<01:05,  5.07s/it] 88%|████████▊ | 88/100 [07:44<01:01,  5.09s/it] 89%|████████▉ | 89/100 [07:48<00:51,  4.66s/it] 90%|█████████ | 90/100 [07:58<01:01,  6.18s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8242 / 0.9661 / 0.9024/ [0.57142857 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4244 / 0.3677 / 0.9098 / 0.4784/ [0.04458599 0.96551724 0.47844828]
 91%|█████████ | 91/100 [08:02<00:48,  5.43s/it] 92%|█████████▏| 92/100 [08:06<00:42,  5.28s/it] 93%|█████████▎| 93/100 [08:10<00:33,  4.79s/it] 94%|█████████▍| 94/100 [08:15<00:29,  4.88s/it] 95%|█████████▌| 95/100 [08:24<00:29,  5.95s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8401 / 0.9831 / 0.9024/ [0.61904762 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4349 / 0.3753 / 0.9262 / 0.5000/ [0.04458599 0.96551724 0.5       ]
 96%|█████████▌| 96/100 [08:29<00:23,  5.87s/it] 97%|█████████▋| 97/100 [08:33<00:16,  5.34s/it] 98%|█████████▊| 98/100 [08:39<00:10,  5.30s/it] 99%|█████████▉| 99/100 [08:43<00:04,  4.87s/it]100%|██████████| 100/100 [08:53<00:00,  6.45s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8398 / 0.9661 / 0.9024/ [0.61904762 0.97368421 0.90243902]
                Test acc/f1/spec/sens = 0.4937 / 0.4143 / 0.8566 / 0.6293/ [0.05095541 0.93103448 0.62931034]
Trial 3, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8700 / 0.8398 / 0.9661 / 0.9024/ [0.61904762 0.97368421 0.90243902]
Test acc/f1/spec/sens = 0.4937 / 0.4143 / 0.8566 / 0.6293/ [0.05095541 0.93103448 0.62931034]
>> Finished.
Acc, agreement for latest model:  0.49369747899159666 0.5294117647058824 [0.05095541 0.93103448 0.62931034]
Load best checkpoint for thief model
Acc, agreement for best model:  0.42016806722689076 0.4684873949579832 [0.05095541 0.96551724 0.46551724]
Trial 2/5 || Cycle 5/5 || Label set size 900 || Test acc 0.4202 || Test agreement 0.4685 || Spec 0.9098 || Sens 0.4655 Class Acc: [0.05095541 0.96551724 0.46551724]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.34it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.43it/s] 75%|███████▌  | 9/12 [00:01<00:00, 10.96it/s]100%|██████████| 12/12 [00:01<00:00,  8.56it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:04,  1.41it/s] 57%|█████▋    | 4/7 [00:00<00:00,  5.33it/s]100%|██████████| 7/7 [00:01<00:00,  5.87it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2018, -1.2202, -1.1938]), tensor([0.8523, 0.8471, 0.8553]))
Val set stats: mean/std =  (tensor([-1.2455, -1.2585, -1.2387]), tensor([0.8356, 0.8314, 0.8385]))
Validation set distribution: 
Number of samples  100
{0: 15, 1: 40, 2: 45}
Labeled set distribution: 
Number of samples  180
{0: 27, 1: 81, 2: 72}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.2878, agreement = 0.2836, f1 = 0.2025, spec = 0.9795, sens = 0.0862 Class Acc: [0.72611465 0.03448276 0.0862069 ]
Initial model on validation dataset: acc = 0.1500, agreement = 0.1500, f1 = 0.1124, spec = 0.6545, sens = 0.0444 Class Acc: [0.86666667 0.         0.04444444]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:35,  1.57s/it]  2%|▏         | 2/100 [00:04<03:49,  2.34s/it]  3%|▎         | 3/100 [00:06<03:13,  1.99s/it]  4%|▍         | 4/100 [00:09<03:54,  2.44s/it]  5%|▌         | 5/100 [00:13<04:52,  3.08s/it]Epoch 5: Train acc/f1 = 0.7056 / 0.6765 / 0.8148 / 0.9306/ [0.88888889 0.44444444 0.93055556] 
                Val acc/f1/spec/sens = 0.6200 / 0.5670 / 1.0000 / 0.3333/ [0.6        0.95       0.33333333]
                Test acc/f1/spec/sens = 0.4202 / 0.4089 / 0.9713 / 0.2069/ [0.74522293 0.40229885 0.20689655]
  6%|▌         | 6/100 [00:16<04:39,  2.97s/it]  7%|▋         | 7/100 [00:17<03:54,  2.53s/it]  8%|▊         | 8/100 [00:20<04:12,  2.74s/it]  9%|▉         | 9/100 [00:22<03:36,  2.38s/it] 10%|█         | 10/100 [00:28<05:13,  3.48s/it]Epoch 10: Train acc/f1 = 0.9389 / 0.9014 / 0.9537 / 0.9861/ [0.7037037  0.97530864 0.98611111] 
                Val acc/f1/spec/sens = 0.8600 / 0.8013 / 0.9455 / 0.8667/ [0.6        0.95       0.86666667]
                Test acc/f1/spec/sens = 0.2752 / 0.2442 / 0.9795 / 0.1466/ [0.07006369 0.98850575 0.14655172]
 11%|█         | 11/100 [00:30<04:17,  2.89s/it] 12%|█▏        | 12/100 [00:32<04:11,  2.85s/it] 13%|█▎        | 13/100 [00:34<03:35,  2.47s/it] 14%|█▍        | 14/100 [00:37<03:49,  2.67s/it] 15%|█▌        | 15/100 [00:41<04:27,  3.14s/it]Epoch 15: Train acc/f1 = 0.9722 / 0.9569 / 0.9907 / 1.0000/ [0.85185185 0.98765432 1.        ] 
                Val acc/f1/spec/sens = 0.8400 / 0.8075 / 0.8909 / 0.9556/ [0.86666667 0.7        0.95555556]
                Test acc/f1/spec/sens = 0.2458 / 0.2183 / 1.0000 / 0.0474/ [0.12101911 1.         0.04741379]
 16%|█▌        | 16/100 [00:44<04:14,  3.03s/it] 17%|█▋        | 17/100 [00:46<03:35,  2.60s/it] 18%|█▊        | 18/100 [00:49<03:45,  2.74s/it] 19%|█▉        | 19/100 [00:50<03:13,  2.38s/it] 20%|██        | 20/100 [00:56<04:24,  3.30s/it]Epoch 20: Train acc/f1 = 0.9611 / 0.9452 / 1.0000 / 0.9167/ [1.         0.98765432 0.91666667] 
                Val acc/f1/spec/sens = 0.8300 / 0.8061 / 1.0000 / 0.7111/ [1.         0.9        0.71111111]
                Test acc/f1/spec/sens = 0.2395 / 0.2211 / 1.0000 / 0.0043/ [0.27388535 0.8045977  0.00431034]
 21%|██        | 21/100 [00:57<03:39,  2.78s/it] 22%|██▏       | 22/100 [01:00<03:45,  2.89s/it] 23%|██▎       | 23/100 [01:02<03:12,  2.50s/it] 24%|██▍       | 24/100 [01:05<03:16,  2.58s/it] 25%|██▌       | 25/100 [01:09<03:51,  3.09s/it]Epoch 25: Train acc/f1 = 0.9944 / 0.9916 / 1.0000 / 0.9861/ [1.         1.         0.98611111] 
                Val acc/f1/spec/sens = 0.9200 / 0.8965 / 0.9818 / 0.9333/ [0.93333333 0.9        0.93333333]
                Test acc/f1/spec/sens = 0.2626 / 0.2358 / 0.9959 / 0.1293/ [0.05732484 0.98850575 0.12931034]
 26%|██▌       | 26/100 [01:12<03:49,  3.11s/it] 27%|██▋       | 27/100 [01:14<03:13,  2.65s/it] 28%|██▊       | 28/100 [01:17<03:14,  2.71s/it] 29%|██▉       | 29/100 [01:18<02:47,  2.37s/it] 30%|███       | 30/100 [01:24<03:49,  3.27s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.2584 / 0.2293 / 0.9959 / 0.1207/ [0.05095541 1.         0.12068966]
 31%|███       | 31/100 [01:25<03:11,  2.77s/it] 32%|███▏      | 32/100 [01:28<03:09,  2.79s/it] 33%|███▎      | 33/100 [01:30<02:42,  2.42s/it] 34%|███▍      | 34/100 [01:32<02:47,  2.53s/it] 35%|███▌      | 35/100 [01:37<03:17,  3.05s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8890 / 0.9818 / 0.8889/ [0.93333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.2773 / 0.2594 / 0.9959 / 0.1293/ [0.12101911 0.95402299 0.12931034]
 36%|███▌      | 36/100 [01:39<03:09,  2.97s/it] 37%|███▋      | 37/100 [01:41<02:39,  2.53s/it] 38%|███▊      | 38/100 [01:44<02:41,  2.60s/it] 39%|███▉      | 39/100 [01:45<02:20,  2.30s/it] 40%|████      | 40/100 [01:51<03:14,  3.24s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.2983 / 0.2830 / 0.9918 / 0.1897/ [0.10191083 0.94252874 0.18965517]
 41%|████      | 41/100 [01:52<02:43,  2.76s/it] 42%|████▏     | 42/100 [01:55<02:40,  2.77s/it] 43%|████▎     | 43/100 [01:57<02:17,  2.42s/it] 44%|████▍     | 44/100 [02:00<02:22,  2.54s/it] 45%|████▌     | 45/100 [02:04<02:48,  3.06s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.3046 / 0.2919 / 0.9795 / 0.1853/ [0.11464968 0.96551724 0.18534483]
 46%|████▌     | 46/100 [02:07<02:41,  2.99s/it] 47%|████▋     | 47/100 [02:08<02:15,  2.55s/it] 48%|████▊     | 48/100 [02:11<02:15,  2.60s/it] 49%|████▉     | 49/100 [02:12<01:56,  2.29s/it] 50%|█████     | 50/100 [02:18<02:40,  3.21s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9132 / 0.9818 / 0.9333/ [0.93333333 0.925      0.93333333]
                Test acc/f1/spec/sens = 0.2731 / 0.2554 / 0.9959 / 0.1293/ [0.10828025 0.95402299 0.12931034]
 51%|█████     | 51/100 [02:19<02:12,  2.71s/it] 52%|█████▏    | 52/100 [02:22<02:11,  2.73s/it] 53%|█████▎    | 53/100 [02:24<01:52,  2.39s/it] 54%|█████▍    | 54/100 [02:26<01:55,  2.51s/it] 55%|█████▌    | 55/100 [02:31<02:17,  3.06s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.2983 / 0.2834 / 0.9918 / 0.1767/ [0.10828025 0.96551724 0.17672414]
 56%|█████▌    | 56/100 [02:34<02:11,  2.99s/it] 57%|█████▋    | 57/100 [02:35<01:49,  2.55s/it] 58%|█████▊    | 58/100 [02:38<01:49,  2.61s/it] 59%|█████▉    | 59/100 [02:40<01:34,  2.31s/it] 60%|██████    | 60/100 [02:45<02:10,  3.27s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.3025 / 0.2915 / 0.9918 / 0.1810/ [0.12738854 0.94252874 0.18103448]
 61%|██████    | 61/100 [02:47<01:47,  2.75s/it] 62%|██████▏   | 62/100 [02:49<01:44,  2.74s/it] 63%|██████▎   | 63/100 [02:51<01:28,  2.39s/it] 64%|██████▍   | 64/100 [02:54<01:30,  2.50s/it] 65%|██████▌   | 65/100 [02:58<01:45,  3.00s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.2920 / 0.2782 / 0.9959 / 0.1724/ [0.10191083 0.95402299 0.17241379]
 66%|██████▌   | 66/100 [03:00<01:38,  2.91s/it] 67%|██████▋   | 67/100 [03:02<01:22,  2.50s/it] 68%|██████▊   | 68/100 [03:05<01:22,  2.58s/it] 69%|██████▉   | 69/100 [03:06<01:10,  2.29s/it] 70%|███████   | 70/100 [03:12<01:37,  3.24s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.2857 / 0.2676 / 0.9959 / 0.1638/ [0.08917197 0.96551724 0.1637931 ]
 71%|███████   | 71/100 [03:13<01:19,  2.73s/it] 72%|███████▏  | 72/100 [03:16<01:16,  2.75s/it] 73%|███████▎  | 73/100 [03:18<01:04,  2.40s/it] 74%|███████▍  | 74/100 [03:21<01:05,  2.52s/it] 75%|███████▌  | 75/100 [03:25<01:16,  3.06s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8930 / 0.9818 / 0.9333/ [0.86666667 0.925      0.93333333]
                Test acc/f1/spec/sens = 0.2815 / 0.2642 / 0.9959 / 0.1466/ [0.10191083 0.96551724 0.14655172]
 76%|███████▌  | 76/100 [03:28<01:11,  2.98s/it] 77%|███████▋  | 77/100 [03:29<00:58,  2.55s/it] 78%|███████▊  | 78/100 [03:32<00:58,  2.66s/it] 79%|███████▉  | 79/100 [03:34<00:48,  2.33s/it] 80%|████████  | 80/100 [03:39<01:05,  3.28s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.3067 / 0.2964 / 0.9918 / 0.1810/ [0.12738854 0.96551724 0.18103448]
 81%|████████  | 81/100 [03:41<00:52,  2.77s/it] 82%|████████▏ | 82/100 [03:44<00:49,  2.78s/it] 83%|████████▎ | 83/100 [03:45<00:40,  2.40s/it] 84%|████████▍ | 84/100 [03:48<00:40,  2.52s/it] 85%|████████▌ | 85/100 [03:52<00:45,  3.02s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.3004 / 0.2880 / 0.9918 / 0.1853/ [0.11464968 0.94252874 0.18534483]
 86%|████████▌ | 86/100 [03:55<00:41,  2.94s/it] 87%|████████▋ | 87/100 [03:56<00:32,  2.52s/it] 88%|████████▊ | 88/100 [03:59<00:31,  2.61s/it] 89%|████████▉ | 89/100 [04:01<00:25,  2.30s/it] 90%|█████████ | 90/100 [04:06<00:32,  3.26s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8930 / 0.9818 / 0.9333/ [0.86666667 0.925      0.93333333]
                Test acc/f1/spec/sens = 0.2689 / 0.2487 / 0.9959 / 0.1164/ [0.10828025 0.96551724 0.11637931]
 91%|█████████ | 91/100 [04:08<00:24,  2.77s/it] 92%|█████████▏| 92/100 [04:11<00:22,  2.76s/it] 93%|█████████▎| 93/100 [04:12<00:16,  2.41s/it] 94%|█████████▍| 94/100 [04:15<00:15,  2.52s/it] 95%|█████████▌| 95/100 [04:19<00:15,  3.01s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.3004 / 0.2876 / 0.9959 / 0.1681/ [0.12738854 0.96551724 0.16810345]
 96%|█████████▌| 96/100 [04:22<00:11,  2.91s/it] 97%|█████████▋| 97/100 [04:23<00:07,  2.52s/it] 98%|█████████▊| 98/100 [04:26<00:05,  2.60s/it] 99%|█████████▉| 99/100 [04:28<00:02,  2.31s/it]100%|██████████| 100/100 [04:33<00:00,  3.22s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.2731 / 0.2530 / 0.9959 / 0.1422/ [0.08280255 0.96551724 0.14224138]
Trial 4, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9300 / 0.9052 / 0.9818 / 0.9556/ [0.86666667 0.925      0.95555556]
Test acc/f1/spec/sens = 0.2731 / 0.2530 / 0.9959 / 0.1422/ [0.08280255 0.96551724 0.14224138]
>> Finished.
Acc, agreement for latest model:  0.27310924369747897 0.32983193277310924 [0.08280255 0.96551724 0.14224138]
Load best checkpoint for thief model
Acc, agreement for best model:  0.2542016806722689 0.3130252100840336 [0.07643312 0.96551724 0.10775862]
Trial 3/5 || Cycle 1/5 || Label set size 180 || Test acc 0.2542 || Test agreement 0.3130 || Spec 0.9959 || Sens 0.1078 Class Acc: [0.07643312 0.96551724 0.10775862]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.01s/it]100%|██████████| 2/2 [00:13<00:00,  5.43s/it]100%|██████████| 2/2 [00:13<00:00,  6.74s/it]
Maximum distance from cluster centers is 0.48
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.42it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.60it/s] 67%|██████▋   | 8/12 [00:01<00:00, 10.67it/s]100%|██████████| 12/12 [00:01<00:00,  8.61it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 25, 1: 76, 2: 79}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 40, 2: 45}
Labeled set distribution: 
Number of samples  360
{0: 52, 1: 157, 2: 151}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.5252, agreement = 0.5273, f1 = 0.4263, spec = 0.5287, sens = 0.8103 Class Acc: [0.26751592 0.22988506 0.81034483]
Initial model on validation dataset: acc = 0.4100, agreement = 0.4100, f1 = 0.2754, spec = 0.3818, sens = 0.8222 Class Acc: [0.2        0.025      0.82222222]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<03:18,  2.01s/it]  2%|▏         | 2/100 [00:05<04:44,  2.90s/it]  3%|▎         | 3/100 [00:07<04:04,  2.52s/it]  4%|▍         | 4/100 [00:10<04:30,  2.82s/it]  5%|▌         | 5/100 [00:16<05:51,  3.70s/it]Epoch 5: Train acc/f1 = 0.8528 / 0.7081 / 0.8278 / 0.9801/ [0.19230769 0.94904459 0.98013245] 
                Val acc/f1/spec/sens = 0.7900 / 0.7251 / 1.0000 / 0.6889/ [0.53333333 1.         0.68888889]
                Test acc/f1/spec/sens = 0.5903 / 0.4420 / 0.6107 / 0.9655/ [0.02547771 0.6091954  0.96551724]
  6%|▌         | 6/100 [00:19<05:45,  3.67s/it]  7%|▋         | 7/100 [00:21<04:53,  3.15s/it]  8%|▊         | 8/100 [00:25<04:54,  3.20s/it]  9%|▉         | 9/100 [00:27<04:19,  2.85s/it] 10%|█         | 10/100 [00:33<05:58,  3.98s/it]Epoch 10: Train acc/f1 = 0.6444 / 0.5829 / 1.0000 / 0.2384/ [0.90384615 0.94904459 0.2384106 ] 
                Val acc/f1/spec/sens = 0.5700 / 0.5468 / 1.0000 / 0.2222/ [1.         0.8        0.22222222]
                Test acc/f1/spec/sens = 0.2794 / 0.2814 / 0.9590 / 0.0216/ [0.36942675 0.8045977  0.02155172]
 11%|█         | 11/100 [00:35<05:02,  3.40s/it] 12%|█▏        | 12/100 [00:39<04:59,  3.40s/it] 13%|█▎        | 13/100 [00:41<04:20,  2.99s/it] 14%|█▍        | 14/100 [00:44<04:25,  3.09s/it] 15%|█▌        | 15/100 [00:49<05:17,  3.74s/it]Epoch 15: Train acc/f1 = 0.9667 / 0.9516 / 0.9809 / 1.0000/ [0.92307692 0.94904459 1.        ] 
                Val acc/f1/spec/sens = 0.8800 / 0.8003 / 0.9455 / 0.9111/ [0.46666667 1.         0.91111111]
                Test acc/f1/spec/sens = 0.5588 / 0.4848 / 0.8975 / 0.7241/ [0.0955414  0.95402299 0.72413793]
 16%|█▌        | 16/100 [00:53<05:13,  3.73s/it] 17%|█▋        | 17/100 [00:55<04:29,  3.24s/it] 18%|█▊        | 18/100 [00:58<04:26,  3.25s/it] 19%|█▉        | 19/100 [01:01<03:54,  2.90s/it] 20%|██        | 20/100 [01:07<05:18,  3.98s/it]Epoch 20: Train acc/f1 = 0.9972 / 0.9957 / 1.0000 / 1.0000/ [0.98076923 1.         1.        ] 
                Val acc/f1/spec/sens = 0.9200 / 0.8737 / 0.9636 / 0.9556/ [0.66666667 0.975      0.95555556]
                Test acc/f1/spec/sens = 0.4307 / 0.4171 / 0.9262 / 0.4310/ [0.14649682 0.94252874 0.43103448]
 21%|██        | 21/100 [01:09<04:30,  3.42s/it] 22%|██▏       | 22/100 [01:13<04:26,  3.42s/it] 23%|██▎       | 23/100 [01:15<03:52,  3.02s/it] 24%|██▍       | 24/100 [01:18<03:57,  3.12s/it] 25%|██▌       | 25/100 [01:23<04:41,  3.75s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4454 / 0.4413 / 0.9057 / 0.4181/ [0.22929936 0.90804598 0.41810345]
 26%|██▌       | 26/100 [01:27<04:27,  3.62s/it] 27%|██▋       | 27/100 [01:29<03:50,  3.16s/it] 28%|██▊       | 28/100 [01:32<03:52,  3.23s/it] 29%|██▉       | 29/100 [01:34<03:24,  2.88s/it] 30%|███       | 30/100 [01:41<04:40,  4.00s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8417 / 0.9455 / 0.9333/ [0.66666667 0.925      0.93333333]
                Test acc/f1/spec/sens = 0.4748 / 0.4696 / 0.8934 / 0.4526/ [0.27388535 0.89655172 0.45258621]
 31%|███       | 31/100 [01:43<03:57,  3.44s/it] 32%|███▏      | 32/100 [01:46<03:50,  3.39s/it] 33%|███▎      | 33/100 [01:48<03:22,  3.02s/it] 34%|███▍      | 34/100 [01:52<03:24,  3.10s/it] 35%|███▌      | 35/100 [01:57<04:02,  3.73s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8347 / 0.9273 / 0.9333/ [0.6        0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4475 / 0.4469 / 0.9139 / 0.4052/ [0.25477707 0.90804598 0.40517241]
 36%|███▌      | 36/100 [02:00<03:50,  3.61s/it] 37%|███▋      | 37/100 [02:02<03:18,  3.15s/it] 38%|███▊      | 38/100 [02:05<03:18,  3.20s/it] 39%|███▉      | 39/100 [02:08<02:55,  2.88s/it] 40%|████      | 40/100 [02:14<03:56,  3.93s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8347 / 0.9273 / 0.9333/ [0.6        0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4580 / 0.4570 / 0.8852 / 0.4224/ [0.26751592 0.89655172 0.42241379]
 41%|████      | 41/100 [02:16<03:22,  3.44s/it] 42%|████▏     | 42/100 [02:20<03:19,  3.43s/it] 43%|████▎     | 43/100 [02:22<02:52,  3.03s/it] 44%|████▍     | 44/100 [02:25<02:55,  3.13s/it] 45%|████▌     | 45/100 [02:30<03:28,  3.79s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4643 / 0.4687 / 0.9016 / 0.3966/ [0.32484076 0.89655172 0.39655172]
 46%|████▌     | 46/100 [02:34<03:16,  3.65s/it] 47%|████▋     | 47/100 [02:36<02:48,  3.18s/it] 48%|████▊     | 48/100 [02:39<02:48,  3.24s/it] 49%|████▉     | 49/100 [02:41<02:27,  2.90s/it] 50%|█████     | 50/100 [02:48<03:20,  4.00s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4391 / 0.4448 / 0.9098 / 0.3621/ [0.29299363 0.90804598 0.36206897]
 51%|█████     | 51/100 [02:50<02:48,  3.43s/it] 52%|█████▏    | 52/100 [02:53<02:43,  3.40s/it] 53%|█████▎    | 53/100 [02:55<02:21,  3.01s/it] 54%|█████▍    | 54/100 [02:59<02:22,  3.10s/it] 55%|█████▌    | 55/100 [03:04<02:49,  3.77s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4643 / 0.4661 / 0.8934 / 0.4138/ [0.29936306 0.89655172 0.4137931 ]
 56%|█████▌    | 56/100 [03:07<02:39,  3.62s/it] 57%|█████▋    | 57/100 [03:09<02:15,  3.15s/it] 58%|█████▊    | 58/100 [03:13<02:14,  3.21s/it] 59%|█████▉    | 59/100 [03:15<01:57,  2.86s/it] 60%|██████    | 60/100 [03:21<02:37,  3.94s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4496 / 0.4535 / 0.8934 / 0.3879/ [0.29299363 0.89655172 0.38793103]
 61%|██████    | 61/100 [03:23<02:12,  3.39s/it] 62%|██████▏   | 62/100 [03:27<02:08,  3.38s/it] 63%|██████▎   | 63/100 [03:29<01:50,  2.98s/it] 64%|██████▍   | 64/100 [03:32<01:51,  3.08s/it] 65%|██████▌   | 65/100 [03:37<02:10,  3.74s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4580 / 0.4603 / 0.8934 / 0.4052/ [0.29299363 0.89655172 0.40517241]
 66%|██████▌   | 66/100 [03:41<02:03,  3.64s/it] 67%|██████▋   | 67/100 [03:43<01:45,  3.19s/it] 68%|██████▊   | 68/100 [03:46<01:43,  3.22s/it] 69%|██████▉   | 69/100 [03:48<01:29,  2.90s/it] 70%|███████   | 70/100 [03:55<01:58,  3.95s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4580 / 0.4601 / 0.8975 / 0.4095/ [0.28025478 0.90804598 0.40948276]
 71%|███████   | 71/100 [03:57<01:38,  3.41s/it] 72%|███████▏  | 72/100 [04:00<01:34,  3.39s/it] 73%|███████▎  | 73/100 [04:02<01:20,  3.00s/it] 74%|███████▍  | 74/100 [04:06<01:20,  3.09s/it] 75%|███████▌  | 75/100 [04:11<01:33,  3.76s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8417 / 0.9455 / 0.9333/ [0.66666667 0.925      0.93333333]
                Test acc/f1/spec/sens = 0.4496 / 0.4537 / 0.8893 / 0.3879/ [0.29299363 0.89655172 0.38793103]
 76%|███████▌  | 76/100 [04:14<01:26,  3.61s/it] 77%|███████▋  | 77/100 [04:16<01:12,  3.15s/it] 78%|███████▊  | 78/100 [04:20<01:10,  3.21s/it] 79%|███████▉  | 79/100 [04:22<01:00,  2.89s/it] 80%|████████  | 80/100 [04:28<01:19,  3.97s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4622 / 0.4636 / 0.8852 / 0.4181/ [0.2866242  0.89655172 0.41810345]
 81%|████████  | 81/100 [04:30<01:04,  3.41s/it] 82%|████████▏ | 82/100 [04:34<01:00,  3.34s/it] 83%|████████▎ | 83/100 [04:36<00:50,  2.99s/it] 84%|████████▍ | 84/100 [04:39<00:49,  3.11s/it] 85%|████████▌ | 85/100 [04:44<00:56,  3.79s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4286 / 0.4384 / 0.9098 / 0.3276/ [0.31210191 0.90804598 0.32758621]
 86%|████████▌ | 86/100 [04:48<00:51,  3.64s/it] 87%|████████▋ | 87/100 [04:50<00:41,  3.20s/it] 88%|████████▊ | 88/100 [04:53<00:38,  3.24s/it] 89%|████████▉ | 89/100 [04:55<00:31,  2.89s/it] 90%|█████████ | 90/100 [05:02<00:39,  3.96s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4475 / 0.4505 / 0.8893 / 0.3922/ [0.28025478 0.89655172 0.39224138]
 91%|█████████ | 91/100 [05:04<00:30,  3.43s/it] 92%|█████████▏| 92/100 [05:07<00:27,  3.38s/it] 93%|█████████▎| 93/100 [05:09<00:20,  2.98s/it] 94%|█████████▍| 94/100 [05:13<00:18,  3.06s/it] 95%|█████████▌| 95/100 [05:18<00:18,  3.71s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4622 / 0.4613 / 0.9057 / 0.4181/ [0.28025478 0.90804598 0.41810345]
 96%|█████████▌| 96/100 [05:21<00:14,  3.56s/it] 97%|█████████▋| 97/100 [05:23<00:09,  3.11s/it] 98%|█████████▊| 98/100 [05:26<00:06,  3.18s/it] 99%|█████████▉| 99/100 [05:28<00:02,  2.86s/it]100%|██████████| 100/100 [05:35<00:00,  3.99s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.4538 / 0.4568 / 0.8975 / 0.3966/ [0.29299363 0.89655172 0.39655172]
Trial 4, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9000 / 0.8538 / 0.9455 / 0.9333/ [0.66666667 0.95       0.93333333]
Test acc/f1/spec/sens = 0.4538 / 0.4568 / 0.8975 / 0.3966/ [0.29299363 0.89655172 0.39655172]
>> Finished.
Acc, agreement for latest model:  0.453781512605042 0.47689075630252103 [0.29299363 0.89655172 0.39655172]
Load best checkpoint for thief model
Acc, agreement for best model:  0.45588235294117646 0.49159663865546216 [0.10191083 0.94252874 0.51293103]
Trial 3/5 || Cycle 2/5 || Label set size 360 || Test acc 0.4559 || Test agreement 0.4916 || Spec 0.9262 || Sens 0.5129 Class Acc: [0.10191083 0.94252874 0.51293103]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.92s/it]100%|██████████| 2/2 [00:12<00:00,  4.98s/it]100%|██████████| 2/2 [00:12<00:00,  6.16s/it]
Maximum distance from cluster centers is 0.44
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.38it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.67it/s] 67%|██████▋   | 8/12 [00:01<00:00, 10.51it/s]100%|██████████| 12/12 [00:01<00:00,  8.98it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 34, 1: 78, 2: 68}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 40, 2: 45}
Labeled set distribution: 
Number of samples  540
{0: 86, 1: 235, 2: 219}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.5210, agreement = 0.5399, f1 = 0.3675, spec = 0.2254, sens = 0.9095 Class Acc: [0.17834395 0.10344828 0.90948276]
Initial model on validation dataset: acc = 0.4400, agreement = 0.4400, f1 = 0.2080, spec = 0.0545, sens = 0.9778 Class Acc: [0.         0.         0.97777778]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:20,  2.63s/it]  2%|▏         | 2/100 [00:06<05:34,  3.41s/it]  3%|▎         | 3/100 [00:09<04:59,  3.09s/it]  4%|▍         | 4/100 [00:13<05:35,  3.49s/it]  5%|▌         | 5/100 [00:19<07:05,  4.48s/it]Epoch 5: Train acc/f1 = 0.9019 / 0.8764 / 0.9688 / 0.9087/ [0.84883721 0.91489362 0.9086758 ] 
                Val acc/f1/spec/sens = 0.8600 / 0.8140 / 0.9636 / 0.8444/ [0.73333333 0.925      0.84444444]
                Test acc/f1/spec/sens = 0.4874 / 0.4145 / 0.9098 / 0.5948/ [0.05095541 0.98850575 0.59482759]
  6%|▌         | 6/100 [00:23<06:50,  4.36s/it]  7%|▋         | 7/100 [00:26<05:53,  3.80s/it]  8%|▊         | 8/100 [00:30<05:50,  3.80s/it]  9%|▉         | 9/100 [00:32<05:12,  3.44s/it] 10%|█         | 10/100 [00:40<07:00,  4.67s/it]Epoch 10: Train acc/f1 = 0.9278 / 0.9058 / 1.0000 / 0.8584/ [0.91860465 0.99574468 0.85844749] 
                Val acc/f1/spec/sens = 0.8400 / 0.7787 / 0.9818 / 0.8000/ [0.6   0.975 0.8  ]
                Test acc/f1/spec/sens = 0.3067 / 0.3072 / 0.9303 / 0.1940/ [0.08917197 1.         0.19396552]
 11%|█         | 11/100 [00:42<06:01,  4.06s/it] 12%|█▏        | 12/100 [00:47<05:57,  4.06s/it] 13%|█▎        | 13/100 [00:49<05:17,  3.65s/it] 14%|█▍        | 14/100 [00:53<05:29,  3.83s/it] 15%|█▌        | 15/100 [01:00<06:30,  4.60s/it]Epoch 15: Train acc/f1 = 0.9259 / 0.9106 / 0.9813 / 0.9224/ [0.96511628 0.91489362 0.92237443] 
                Val acc/f1/spec/sens = 0.8700 / 0.8400 / 1.0000 / 0.7778/ [0.93333333 0.95       0.77777778]
                Test acc/f1/spec/sens = 0.2752 / 0.2537 / 0.9262 / 0.0647/ [0.21656051 0.94252874 0.06465517]
 16%|█▌        | 16/100 [01:04<06:15,  4.47s/it] 17%|█▋        | 17/100 [01:07<05:23,  3.89s/it] 18%|█▊        | 18/100 [01:10<05:15,  3.85s/it] 19%|█▉        | 19/100 [01:13<04:41,  3.47s/it] 20%|██        | 20/100 [01:21<06:16,  4.71s/it]Epoch 20: Train acc/f1 = 0.9796 / 0.9703 / 1.0000 / 0.9817/ [0.91860465 1.         0.98173516] 
                Val acc/f1/spec/sens = 0.8600 / 0.8065 / 0.9818 / 0.8222/ [0.66666667 0.975      0.82222222]
                Test acc/f1/spec/sens = 0.5105 / 0.4446 / 0.9385 / 0.6250/ [0.07006369 1.         0.625     ]
 21%|██        | 21/100 [01:23<05:23,  4.09s/it] 22%|██▏       | 22/100 [01:27<05:16,  4.05s/it] 23%|██▎       | 23/100 [01:30<04:37,  3.61s/it] 24%|██▍       | 24/100 [01:34<04:38,  3.67s/it] 25%|██▌       | 25/100 [01:40<05:32,  4.43s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8375 / 0.9455 / 0.8889/ [0.73333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.4370 / 0.3967 / 0.9057 / 0.4871/ [0.05095541 1.         0.48706897]
 26%|██▌       | 26/100 [01:44<05:13,  4.24s/it] 27%|██▋       | 27/100 [01:46<04:32,  3.73s/it] 28%|██▊       | 28/100 [01:50<04:30,  3.76s/it] 29%|██▉       | 29/100 [01:52<04:01,  3.41s/it] 30%|███       | 30/100 [02:00<05:25,  4.65s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8375 / 0.9455 / 0.8889/ [0.73333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.5252 / 0.4489 / 0.9016 / 0.6681/ [0.05095541 1.         0.66810345]
 31%|███       | 31/100 [02:03<04:37,  4.03s/it] 32%|███▏      | 32/100 [02:06<04:30,  3.98s/it] 33%|███▎      | 33/100 [02:09<03:57,  3.55s/it] 34%|███▍      | 34/100 [02:13<04:02,  3.67s/it] 35%|███▌      | 35/100 [02:19<04:51,  4.49s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8375 / 0.9455 / 0.8889/ [0.73333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.5231 / 0.4486 / 0.9057 / 0.6638/ [0.05095541 1.         0.6637931 ]
 36%|███▌      | 36/100 [02:23<04:34,  4.30s/it] 37%|███▋      | 37/100 [02:26<03:58,  3.79s/it] 38%|███▊      | 38/100 [02:30<03:54,  3.78s/it] 39%|███▉      | 39/100 [02:32<03:29,  3.43s/it] 40%|████      | 40/100 [02:40<04:38,  4.64s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9636 / 0.8889/ [0.8        0.925      0.88888889]
                Test acc/f1/spec/sens = 0.5063 / 0.4340 / 0.9057 / 0.6293/ [0.05095541 1.         0.62931034]
 41%|████      | 41/100 [02:42<03:57,  4.03s/it] 42%|████▏     | 42/100 [02:46<03:50,  3.98s/it] 43%|████▎     | 43/100 [02:49<03:24,  3.59s/it] 44%|████▍     | 44/100 [02:53<03:24,  3.66s/it] 45%|████▌     | 45/100 [02:59<04:06,  4.49s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8485 / 0.9455 / 0.9111/ [0.73333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.5525 / 0.4637 / 0.8975 / 0.7241/ [0.05095541 1.         0.72413793]
 46%|████▌     | 46/100 [03:03<03:51,  4.29s/it] 47%|████▋     | 47/100 [03:06<03:22,  3.82s/it] 48%|████▊     | 48/100 [03:09<03:18,  3.82s/it] 49%|████▉     | 49/100 [03:12<02:56,  3.47s/it] 50%|█████     | 50/100 [03:20<03:55,  4.71s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8295 / 0.9273 / 0.8889/ [0.73333333 0.9        0.88888889]
                Test acc/f1/spec/sens = 0.5357 / 0.4556 / 0.8975 / 0.6897/ [0.05095541 1.         0.68965517]
 51%|█████     | 51/100 [03:22<03:20,  4.09s/it] 52%|█████▏    | 52/100 [03:26<03:13,  4.02s/it] 53%|█████▎    | 53/100 [03:29<02:51,  3.64s/it] 54%|█████▍    | 54/100 [03:33<02:51,  3.73s/it] 55%|█████▌    | 55/100 [03:39<03:22,  4.49s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8485 / 0.9455 / 0.9111/ [0.73333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.4748 / 0.4221 / 0.9057 / 0.5647/ [0.05095541 1.         0.56465517]
 56%|█████▌    | 56/100 [03:43<03:09,  4.31s/it] 57%|█████▋    | 57/100 [03:46<02:44,  3.82s/it] 58%|█████▊    | 58/100 [03:50<02:41,  3.84s/it] 59%|█████▉    | 59/100 [03:52<02:22,  3.48s/it] 60%|██████    | 60/100 [04:00<03:06,  4.67s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8485 / 0.9455 / 0.9111/ [0.73333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.4643 / 0.4134 / 0.9057 / 0.5431/ [0.05095541 1.         0.54310345]
 61%|██████    | 61/100 [04:02<02:39,  4.08s/it] 62%|██████▏   | 62/100 [04:06<02:32,  4.01s/it] 63%|██████▎   | 63/100 [04:09<02:14,  3.63s/it] 64%|██████▍   | 64/100 [04:13<02:12,  3.69s/it] 65%|██████▌   | 65/100 [04:19<02:36,  4.48s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8295 / 0.9273 / 0.8889/ [0.73333333 0.9        0.88888889]
                Test acc/f1/spec/sens = 0.4769 / 0.4217 / 0.9057 / 0.5690/ [0.05095541 1.         0.56896552]
 66%|██████▌   | 66/100 [04:23<02:25,  4.29s/it] 67%|██████▋   | 67/100 [04:26<02:05,  3.81s/it] 68%|██████▊   | 68/100 [04:29<02:01,  3.79s/it] 69%|██████▉   | 69/100 [04:32<01:47,  3.47s/it] 70%|███████   | 70/100 [04:39<02:19,  4.64s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8375 / 0.9455 / 0.8889/ [0.73333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.5021 / 0.4340 / 0.9057 / 0.6207/ [0.05095541 1.         0.62068966]
 71%|███████   | 71/100 [04:42<01:56,  4.03s/it] 72%|███████▏  | 72/100 [04:46<01:51,  3.99s/it] 73%|███████▎  | 73/100 [04:49<01:36,  3.57s/it] 74%|███████▍  | 74/100 [04:52<01:34,  3.62s/it] 75%|███████▌  | 75/100 [04:59<01:50,  4.43s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8375 / 0.9455 / 0.8889/ [0.73333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.5210 / 0.4471 / 0.9057 / 0.6595/ [0.05095541 1.         0.65948276]
 76%|███████▌  | 76/100 [05:02<01:41,  4.25s/it] 77%|███████▋  | 77/100 [05:05<01:26,  3.76s/it] 78%|███████▊  | 78/100 [05:09<01:23,  3.78s/it] 79%|███████▉  | 79/100 [05:12<01:12,  3.44s/it] 80%|████████  | 80/100 [05:19<01:32,  4.60s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8406 / 0.9273 / 0.9111/ [0.73333333 0.9        0.91111111]
                Test acc/f1/spec/sens = 0.5273 / 0.4512 / 0.9016 / 0.6724/ [0.05095541 1.         0.67241379]
 81%|████████  | 81/100 [05:21<01:15,  3.99s/it] 82%|████████▏ | 82/100 [05:25<01:11,  3.95s/it] 83%|████████▎ | 83/100 [05:28<01:00,  3.57s/it] 84%|████████▍ | 84/100 [05:32<00:58,  3.64s/it] 85%|████████▌ | 85/100 [05:38<01:07,  4.48s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8485 / 0.9455 / 0.9111/ [0.73333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.4832 / 0.4262 / 0.9057 / 0.5819/ [0.05095541 1.         0.58189655]
 86%|████████▌ | 86/100 [05:42<01:00,  4.29s/it] 87%|████████▋ | 87/100 [05:45<00:49,  3.77s/it] 88%|████████▊ | 88/100 [05:48<00:45,  3.77s/it] 89%|████████▉ | 89/100 [05:51<00:37,  3.44s/it] 90%|█████████ | 90/100 [05:59<00:46,  4.66s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8375 / 0.9455 / 0.8889/ [0.73333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.4832 / 0.4262 / 0.9057 / 0.5819/ [0.05095541 1.         0.58189655]
 91%|█████████ | 91/100 [06:01<00:36,  4.04s/it] 92%|█████████▏| 92/100 [06:05<00:31,  3.98s/it] 93%|█████████▎| 93/100 [06:08<00:25,  3.61s/it] 94%|█████████▍| 94/100 [06:12<00:22,  3.69s/it] 95%|█████████▌| 95/100 [06:18<00:22,  4.53s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8375 / 0.9455 / 0.8889/ [0.73333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.4874 / 0.4274 / 0.9057 / 0.5905/ [0.05095541 1.         0.59051724]
 96%|█████████▌| 96/100 [06:22<00:17,  4.34s/it] 97%|█████████▋| 97/100 [06:25<00:11,  3.81s/it] 98%|█████████▊| 98/100 [06:28<00:07,  3.83s/it] 99%|█████████▉| 99/100 [06:31<00:03,  3.49s/it]100%|██████████| 100/100 [06:39<00:00,  4.72s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8485 / 0.9455 / 0.9111/ [0.73333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.5105 / 0.4448 / 0.8975 / 0.6379/ [0.05095541 1.         0.63793103]
Trial 4, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8900 / 0.8485 / 0.9455 / 0.9111/ [0.73333333 0.925      0.91111111]
Test acc/f1/spec/sens = 0.5105 / 0.4448 / 0.8975 / 0.6379/ [0.05095541 1.         0.63793103]
>> Finished.
Acc, agreement for latest model:  0.5105042016806722 0.5630252100840336 [0.05095541 1.         0.63793103]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4642857142857143 0.5168067226890757 [0.08917197 1.         0.51724138]
Trial 3/5 || Cycle 3/5 || Label set size 540 || Test acc 0.4643 || Test agreement 0.5168 || Spec 0.9180 || Sens 0.5172 Class Acc: [0.08917197 1.         0.51724138]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.10s/it]100%|██████████| 2/2 [00:12<00:00,  5.05s/it]100%|██████████| 2/2 [00:12<00:00,  6.26s/it]
Maximum distance from cluster centers is 0.39
labeled set:  720
unlabeled set:  713
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.52it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.83it/s] 67%|██████▋   | 8/12 [00:00<00:00, 11.51it/s]100%|██████████| 12/12 [00:01<00:00,  9.18it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 24, 1: 113, 2: 43}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 40, 2: 45}
Labeled set distribution: 
Number of samples  720
{0: 110, 1: 348, 2: 262}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.2962, agreement = 0.2941, f1 = 0.2626, spec = 0.9959, sens = 0.0000 Class Acc: [0.61146497 0.51724138 0.        ]
Initial model on validation dataset: acc = 0.3600, agreement = 0.3600, f1 = 0.3083, spec = 0.9818, sens = 0.0222 Class Acc: [0.73333333 0.6        0.02222222]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:06,  3.09s/it]  2%|▏         | 2/100 [00:07<06:31,  3.99s/it]  3%|▎         | 3/100 [00:10<05:50,  3.61s/it]  4%|▍         | 4/100 [00:15<06:29,  4.05s/it]  5%|▌         | 5/100 [00:23<08:21,  5.28s/it]Epoch 5: Train acc/f1 = 0.8778 / 0.8523 / 0.9782 / 0.8511/ [0.89090909 0.89367816 0.85114504] 
                Val acc/f1/spec/sens = 0.9100 / 0.8500 / 0.9455 / 1.0000/ [0.53333333 0.95       1.        ]
                Test acc/f1/spec/sens = 0.2332 / 0.2171 / 0.9344 / 0.0862/ [0.14649682 0.7816092  0.0862069 ]
  6%|▌         | 6/100 [00:27<07:49,  4.99s/it]  7%|▋         | 7/100 [00:30<06:49,  4.40s/it]  8%|▊         | 8/100 [00:35<06:58,  4.54s/it]  9%|▉         | 9/100 [00:38<06:16,  4.13s/it] 10%|█         | 10/100 [00:47<08:10,  5.45s/it]Epoch 10: Train acc/f1 = 0.7083 / 0.6100 / 1.0000 / 0.5191/ [0.23636364 1.         0.51908397] 
                Val acc/f1/spec/sens = 0.6400 / 0.5510 / 0.9818 / 0.4889/ [0.2        0.975      0.48888889]
                Test acc/f1/spec/sens = 0.2164 / 0.1490 / 1.0000 / 0.0690/ [0.         1.         0.06896552]
 11%|█         | 11/100 [00:50<07:04,  4.77s/it] 12%|█▏        | 12/100 [00:54<06:49,  4.66s/it] 13%|█▎        | 13/100 [00:57<06:04,  4.19s/it] 14%|█▍        | 14/100 [01:02<06:03,  4.23s/it] 15%|█▌        | 15/100 [01:09<07:19,  5.16s/it]Epoch 15: Train acc/f1 = 0.9597 / 0.9430 / 0.9782 / 0.9809/ [0.88181818 0.9683908  0.98091603] 
                Val acc/f1/spec/sens = 0.8500 / 0.7458 / 0.8545 / 0.9556/ [0.33333333 0.925      0.95555556]
                Test acc/f1/spec/sens = 0.5567 / 0.4802 / 0.8115 / 0.7500/ [0.10191083 0.86206897 0.75      ]
 16%|█▌        | 16/100 [01:14<06:56,  4.96s/it] 17%|█▋        | 17/100 [01:17<06:05,  4.41s/it] 18%|█▊        | 18/100 [01:21<06:02,  4.43s/it] 19%|█▉        | 19/100 [01:24<05:27,  4.04s/it] 20%|██        | 20/100 [01:33<07:14,  5.43s/it]Epoch 20: Train acc/f1 = 0.9542 / 0.9379 / 0.9934 / 0.9046/ [0.94545455 0.99425287 0.90458015] 
                Val acc/f1/spec/sens = 0.9100 / 0.8811 / 1.0000 / 0.9111/ [0.8        0.95       0.91111111]
                Test acc/f1/spec/sens = 0.5021 / 0.4548 / 0.9631 / 0.6207/ [0.0955414  0.91954023 0.62068966]
 21%|██        | 21/100 [01:36<06:17,  4.78s/it] 22%|██▏       | 22/100 [01:41<06:02,  4.65s/it] 23%|██▎       | 23/100 [01:44<05:24,  4.21s/it] 24%|██▍       | 24/100 [01:48<05:24,  4.26s/it] 25%|██▌       | 25/100 [01:55<06:26,  5.16s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8109 / 0.9273 / 0.9333/ [0.53333333 0.95       0.93333333]
                Test acc/f1/spec/sens = 0.5462 / 0.4713 / 0.9057 / 0.7112/ [0.06369427 0.97701149 0.7112069 ]
 26%|██▌       | 26/100 [02:00<06:05,  4.94s/it] 27%|██▋       | 27/100 [02:03<05:21,  4.41s/it] 28%|██▊       | 28/100 [02:07<05:16,  4.40s/it] 29%|██▉       | 29/100 [02:11<04:46,  4.03s/it] 30%|███       | 30/100 [02:19<06:17,  5.40s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8120 / 0.9273 / 0.9111/ [0.6        0.925      0.91111111]
                Test acc/f1/spec/sens = 0.5567 / 0.4886 / 0.9057 / 0.7112/ [0.0955414  0.97701149 0.7112069 ]
 31%|███       | 31/100 [02:22<05:27,  4.75s/it] 32%|███▏      | 32/100 [02:27<05:17,  4.67s/it] 33%|███▎      | 33/100 [02:30<04:41,  4.20s/it] 34%|███▍      | 34/100 [02:34<04:43,  4.30s/it] 35%|███▌      | 35/100 [02:42<05:37,  5.20s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7824 / 0.9091 / 0.8889/ [0.53333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.5441 / 0.4804 / 0.9016 / 0.6853/ [0.0955414  0.97701149 0.68534483]
 36%|███▌      | 36/100 [02:46<05:21,  5.02s/it] 37%|███▋      | 37/100 [02:50<04:41,  4.46s/it] 38%|███▊      | 38/100 [02:54<04:35,  4.45s/it] 39%|███▉      | 39/100 [02:57<04:08,  4.07s/it] 40%|████      | 40/100 [03:06<05:23,  5.39s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8194 / 0.9818 / 0.8667/ [0.66666667 0.95       0.86666667]
                Test acc/f1/spec/sens = 0.5210 / 0.4686 / 0.9098 / 0.6293/ [0.10828025 0.97701149 0.62931034]
 41%|████      | 41/100 [03:09<04:40,  4.75s/it] 42%|████▏     | 42/100 [03:13<04:28,  4.62s/it] 43%|████▎     | 43/100 [03:16<03:56,  4.16s/it] 44%|████▍     | 44/100 [03:21<03:57,  4.23s/it] 45%|████▌     | 45/100 [03:28<04:43,  5.16s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7902 / 0.9273 / 0.8889/ [0.53333333 0.95       0.88888889]
                Test acc/f1/spec/sens = 0.5441 / 0.4813 / 0.9057 / 0.6810/ [0.0955414  0.98850575 0.68103448]
 46%|████▌     | 46/100 [03:32<04:24,  4.90s/it] 47%|████▋     | 47/100 [03:36<03:53,  4.41s/it] 48%|████▊     | 48/100 [03:40<03:49,  4.41s/it] 49%|████▉     | 49/100 [03:43<03:26,  4.05s/it] 50%|█████     | 50/100 [03:52<04:29,  5.39s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8197 / 0.9455 / 0.8889/ [0.66666667 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.5294 / 0.4663 / 0.9057 / 0.6595/ [0.08280255 0.98850575 0.65948276]
 51%|█████     | 51/100 [03:55<03:51,  4.72s/it] 52%|█████▏    | 52/100 [03:59<03:40,  4.60s/it] 53%|█████▎    | 53/100 [04:02<03:15,  4.17s/it] 54%|█████▍    | 54/100 [04:07<03:15,  4.24s/it] 55%|█████▌    | 55/100 [04:14<03:53,  5.19s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7902 / 0.9273 / 0.8889/ [0.53333333 0.95       0.88888889]
                Test acc/f1/spec/sens = 0.5504 / 0.4822 / 0.9016 / 0.6983/ [0.08917197 0.98850575 0.69827586]
 56%|█████▌    | 56/100 [04:19<03:37,  4.95s/it] 57%|█████▋    | 57/100 [04:22<03:09,  4.41s/it] 58%|█████▊    | 58/100 [04:26<03:04,  4.38s/it] 59%|█████▉    | 59/100 [04:29<02:45,  4.04s/it] 60%|██████    | 60/100 [04:38<03:34,  5.37s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8276 / 0.9636 / 0.8889/ [0.66666667 0.95       0.88888889]
                Test acc/f1/spec/sens = 0.5336 / 0.4737 / 0.9057 / 0.6638/ [0.0955414  0.97701149 0.6637931 ]
 61%|██████    | 61/100 [04:41<03:02,  4.69s/it] 62%|██████▏   | 62/100 [04:45<02:55,  4.63s/it] 63%|██████▎   | 63/100 [04:48<02:35,  4.20s/it] 64%|██████▍   | 64/100 [04:53<02:33,  4.27s/it] 65%|██████▌   | 65/100 [05:00<03:01,  5.19s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8197 / 0.9455 / 0.8889/ [0.66666667 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.5420 / 0.4761 / 0.9057 / 0.6810/ [0.08917197 0.98850575 0.68103448]
 66%|██████▌   | 66/100 [05:05<02:48,  4.95s/it] 67%|██████▋   | 67/100 [05:08<02:25,  4.40s/it] 68%|██████▊   | 68/100 [05:12<02:19,  4.37s/it] 69%|██████▉   | 69/100 [05:15<02:05,  4.04s/it] 70%|███████   | 70/100 [05:24<02:43,  5.45s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7902 / 0.9273 / 0.8889/ [0.53333333 0.95       0.88888889]
                Test acc/f1/spec/sens = 0.5441 / 0.4832 / 0.9016 / 0.6810/ [0.10191083 0.97701149 0.68103448]
 71%|███████   | 71/100 [05:27<02:19,  4.81s/it] 72%|███████▏  | 72/100 [05:32<02:11,  4.68s/it] 73%|███████▎  | 73/100 [05:35<01:54,  4.23s/it] 74%|███████▍  | 74/100 [05:39<01:50,  4.26s/it] 75%|███████▌  | 75/100 [05:47<02:08,  5.16s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7902 / 0.9273 / 0.8889/ [0.53333333 0.95       0.88888889]
                Test acc/f1/spec/sens = 0.5441 / 0.4822 / 0.9057 / 0.6810/ [0.10191083 0.97701149 0.68103448]
 76%|███████▌  | 76/100 [05:51<01:58,  4.94s/it] 77%|███████▋  | 77/100 [05:54<01:41,  4.43s/it] 78%|███████▊  | 78/100 [05:59<01:37,  4.43s/it] 79%|███████▉  | 79/100 [06:02<01:25,  4.07s/it] 80%|████████  | 80/100 [06:10<01:47,  5.37s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7902 / 0.9273 / 0.8889/ [0.53333333 0.95       0.88888889]
                Test acc/f1/spec/sens = 0.5462 / 0.4845 / 0.9016 / 0.6853/ [0.10191083 0.97701149 0.68534483]
 81%|████████  | 81/100 [06:13<01:29,  4.71s/it] 82%|████████▏ | 82/100 [06:18<01:23,  4.62s/it] 83%|████████▎ | 83/100 [06:21<01:10,  4.16s/it] 84%|████████▍ | 84/100 [06:25<01:07,  4.24s/it] 85%|████████▌ | 85/100 [06:33<01:18,  5.23s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8093 / 0.9455 / 0.8889/ [0.6        0.95       0.88888889]
                Test acc/f1/spec/sens = 0.5210 / 0.4597 / 0.9057 / 0.6422/ [0.08280255 0.98850575 0.64224138]
 86%|████████▌ | 86/100 [06:37<01:09,  4.95s/it] 87%|████████▋ | 87/100 [06:40<00:57,  4.39s/it] 88%|████████▊ | 88/100 [06:45<00:52,  4.38s/it] 89%|████████▉ | 89/100 [06:48<00:44,  4.04s/it] 90%|█████████ | 90/100 [06:56<00:53,  5.39s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8015 / 0.9273 / 0.8889/ [0.6        0.925      0.88888889]
                Test acc/f1/spec/sens = 0.5546 / 0.4889 / 0.9057 / 0.7026/ [0.10191083 0.97701149 0.70258621]
 91%|█████████ | 91/100 [07:00<00:42,  4.72s/it] 92%|█████████▏| 92/100 [07:04<00:37,  4.64s/it] 93%|█████████▎| 93/100 [07:07<00:29,  4.20s/it] 94%|█████████▍| 94/100 [07:12<00:25,  4.30s/it] 95%|█████████▌| 95/100 [07:19<00:26,  5.24s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8276 / 0.9636 / 0.8889/ [0.66666667 0.95       0.88888889]
                Test acc/f1/spec/sens = 0.5483 / 0.4826 / 0.9057 / 0.6897/ [0.0955414  0.98850575 0.68965517]
 96%|█████████▌| 96/100 [07:24<00:19,  4.98s/it] 97%|█████████▋| 97/100 [07:27<00:13,  4.44s/it] 98%|█████████▊| 98/100 [07:31<00:08,  4.40s/it] 99%|█████████▉| 99/100 [07:34<00:04,  4.05s/it]100%|██████████| 100/100 [07:43<00:00,  5.40s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8093 / 0.9455 / 0.8889/ [0.6        0.95       0.88888889]
                Test acc/f1/spec/sens = 0.5378 / 0.4786 / 0.9057 / 0.6681/ [0.10191083 0.97701149 0.66810345]
Trial 4, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8700 / 0.8093 / 0.9455 / 0.8889/ [0.6        0.95       0.88888889]
Test acc/f1/spec/sens = 0.5378 / 0.4786 / 0.9057 / 0.6681/ [0.10191083 0.97701149 0.66810345]
>> Finished.
Acc, agreement for latest model:  0.5378151260504201 0.6029411764705882 [0.10191083 0.97701149 0.66810345]
Load best checkpoint for thief model
Acc, agreement for best model:  0.28781512605042014 0.3550420168067227 [0.08917197 0.88505747 0.19827586]
Trial 3/5 || Cycle 4/5 || Label set size 720 || Test acc 0.2878 || Test agreement 0.3550 || Spec 0.9221 || Sens 0.1983 Class Acc: [0.08917197 0.88505747 0.19827586]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.36s/it]100%|██████████| 2/2 [00:12<00:00,  5.16s/it]100%|██████████| 2/2 [00:12<00:00,  6.38s/it]
Maximum distance from cluster centers is 0.18
labeled set:  900
unlabeled set:  533
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.49it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.30it/s] 67%|██████▋   | 8/12 [00:00<00:00, 11.99it/s]100%|██████████| 12/12 [00:01<00:00,  9.18it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 27, 1: 75, 2: 78}
Validation set distribution: 
Number of samples  100
{0: 15, 1: 40, 2: 45}
Labeled set distribution: 
Number of samples  900
{0: 137, 1: 423, 2: 340}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.2773, agreement = 0.2500, f1 = 0.2703, spec = 0.9385, sens = 0.0302 Class Acc: [0.37579618 0.75862069 0.03017241]
Initial model on validation dataset: acc = 0.2700, agreement = 0.2700, f1 = 0.2123, spec = 1.0000, sens = 0.0000 Class Acc: [0.33333333 0.55       0.        ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:21,  3.86s/it]  2%|▏         | 2/100 [00:08<07:23,  4.53s/it]  3%|▎         | 3/100 [00:12<06:42,  4.15s/it]  4%|▍         | 4/100 [00:17<07:26,  4.65s/it]  5%|▌         | 5/100 [00:26<09:33,  6.04s/it]Epoch 5: Train acc/f1 = 0.8789 / 0.8337 / 0.9714 / 0.9059/ [0.6350365  0.93617021 0.90588235] 
                Val acc/f1/spec/sens = 0.8900 / 0.7845 / 0.8909 / 1.0000/ [0.33333333 0.975      1.        ]
                Test acc/f1/spec/sens = 0.2815 / 0.2810 / 0.8730 / 0.1724/ [0.1656051  0.7816092  0.17241379]
  6%|▌         | 6/100 [00:31<08:59,  5.74s/it]  7%|▋         | 7/100 [00:35<07:57,  5.13s/it]  8%|▊         | 8/100 [00:40<07:57,  5.19s/it]  9%|▉         | 9/100 [00:44<07:11,  4.74s/it] 10%|█         | 10/100 [00:54<09:22,  6.25s/it]Epoch 10: Train acc/f1 = 0.8589 / 0.7449 / 0.8679 / 0.9412/ [0.2919708  0.97635934 0.94117647] 
                Val acc/f1/spec/sens = 0.8700 / 0.7236 / 0.8909 / 1.0000/ [0.2   0.975 1.   ]
                Test acc/f1/spec/sens = 0.5504 / 0.4203 / 0.7787 / 0.8491/ [0.         0.74712644 0.84913793]
 11%|█         | 11/100 [00:58<08:09,  5.50s/it] 12%|█▏        | 12/100 [01:03<08:02,  5.48s/it] 13%|█▎        | 13/100 [01:07<07:10,  4.95s/it] 14%|█▍        | 14/100 [01:12<07:03,  4.92s/it] 15%|█▌        | 15/100 [01:20<08:25,  5.95s/it]Epoch 15: Train acc/f1 = 0.9811 / 0.9756 / 0.9946 / 0.9853/ [0.98540146 0.97635934 0.98529412] 
                Val acc/f1/spec/sens = 0.8600 / 0.7886 / 0.9091 / 0.9111/ [0.46666667 0.95       0.91111111]
                Test acc/f1/spec/sens = 0.2479 / 0.2310 / 0.8443 / 0.1853/ [0.05732484 0.75862069 0.18534483]
 16%|█▌        | 16/100 [01:25<07:52,  5.63s/it] 17%|█▋        | 17/100 [01:28<06:57,  5.03s/it] 18%|█▊        | 18/100 [01:34<06:55,  5.06s/it] 19%|█▉        | 19/100 [01:37<06:17,  4.67s/it] 20%|██        | 20/100 [01:47<08:18,  6.23s/it]Epoch 20: Train acc/f1 = 0.9922 / 0.9885 / 0.9964 / 0.9971/ [0.98540146 0.99054374 0.99705882] 
                Val acc/f1/spec/sens = 0.9100 / 0.8659 / 0.9455 / 0.9556/ [0.66666667 0.95       0.95555556]
                Test acc/f1/spec/sens = 0.4895 / 0.4305 / 0.8279 / 0.6509/ [0.05095541 0.85057471 0.65086207]
 21%|██        | 21/100 [01:51<07:14,  5.50s/it] 22%|██▏       | 22/100 [01:56<06:55,  5.32s/it] 23%|██▎       | 23/100 [02:00<06:16,  4.89s/it] 24%|██▍       | 24/100 [02:05<06:11,  4.88s/it] 25%|██▌       | 25/100 [02:13<07:22,  5.90s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8027 / 0.9273 / 0.9333/ [0.53333333 0.925      0.93333333]
                Test acc/f1/spec/sens = 0.3992 / 0.3678 / 0.8525 / 0.4698/ [0.05732484 0.82758621 0.46982759]
 26%|██▌       | 26/100 [02:18<06:54,  5.60s/it] 27%|██▋       | 27/100 [02:22<06:08,  5.05s/it] 28%|██▊       | 28/100 [02:26<06:01,  5.02s/it] 29%|██▉       | 29/100 [02:30<05:29,  4.64s/it] 30%|███       | 30/100 [02:40<07:11,  6.16s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7873 / 0.9273 / 0.8889/ [0.53333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3151 / 0.3024 / 0.8893 / 0.2888/ [0.05732484 0.85057471 0.2887931 ]
 31%|███       | 31/100 [02:44<06:16,  5.45s/it] 32%|███▏      | 32/100 [02:49<06:01,  5.32s/it] 33%|███▎      | 33/100 [02:53<05:25,  4.85s/it] 34%|███▍      | 34/100 [02:57<05:21,  4.87s/it] 35%|███▌      | 35/100 [03:06<06:27,  5.96s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7873 / 0.9273 / 0.8889/ [0.53333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.2941 / 0.2857 / 0.8975 / 0.2371/ [0.07006369 0.85057471 0.23706897]
 36%|███▌      | 36/100 [03:11<06:02,  5.66s/it] 37%|███▋      | 37/100 [03:15<05:20,  5.08s/it] 38%|███▊      | 38/100 [03:20<05:13,  5.05s/it] 39%|███▉      | 39/100 [03:23<04:46,  4.70s/it] 40%|████      | 40/100 [03:33<06:08,  6.14s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7873 / 0.9273 / 0.8889/ [0.53333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3634 / 0.3379 / 0.8525 / 0.4224/ [0.05732484 0.75862069 0.42241379]
 41%|████      | 41/100 [03:37<05:20,  5.42s/it] 42%|████▏     | 42/100 [03:42<05:09,  5.33s/it] 43%|████▎     | 43/100 [03:46<04:37,  4.87s/it] 44%|████▍     | 44/100 [03:51<04:35,  4.91s/it] 45%|████▌     | 45/100 [03:59<05:27,  5.95s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7873 / 0.9273 / 0.8889/ [0.53333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3067 / 0.2978 / 0.8566 / 0.3103/ [0.05732484 0.74712644 0.31034483]
 46%|████▌     | 46/100 [04:04<05:06,  5.67s/it] 47%|████▋     | 47/100 [04:08<04:31,  5.11s/it] 48%|████▊     | 48/100 [04:13<04:22,  5.04s/it] 49%|████▉     | 49/100 [04:17<03:58,  4.68s/it] 50%|█████     | 50/100 [04:26<05:08,  6.16s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7950 / 0.9273 / 0.9111/ [0.53333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.3761 / 0.3475 / 0.8402 / 0.4483/ [0.05732484 0.75862069 0.44827586]
 51%|█████     | 51/100 [04:30<04:26,  5.44s/it] 52%|█████▏    | 52/100 [04:35<04:14,  5.30s/it] 53%|█████▎    | 53/100 [04:39<03:49,  4.88s/it] 54%|█████▍    | 54/100 [04:44<03:46,  4.93s/it] 55%|█████▌    | 55/100 [04:52<04:28,  5.97s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7873 / 0.9273 / 0.8889/ [0.53333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3067 / 0.2963 / 0.8975 / 0.2629/ [0.07006369 0.85057471 0.26293103]
 56%|█████▌    | 56/100 [04:57<04:10,  5.70s/it] 57%|█████▋    | 57/100 [05:01<03:41,  5.15s/it] 58%|█████▊    | 58/100 [05:06<03:33,  5.09s/it] 59%|█████▉    | 59/100 [05:10<03:13,  4.73s/it] 60%|██████    | 60/100 [05:20<04:11,  6.28s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7873 / 0.9273 / 0.8889/ [0.53333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3529 / 0.3316 / 0.8934 / 0.3621/ [0.06369427 0.85057471 0.36206897]
 61%|██████    | 61/100 [05:24<03:36,  5.55s/it] 62%|██████▏   | 62/100 [05:29<03:23,  5.36s/it] 63%|██████▎   | 63/100 [05:33<03:01,  4.90s/it] 64%|██████▍   | 64/100 [05:38<02:57,  4.93s/it] 65%|██████▌   | 65/100 [05:46<03:28,  5.96s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7873 / 0.9273 / 0.8889/ [0.53333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3109 / 0.2998 / 0.8607 / 0.3103/ [0.06369427 0.75862069 0.31034483]
 66%|██████▌   | 66/100 [05:51<03:15,  5.74s/it] 67%|██████▋   | 67/100 [05:55<02:50,  5.16s/it] 68%|██████▊   | 68/100 [06:00<02:45,  5.16s/it] 69%|██████▉   | 69/100 [06:04<02:28,  4.78s/it] 70%|███████   | 70/100 [06:13<03:04,  6.16s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7950 / 0.9273 / 0.9111/ [0.53333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.3887 / 0.3566 / 0.8689 / 0.4569/ [0.05732484 0.8045977  0.45689655]
 71%|███████   | 71/100 [06:17<02:38,  5.45s/it] 72%|███████▏  | 72/100 [06:22<02:29,  5.33s/it] 73%|███████▎  | 73/100 [06:26<02:11,  4.87s/it] 74%|███████▍  | 74/100 [06:31<02:07,  4.89s/it] 75%|███████▌  | 75/100 [06:39<02:27,  5.91s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7921 / 0.9273 / 0.9111/ [0.53333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.3319 / 0.3143 / 0.8607 / 0.3534/ [0.05732484 0.77011494 0.35344828]
 76%|███████▌  | 76/100 [06:44<02:16,  5.70s/it] 77%|███████▋  | 77/100 [06:48<01:56,  5.08s/it] 78%|███████▊  | 78/100 [06:53<01:50,  5.04s/it] 79%|███████▉  | 79/100 [06:57<01:38,  4.68s/it] 80%|████████  | 80/100 [07:07<02:03,  6.17s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7873 / 0.9273 / 0.8889/ [0.53333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3235 / 0.3101 / 0.8607 / 0.3362/ [0.06369427 0.75862069 0.3362069 ]
 81%|████████  | 81/100 [07:10<01:44,  5.48s/it] 82%|████████▏ | 82/100 [07:16<01:37,  5.39s/it] 83%|████████▎ | 83/100 [07:19<01:23,  4.91s/it] 84%|████████▍ | 84/100 [07:24<01:18,  4.90s/it] 85%|████████▌ | 85/100 [07:33<01:29,  5.95s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7950 / 0.9273 / 0.9111/ [0.53333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.3487 / 0.3312 / 0.8852 / 0.3621/ [0.06369427 0.82758621 0.36206897]
 86%|████████▌ | 86/100 [07:38<01:18,  5.63s/it] 87%|████████▋ | 87/100 [07:41<01:06,  5.09s/it] 88%|████████▊ | 88/100 [07:46<01:01,  5.09s/it] 89%|████████▉ | 89/100 [07:50<00:51,  4.72s/it] 90%|█████████ | 90/100 [08:00<01:02,  6.21s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7873 / 0.9273 / 0.8889/ [0.53333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3088 / 0.2990 / 0.8975 / 0.2672/ [0.07006369 0.85057471 0.26724138]
 91%|█████████ | 91/100 [08:04<00:49,  5.53s/it] 92%|█████████▏| 92/100 [08:09<00:42,  5.37s/it] 93%|█████████▎| 93/100 [08:13<00:34,  4.91s/it] 94%|█████████▍| 94/100 [08:18<00:29,  4.93s/it] 95%|█████████▌| 95/100 [08:26<00:30,  6.03s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7873 / 0.9273 / 0.8889/ [0.53333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3172 / 0.3058 / 0.8402 / 0.3319/ [0.05732484 0.74712644 0.33189655]
 96%|█████████▌| 96/100 [08:31<00:22,  5.72s/it] 97%|█████████▋| 97/100 [08:35<00:15,  5.18s/it] 98%|█████████▊| 98/100 [08:40<00:10,  5.13s/it] 99%|█████████▉| 99/100 [08:44<00:04,  4.74s/it]100%|██████████| 100/100 [08:54<00:00,  6.25s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7950 / 0.9273 / 0.9111/ [0.53333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.3424 / 0.3230 / 0.8402 / 0.3836/ [0.05732484 0.74712644 0.38362069]
Trial 4, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8600 / 0.7950 / 0.9273 / 0.9111/ [0.53333333 0.925      0.91111111]
Test acc/f1/spec/sens = 0.3424 / 0.3230 / 0.8402 / 0.3836/ [0.05732484 0.74712644 0.38362069]
>> Finished.
Acc, agreement for latest model:  0.34243697478991597 0.4012605042016807 [0.05732484 0.74712644 0.38362069]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4894957983193277 0.5525210084033614 [0.05095541 0.85057471 0.65086207]
Trial 3/5 || Cycle 5/5 || Label set size 900 || Test acc 0.4895 || Test agreement 0.5525 || Spec 0.8279 || Sens 0.6509 Class Acc: [0.05095541 0.85057471 0.65086207]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.33it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.83it/s] 75%|███████▌  | 9/12 [00:01<00:00, 11.69it/s]100%|██████████| 12/12 [00:01<00:00,  8.76it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:04,  1.35it/s] 57%|█████▋    | 4/7 [00:00<00:00,  5.57it/s]100%|██████████| 7/7 [00:01<00:00,  5.76it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2589, -1.2728, -1.2519]), tensor([0.8264, 0.8225, 0.8287]))
Val set stats: mean/std =  (tensor([-1.2072, -1.2252, -1.1987]), tensor([0.8647, 0.8585, 0.8686]))
Validation set distribution: 
Number of samples  100
{0: 18, 1: 43, 2: 39}
Labeled set distribution: 
Number of samples  180
{0: 27, 1: 70, 2: 83}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.2332, agreement = 0.2416, f1 = 0.2188, spec = 0.9098, sens = 0.0302 Class Acc: [0.37579618 0.51724138 0.03017241]
Initial model on validation dataset: acc = 0.4100, agreement = 0.4100, f1 = 0.3121, spec = 1.0000, sens = 0.0256 Class Acc: [0.38888889 0.76744186 0.02564103]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:37,  1.59s/it]  2%|▏         | 2/100 [00:04<04:01,  2.46s/it]  3%|▎         | 3/100 [00:06<03:17,  2.03s/it]  4%|▍         | 4/100 [00:09<03:44,  2.34s/it]  5%|▌         | 5/100 [00:13<04:49,  3.05s/it]Epoch 5: Train acc/f1 = 0.8611 / 0.6825 / 0.8144 / 1.0000/ [0.11111111 0.98571429 1.        ] 
                Val acc/f1/spec/sens = 0.5200 / 0.3770 / 1.0000 / 0.1795/ [0.11111111 1.         0.17948718]
                Test acc/f1/spec/sens = 0.5105 / 0.4013 / 0.8443 / 0.6724/ [0.         1.         0.67241379]
  6%|▌         | 6/100 [00:16<04:50,  3.09s/it]  7%|▋         | 7/100 [00:18<04:01,  2.60s/it]  8%|▊         | 8/100 [00:21<04:14,  2.77s/it]  9%|▉         | 9/100 [00:22<03:37,  2.40s/it] 10%|█         | 10/100 [00:28<05:03,  3.37s/it]Epoch 10: Train acc/f1 = 0.9333 / 0.8798 / 0.9278 / 1.0000/ [0.55555556 1.         1.        ] 
                Val acc/f1/spec/sens = 0.8000 / 0.6180 / 0.7705 / 0.9231/ [0.05555556 1.         0.92307692]
                Test acc/f1/spec/sens = 0.4517 / 0.3606 / 0.6557 / 0.5474/ [0.00636943 1.         0.54741379]
 11%|█         | 11/100 [00:29<04:09,  2.81s/it] 12%|█▏        | 12/100 [00:33<04:17,  2.93s/it] 13%|█▎        | 13/100 [00:34<03:38,  2.52s/it] 14%|█▍        | 14/100 [00:37<03:43,  2.60s/it] 15%|█▌        | 15/100 [00:41<04:20,  3.07s/it]Epoch 15: Train acc/f1 = 0.7056 / 0.6656 / 0.6082 / 0.9880/ [0.88888889 0.3        0.98795181] 
                Val acc/f1/spec/sens = 0.6600 / 0.6355 / 0.8525 / 0.8718/ [0.72222222 0.44186047 0.87179487]
                Test acc/f1/spec/sens = 0.4958 / 0.3447 / 0.3115 / 0.9095/ [0.03821656 0.2183908  0.90948276]
 16%|█▌        | 16/100 [00:44<04:08,  2.96s/it] 17%|█▋        | 17/100 [00:45<03:31,  2.55s/it] 18%|█▊        | 18/100 [00:48<03:42,  2.71s/it] 19%|█▉        | 19/100 [00:50<03:12,  2.38s/it] 20%|██        | 20/100 [00:56<04:24,  3.31s/it]Epoch 20: Train acc/f1 = 0.9889 / 0.9836 / 0.9897 / 0.9880/ [0.96296296 1.         0.98795181] 
                Val acc/f1/spec/sens = 0.8300 / 0.7255 / 0.8197 / 0.9231/ [0.27777778 0.97674419 0.92307692]
                Test acc/f1/spec/sens = 0.5357 / 0.4632 / 0.6598 / 0.7198/ [0.03821656 0.94252874 0.71982759]
 21%|██        | 21/100 [00:57<03:38,  2.77s/it] 22%|██▏       | 22/100 [01:00<03:35,  2.76s/it] 23%|██▎       | 23/100 [01:01<03:04,  2.40s/it] 24%|██▍       | 24/100 [01:04<03:11,  2.51s/it] 25%|██▌       | 25/100 [01:08<03:47,  3.03s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7350 / 0.8197 / 0.9487/ [0.27777778 0.97674419 0.94871795]
                Test acc/f1/spec/sens = 0.6450 / 0.5169 / 0.5779 / 0.9612/ [0.03821656 0.89655172 0.9612069 ]
 26%|██▌       | 26/100 [01:11<03:37,  2.95s/it] 27%|██▋       | 27/100 [01:13<03:04,  2.53s/it] 28%|██▊       | 28/100 [01:16<03:08,  2.62s/it] 29%|██▉       | 29/100 [01:17<02:44,  2.32s/it] 30%|███       | 30/100 [01:23<03:51,  3.30s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7588 / 0.8361 / 0.9487/ [0.33333333 0.97674419 0.94871795]
                Test acc/f1/spec/sens = 0.5777 / 0.4917 / 0.5369 / 0.8405/ [0.04458599 0.83908046 0.84051724]
 31%|███       | 31/100 [01:24<03:12,  2.79s/it] 32%|███▏      | 32/100 [01:27<03:09,  2.79s/it] 33%|███▎      | 33/100 [01:29<02:42,  2.43s/it] 34%|███▍      | 34/100 [01:31<02:47,  2.53s/it] 35%|███▌      | 35/100 [01:36<03:18,  3.06s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7487 / 0.8361 / 0.9231/ [0.33333333 0.97674419 0.92307692]
                Test acc/f1/spec/sens = 0.6197 / 0.5092 / 0.5779 / 0.8922/ [0.03821656 0.94252874 0.89224138]
 36%|███▌      | 36/100 [01:39<03:10,  2.98s/it] 37%|███▋      | 37/100 [01:40<02:41,  2.56s/it] 38%|███▊      | 38/100 [01:43<02:44,  2.65s/it] 39%|███▉      | 39/100 [01:45<02:21,  2.32s/it] 40%|████      | 40/100 [01:50<03:16,  3.27s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7588 / 0.8361 / 0.9487/ [0.33333333 0.97674419 0.94871795]
                Test acc/f1/spec/sens = 0.5945 / 0.4997 / 0.5287 / 0.8621/ [0.03821656 0.88505747 0.86206897]
 41%|████      | 41/100 [01:52<02:42,  2.76s/it] 42%|████▏     | 42/100 [01:54<02:40,  2.76s/it] 43%|████▎     | 43/100 [01:56<02:16,  2.40s/it] 44%|████▍     | 44/100 [01:59<02:26,  2.62s/it] 45%|████▌     | 45/100 [02:03<02:50,  3.10s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7812 / 0.8525 / 0.9487/ [0.38888889 0.97674419 0.94871795]
                Test acc/f1/spec/sens = 0.6239 / 0.5137 / 0.5492 / 0.9052/ [0.03821656 0.93103448 0.90517241]
 46%|████▌     | 46/100 [02:06<02:42,  3.01s/it] 47%|████▋     | 47/100 [02:08<02:15,  2.56s/it] 48%|████▊     | 48/100 [02:10<02:16,  2.63s/it] 49%|████▉     | 49/100 [02:12<01:58,  2.32s/it] 50%|█████     | 50/100 [02:17<02:43,  3.27s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7706 / 0.8525 / 0.9231/ [0.38888889 0.97674419 0.92307692]
                Test acc/f1/spec/sens = 0.6029 / 0.5121 / 0.5615 / 0.8534/ [0.05095541 0.93103448 0.85344828]
 51%|█████     | 51/100 [02:19<02:15,  2.77s/it] 52%|█████▏    | 52/100 [02:22<02:12,  2.77s/it] 53%|█████▎    | 53/100 [02:23<01:53,  2.42s/it] 54%|█████▍    | 54/100 [02:26<01:56,  2.53s/it] 55%|█████▌    | 55/100 [02:30<02:16,  3.03s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7487 / 0.8361 / 0.9231/ [0.33333333 0.97674419 0.92307692]
                Test acc/f1/spec/sens = 0.6176 / 0.5144 / 0.5287 / 0.9052/ [0.03821656 0.89655172 0.90517241]
 56%|█████▌    | 56/100 [02:33<02:10,  2.96s/it] 57%|█████▋    | 57/100 [02:35<01:49,  2.55s/it] 58%|█████▊    | 58/100 [02:38<01:50,  2.64s/it] 59%|█████▉    | 59/100 [02:39<01:34,  2.31s/it] 60%|██████    | 60/100 [02:45<02:10,  3.27s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7588 / 0.8361 / 0.9487/ [0.33333333 0.97674419 0.94871795]
                Test acc/f1/spec/sens = 0.6324 / 0.5241 / 0.5205 / 0.9310/ [0.03821656 0.90804598 0.93103448]
 61%|██████    | 61/100 [02:46<01:46,  2.73s/it] 62%|██████▏   | 62/100 [02:49<01:44,  2.74s/it] 63%|██████▎   | 63/100 [02:51<01:28,  2.38s/it] 64%|██████▍   | 64/100 [02:53<01:30,  2.51s/it] 65%|██████▌   | 65/100 [02:58<01:45,  3.03s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7812 / 0.8525 / 0.9487/ [0.38888889 0.97674419 0.94871795]
                Test acc/f1/spec/sens = 0.6345 / 0.5283 / 0.5041 / 0.9483/ [0.03821656 0.87356322 0.94827586]
 66%|██████▌   | 66/100 [03:00<01:41,  2.98s/it] 67%|██████▋   | 67/100 [03:02<01:24,  2.56s/it] 68%|██████▊   | 68/100 [03:05<01:23,  2.61s/it] 69%|██████▉   | 69/100 [03:06<01:11,  2.31s/it] 70%|███████   | 70/100 [03:12<01:37,  3.25s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7706 / 0.8525 / 0.9231/ [0.38888889 0.97674419 0.92307692]
                Test acc/f1/spec/sens = 0.6113 / 0.5117 / 0.5410 / 0.8879/ [0.04458599 0.89655172 0.88793103]
 71%|███████   | 71/100 [03:13<01:19,  2.72s/it] 72%|███████▏  | 72/100 [03:16<01:17,  2.76s/it] 73%|███████▎  | 73/100 [03:18<01:04,  2.40s/it] 74%|███████▍  | 74/100 [03:21<01:06,  2.54s/it] 75%|███████▌  | 75/100 [03:25<01:16,  3.07s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7487 / 0.8361 / 0.9231/ [0.33333333 0.97674419 0.92307692]
                Test acc/f1/spec/sens = 0.5609 / 0.4825 / 0.5779 / 0.7802/ [0.05095541 0.89655172 0.78017241]
 76%|███████▌  | 76/100 [03:28<01:11,  2.99s/it] 77%|███████▋  | 77/100 [03:29<00:58,  2.53s/it] 78%|███████▊  | 78/100 [03:32<00:57,  2.60s/it] 79%|███████▉  | 79/100 [03:34<00:48,  2.30s/it] 80%|████████  | 80/100 [03:39<01:05,  3.25s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7706 / 0.8525 / 0.9231/ [0.38888889 0.97674419 0.92307692]
                Test acc/f1/spec/sens = 0.6176 / 0.5164 / 0.5574 / 0.8879/ [0.04458599 0.93103448 0.88793103]
 81%|████████  | 81/100 [03:41<00:52,  2.77s/it] 82%|████████▏ | 82/100 [03:43<00:49,  2.78s/it] 83%|████████▎ | 83/100 [03:45<00:41,  2.41s/it] 84%|████████▍ | 84/100 [03:48<00:40,  2.53s/it] 85%|████████▌ | 85/100 [03:52<00:45,  3.06s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7350 / 0.8197 / 0.9487/ [0.27777778 0.97674419 0.94871795]
                Test acc/f1/spec/sens = 0.6324 / 0.5260 / 0.5164 / 0.9267/ [0.03821656 0.91954023 0.92672414]
 86%|████████▌ | 86/100 [03:55<00:41,  2.98s/it] 87%|████████▋ | 87/100 [03:56<00:33,  2.57s/it] 88%|████████▊ | 88/100 [03:59<00:31,  2.64s/it] 89%|████████▉ | 89/100 [04:01<00:25,  2.32s/it] 90%|█████████ | 90/100 [04:06<00:32,  3.23s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7487 / 0.8361 / 0.9231/ [0.33333333 0.97674419 0.92307692]
                Test acc/f1/spec/sens = 0.5546 / 0.4772 / 0.5697 / 0.7543/ [0.05095541 0.93103448 0.75431034]
 91%|█████████ | 91/100 [04:08<00:24,  2.74s/it] 92%|█████████▏| 92/100 [04:11<00:22,  2.76s/it] 93%|█████████▎| 93/100 [04:12<00:16,  2.42s/it] 94%|█████████▍| 94/100 [04:15<00:15,  2.54s/it] 95%|█████████▌| 95/100 [04:19<00:15,  3.05s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7487 / 0.8361 / 0.9231/ [0.33333333 0.97674419 0.92307692]
                Test acc/f1/spec/sens = 0.5819 / 0.4949 / 0.5492 / 0.8233/ [0.05095541 0.89655172 0.82327586]
 96%|█████████▌| 96/100 [04:22<00:11,  2.99s/it] 97%|█████████▋| 97/100 [04:24<00:07,  2.56s/it] 98%|█████████▊| 98/100 [04:26<00:05,  2.61s/it] 99%|█████████▉| 99/100 [04:28<00:02,  2.32s/it]100%|██████████| 100/100 [04:34<00:00,  3.25s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7487 / 0.8361 / 0.9231/ [0.33333333 0.97674419 0.92307692]
                Test acc/f1/spec/sens = 0.6092 / 0.5149 / 0.5615 / 0.8664/ [0.05095541 0.93103448 0.86637931]
Trial 5, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8400 / 0.7487 / 0.8361 / 0.9231/ [0.33333333 0.97674419 0.92307692]
Test acc/f1/spec/sens = 0.6092 / 0.5149 / 0.5615 / 0.8664/ [0.05095541 0.93103448 0.86637931]
>> Finished.
Acc, agreement for latest model:  0.6092436974789915 0.6365546218487395 [0.05095541 0.93103448 0.86637931]
Load best checkpoint for thief model
Acc, agreement for best model:  0.6323529411764706 0.6218487394957983 [0.04458599 0.82758621 0.95689655]
Trial 4/5 || Cycle 1/5 || Label set size 180 || Test acc 0.6324 || Test agreement 0.6218 || Spec 0.5041 || Sens 0.9569 Class Acc: [0.04458599 0.82758621 0.95689655]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.65s/it]100%|██████████| 2/2 [00:12<00:00,  5.28s/it]100%|██████████| 2/2 [00:13<00:00,  6.53s/it]
Maximum distance from cluster centers is 0.54
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.29it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.37it/s] 75%|███████▌  | 9/12 [00:01<00:00, 10.48it/s]100%|██████████| 12/12 [00:01<00:00,  8.31it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 32, 1: 87, 2: 61}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 43, 2: 39}
Labeled set distribution: 
Number of samples  360
{0: 59, 1: 157, 2: 144}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.3529, agreement = 0.3151, f1 = 0.2121, spec = 0.9631, sens = 0.0431 Class Acc: [0.99363057 0.02298851 0.04310345]
Initial model on validation dataset: acc = 0.2100, agreement = 0.2100, f1 = 0.1772, spec = 0.9180, sens = 0.1282 Class Acc: [0.83333333 0.02325581 0.12820513]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<03:28,  2.11s/it]  2%|▏         | 2/100 [00:05<04:43,  2.90s/it]  3%|▎         | 3/100 [00:07<04:07,  2.55s/it]  4%|▍         | 4/100 [00:11<04:46,  2.99s/it]  5%|▌         | 5/100 [00:16<06:02,  3.82s/it]Epoch 5: Train acc/f1 = 0.8389 / 0.8048 / 0.8148 / 0.9514/ [0.6440678  0.8089172  0.95138889] 
                Val acc/f1/spec/sens = 0.7700 / 0.5972 / 0.7213 / 1.0000/ [0.05555556 0.86046512 1.        ]
                Test acc/f1/spec/sens = 0.6555 / 0.5102 / 0.6393 / 0.9957/ [0.01910828 0.89655172 0.99568966]
  6%|▌         | 6/100 [00:19<05:41,  3.64s/it]  7%|▋         | 7/100 [00:22<04:51,  3.13s/it]  8%|▊         | 8/100 [00:25<05:03,  3.30s/it]  9%|▉         | 9/100 [00:27<04:26,  2.93s/it] 10%|█         | 10/100 [00:34<06:11,  4.13s/it]Epoch 10: Train acc/f1 = 0.8806 / 0.8535 / 0.9491 / 0.9028/ [0.83050847 0.87898089 0.90277778] 
                Val acc/f1/spec/sens = 0.9000 / 0.8723 / 0.9508 / 0.8718/ [0.77777778 0.97674419 0.87179487]
                Test acc/f1/spec/sens = 0.3550 / 0.3010 / 0.8033 / 0.3276/ [0.03821656 1.         0.32758621]
 11%|█         | 11/100 [00:36<05:13,  3.52s/it] 12%|█▏        | 12/100 [00:40<05:04,  3.46s/it] 13%|█▎        | 13/100 [00:42<04:27,  3.07s/it] 14%|█▍        | 14/100 [00:45<04:30,  3.15s/it] 15%|█▌        | 15/100 [00:50<05:21,  3.78s/it]Epoch 15: Train acc/f1 = 0.9361 / 0.9208 / 0.9769 / 0.9722/ [0.96610169 0.89171975 0.97222222] 
                Val acc/f1/spec/sens = 0.8900 / 0.8382 / 0.9180 / 0.9744/ [0.55555556 0.95348837 0.97435897]
                Test acc/f1/spec/sens = 0.4517 / 0.3807 / 0.8607 / 0.5388/ [0.03184713 0.97701149 0.5387931 ]
 16%|█▌        | 16/100 [00:54<05:08,  3.68s/it] 17%|█▋        | 17/100 [00:56<04:27,  3.22s/it] 18%|█▊        | 18/100 [00:59<04:28,  3.27s/it] 19%|█▉        | 19/100 [01:01<03:57,  2.93s/it] 20%|██        | 20/100 [01:08<05:20,  4.01s/it]Epoch 20: Train acc/f1 = 0.9694 / 0.9612 / 0.9815 / 0.9792/ [0.89830508 0.98726115 0.97916667] 
                Val acc/f1/spec/sens = 0.8800 / 0.7997 / 0.9016 / 0.9744/ [0.38888889 1.         0.97435897]
                Test acc/f1/spec/sens = 0.2395 / 0.1813 / 0.8156 / 0.1121/ [0.00636943 1.         0.11206897]
 21%|██        | 21/100 [01:10<04:31,  3.44s/it] 22%|██▏       | 22/100 [01:13<04:25,  3.41s/it] 23%|██▎       | 23/100 [01:15<03:51,  3.01s/it] 24%|██▍       | 24/100 [01:19<03:55,  3.10s/it] 25%|██▌       | 25/100 [01:24<04:41,  3.75s/it]Epoch 25: Train acc/f1 = 0.9917 / 0.9882 / 0.9954 / 0.9931/ [0.98305085 0.99363057 0.99305556] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2395 / 0.1802 / 0.8607 / 0.1121/ [0.00636943 1.         0.11206897]
 26%|██▌       | 26/100 [01:27<04:30,  3.65s/it] 27%|██▋       | 27/100 [01:30<03:53,  3.20s/it] 28%|██▊       | 28/100 [01:33<03:53,  3.24s/it] 29%|██▉       | 29/100 [01:35<03:23,  2.87s/it] 30%|███       | 30/100 [01:42<04:40,  4.01s/it]Epoch 30: Train acc/f1 = 0.9972 / 0.9961 / 1.0000 / 1.0000/ [1.         0.99363057 1.        ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8451 / 0.9508 / 0.9487/ [0.61111111 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2521 / 0.1954 / 0.8484 / 0.1379/ [0.00636943 1.         0.13793103]
 31%|███       | 31/100 [01:44<03:57,  3.44s/it] 32%|███▏      | 32/100 [01:47<03:51,  3.40s/it] 33%|███▎      | 33/100 [01:49<03:21,  3.01s/it] 34%|███▍      | 34/100 [01:53<03:25,  3.12s/it] 35%|███▌      | 35/100 [01:58<04:03,  3.75s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8451 / 0.9508 / 0.9487/ [0.61111111 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2542 / 0.2003 / 0.8197 / 0.1379/ [0.01273885 1.         0.13793103]
 36%|███▌      | 36/100 [02:01<03:51,  3.62s/it] 37%|███▋      | 37/100 [02:03<03:18,  3.15s/it] 38%|███▊      | 38/100 [02:07<03:20,  3.23s/it] 39%|███▉      | 39/100 [02:09<02:55,  2.88s/it] 40%|████      | 40/100 [02:15<03:56,  3.95s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2101 / 0.1490 / 0.8484 / 0.0517/ [0.00636943 1.         0.05172414]
 41%|████      | 41/100 [02:17<03:20,  3.40s/it] 42%|████▏     | 42/100 [02:21<03:16,  3.38s/it] 43%|████▎     | 43/100 [02:23<02:49,  2.98s/it] 44%|████▍     | 44/100 [02:26<02:52,  3.09s/it] 45%|████▌     | 45/100 [02:31<03:24,  3.72s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2458 / 0.1920 / 0.8115 / 0.1207/ [0.01273885 1.         0.12068966]
 46%|████▌     | 46/100 [02:34<03:15,  3.61s/it] 47%|████▋     | 47/100 [02:36<02:46,  3.14s/it] 48%|████▊     | 48/100 [02:40<02:46,  3.20s/it] 49%|████▉     | 49/100 [02:42<02:25,  2.85s/it] 50%|█████     | 50/100 [02:48<03:15,  3.91s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2500 / 0.1963 / 0.8197 / 0.1293/ [0.01273885 1.         0.12931034]
 51%|█████     | 51/100 [02:50<02:44,  3.35s/it] 52%|█████▏    | 52/100 [02:54<02:40,  3.35s/it] 53%|█████▎    | 53/100 [02:56<02:19,  2.96s/it] 54%|█████▍    | 54/100 [02:59<02:22,  3.09s/it] 55%|█████▌    | 55/100 [03:04<02:47,  3.72s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2227 / 0.1665 / 0.8197 / 0.0733/ [0.01273885 1.         0.07327586]
 56%|█████▌    | 56/100 [03:08<02:38,  3.61s/it] 57%|█████▋    | 57/100 [03:10<02:15,  3.14s/it] 58%|█████▊    | 58/100 [03:13<02:14,  3.21s/it] 59%|█████▉    | 59/100 [03:15<01:57,  2.87s/it] 60%|██████    | 60/100 [03:22<02:38,  3.95s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2311 / 0.1761 / 0.8238 / 0.0905/ [0.01273885 1.         0.09051724]
 61%|██████    | 61/100 [03:24<02:12,  3.40s/it] 62%|██████▏   | 62/100 [03:27<02:08,  3.39s/it] 63%|██████▎   | 63/100 [03:29<01:51,  3.01s/it] 64%|██████▍   | 64/100 [03:32<01:51,  3.09s/it] 65%|██████▌   | 65/100 [03:38<02:10,  3.73s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8451 / 0.9508 / 0.9487/ [0.61111111 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2164 / 0.1604 / 0.8115 / 0.0603/ [0.01273885 1.         0.06034483]
 66%|██████▌   | 66/100 [03:41<02:03,  3.64s/it] 67%|██████▋   | 67/100 [03:43<01:44,  3.18s/it] 68%|██████▊   | 68/100 [03:47<01:43,  3.23s/it] 69%|██████▉   | 69/100 [03:49<01:29,  2.89s/it] 70%|███████   | 70/100 [03:55<01:59,  3.99s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2584 / 0.2046 / 0.8115 / 0.1466/ [0.01273885 1.         0.14655172]
 71%|███████   | 71/100 [03:57<01:39,  3.42s/it] 72%|███████▏  | 72/100 [04:01<01:35,  3.40s/it] 73%|███████▎  | 73/100 [04:03<01:21,  3.01s/it] 74%|███████▍  | 74/100 [04:06<01:20,  3.10s/it] 75%|███████▌  | 75/100 [04:11<01:33,  3.74s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2395 / 0.1823 / 0.8402 / 0.1121/ [0.00636943 1.         0.11206897]
 76%|███████▌  | 76/100 [04:15<01:27,  3.63s/it] 77%|███████▋  | 77/100 [04:17<01:13,  3.17s/it] 78%|███████▊  | 78/100 [04:20<01:10,  3.22s/it] 79%|███████▉  | 79/100 [04:22<01:01,  2.91s/it] 80%|████████  | 80/100 [04:29<01:20,  4.00s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2332 / 0.1790 / 0.8115 / 0.0948/ [0.01273885 1.         0.09482759]
 81%|████████  | 81/100 [04:31<01:05,  3.45s/it] 82%|████████▏ | 82/100 [04:34<01:01,  3.39s/it] 83%|████████▎ | 83/100 [04:37<00:51,  3.04s/it] 84%|████████▍ | 84/100 [04:40<00:50,  3.14s/it] 85%|████████▌ | 85/100 [04:45<00:56,  3.74s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2122 / 0.1537 / 0.8443 / 0.0517/ [0.01273885 1.         0.05172414]
 86%|████████▌ | 86/100 [04:48<00:50,  3.62s/it] 87%|████████▋ | 87/100 [04:50<00:41,  3.17s/it] 88%|████████▊ | 88/100 [04:54<00:38,  3.21s/it] 89%|████████▉ | 89/100 [04:56<00:31,  2.88s/it] 90%|█████████ | 90/100 [05:02<00:39,  3.95s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2122 / 0.1537 / 0.8443 / 0.0517/ [0.01273885 1.         0.05172414]
 91%|█████████ | 91/100 [05:04<00:30,  3.40s/it] 92%|█████████▏| 92/100 [05:08<00:27,  3.39s/it] 93%|█████████▎| 93/100 [05:10<00:21,  3.00s/it] 94%|█████████▍| 94/100 [05:13<00:18,  3.10s/it] 95%|█████████▌| 95/100 [05:18<00:18,  3.72s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2122 / 0.1543 / 0.8279 / 0.0517/ [0.01273885 1.         0.05172414]
 96%|█████████▌| 96/100 [05:22<00:14,  3.61s/it] 97%|█████████▋| 97/100 [05:24<00:09,  3.15s/it] 98%|█████████▊| 98/100 [05:27<00:06,  3.22s/it] 99%|█████████▉| 99/100 [05:29<00:02,  2.91s/it]100%|██████████| 100/100 [05:36<00:00,  3.98s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.2374 / 0.1836 / 0.8115 / 0.1034/ [0.01273885 1.         0.10344828]
Trial 5, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8800 / 0.8273 / 0.9344 / 0.9487/ [0.55555556 0.95348837 0.94871795]
Test acc/f1/spec/sens = 0.2374 / 0.1836 / 0.8115 / 0.1034/ [0.01273885 1.         0.10344828]
>> Finished.
Acc, agreement for latest model:  0.23739495798319327 0.3067226890756303 [0.01273885 1.         0.10344828]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3550420168067227 0.42857142857142855 [0.03821656 1.         0.32758621]
Trial 4/5 || Cycle 2/5 || Label set size 360 || Test acc 0.3550 || Test agreement 0.4286 || Spec 0.8033 || Sens 0.3276 Class Acc: [0.03821656 1.         0.32758621]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.85s/it]100%|██████████| 2/2 [00:11<00:00,  4.95s/it]100%|██████████| 2/2 [00:12<00:00,  6.13s/it]
Maximum distance from cluster centers is 0.25
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.57it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.13it/s] 67%|██████▋   | 8/12 [00:00<00:00, 11.46it/s]100%|██████████| 12/12 [00:01<00:00,  9.44it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 20, 1: 98, 2: 62}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 43, 2: 39}
Labeled set distribution: 
Number of samples  540
{0: 79, 1: 255, 2: 206}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.2920, agreement = 0.2920, f1 = 0.1743, spec = 0.9016, sens = 0.0043 Class Acc: [0.85987261 0.03448276 0.00431034]
Initial model on validation dataset: acc = 0.2600, agreement = 0.2600, f1 = 0.2374, spec = 0.9016, sens = 0.0513 Class Acc: [0.77777778 0.23255814 0.05128205]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:15,  2.58s/it]  2%|▏         | 2/100 [00:06<05:37,  3.45s/it]  3%|▎         | 3/100 [00:09<04:59,  3.09s/it]  4%|▍         | 4/100 [00:13<05:24,  3.38s/it]  5%|▌         | 5/100 [00:19<06:56,  4.38s/it]Epoch 5: Train acc/f1 = 0.8667 / 0.8012 / 0.9431 / 0.8786/ [0.48101266 0.97647059 0.87864078] 
                Val acc/f1/spec/sens = 0.7900 / 0.7460 / 1.0000 / 0.6923/ [0.55555556 0.97674419 0.69230769]
                Test acc/f1/spec/sens = 0.2479 / 0.1875 / 0.9959 / 0.1336/ [0.         1.         0.13362069]
  6%|▌         | 6/100 [00:23<06:50,  4.37s/it]  7%|▋         | 7/100 [00:26<05:54,  3.81s/it]  8%|▊         | 8/100 [00:30<05:51,  3.82s/it]  9%|▉         | 9/100 [00:32<05:13,  3.44s/it] 10%|█         | 10/100 [00:40<07:01,  4.69s/it]Epoch 10: Train acc/f1 = 0.4852 / 0.2480 / 1.0000 / 0.0243/ [0.02531646 1.         0.02427184] 
                Val acc/f1/spec/sens = 0.4300 / 0.2005 / 1.0000 / 0.0000/ [0. 1. 0.]
                Test acc/f1/spec/sens = 0.1828 / 0.1030 / 1.0000 / 0.0000/ [0. 1. 0.]
 11%|█         | 11/100 [00:42<05:59,  4.04s/it] 12%|█▏        | 12/100 [00:47<06:01,  4.10s/it] 13%|█▎        | 13/100 [00:49<05:18,  3.66s/it] 14%|█▍        | 14/100 [00:53<05:20,  3.72s/it] 15%|█▌        | 15/100 [00:59<06:18,  4.45s/it]Epoch 15: Train acc/f1 = 0.9315 / 0.9115 / 1.0000 / 0.8544/ [1.         0.97254902 0.85436893] 
                Val acc/f1/spec/sens = 0.8700 / 0.8162 / 0.9180 / 0.9231/ [0.55555556 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.2248 / 0.1906 / 1.0000 / 0.0302/ [0.14012739 0.89655172 0.03017241]
 16%|█▌        | 16/100 [01:03<05:57,  4.26s/it] 17%|█▋        | 17/100 [01:06<05:12,  3.76s/it] 18%|█▊        | 18/100 [01:09<05:09,  3.77s/it] 19%|█▉        | 19/100 [01:12<04:36,  3.41s/it] 20%|██        | 20/100 [01:19<06:06,  4.58s/it]Epoch 20: Train acc/f1 = 0.9741 / 0.9629 / 0.9970 / 0.9951/ [0.98734177 0.95294118 0.99514563] 
                Val acc/f1/spec/sens = 0.8300 / 0.7914 / 0.9016 / 0.8718/ [0.66666667 0.86046512 0.87179487]
                Test acc/f1/spec/sens = 0.1849 / 0.1779 / 0.9877 / 0.0560/ [0.22292994 0.45977011 0.05603448]
 21%|██        | 21/100 [01:22<05:14,  3.98s/it] 22%|██▏       | 22/100 [01:26<05:08,  3.96s/it] 23%|██▎       | 23/100 [01:28<04:29,  3.50s/it] 24%|██▍       | 24/100 [01:32<04:34,  3.62s/it] 25%|██▌       | 25/100 [01:38<05:29,  4.39s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7964 / 0.9180 / 0.8462/ [0.55555556 0.97674419 0.84615385]
                Test acc/f1/spec/sens = 0.4622 / 0.4292 / 0.9713 / 0.5259/ [0.13375796 0.88505747 0.52586207]
 26%|██▌       | 26/100 [01:42<05:13,  4.24s/it] 27%|██▋       | 27/100 [01:45<04:32,  3.74s/it] 28%|██▊       | 28/100 [01:49<04:31,  3.78s/it] 29%|██▉       | 29/100 [01:51<04:03,  3.43s/it] 30%|███       | 30/100 [01:59<05:25,  4.66s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8071 / 0.9016 / 0.8718/ [0.55555556 0.97674419 0.87179487]
                Test acc/f1/spec/sens = 0.4265 / 0.4018 / 0.9713 / 0.4569/ [0.13375796 0.87356322 0.45689655]
 31%|███       | 31/100 [02:01<04:42,  4.09s/it] 32%|███▏      | 32/100 [02:05<04:33,  4.02s/it] 33%|███▎      | 33/100 [02:08<04:00,  3.59s/it] 34%|███▍      | 34/100 [02:12<04:02,  3.67s/it] 35%|███▌      | 35/100 [02:18<04:48,  4.44s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8327 / 0.9344 / 0.8462/ [0.66666667 0.97674419 0.84615385]
                Test acc/f1/spec/sens = 0.4391 / 0.4127 / 0.9713 / 0.5216/ [0.14012739 0.75862069 0.52155172]
 36%|███▌      | 36/100 [02:22<04:33,  4.27s/it] 37%|███▋      | 37/100 [02:25<03:57,  3.78s/it] 38%|███▊      | 38/100 [02:28<03:56,  3.81s/it] 39%|███▉      | 39/100 [02:31<03:31,  3.47s/it] 40%|████      | 40/100 [02:38<04:37,  4.63s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8213 / 0.9344 / 0.8205/ [0.66666667 0.97674419 0.82051282]
                Test acc/f1/spec/sens = 0.3950 / 0.3758 / 0.9795 / 0.3922/ [0.13375796 0.87356322 0.39224138]
 41%|████      | 41/100 [02:41<03:57,  4.03s/it] 42%|████▏     | 42/100 [02:45<03:49,  3.96s/it] 43%|████▎     | 43/100 [02:47<03:23,  3.56s/it] 44%|████▍     | 44/100 [02:51<03:24,  3.65s/it] 45%|████▌     | 45/100 [02:58<04:04,  4.44s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8330 / 0.9508 / 0.8462/ [0.66666667 0.97674419 0.84615385]
                Test acc/f1/spec/sens = 0.3908 / 0.3766 / 0.9754 / 0.4095/ [0.15286624 0.77011494 0.40948276]
 46%|████▌     | 46/100 [03:01<03:49,  4.26s/it] 47%|████▋     | 47/100 [03:04<03:19,  3.77s/it] 48%|████▊     | 48/100 [03:08<03:14,  3.74s/it] 49%|████▉     | 49/100 [03:10<02:53,  3.40s/it] 50%|█████     | 50/100 [03:18<03:50,  4.61s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8411 / 0.9344 / 0.8718/ [0.66666667 0.97674419 0.87179487]
                Test acc/f1/spec/sens = 0.3971 / 0.3819 / 0.9754 / 0.4138/ [0.15286624 0.79310345 0.4137931 ]
 51%|█████     | 51/100 [03:20<03:15,  3.99s/it] 52%|█████▏    | 52/100 [03:24<03:09,  3.95s/it] 53%|█████▎    | 53/100 [03:27<02:46,  3.54s/it] 54%|█████▍    | 54/100 [03:31<02:48,  3.67s/it] 55%|█████▌    | 55/100 [03:37<03:20,  4.46s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8411 / 0.9344 / 0.8718/ [0.66666667 0.97674419 0.87179487]
                Test acc/f1/spec/sens = 0.3697 / 0.3557 / 0.9795 / 0.3405/ [0.14012739 0.86206897 0.34051724]
 56%|█████▌    | 56/100 [03:41<03:10,  4.32s/it] 57%|█████▋    | 57/100 [03:44<02:44,  3.84s/it] 58%|█████▊    | 58/100 [03:48<02:41,  3.84s/it] 59%|█████▉    | 59/100 [03:50<02:22,  3.48s/it] 60%|██████    | 60/100 [03:58<03:06,  4.65s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8245 / 0.9180 / 0.8718/ [0.61111111 0.97674419 0.87179487]
                Test acc/f1/spec/sens = 0.3992 / 0.3814 / 0.9754 / 0.4267/ [0.14012739 0.79310345 0.42672414]
 61%|██████    | 61/100 [04:00<02:37,  4.05s/it] 62%|██████▏   | 62/100 [04:04<02:30,  3.97s/it] 63%|██████▎   | 63/100 [04:07<02:12,  3.57s/it] 64%|██████▍   | 64/100 [04:10<02:10,  3.63s/it] 65%|██████▌   | 65/100 [04:17<02:34,  4.42s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8411 / 0.9344 / 0.8718/ [0.66666667 0.97674419 0.87179487]
                Test acc/f1/spec/sens = 0.3866 / 0.3699 / 0.9754 / 0.3879/ [0.14012739 0.82758621 0.38793103]
 66%|██████▌   | 66/100 [04:21<02:24,  4.24s/it] 67%|██████▋   | 67/100 [04:23<02:04,  3.78s/it] 68%|██████▊   | 68/100 [04:27<02:02,  3.83s/it] 69%|██████▉   | 69/100 [04:30<01:47,  3.48s/it] 70%|███████   | 70/100 [04:37<02:19,  4.64s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8411 / 0.9344 / 0.8718/ [0.66666667 0.97674419 0.87179487]
                Test acc/f1/spec/sens = 0.4013 / 0.3854 / 0.9754 / 0.4397/ [0.15286624 0.74712644 0.43965517]
 71%|███████   | 71/100 [04:40<01:56,  4.03s/it] 72%|███████▏  | 72/100 [04:44<01:51,  3.98s/it] 73%|███████▎  | 73/100 [04:46<01:36,  3.56s/it] 74%|███████▍  | 74/100 [04:50<01:35,  3.66s/it] 75%|███████▌  | 75/100 [04:56<01:50,  4.44s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8411 / 0.9344 / 0.8718/ [0.66666667 0.97674419 0.87179487]
                Test acc/f1/spec/sens = 0.3887 / 0.3731 / 0.9754 / 0.3836/ [0.14649682 0.83908046 0.38362069]
 76%|███████▌  | 76/100 [05:00<01:41,  4.25s/it] 77%|███████▋  | 77/100 [05:03<01:26,  3.75s/it] 78%|███████▊  | 78/100 [05:07<01:22,  3.77s/it] 79%|███████▉  | 79/100 [05:09<01:12,  3.47s/it] 80%|████████  | 80/100 [05:17<01:34,  4.72s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8327 / 0.9344 / 0.8462/ [0.66666667 0.97674419 0.84615385]
                Test acc/f1/spec/sens = 0.3824 / 0.3682 / 0.9754 / 0.4052/ [0.14012739 0.75862069 0.40517241]
 81%|████████  | 81/100 [05:20<01:17,  4.08s/it] 82%|████████▏ | 82/100 [05:24<01:12,  4.05s/it] 83%|████████▎ | 83/100 [05:26<01:01,  3.63s/it] 84%|████████▍ | 84/100 [05:30<00:58,  3.68s/it] 85%|████████▌ | 85/100 [05:36<01:06,  4.44s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8411 / 0.9344 / 0.8718/ [0.66666667 0.97674419 0.87179487]
                Test acc/f1/spec/sens = 0.4097 / 0.3881 / 0.9754 / 0.4397/ [0.13375796 0.82758621 0.43965517]
 86%|████████▌ | 86/100 [05:40<00:59,  4.26s/it] 87%|████████▋ | 87/100 [05:43<00:48,  3.75s/it] 88%|████████▊ | 88/100 [05:46<00:45,  3.78s/it] 89%|████████▉ | 89/100 [05:49<00:37,  3.42s/it] 90%|█████████ | 90/100 [05:56<00:46,  4.61s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8245 / 0.9180 / 0.8718/ [0.61111111 0.97674419 0.87179487]
                Test acc/f1/spec/sens = 0.3929 / 0.3750 / 0.9754 / 0.4009/ [0.14012739 0.82758621 0.40086207]
 91%|█████████ | 91/100 [05:59<00:36,  4.02s/it] 92%|█████████▏| 92/100 [06:03<00:31,  3.99s/it] 93%|█████████▎| 93/100 [06:06<00:25,  3.59s/it] 94%|█████████▍| 94/100 [06:09<00:21,  3.65s/it] 95%|█████████▌| 95/100 [06:16<00:22,  4.42s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8327 / 0.9344 / 0.8462/ [0.66666667 0.97674419 0.84615385]
                Test acc/f1/spec/sens = 0.3887 / 0.3729 / 0.9754 / 0.3966/ [0.14649682 0.8045977  0.39655172]
 96%|█████████▌| 96/100 [06:19<00:16,  4.23s/it] 97%|█████████▋| 97/100 [06:22<00:11,  3.75s/it] 98%|█████████▊| 98/100 [06:26<00:07,  3.78s/it] 99%|█████████▉| 99/100 [06:28<00:03,  3.42s/it]100%|██████████| 100/100 [06:36<00:00,  4.64s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8327 / 0.9344 / 0.8462/ [0.66666667 0.97674419 0.84615385]
                Test acc/f1/spec/sens = 0.3824 / 0.3716 / 0.9795 / 0.3922/ [0.15923567 0.75862069 0.39224138]
Trial 5, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8700 / 0.8327 / 0.9344 / 0.8462/ [0.66666667 0.97674419 0.84615385]
Test acc/f1/spec/sens = 0.3824 / 0.3716 / 0.9795 / 0.3922/ [0.15923567 0.75862069 0.39224138]
>> Finished.
Acc, agreement for latest model:  0.38235294117647056 0.41596638655462187 [0.15923567 0.75862069 0.39224138]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4495798319327731 0.48739495798319327 [0.21019108 0.67816092 0.52586207]
Trial 4/5 || Cycle 3/5 || Label set size 540 || Test acc 0.4496 || Test agreement 0.4874 || Spec 0.9959 || Sens 0.5259 Class Acc: [0.21019108 0.67816092 0.52586207]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.84s/it]100%|██████████| 2/2 [00:11<00:00,  4.95s/it]100%|██████████| 2/2 [00:12<00:00,  6.11s/it]
Maximum distance from cluster centers is 0.34
labeled set:  720
unlabeled set:  713
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.57it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.31it/s] 67%|██████▋   | 8/12 [00:00<00:00, 11.47it/s]100%|██████████| 12/12 [00:01<00:00,  9.63it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 35, 1: 82, 2: 63}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 43, 2: 39}
Labeled set distribution: 
Number of samples  720
{0: 114, 1: 337, 2: 269}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.2374, agreement = 0.2479, f1 = 0.1926, spec = 0.3893, sens = 0.3707 Class Acc: [0.04458599 0.22988506 0.37068966]
Initial model on validation dataset: acc = 0.3800, agreement = 0.3800, f1 = 0.3001, spec = 0.2951, sens = 0.6410 Class Acc: [0.05555556 0.27906977 0.64102564]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:09,  3.13s/it]  2%|▏         | 2/100 [00:07<06:25,  3.93s/it]  3%|▎         | 3/100 [00:11<05:58,  3.70s/it]  4%|▍         | 4/100 [00:15<06:42,  4.19s/it]  5%|▌         | 5/100 [00:23<08:24,  5.31s/it]Epoch 5: Train acc/f1 = 0.9153 / 0.8839 / 0.9756 / 0.9033/ [0.75438596 0.97922849 0.90334572] 
                Val acc/f1/spec/sens = 0.8800 / 0.8140 / 0.8689 / 1.0000/ [0.44444444 0.95348837 1.        ]
                Test acc/f1/spec/sens = 0.2626 / 0.2358 / 0.9180 / 0.1552/ [0.04458599 0.94252874 0.15517241]
  6%|▌         | 6/100 [00:27<07:55,  5.06s/it]  7%|▋         | 7/100 [00:30<06:50,  4.41s/it]  8%|▊         | 8/100 [00:35<06:45,  4.41s/it]  9%|▉         | 9/100 [00:38<06:04,  4.01s/it] 10%|█         | 10/100 [00:47<08:16,  5.52s/it]Epoch 10: Train acc/f1 = 0.9403 / 0.9089 / 0.9557 / 0.9814/ [0.70175439 0.98813056 0.98141264] 
                Val acc/f1/spec/sens = 0.9500 / 0.9321 / 0.9508 / 1.0000/ [0.83333333 0.95348837 1.        ]
                Test acc/f1/spec/sens = 0.6429 / 0.5497 / 0.8156 / 0.8836/ [0.14649682 0.89655172 0.88362069]
 11%|█         | 11/100 [00:50<07:08,  4.81s/it] 12%|█▏        | 12/100 [00:54<06:51,  4.68s/it] 13%|█▎        | 13/100 [00:58<06:06,  4.21s/it] 14%|█▍        | 14/100 [01:02<06:06,  4.26s/it] 15%|█▌        | 15/100 [01:09<07:15,  5.13s/it]Epoch 15: Train acc/f1 = 0.8931 / 0.8624 / 1.0000 / 0.7658/ [0.96491228 0.97032641 0.76579926] 
                Val acc/f1/spec/sens = 0.8600 / 0.8329 / 0.9836 / 0.7436/ [0.83333333 0.97674419 0.74358974]
                Test acc/f1/spec/sens = 0.2836 / 0.2807 / 0.9221 / 0.1078/ [0.15923567 0.97701149 0.10775862]
 16%|█▌        | 16/100 [01:13<06:52,  4.91s/it] 17%|█▋        | 17/100 [01:17<06:02,  4.37s/it] 18%|█▊        | 18/100 [01:21<05:57,  4.36s/it] 19%|█▉        | 19/100 [01:24<05:26,  4.04s/it] 20%|██        | 20/100 [01:33<07:12,  5.41s/it]Epoch 20: Train acc/f1 = 0.9819 / 0.9802 / 0.9978 / 0.9703/ [0.97368421 0.99406528 0.97026022] 
                Val acc/f1/spec/sens = 0.8700 / 0.8197 / 0.9508 / 0.9231/ [0.55555556 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.3025 / 0.2641 / 0.9836 / 0.2198/ [0.03821656 1.         0.21982759]
 21%|██        | 21/100 [01:36<06:13,  4.73s/it] 22%|██▏       | 22/100 [01:40<06:03,  4.66s/it] 23%|██▎       | 23/100 [01:44<05:24,  4.21s/it] 24%|██▍       | 24/100 [01:48<05:23,  4.26s/it] 25%|██▌       | 25/100 [01:55<06:29,  5.19s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8398 / 0.9672 / 0.8974/ [0.66666667 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.3782 / 0.3478 / 0.9672 / 0.3534/ [0.07006369 1.         0.35344828]
 26%|██▌       | 26/100 [02:00<06:07,  4.96s/it] 27%|██▋       | 27/100 [02:03<05:19,  4.37s/it] 28%|██▊       | 28/100 [02:07<05:14,  4.37s/it] 29%|██▉       | 29/100 [02:10<04:44,  4.01s/it] 30%|███       | 30/100 [02:19<06:13,  5.34s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8394 / 0.9508 / 0.8974/ [0.66666667 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.3950 / 0.3631 / 0.9385 / 0.3836/ [0.07643312 1.         0.38362069]
 31%|███       | 31/100 [02:22<05:25,  4.72s/it] 32%|███▏      | 32/100 [02:27<05:15,  4.65s/it] 33%|███▎      | 33/100 [02:30<04:42,  4.22s/it] 34%|███▍      | 34/100 [02:34<04:44,  4.31s/it] 35%|███▌      | 35/100 [02:42<05:42,  5.27s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8398 / 0.9672 / 0.8974/ [0.66666667 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.3950 / 0.3597 / 0.9426 / 0.3922/ [0.06369427 1.         0.39224138]
 36%|███▌      | 36/100 [02:46<05:21,  5.03s/it] 37%|███▋      | 37/100 [02:49<04:42,  4.49s/it] 38%|███▊      | 38/100 [02:54<04:37,  4.47s/it] 39%|███▉      | 39/100 [02:57<04:08,  4.07s/it] 40%|████      | 40/100 [03:05<05:22,  5.37s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8398 / 0.9672 / 0.8974/ [0.66666667 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.4097 / 0.3694 / 0.9303 / 0.4267/ [0.05732484 1.         0.42672414]
 41%|████      | 41/100 [03:09<04:37,  4.70s/it] 42%|████▏     | 42/100 [03:13<04:27,  4.61s/it] 43%|████▎     | 43/100 [03:16<03:58,  4.19s/it] 44%|████▍     | 44/100 [03:21<03:56,  4.23s/it] 45%|████▌     | 45/100 [03:28<04:43,  5.15s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8398 / 0.9672 / 0.8974/ [0.66666667 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.3718 / 0.3355 / 0.9385 / 0.3491/ [0.05732484 1.         0.34913793]
 46%|████▌     | 46/100 [03:32<04:27,  4.96s/it] 47%|████▋     | 47/100 [03:36<03:55,  4.44s/it] 48%|████▊     | 48/100 [03:40<03:50,  4.44s/it] 49%|████▉     | 49/100 [03:43<03:27,  4.08s/it] 50%|█████     | 50/100 [03:52<04:28,  5.37s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8554 / 0.9672 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.4391 / 0.4017 / 0.9098 / 0.4655/ [0.08917197 1.         0.46551724]
 51%|█████     | 51/100 [03:55<03:51,  4.72s/it] 52%|█████▏    | 52/100 [03:59<03:43,  4.66s/it] 53%|█████▎    | 53/100 [04:03<03:18,  4.22s/it] 54%|█████▍    | 54/100 [04:07<03:16,  4.27s/it] 55%|█████▌    | 55/100 [04:14<03:50,  5.13s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8398 / 0.9672 / 0.8974/ [0.66666667 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.4076 / 0.3731 / 0.9221 / 0.4095/ [0.07643312 1.         0.40948276]
 56%|█████▌    | 56/100 [04:18<03:35,  4.90s/it] 57%|█████▋    | 57/100 [04:22<03:08,  4.38s/it] 58%|█████▊    | 58/100 [04:26<03:05,  4.42s/it] 59%|█████▉    | 59/100 [04:29<02:45,  4.03s/it] 60%|██████    | 60/100 [04:38<03:33,  5.35s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8554 / 0.9672 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.4181 / 0.3825 / 0.9139 / 0.4267/ [0.08280255 1.         0.42672414]
 61%|██████    | 61/100 [04:41<03:02,  4.69s/it] 62%|██████▏   | 62/100 [04:45<02:53,  4.58s/it] 63%|██████▎   | 63/100 [04:48<02:35,  4.20s/it] 64%|██████▍   | 64/100 [04:53<02:32,  4.23s/it] 65%|██████▌   | 65/100 [05:00<02:58,  5.10s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8554 / 0.9672 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.4181 / 0.3792 / 0.9180 / 0.4353/ [0.07006369 1.         0.43534483]
 66%|██████▌   | 66/100 [05:04<02:45,  4.87s/it] 67%|██████▋   | 67/100 [05:07<02:24,  4.38s/it] 68%|██████▊   | 68/100 [05:12<02:20,  4.38s/it] 69%|██████▉   | 69/100 [05:15<02:04,  4.02s/it] 70%|███████   | 70/100 [05:23<02:40,  5.34s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8554 / 0.9672 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.4139 / 0.3733 / 0.9139 / 0.4310/ [0.06369427 1.         0.43103448]
 71%|███████   | 71/100 [05:27<02:16,  4.69s/it] 72%|███████▏  | 72/100 [05:31<02:10,  4.65s/it] 73%|███████▎  | 73/100 [05:34<01:54,  4.26s/it] 74%|███████▍  | 74/100 [05:39<01:52,  4.33s/it] 75%|███████▌  | 75/100 [05:46<02:09,  5.17s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8398 / 0.9672 / 0.8974/ [0.66666667 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.3971 / 0.3601 / 0.9344 / 0.4009/ [0.05732484 1.         0.40086207]
 76%|███████▌  | 76/100 [05:50<01:58,  4.92s/it] 77%|███████▋  | 77/100 [05:54<01:40,  4.37s/it] 78%|███████▊  | 78/100 [05:58<01:36,  4.37s/it] 79%|███████▉  | 79/100 [06:01<01:24,  4.01s/it] 80%|████████  | 80/100 [06:10<01:47,  5.38s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8554 / 0.9672 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.4076 / 0.3699 / 0.9303 / 0.4181/ [0.06369427 1.         0.41810345]
 81%|████████  | 81/100 [06:13<01:29,  4.73s/it] 82%|████████▏ | 82/100 [06:17<01:22,  4.60s/it] 83%|████████▎ | 83/100 [06:20<01:11,  4.19s/it] 84%|████████▍ | 84/100 [06:25<01:07,  4.23s/it] 85%|████████▌ | 85/100 [06:32<01:18,  5.21s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8554 / 0.9672 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.3992 / 0.3622 / 0.9344 / 0.4052/ [0.05732484 1.         0.40517241]
 86%|████████▌ | 86/100 [06:37<01:09,  5.00s/it] 87%|████████▋ | 87/100 [06:40<00:57,  4.46s/it] 88%|████████▊ | 88/100 [06:45<00:54,  4.51s/it] 89%|████████▉ | 89/100 [06:48<00:45,  4.12s/it] 90%|█████████ | 90/100 [06:56<00:54,  5.48s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8398 / 0.9672 / 0.8974/ [0.66666667 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.3971 / 0.3593 / 0.9344 / 0.4009/ [0.05732484 1.         0.40086207]
 91%|█████████ | 91/100 [07:00<00:43,  4.82s/it] 92%|█████████▏| 92/100 [07:04<00:38,  4.76s/it] 93%|█████████▎| 93/100 [07:07<00:29,  4.27s/it] 94%|█████████▍| 94/100 [07:12<00:25,  4.31s/it] 95%|█████████▌| 95/100 [07:19<00:26,  5.23s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8551 / 0.9508 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.3950 / 0.3580 / 0.9344 / 0.3966/ [0.05732484 1.         0.39655172]
 96%|█████████▌| 96/100 [07:24<00:19,  4.97s/it] 97%|█████████▋| 97/100 [07:27<00:13,  4.42s/it] 98%|█████████▊| 98/100 [07:31<00:08,  4.42s/it] 99%|█████████▉| 99/100 [07:34<00:04,  4.02s/it]100%|██████████| 100/100 [07:43<00:00,  5.34s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8398 / 0.9672 / 0.8974/ [0.66666667 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.4034 / 0.3671 / 0.9139 / 0.4052/ [0.07006369 1.         0.40517241]
Trial 5, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8800 / 0.8398 / 0.9672 / 0.8974/ [0.66666667 0.95348837 0.8974359 ]
Test acc/f1/spec/sens = 0.4034 / 0.3671 / 0.9139 / 0.4052/ [0.07006369 1.         0.40517241]
>> Finished.
Acc, agreement for latest model:  0.40336134453781514 0.4642857142857143 [0.07006369 1.         0.40517241]
Load best checkpoint for thief model
Acc, agreement for best model:  0.6428571428571429 0.6869747899159664 [0.14649682 0.89655172 0.88362069]
Trial 4/5 || Cycle 4/5 || Label set size 720 || Test acc 0.6429 || Test agreement 0.6870 || Spec 0.8156 || Sens 0.8836 Class Acc: [0.14649682 0.89655172 0.88362069]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.13s/it]100%|██████████| 2/2 [00:12<00:00,  5.07s/it]100%|██████████| 2/2 [00:12<00:00,  6.26s/it]
Maximum distance from cluster centers is 0.24
labeled set:  900
unlabeled set:  533
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.46it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.76it/s] 67%|██████▋   | 8/12 [00:01<00:00, 10.23it/s]100%|██████████| 12/12 [00:01<00:00,  8.75it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 27, 1: 83, 2: 70}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 43, 2: 39}
Labeled set distribution: 
Number of samples  900
{0: 141, 1: 420, 2: 339}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.2647, agreement = 0.2374, f1 = 0.2059, spec = 0.7213, sens = 0.0690 Class Acc: [0.65605096 0.08045977 0.06896552]
Initial model on validation dataset: acc = 0.2300, agreement = 0.2300, f1 = 0.1835, spec = 0.9836, sens = 0.1026 Class Acc: [1.         0.02325581 0.1025641 ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:14,  3.78s/it]  2%|▏         | 2/100 [00:09<07:43,  4.73s/it]  3%|▎         | 3/100 [00:12<06:54,  4.27s/it]  4%|▍         | 4/100 [00:18<07:31,  4.70s/it]  5%|▌         | 5/100 [00:26<09:25,  5.95s/it]Epoch 5: Train acc/f1 = 0.8856 / 0.8443 / 0.9572 / 0.8879/ [0.64539007 0.96428571 0.8879056 ] 
                Val acc/f1/spec/sens = 0.8600 / 0.8361 / 0.9836 / 0.8462/ [0.77777778 0.90697674 0.84615385]
                Test acc/f1/spec/sens = 0.2710 / 0.2525 / 0.9221 / 0.1466/ [0.05095541 1.         0.14655172]
  6%|▌         | 6/100 [00:31<09:01,  5.76s/it]  7%|▋         | 7/100 [00:35<07:57,  5.13s/it]  8%|▊         | 8/100 [00:40<07:46,  5.07s/it]  9%|▉         | 9/100 [00:44<07:04,  4.66s/it] 10%|█         | 10/100 [00:54<09:19,  6.22s/it]Epoch 10: Train acc/f1 = 0.9078 / 0.8687 / 0.9697 / 0.9174/ [0.63829787 0.99047619 0.91740413] 
                Val acc/f1/spec/sens = 0.8600 / 0.8116 / 0.9672 / 0.8718/ [0.55555556 0.97674419 0.87179487]
                Test acc/f1/spec/sens = 0.2857 / 0.2727 / 0.9221 / 0.1940/ [0.02547771 1.         0.19396552]
 11%|█         | 11/100 [00:57<08:08,  5.49s/it] 12%|█▏        | 12/100 [01:02<07:50,  5.35s/it] 13%|█▎        | 13/100 [01:06<07:04,  4.88s/it] 14%|█▍        | 14/100 [01:11<07:04,  4.93s/it] 15%|█▌        | 15/100 [01:20<08:24,  5.93s/it]Epoch 15: Train acc/f1 = 0.7744 / 0.7405 / 1.0000 / 0.5428/ [0.65957447 1.         0.54277286] 
                Val acc/f1/spec/sens = 0.7500 / 0.7243 / 1.0000 / 0.4615/ [1.         0.90697674 0.46153846]
                Test acc/f1/spec/sens = 0.2584 / 0.2330 / 1.0000 / 0.0259/ [0.1910828  1.         0.02586207]
 16%|█▌        | 16/100 [01:25<07:59,  5.71s/it] 17%|█▋        | 17/100 [01:29<07:06,  5.14s/it] 18%|█▊        | 18/100 [01:34<06:58,  5.11s/it] 19%|█▉        | 19/100 [01:37<06:16,  4.65s/it] 20%|██        | 20/100 [01:47<08:09,  6.12s/it]Epoch 20: Train acc/f1 = 0.9522 / 0.9456 / 1.0000 / 0.9056/ [1.         0.97380952 0.90560472] 
                Val acc/f1/spec/sens = 0.8600 / 0.8378 / 1.0000 / 0.7179/ [0.88888889 0.97674419 0.71794872]
                Test acc/f1/spec/sens = 0.2227 / 0.2180 / 1.0000 / 0.0733/ [0.06369427 0.90804598 0.07327586]
 21%|██        | 21/100 [01:50<07:07,  5.42s/it] 22%|██▏       | 22/100 [01:55<06:47,  5.23s/it] 23%|██▎       | 23/100 [01:59<06:07,  4.77s/it] 24%|██▍       | 24/100 [02:04<06:07,  4.83s/it] 25%|██▌       | 25/100 [02:12<07:19,  5.86s/it]Epoch 25: Train acc/f1 = 0.9989 / 0.9984 / 1.0000 / 1.0000/ [1.         0.99761905 1.        ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8613 / 0.9180 / 0.9231/ [0.72222222 0.93023256 0.92307692]
                Test acc/f1/spec/sens = 0.2521 / 0.2403 / 0.9467 / 0.1293/ [0.05095541 0.94252874 0.12931034]
 26%|██▌       | 26/100 [02:17<06:52,  5.57s/it] 27%|██▋       | 27/100 [02:21<06:11,  5.08s/it] 28%|██▊       | 28/100 [02:26<06:03,  5.04s/it] 29%|██▉       | 29/100 [02:30<05:27,  4.61s/it] 30%|███       | 30/100 [02:39<07:11,  6.16s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8692 / 0.9344 / 0.9231/ [0.72222222 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.2941 / 0.2932 / 0.9180 / 0.2155/ [0.05732484 0.93103448 0.21551724]
 31%|███       | 31/100 [02:43<06:15,  5.45s/it] 32%|███▏      | 32/100 [02:48<06:00,  5.30s/it] 33%|███▎      | 33/100 [02:52<05:24,  4.84s/it] 34%|███▍      | 34/100 [02:57<05:22,  4.89s/it] 35%|███▌      | 35/100 [03:05<06:22,  5.88s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8609 / 0.9344 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.2815 / 0.2825 / 0.9180 / 0.1853/ [0.05732484 0.94252874 0.18534483]
 36%|███▌      | 36/100 [03:10<06:00,  5.64s/it] 37%|███▋      | 37/100 [03:14<05:23,  5.14s/it] 38%|███▊      | 38/100 [03:19<05:15,  5.09s/it] 39%|███▉      | 39/100 [03:23<04:44,  4.66s/it] 40%|████      | 40/100 [03:32<06:08,  6.14s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8609 / 0.9344 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.2857 / 0.2927 / 0.9139 / 0.1940/ [0.08280255 0.89655172 0.19396552]
 41%|████      | 41/100 [03:36<05:20,  5.42s/it] 42%|████▏     | 42/100 [03:41<05:09,  5.33s/it] 43%|████▎     | 43/100 [03:45<04:37,  4.86s/it] 44%|████▍     | 44/100 [03:50<04:34,  4.89s/it] 45%|████▌     | 45/100 [03:58<05:25,  5.91s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8692 / 0.9344 / 0.9231/ [0.72222222 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.2983 / 0.2940 / 0.9139 / 0.2069/ [0.07643312 0.94252874 0.20689655]
 46%|████▌     | 46/100 [04:03<05:06,  5.68s/it] 47%|████▋     | 47/100 [04:07<04:30,  5.11s/it] 48%|████▊     | 48/100 [04:12<04:25,  5.11s/it] 49%|████▉     | 49/100 [04:16<04:01,  4.74s/it] 50%|█████     | 50/100 [04:26<05:06,  6.14s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8609 / 0.9344 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.2563 / 0.2462 / 0.9262 / 0.1379/ [0.05095541 0.94252874 0.13793103]
 51%|█████     | 51/100 [04:29<04:25,  5.42s/it] 52%|█████▏    | 52/100 [04:34<04:13,  5.29s/it] 53%|█████▎    | 53/100 [04:38<03:47,  4.84s/it] 54%|█████▍    | 54/100 [04:43<03:46,  4.91s/it] 55%|█████▌    | 55/100 [04:51<04:25,  5.89s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8609 / 0.9344 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.2689 / 0.2725 / 0.9221 / 0.1466/ [0.0955414  0.90804598 0.14655172]
 56%|█████▌    | 56/100 [04:56<04:05,  5.57s/it] 57%|█████▋    | 57/100 [05:00<03:33,  4.97s/it] 58%|█████▊    | 58/100 [05:05<03:29,  4.98s/it] 59%|█████▉    | 59/100 [05:09<03:09,  4.63s/it] 60%|██████    | 60/100 [05:18<04:05,  6.14s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8609 / 0.9344 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.2815 / 0.2850 / 0.9180 / 0.1810/ [0.08280255 0.90804598 0.18103448]
 61%|██████    | 61/100 [05:22<03:31,  5.41s/it] 62%|██████▏   | 62/100 [05:27<03:19,  5.26s/it] 63%|██████▎   | 63/100 [05:31<02:58,  4.82s/it] 64%|██████▍   | 64/100 [05:36<02:58,  4.95s/it] 65%|██████▌   | 65/100 [05:44<03:29,  5.98s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8609 / 0.9344 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.2773 / 0.2733 / 0.9180 / 0.1767/ [0.05732484 0.94252874 0.17672414]
 66%|██████▌   | 66/100 [05:49<03:14,  5.71s/it] 67%|██████▋   | 67/100 [05:53<02:49,  5.13s/it] 68%|██████▊   | 68/100 [05:58<02:42,  5.07s/it] 69%|██████▉   | 69/100 [06:02<02:25,  4.69s/it] 70%|███████   | 70/100 [06:11<03:04,  6.16s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8692 / 0.9344 / 0.9231/ [0.72222222 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.2941 / 0.2942 / 0.9098 / 0.2069/ [0.07006369 0.93103448 0.20689655]
 71%|███████   | 71/100 [06:15<02:37,  5.45s/it] 72%|███████▏  | 72/100 [06:20<02:28,  5.29s/it] 73%|███████▎  | 73/100 [06:24<02:09,  4.80s/it] 74%|███████▍  | 74/100 [06:29<02:05,  4.83s/it] 75%|███████▌  | 75/100 [06:37<02:26,  5.87s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8609 / 0.9344 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.3088 / 0.3135 / 0.9057 / 0.2414/ [0.08280255 0.89655172 0.24137931]
 76%|███████▌  | 76/100 [06:42<02:14,  5.60s/it] 77%|███████▋  | 77/100 [06:46<01:56,  5.07s/it] 78%|███████▊  | 78/100 [06:51<01:51,  5.08s/it] 79%|███████▉  | 79/100 [06:55<01:37,  4.66s/it] 80%|████████  | 80/100 [07:04<02:03,  6.17s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8609 / 0.9344 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.2962 / 0.2956 / 0.9180 / 0.2026/ [0.07643312 0.94252874 0.20258621]
 81%|████████  | 81/100 [07:08<01:44,  5.48s/it] 82%|████████▏ | 82/100 [07:13<01:35,  5.32s/it] 83%|████████▎ | 83/100 [07:17<01:22,  4.84s/it] 84%|████████▍ | 84/100 [07:22<01:17,  4.87s/it] 85%|████████▌ | 85/100 [07:30<01:26,  5.75s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8493 / 0.9344 / 0.8718/ [0.72222222 0.95348837 0.87179487]
                Test acc/f1/spec/sens = 0.2899 / 0.2882 / 0.9180 / 0.1983/ [0.05732484 0.95402299 0.19827586]
 86%|████████▌ | 86/100 [07:34<01:15,  5.42s/it] 87%|████████▋ | 87/100 [07:38<01:03,  4.86s/it] 88%|████████▊ | 88/100 [07:42<00:57,  4.77s/it] 89%|████████▉ | 89/100 [07:46<00:48,  4.40s/it] 90%|█████████ | 90/100 [07:55<00:57,  5.71s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8609 / 0.9344 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.2815 / 0.2700 / 0.9180 / 0.1853/ [0.04458599 0.96551724 0.18534483]
 91%|█████████ | 91/100 [07:58<00:45,  5.07s/it] 92%|█████████▏| 92/100 [08:03<00:39,  4.92s/it] 93%|█████████▎| 93/100 [08:06<00:31,  4.50s/it] 94%|█████████▍| 94/100 [08:11<00:27,  4.52s/it] 95%|█████████▌| 95/100 [08:19<00:27,  5.50s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8692 / 0.9344 / 0.9231/ [0.72222222 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.2731 / 0.2701 / 0.9180 / 0.1638/ [0.06369427 0.94252874 0.1637931 ]
 96%|█████████▌| 96/100 [08:23<00:20,  5.25s/it] 97%|█████████▋| 97/100 [08:27<00:14,  4.74s/it] 98%|█████████▊| 98/100 [08:32<00:09,  4.72s/it] 99%|█████████▉| 99/100 [08:35<00:04,  4.37s/it]100%|██████████| 100/100 [08:44<00:00,  5.67s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8609 / 0.9344 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.2857 / 0.2874 / 0.9180 / 0.1853/ [0.07643312 0.93103448 0.18534483]
Trial 5, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8900 / 0.8609 / 0.9344 / 0.8974/ [0.72222222 0.95348837 0.8974359 ]
Test acc/f1/spec/sens = 0.2857 / 0.2874 / 0.9180 / 0.1853/ [0.07643312 0.93103448 0.18534483]
>> Finished.
Acc, agreement for latest model:  0.2857142857142857 0.32142857142857145 [0.07643312 0.93103448 0.18534483]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3697478991596639 0.4327731092436975 [0.41401274 0.87356322 0.15086207]
Trial 4/5 || Cycle 5/5 || Label set size 900 || Test acc 0.3697 || Test agreement 0.4328 || Spec 0.9221 || Sens 0.1509 Class Acc: [0.41401274 0.87356322 0.15086207]
**************************************************************************************************** 

Number of samples  900
0.4546218487394958 0.05509811753877482
        acc  ...                label dist
0  0.382353  ...  {0: 162, 1: 395, 2: 343}
1  0.401261  ...  {0: 168, 1: 426, 2: 306}
2  0.420168  ...  {0: 167, 1: 402, 2: 331}
3  0.489496  ...  {0: 137, 1: 423, 2: 340}
4  0.369748  ...  {0: 141, 1: 420, 2: 339}

[5 rows x 6 columns]
Results saved to  /home/ankita/scratch/data_msa_medical/results_ankita//pocus_resnet18/butterfly_resnet50/SGD/1000_val100/kcenter_v3
