nohup: ignoring input
[24/03/07 12:54:50] [conf.py:  298]: PyTorch Version: torch=1.11.0, cuda=11.3, cudnn=8200
[24/03/07 12:54:50] [conf.py:  300]: ACTIVE:
  ADDENDUM: 180
  ALPHA: 0.2
  AUGMENT: None
  BETA: 1.0
  BUDGET: 1000
  CUTMIX_PROB: 0.0
  CYCLES: 5
  INITIAL: 180
  LA: False
  METHOD: entropy
  PRETRAINED_PATH: /home/ankita/scratch/data_msa_medical/ckpts/resnet50-imagenet1k.pth
  TEMP: 1.0
  TRO: 1.0
  USE_PRETRAINED: True
  VAL: 100
AM:
  SGR: 1000
  THRESHOLD: 0.5
CUDNN_BENCHMARK: True
DS_SEED: 123
EDM:
  HASH: /home/harsh_s/scratch/msacopy/exp/hash/alpha.pt
  NUM_MODELS: 5
  PATH1: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T0.pt
  PATH2: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T1.pt
  PATH3: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T2.pt
  PATH4: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T3.pt
  PATH5: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T4.pt
GR:
  EPSILON: 0.1
  SUR_PATH: /home/harsh_s/scratch/msacopy/GRAD2/batch_training/outputs/trained_models/imagenet_cifar10_to_cifar10_surrogate_10epochs.pt
LOG_DEST: resnet18_resnet50_pocus_240307_125450.txt
LOG_TIME: 240307_125450
METHOD_NAME: v4
OUT_DIR: /home/ankita/scratch/data_msa_medical/results_ankita/
PL:
  CLASS_BLNC: 10
  ITERATIONS: 20
  KAPPA_N: 0.005
  KAPPA_P: 0.05
  NO_PROGRESS: False
  NO_UNCERTAINTY: False
  TAU_N: 0.05
  TAU_P: 0.7
  TEMP_NL: 2.0
RNG_SEED: 1
SAVE_DIR: /home/ankita/scratch/data_msa_medical/results_ankita//pocus_resnet18/butterfly_resnet50/SGD/1000_val100/entropy_v4
THIEF:
  ARCH: resnet50
  DATASET: butterfly
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/Butte
  HARD_LABELS: True
  NUM_TRAIN: 1281167
  SUBSET: 128116
TRAIN:
  BATCH: 16
  EPOCH: 100
  GAMMA: 0.1
  LR: 0.02
  MILESTONES: [20, 40, 60, 80]
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  WDECAY: 0.0005
TRIALS: 5
VICTIM:
  ARCH: resnet18
  DATASET: pocus
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/covid_5_fold
  HEIGHT: 224
  PATH: /home/ankita/scratch/data_msa_medical/victim_models/pocus_resnet18.pth.tar
  PATHIN: /home/harsh_s/scratch/msacopy/ckpts/cifar10-resnet32-inaccurate/checkpoint.pth.tar
  WIDTH: 224
Loaded target dataset of size 476 with 3 classes
target model keys:  122
checkpoint keys:  122

Target model acc = 0.8991596638655462
Val-Acc: 0.8992 Val-Spec: 0.9795 Val-Sens: 0.9224 Class Acc: [0.8343949  0.95402299 0.92241379]
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.64it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.14it/s] 67%|██████▋   | 8/12 [00:00<00:00, 10.56it/s]100%|██████████| 12/12 [00:01<00:00,  9.70it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.76it/s] 57%|█████▋    | 4/7 [00:00<00:00,  6.58it/s]100%|██████████| 7/7 [00:00<00:00,  7.49it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2587, -1.2742, -1.2515]), tensor([0.8385, 0.8326, 0.8417]))
Val set stats: mean/std =  (tensor([-1.1715, -1.1901, -1.1622]), tensor([0.8641, 0.8598, 0.8667]))
Validation set distribution: 
Number of samples  100
{0: 18, 1: 50, 2: 32}
Labeled set distribution: 
Number of samples  180
{0: 34, 1: 67, 2: 79}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.1975, agreement = 0.1933, f1 = 0.1590, spec = 0.6066, sens = 0.1595 Class Acc: [0.00636943 0.64367816 0.15948276]
Initial model on validation dataset: acc = 0.5300, agreement = 0.5300, f1 = 0.3449, spec = 0.9118, sens = 0.2812 Class Acc: [0.      0.88    0.28125]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:29,  1.51s/it]  2%|▏         | 2/100 [00:04<03:57,  2.42s/it]  3%|▎         | 3/100 [00:06<03:12,  1.99s/it]  4%|▍         | 4/100 [00:08<03:32,  2.21s/it]  5%|▌         | 5/100 [00:12<04:35,  2.90s/it]Epoch 5: Train acc/f1 = 0.5167 / 0.4545 / 1.0000 / 0.1899/ [0.32352941 1.         0.18987342] 
                Val acc/f1/spec/sens = 0.5500 / 0.3216 / 1.0000 / 0.1562/ [0.      1.      0.15625]
                Test acc/f1/spec/sens = 0.1891 / 0.1171 / 0.9836 / 0.0043/ [0.01273885 1.         0.00431034]
  6%|▌         | 6/100 [00:15<04:36,  2.94s/it]  7%|▋         | 7/100 [00:17<03:50,  2.48s/it]  8%|▊         | 8/100 [00:19<03:54,  2.55s/it]  9%|▉         | 9/100 [00:21<03:21,  2.22s/it] 10%|█         | 10/100 [00:26<04:37,  3.08s/it]Epoch 10: Train acc/f1 = 0.9111 / 0.8856 / 0.9208 / 0.9747/ [0.76470588 0.91044776 0.97468354] 
                Val acc/f1/spec/sens = 0.9000 / 0.8661 / 0.9412 / 0.9062/ [0.77777778 0.94       0.90625   ]
                Test acc/f1/spec/sens = 0.3803 / 0.3822 / 0.8320 / 0.2069/ [0.61783439 0.4137931  0.20689655]
 11%|█         | 11/100 [00:27<03:51,  2.60s/it] 12%|█▏        | 12/100 [00:30<03:44,  2.55s/it] 13%|█▎        | 13/100 [00:31<03:13,  2.22s/it] 14%|█▍        | 14/100 [00:34<03:20,  2.33s/it] 15%|█▌        | 15/100 [00:38<03:55,  2.77s/it]Epoch 15: Train acc/f1 = 0.9333 / 0.9077 / 0.9208 / 0.9873/ [0.70588235 0.98507463 0.98734177] 
                Val acc/f1/spec/sens = 0.7100 / 0.5289 / 0.6765 / 0.9375/ [0.     0.82   0.9375]
                Test acc/f1/spec/sens = 0.3298 / 0.3287 / 0.9303 / 0.2716/ [0.21656051 0.68965517 0.27155172]
 16%|█▌        | 16/100 [00:40<03:47,  2.70s/it] 17%|█▋        | 17/100 [00:42<03:15,  2.36s/it] 18%|█▊        | 18/100 [00:44<03:20,  2.44s/it] 19%|█▉        | 19/100 [00:46<02:57,  2.19s/it] 20%|██        | 20/100 [00:51<04:08,  3.11s/it]Epoch 20: Train acc/f1 = 0.9889 / 0.9858 / 1.0000 / 0.9873/ [1.         0.98507463 0.98734177] 
                Val acc/f1/spec/sens = 0.9000 / 0.8771 / 0.9853 / 0.8125/ [0.94444444 0.94       0.8125    ]
                Test acc/f1/spec/sens = 0.4244 / 0.3918 / 0.8525 / 0.4957/ [0.10191083 0.81609195 0.49568966]
 21%|██        | 21/100 [00:53<03:26,  2.61s/it] 22%|██▏       | 22/100 [00:55<03:22,  2.60s/it] 23%|██▎       | 23/100 [00:57<02:53,  2.25s/it] 24%|██▍       | 24/100 [00:59<02:57,  2.34s/it] 25%|██▌       | 25/100 [01:03<03:33,  2.85s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8393 / 0.9853 / 0.7812/ [0.94444444 0.88       0.78125   ]
                Test acc/f1/spec/sens = 0.3403 / 0.3514 / 0.8443 / 0.2543/ [0.24203822 0.74712644 0.25431034]
 26%|██▌       | 26/100 [01:06<03:23,  2.75s/it] 27%|██▋       | 27/100 [01:07<02:52,  2.36s/it] 28%|██▊       | 28/100 [01:10<02:54,  2.43s/it] 29%|██▉       | 29/100 [01:11<02:32,  2.15s/it] 30%|███       | 30/100 [01:16<03:31,  3.02s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8684 / 0.9706 / 0.8438/ [0.94444444 0.9        0.84375   ]
                Test acc/f1/spec/sens = 0.3319 / 0.3230 / 0.8607 / 0.2543/ [0.18471338 0.8045977  0.25431034]
 31%|███       | 31/100 [01:18<02:55,  2.55s/it] 32%|███▏      | 32/100 [01:21<02:54,  2.56s/it] 33%|███▎      | 33/100 [01:22<02:28,  2.22s/it] 34%|███▍      | 34/100 [01:24<02:31,  2.30s/it] 35%|███▌      | 35/100 [01:29<03:04,  2.84s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8684 / 0.9706 / 0.8438/ [0.94444444 0.9        0.84375   ]
                Test acc/f1/spec/sens = 0.3130 / 0.3148 / 0.8893 / 0.1983/ [0.18471338 0.85057471 0.19827586]
 36%|███▌      | 36/100 [01:31<02:55,  2.75s/it] 37%|███▋      | 37/100 [01:33<02:28,  2.36s/it] 38%|███▊      | 38/100 [01:35<02:28,  2.39s/it] 39%|███▉      | 39/100 [01:36<02:09,  2.12s/it] 40%|████      | 40/100 [01:41<02:58,  2.97s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8491 / 0.9412 / 0.8438/ [0.83333333 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3466 / 0.3418 / 0.8320 / 0.3017/ [0.17834395 0.77011494 0.30172414]
 41%|████      | 41/100 [01:43<02:28,  2.51s/it] 42%|████▏     | 42/100 [01:45<02:27,  2.54s/it] 43%|████▎     | 43/100 [01:47<02:06,  2.22s/it] 44%|████▍     | 44/100 [01:50<02:10,  2.33s/it] 45%|████▌     | 45/100 [01:54<02:35,  2.83s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8637 / 0.9559 / 0.8438/ [0.88888889 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3382 / 0.3368 / 0.8689 / 0.2672/ [0.17834395 0.81609195 0.26724138]
 46%|████▌     | 46/100 [01:57<02:35,  2.88s/it] 47%|████▋     | 47/100 [01:58<02:11,  2.49s/it] 48%|████▊     | 48/100 [02:01<02:10,  2.50s/it] 49%|████▉     | 49/100 [02:02<01:53,  2.22s/it] 50%|█████     | 50/100 [02:07<02:31,  3.03s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3340 / 0.3355 / 0.8648 / 0.2586/ [0.18471338 0.8045977  0.25862069]
 51%|█████     | 51/100 [02:09<02:05,  2.57s/it] 52%|█████▏    | 52/100 [02:11<02:04,  2.59s/it] 53%|█████▎    | 53/100 [02:13<01:48,  2.31s/it] 54%|█████▍    | 54/100 [02:16<01:50,  2.40s/it] 55%|█████▌    | 55/100 [02:19<02:08,  2.86s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3382 / 0.3325 / 0.8730 / 0.2543/ [0.18471338 0.83908046 0.25431034]
 56%|█████▌    | 56/100 [02:22<02:02,  2.79s/it] 57%|█████▋    | 57/100 [02:24<01:42,  2.39s/it] 58%|█████▊    | 58/100 [02:26<01:42,  2.45s/it] 59%|█████▉    | 59/100 [02:28<01:29,  2.17s/it] 60%|██████    | 60/100 [02:33<02:01,  3.03s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3361 / 0.3369 / 0.8689 / 0.2543/ [0.1910828  0.81609195 0.25431034]
 61%|██████    | 61/100 [02:34<01:40,  2.57s/it] 62%|██████▏   | 62/100 [02:37<01:37,  2.57s/it] 63%|██████▎   | 63/100 [02:38<01:22,  2.22s/it] 64%|██████▍   | 64/100 [02:41<01:24,  2.36s/it] 65%|██████▌   | 65/100 [02:45<01:38,  2.83s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3382 / 0.3374 / 0.8689 / 0.2629/ [0.18471338 0.81609195 0.26293103]
 66%|██████▌   | 66/100 [02:47<01:32,  2.71s/it] 67%|██████▋   | 67/100 [02:49<01:16,  2.33s/it] 68%|██████▊   | 68/100 [02:51<01:16,  2.40s/it] 69%|██████▉   | 69/100 [02:53<01:05,  2.13s/it] 70%|███████   | 70/100 [02:58<01:30,  3.02s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3298 / 0.3293 / 0.8443 / 0.2759/ [0.15923567 0.7816092  0.27586207]
 71%|███████   | 71/100 [02:59<01:13,  2.55s/it] 72%|███████▏  | 72/100 [03:02<01:11,  2.56s/it] 73%|███████▎  | 73/100 [03:03<01:00,  2.25s/it] 74%|███████▍  | 74/100 [03:06<01:00,  2.34s/it] 75%|███████▌  | 75/100 [03:10<01:10,  2.83s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8637 / 0.9559 / 0.8438/ [0.88888889 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3382 / 0.3385 / 0.8402 / 0.2759/ [0.18471338 0.7816092  0.27586207]
 76%|███████▌  | 76/100 [03:13<01:07,  2.80s/it] 77%|███████▋  | 77/100 [03:14<00:55,  2.41s/it] 78%|███████▊  | 78/100 [03:17<00:53,  2.43s/it] 79%|███████▉  | 79/100 [03:18<00:45,  2.15s/it] 80%|████████  | 80/100 [03:23<01:01,  3.08s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3214 / 0.3147 / 0.8852 / 0.2241/ [0.17834395 0.83908046 0.22413793]
 81%|████████  | 81/100 [03:25<00:48,  2.58s/it] 82%|████████▏ | 82/100 [03:27<00:46,  2.56s/it] 83%|████████▎ | 83/100 [03:29<00:37,  2.23s/it] 84%|████████▍ | 84/100 [03:31<00:37,  2.33s/it] 85%|████████▌ | 85/100 [03:35<00:42,  2.81s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3403 / 0.3414 / 0.8361 / 0.2759/ [0.1910828  0.7816092  0.27586207]
 86%|████████▌ | 86/100 [03:38<00:38,  2.76s/it] 87%|████████▋ | 87/100 [03:39<00:30,  2.38s/it] 88%|████████▊ | 88/100 [03:42<00:29,  2.44s/it] 89%|████████▉ | 89/100 [03:43<00:23,  2.14s/it] 90%|█████████ | 90/100 [03:48<00:30,  3.03s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8684 / 0.9706 / 0.8438/ [0.94444444 0.9        0.84375   ]
                Test acc/f1/spec/sens = 0.3130 / 0.3196 / 0.8689 / 0.2112/ [0.1910828 0.8045977 0.2112069]
 91%|█████████ | 91/100 [03:50<00:23,  2.58s/it] 92%|█████████▏| 92/100 [03:53<00:20,  2.61s/it] 93%|█████████▎| 93/100 [03:54<00:15,  2.26s/it] 94%|█████████▍| 94/100 [03:57<00:14,  2.35s/it] 95%|█████████▌| 95/100 [04:01<00:14,  2.86s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3277 / 0.3292 / 0.8443 / 0.2586/ [0.18471338 0.77011494 0.25862069]
 96%|█████████▌| 96/100 [04:03<00:11,  2.80s/it] 97%|█████████▋| 97/100 [04:05<00:07,  2.49s/it] 98%|█████████▊| 98/100 [04:08<00:05,  2.64s/it] 99%|█████████▉| 99/100 [04:10<00:02,  2.36s/it]100%|██████████| 100/100 [04:16<00:00,  3.48s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8879 / 0.9706 / 0.8438/ [0.94444444 0.94       0.84375   ]
                Test acc/f1/spec/sens = 0.3298 / 0.3246 / 0.8689 / 0.2586/ [0.1656051  0.81609195 0.25862069]
Trial 1, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9100 / 0.8879 / 0.9706 / 0.8438/ [0.94444444 0.94       0.84375   ]
Test acc/f1/spec/sens = 0.3298 / 0.3246 / 0.8689 / 0.2586/ [0.1656051  0.81609195 0.25862069]
>> Finished.
Acc, agreement for latest model:  0.32983193277310924 0.3949579831932773 [0.1656051  0.81609195 0.25862069]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3235294117647059 0.3865546218487395 [0.17834395 0.86206897 0.21982759]
Trial 0/1 || Cycle 1/5 || Label set size 180 || Test acc 0.3235 || Test agreement 0.3866 || Spec 0.8934 || Sens 0.2198 Class Acc: [0.17834395 0.86206897 0.21982759]
**************************************************************************************************** 

  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:02<00:19,  2.19s/it] 30%|███       | 3/10 [00:02<00:04,  1.59it/s] 50%|█████     | 5/10 [00:03<00:03,  1.60it/s] 70%|███████   | 7/10 [00:03<00:01,  2.55it/s] 90%|█████████ | 9/10 [00:05<00:00,  1.91it/s]100%|██████████| 10/10 [00:05<00:00,  1.81it/s]
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.41it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.58it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.87it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.60it/s]100%|██████████| 12/12 [00:01<00:00,  8.44it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 65, 1: 55, 2: 60}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 50, 2: 32}
Labeled set distribution: 
Number of samples  360
{0: 99, 1: 122, 2: 139}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.3046, agreement = 0.2857, f1 = 0.2055, spec = 1.0000, sens = 0.0259 Class Acc: [0.84713376 0.06896552 0.02586207]
Initial model on validation dataset: acc = 0.3100, agreement = 0.3100, f1 = 0.2343, spec = 0.9853, sens = 0.0000 Class Acc: [0.44444444 0.46       0.        ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<03:29,  2.12s/it]  2%|▏         | 2/100 [00:05<04:57,  3.04s/it]  3%|▎         | 3/100 [00:08<04:22,  2.70s/it]  4%|▍         | 4/100 [00:12<05:08,  3.21s/it]  5%|▌         | 5/100 [00:18<06:56,  4.39s/it]Epoch 5: Train acc/f1 = 0.6806 / 0.6385 / 0.5973 / 0.9712/ [0.29292929 0.66393443 0.97122302] 
                Val acc/f1/spec/sens = 0.8300 / 0.7767 / 0.9559 / 0.8438/ [0.5     0.94    0.84375]
                Test acc/f1/spec/sens = 0.6197 / 0.4732 / 0.7254 / 0.9526/ [0.02547771 0.8045977  0.95258621]
  6%|▌         | 6/100 [00:23<06:56,  4.43s/it]  7%|▋         | 7/100 [00:25<05:47,  3.73s/it]  8%|▊         | 8/100 [00:28<05:37,  3.67s/it]  9%|▉         | 9/100 [00:31<05:05,  3.36s/it] 10%|█         | 10/100 [00:39<07:10,  4.78s/it]Epoch 10: Train acc/f1 = 0.9389 / 0.9361 / 0.9683 / 0.9640/ [0.92929293 0.91803279 0.96402878] 
                Val acc/f1/spec/sens = 0.8700 / 0.7913 / 0.9412 / 1.0000/ [0.38888889 0.96       1.        ]
                Test acc/f1/spec/sens = 0.2605 / 0.2278 / 0.9918 / 0.1509/ [0.02547771 0.97701149 0.15086207]
 11%|█         | 11/100 [00:42<06:11,  4.17s/it] 12%|█▏        | 12/100 [00:46<06:03,  4.13s/it] 13%|█▎        | 13/100 [00:48<05:17,  3.64s/it] 14%|█▍        | 14/100 [00:53<05:31,  3.85s/it] 15%|█▌        | 15/100 [00:59<06:35,  4.66s/it]Epoch 15: Train acc/f1 = 0.9028 / 0.9020 / 1.0000 / 0.7770/ [0.98989899 0.97540984 0.77697842] 
                Val acc/f1/spec/sens = 0.8000 / 0.7807 / 0.9853 / 0.7188/ [0.94444444 0.8        0.71875   ]
                Test acc/f1/spec/sens = 0.2080 / 0.1769 / 1.0000 / 0.0216/ [0.12738854 0.85057471 0.02155172]
 16%|█▌        | 16/100 [01:03<06:16,  4.48s/it] 17%|█▋        | 17/100 [01:06<05:28,  3.96s/it] 18%|█▊        | 18/100 [01:10<05:21,  3.93s/it] 19%|█▉        | 19/100 [01:13<04:44,  3.52s/it] 20%|██        | 20/100 [01:20<06:18,  4.73s/it]Epoch 20: Train acc/f1 = 0.9083 / 0.9044 / 0.8733 / 1.0000/ [0.76767677 0.91803279 1.        ] 
                Val acc/f1/spec/sens = 0.8300 / 0.7584 / 0.8676 / 1.0000/ [0.38888889 0.88       1.        ]
                Test acc/f1/spec/sens = 0.5210 / 0.4132 / 0.7500 / 0.7672/ [0.01910828 0.77011494 0.76724138]
 21%|██        | 21/100 [01:23<05:37,  4.27s/it] 22%|██▏       | 22/100 [01:28<05:35,  4.30s/it] 23%|██▎       | 23/100 [01:30<04:54,  3.83s/it] 24%|██▍       | 24/100 [01:34<04:55,  3.89s/it] 25%|██▌       | 25/100 [01:41<05:57,  4.77s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8364 / 0.9412 / 0.9062/ [0.66666667 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2374 / 0.2052 / 0.9549 / 0.0948/ [0.03184713 0.98850575 0.09482759]
 26%|██▌       | 26/100 [01:45<05:33,  4.51s/it] 27%|██▋       | 27/100 [01:48<04:49,  3.97s/it] 28%|██▊       | 28/100 [01:52<04:45,  3.96s/it] 29%|██▉       | 29/100 [01:54<04:12,  3.56s/it] 30%|███       | 30/100 [02:03<05:50,  5.01s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2500 / 0.2220 / 0.9549 / 0.1078/ [0.05095541 0.98850575 0.10775862]
 31%|███       | 31/100 [02:06<05:02,  4.38s/it] 32%|███▏      | 32/100 [02:10<04:53,  4.32s/it] 33%|███▎      | 33/100 [02:12<04:13,  3.79s/it] 34%|███▍      | 34/100 [02:16<04:09,  3.77s/it] 35%|███▌      | 35/100 [02:23<05:01,  4.64s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8364 / 0.9412 / 0.9062/ [0.66666667 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2479 / 0.2105 / 0.9508 / 0.1121/ [0.03184713 1.         0.11206897]
 36%|███▌      | 36/100 [02:27<04:42,  4.42s/it] 37%|███▋      | 37/100 [02:30<04:11,  3.99s/it] 38%|███▊      | 38/100 [02:34<04:07,  3.99s/it] 39%|███▉      | 39/100 [02:36<03:37,  3.56s/it] 40%|████      | 40/100 [02:44<04:56,  4.95s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2500 / 0.2215 / 0.9549 / 0.1078/ [0.05095541 0.98850575 0.10775862]
 41%|████      | 41/100 [02:47<04:11,  4.26s/it] 42%|████▏     | 42/100 [02:51<03:57,  4.09s/it] 43%|████▎     | 43/100 [02:54<03:30,  3.70s/it] 44%|████▍     | 44/100 [02:57<03:28,  3.72s/it] 45%|████▌     | 45/100 [03:05<04:21,  4.76s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2479 / 0.2166 / 0.9672 / 0.1034/ [0.04458599 1.         0.10344828]
 46%|████▌     | 46/100 [03:09<04:04,  4.52s/it] 47%|████▋     | 47/100 [03:11<03:33,  4.02s/it] 48%|████▊     | 48/100 [03:16<03:35,  4.14s/it] 49%|████▉     | 49/100 [03:19<03:10,  3.74s/it] 50%|█████     | 50/100 [03:27<04:18,  5.17s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2458 / 0.2128 / 0.9795 / 0.1034/ [0.03821656 1.         0.10344828]
 51%|█████     | 51/100 [03:30<03:37,  4.45s/it] 52%|█████▏    | 52/100 [03:34<03:27,  4.32s/it] 53%|█████▎    | 53/100 [03:37<03:01,  3.86s/it] 54%|█████▍    | 54/100 [03:41<02:59,  3.91s/it] 55%|█████▌    | 55/100 [03:48<03:38,  4.85s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2521 / 0.2235 / 0.9467 / 0.1121/ [0.05095541 0.98850575 0.11206897]
 56%|█████▌    | 56/100 [03:52<03:22,  4.59s/it] 57%|█████▋    | 57/100 [03:54<02:51,  4.00s/it] 58%|█████▊    | 58/100 [03:58<02:48,  4.01s/it] 59%|█████▉    | 59/100 [04:01<02:27,  3.61s/it] 60%|██████    | 60/100 [04:09<03:20,  5.01s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2416 / 0.2136 / 0.9754 / 0.0991/ [0.04458599 0.97701149 0.09913793]
 61%|██████    | 61/100 [04:12<02:48,  4.33s/it] 62%|██████▏   | 62/100 [04:16<02:41,  4.25s/it] 63%|██████▎   | 63/100 [04:19<02:18,  3.75s/it] 64%|██████▍   | 64/100 [04:23<02:18,  3.86s/it] 65%|██████▌   | 65/100 [04:30<02:47,  4.78s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8364 / 0.9412 / 0.9062/ [0.66666667 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2500 / 0.2223 / 0.9549 / 0.1078/ [0.05095541 0.98850575 0.10775862]
 66%|██████▌   | 66/100 [04:34<02:36,  4.61s/it] 67%|██████▋   | 67/100 [04:37<02:12,  4.00s/it] 68%|██████▊   | 68/100 [04:40<02:06,  3.94s/it] 69%|██████▉   | 69/100 [04:43<01:54,  3.69s/it] 70%|███████   | 70/100 [04:51<02:29,  4.99s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2458 / 0.2178 / 0.9590 / 0.0991/ [0.05095541 0.98850575 0.09913793]
 71%|███████   | 71/100 [04:54<02:04,  4.31s/it] 72%|███████▏  | 72/100 [04:58<01:58,  4.22s/it] 73%|███████▎  | 73/100 [05:01<01:42,  3.78s/it] 74%|███████▍  | 74/100 [05:05<01:41,  3.89s/it] 75%|███████▌  | 75/100 [05:12<01:56,  4.66s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2458 / 0.2206 / 0.9549 / 0.1034/ [0.05095541 0.97701149 0.10344828]
 76%|███████▌  | 76/100 [05:16<01:48,  4.53s/it] 77%|███████▋  | 77/100 [05:19<01:32,  4.03s/it] 78%|███████▊  | 78/100 [05:23<01:27,  3.97s/it] 79%|███████▉  | 79/100 [05:25<01:14,  3.57s/it] 80%|████████  | 80/100 [05:33<01:39,  4.98s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2437 / 0.2166 / 0.9795 / 0.0991/ [0.05095541 0.97701149 0.09913793]
 81%|████████  | 81/100 [05:36<01:22,  4.34s/it] 82%|████████▏ | 82/100 [05:40<01:15,  4.21s/it] 83%|████████▎ | 83/100 [05:43<01:03,  3.74s/it] 84%|████████▍ | 84/100 [05:47<01:01,  3.87s/it] 85%|████████▌ | 85/100 [05:53<01:09,  4.65s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2353 / 0.2025 / 0.9672 / 0.0862/ [0.03821656 0.98850575 0.0862069 ]
 86%|████████▌ | 86/100 [05:57<01:02,  4.46s/it] 87%|████████▋ | 87/100 [06:00<00:51,  3.97s/it] 88%|████████▊ | 88/100 [06:04<00:47,  3.97s/it] 89%|████████▉ | 89/100 [06:07<00:38,  3.55s/it] 90%|█████████ | 90/100 [06:15<00:48,  4.84s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2479 / 0.2176 / 0.9631 / 0.1034/ [0.04458599 1.         0.10344828]
 91%|█████████ | 91/100 [06:18<00:38,  4.25s/it] 92%|█████████▏| 92/100 [06:22<00:34,  4.30s/it] 93%|█████████▎| 93/100 [06:24<00:26,  3.76s/it] 94%|█████████▍| 94/100 [06:29<00:23,  3.87s/it] 95%|█████████▌| 95/100 [06:35<00:23,  4.78s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9412 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2479 / 0.2168 / 0.9713 / 0.1034/ [0.04458599 1.         0.10344828]
 96%|█████████▌| 96/100 [06:40<00:18,  4.58s/it] 97%|█████████▋| 97/100 [06:42<00:12,  4.05s/it] 98%|█████████▊| 98/100 [06:47<00:08,  4.06s/it] 99%|█████████▉| 99/100 [06:49<00:03,  3.68s/it]100%|██████████| 100/100 [06:58<00:00,  5.09s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8364 / 0.9412 / 0.9062/ [0.66666667 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.2458 / 0.2166 / 0.9590 / 0.1034/ [0.04458599 0.98850575 0.10344828]
Trial 1, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8700 / 0.8364 / 0.9412 / 0.9062/ [0.66666667 0.92       0.90625   ]
Test acc/f1/spec/sens = 0.2458 / 0.2166 / 0.9590 / 0.1034/ [0.04458599 0.98850575 0.10344828]
>> Finished.
Acc, agreement for latest model:  0.24579831932773108 0.3025210084033613 [0.04458599 0.98850575 0.10344828]
Load best checkpoint for thief model
Acc, agreement for best model:  0.46218487394957986 0.5063025210084033 [0.07643312 1.         0.52155172]
Trial 0/1 || Cycle 2/5 || Label set size 360 || Test acc 0.4622 || Test agreement 0.5063 || Spec 0.9016 || Sens 0.5216 Class Acc: [0.07643312 1.         0.52155172]
**************************************************************************************************** 

  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:02<00:18,  2.31s/it] 33%|███▎      | 3/9 [00:02<00:03,  1.50it/s] 56%|█████▌    | 5/9 [00:04<00:02,  1.37it/s] 78%|███████▊  | 7/9 [00:04<00:00,  2.19it/s]100%|██████████| 9/9 [00:04<00:00,  2.68it/s]100%|██████████| 9/9 [00:04<00:00,  1.82it/s]
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.26it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.26it/s] 58%|█████▊    | 7/12 [00:01<00:00,  8.98it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.62it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.55it/s]100%|██████████| 12/12 [00:01<00:00,  7.08it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 85, 1: 71, 2: 24}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 50, 2: 32}
Labeled set distribution: 
Number of samples  540
{0: 184, 1: 193, 2: 163}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.3256, agreement = 0.3782, f1 = 0.3027, spec = 0.8648, sens = 0.2888 Class Acc: [0.10191083 0.82758621 0.2887931 ]
Initial model on validation dataset: acc = 0.4600, agreement = 0.4600, f1 = 0.2568, spec = 0.8529, sens = 0.0938 Class Acc: [0.      0.86    0.09375]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:00,  3.64s/it]  2%|▏         | 2/100 [00:08<07:14,  4.43s/it]  3%|▎         | 3/100 [00:12<06:40,  4.12s/it]  4%|▍         | 4/100 [00:17<07:10,  4.49s/it]  5%|▌         | 5/100 [00:25<09:00,  5.69s/it]Epoch 5: Train acc/f1 = 0.8037 / 0.7998 / 0.9045 / 0.8712/ [0.64130435 0.9015544  0.87116564] 
                Val acc/f1/spec/sens = 0.8200 / 0.7701 / 0.9706 / 0.7500/ [0.61111111 0.94       0.75      ]
                Test acc/f1/spec/sens = 0.5315 / 0.4473 / 0.8279 / 0.6853/ [0.04458599 1.         0.68534483]
  6%|▌         | 6/100 [00:30<08:25,  5.38s/it]  7%|▋         | 7/100 [00:33<07:19,  4.73s/it]  8%|▊         | 8/100 [00:38<07:11,  4.69s/it]  9%|▉         | 9/100 [00:41<06:19,  4.17s/it] 10%|█         | 10/100 [00:50<08:42,  5.80s/it]Epoch 10: Train acc/f1 = 0.7519 / 0.7278 / 0.8037 / 0.9325/ [0.39673913 0.93782383 0.93251534] 
                Val acc/f1/spec/sens = 0.8300 / 0.6855 / 0.8971 / 0.9375/ [0.16666667 1.         0.9375    ]
                Test acc/f1/spec/sens = 0.4748 / 0.3936 / 0.8361 / 0.6466/ [0.05095541 0.7816092  0.64655172]
 11%|█         | 11/100 [00:53<07:29,  5.05s/it] 12%|█▏        | 12/100 [00:59<07:32,  5.14s/it] 13%|█▎        | 13/100 [01:02<06:47,  4.69s/it] 14%|█▍        | 14/100 [01:07<06:48,  4.75s/it] 15%|█▌        | 15/100 [01:15<08:09,  5.76s/it]Epoch 15: Train acc/f1 = 0.5500 / 0.5112 / 1.0000 / 0.3926/ [0.2173913  1.         0.39263804] 
                Val acc/f1/spec/sens = 0.8200 / 0.6341 / 0.9118 / 1.0000/ [0.05555556 0.98       1.        ]
                Test acc/f1/spec/sens = 0.2269 / 0.1854 / 1.0000 / 0.0000/ [0.13375796 1.         0.        ]
 16%|█▌        | 16/100 [01:20<07:48,  5.58s/it] 17%|█▋        | 17/100 [01:24<06:55,  5.01s/it] 18%|█▊        | 18/100 [01:29<06:37,  4.85s/it] 19%|█▉        | 19/100 [01:32<06:06,  4.53s/it] 20%|██        | 20/100 [01:41<07:47,  5.84s/it]Epoch 20: Train acc/f1 = 0.9074 / 0.9064 / 0.9549 / 0.9877/ [0.76086957 0.97927461 0.98773006] 
                Val acc/f1/spec/sens = 0.7800 / 0.6854 / 0.8971 / 0.9062/ [0.27777778 0.88       0.90625   ]
                Test acc/f1/spec/sens = 0.1996 / 0.1560 / 0.8852 / 0.0647/ [0.03184713 0.86206897 0.06465517]
 21%|██        | 21/100 [01:45<06:41,  5.08s/it] 22%|██▏       | 22/100 [01:49<06:21,  4.89s/it] 23%|██▎       | 23/100 [01:52<05:37,  4.38s/it] 24%|██▍       | 24/100 [01:57<05:42,  4.50s/it] 25%|██▌       | 25/100 [02:05<06:59,  5.59s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7964 / 0.9265 / 0.8750/ [0.55555556 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2080 / 0.1622 / 0.9180 / 0.0517/ [0.04458599 0.91954023 0.05172414]
 26%|██▌       | 26/100 [02:10<06:36,  5.36s/it] 27%|██▋       | 27/100 [02:14<05:51,  4.81s/it] 28%|██▊       | 28/100 [02:18<05:46,  4.81s/it] 29%|██▉       | 29/100 [02:22<05:17,  4.48s/it] 30%|███       | 30/100 [02:31<06:57,  5.96s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8145 / 0.9412 / 0.8750/ [0.61111111 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2080 / 0.1622 / 0.9385 / 0.0388/ [0.05732484 0.93103448 0.0387931 ]
 31%|███       | 31/100 [02:35<05:59,  5.21s/it] 32%|███▏      | 32/100 [02:40<05:43,  5.05s/it] 33%|███▎      | 33/100 [02:43<05:03,  4.54s/it] 34%|███▍      | 34/100 [02:47<04:45,  4.32s/it] 35%|███▌      | 35/100 [02:54<05:34,  5.14s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8065 / 0.9265 / 0.8750/ [0.61111111 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.2038 / 0.1555 / 0.9303 / 0.0388/ [0.04458599 0.93103448 0.0387931 ]
 36%|███▌      | 36/100 [02:58<05:12,  4.89s/it] 37%|███▋      | 37/100 [03:02<04:39,  4.44s/it] 38%|███▊      | 38/100 [03:06<04:32,  4.39s/it] 39%|███▉      | 39/100 [03:09<04:02,  3.98s/it] 40%|████      | 40/100 [03:17<05:08,  5.14s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7869 / 0.9265 / 0.8750/ [0.55555556 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.2038 / 0.1598 / 0.9221 / 0.0431/ [0.05095541 0.90804598 0.04310345]
 41%|████      | 41/100 [03:19<04:19,  4.41s/it] 42%|████▏     | 42/100 [03:23<04:07,  4.26s/it] 43%|████▎     | 43/100 [03:26<03:37,  3.82s/it] 44%|████▍     | 44/100 [03:30<03:37,  3.89s/it] 45%|████▌     | 45/100 [03:37<04:22,  4.77s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8024 / 0.9412 / 0.8438/ [0.61111111 0.94       0.84375   ]
                Test acc/f1/spec/sens = 0.2101 / 0.1586 / 0.9590 / 0.0388/ [0.04458599 0.96551724 0.0387931 ]
 46%|████▌     | 46/100 [03:41<04:02,  4.48s/it] 47%|████▋     | 47/100 [03:43<03:29,  3.96s/it] 48%|████▊     | 48/100 [03:47<03:22,  3.90s/it] 49%|████▉     | 49/100 [03:50<03:03,  3.60s/it] 50%|█████     | 50/100 [03:58<04:10,  5.00s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7964 / 0.9265 / 0.8750/ [0.55555556 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2080 / 0.1575 / 0.9508 / 0.0388/ [0.04458599 0.95402299 0.0387931 ]
 51%|█████     | 51/100 [04:01<03:34,  4.38s/it] 52%|█████▏    | 52/100 [04:05<03:22,  4.22s/it] 53%|█████▎    | 53/100 [04:08<02:58,  3.80s/it] 54%|█████▍    | 54/100 [04:12<02:54,  3.80s/it] 55%|█████▌    | 55/100 [04:19<03:31,  4.71s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7979 / 0.9412 / 0.8750/ [0.55555556 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2059 / 0.1563 / 0.9467 / 0.0388/ [0.04458599 0.94252874 0.0387931 ]
 56%|█████▌    | 56/100 [04:23<03:18,  4.50s/it] 57%|█████▋    | 57/100 [04:25<02:51,  3.98s/it] 58%|█████▊    | 58/100 [04:29<02:47,  3.99s/it] 59%|█████▉    | 59/100 [04:32<02:30,  3.66s/it] 60%|██████    | 60/100 [04:40<03:15,  4.90s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7885 / 0.9118 / 0.8750/ [0.55555556 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.2038 / 0.1586 / 0.9139 / 0.0474/ [0.04458599 0.90804598 0.04741379]
 61%|██████    | 61/100 [04:43<02:47,  4.29s/it] 62%|██████▏   | 62/100 [04:47<02:40,  4.22s/it] 63%|██████▎   | 63/100 [04:50<02:24,  3.89s/it] 64%|██████▍   | 64/100 [04:55<02:27,  4.11s/it] 65%|██████▌   | 65/100 [05:03<03:02,  5.22s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7964 / 0.9265 / 0.8750/ [0.55555556 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2059 / 0.1580 / 0.9344 / 0.0431/ [0.04458599 0.93103448 0.04310345]
 66%|██████▌   | 66/100 [05:07<02:44,  4.85s/it] 67%|██████▋   | 67/100 [05:10<02:24,  4.39s/it] 68%|██████▊   | 68/100 [05:14<02:15,  4.23s/it] 69%|██████▉   | 69/100 [05:17<01:59,  3.86s/it] 70%|███████   | 70/100 [05:24<02:30,  5.01s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8145 / 0.9412 / 0.8750/ [0.61111111 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2038 / 0.1555 / 0.9344 / 0.0388/ [0.04458599 0.93103448 0.0387931 ]
 71%|███████   | 71/100 [05:27<02:06,  4.35s/it] 72%|███████▏  | 72/100 [05:31<01:58,  4.22s/it] 73%|███████▎  | 73/100 [05:34<01:42,  3.79s/it] 74%|███████▍  | 74/100 [05:38<01:40,  3.87s/it] 75%|███████▌  | 75/100 [05:45<01:57,  4.72s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7964 / 0.9265 / 0.8750/ [0.55555556 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2017 / 0.1558 / 0.9221 / 0.0431/ [0.04458599 0.90804598 0.04310345]
 76%|███████▌  | 76/100 [05:49<01:47,  4.46s/it] 77%|███████▋  | 77/100 [05:51<01:31,  3.98s/it] 78%|███████▊  | 78/100 [05:55<01:26,  3.94s/it] 79%|███████▉  | 79/100 [05:58<01:15,  3.58s/it] 80%|████████  | 80/100 [06:06<01:35,  4.80s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7964 / 0.9265 / 0.8750/ [0.55555556 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2038 / 0.1553 / 0.9344 / 0.0388/ [0.04458599 0.93103448 0.0387931 ]
 81%|████████  | 81/100 [06:08<01:19,  4.19s/it] 82%|████████▏ | 82/100 [06:12<01:14,  4.13s/it] 83%|████████▎ | 83/100 [06:15<01:03,  3.74s/it] 84%|████████▍ | 84/100 [06:19<01:01,  3.82s/it] 85%|████████▌ | 85/100 [06:26<01:10,  4.69s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7964 / 0.9265 / 0.8750/ [0.55555556 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2038 / 0.1553 / 0.9344 / 0.0388/ [0.04458599 0.93103448 0.0387931 ]
 86%|████████▌ | 86/100 [06:30<01:02,  4.44s/it] 87%|████████▋ | 87/100 [06:33<00:51,  3.93s/it] 88%|████████▊ | 88/100 [06:36<00:46,  3.91s/it] 89%|████████▉ | 89/100 [06:39<00:39,  3.60s/it] 90%|█████████ | 90/100 [06:47<00:49,  4.93s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8145 / 0.9412 / 0.8750/ [0.61111111 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2038 / 0.1552 / 0.9385 / 0.0388/ [0.04458599 0.93103448 0.0387931 ]
 91%|█████████ | 91/100 [06:50<00:38,  4.32s/it] 92%|█████████▏| 92/100 [06:54<00:33,  4.19s/it] 93%|█████████▎| 93/100 [06:57<00:26,  3.78s/it] 94%|█████████▍| 94/100 [07:01<00:22,  3.82s/it] 95%|█████████▌| 95/100 [07:08<00:23,  4.69s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7964 / 0.9265 / 0.8750/ [0.55555556 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2059 / 0.1589 / 0.9344 / 0.0388/ [0.05095541 0.93103448 0.0387931 ]
 96%|█████████▌| 96/100 [07:12<00:17,  4.48s/it] 97%|█████████▋| 97/100 [07:15<00:12,  4.02s/it] 98%|█████████▊| 98/100 [07:19<00:08,  4.02s/it] 99%|█████████▉| 99/100 [07:21<00:03,  3.68s/it]100%|██████████| 100/100 [07:29<00:00,  4.90s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8145 / 0.9412 / 0.8750/ [0.61111111 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.2038 / 0.1554 / 0.9344 / 0.0388/ [0.04458599 0.93103448 0.0387931 ]
Trial 1, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8600 / 0.8145 / 0.9412 / 0.8750/ [0.61111111 0.94       0.875     ]
Test acc/f1/spec/sens = 0.2038 / 0.1554 / 0.9344 / 0.0388/ [0.04458599 0.93103448 0.0387931 ]
>> Finished.
Acc, agreement for latest model:  0.20378151260504201 0.25840336134453784 [0.04458599 0.93103448 0.0387931 ]
Load best checkpoint for thief model
Acc, agreement for best model:  0.226890756302521 0.2920168067226891 [0.15923567 0.91954023 0.01293103]
Trial 0/1 || Cycle 3/5 || Label set size 540 || Test acc 0.2269 || Test agreement 0.2920 || Spec 0.9672 || Sens 0.0129 Class Acc: [0.15923567 0.91954023 0.01293103]
**************************************************************************************************** 

  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:01<00:11,  1.97s/it] 43%|████▎     | 3/7 [00:02<00:02,  1.73it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.77it/s] 86%|████████▌ | 6/7 [00:03<00:00,  2.18it/s]100%|██████████| 7/7 [00:03<00:00,  1.88it/s]
labeled set:  720
unlabeled set:  713
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.55it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.83it/s] 67%|██████▋   | 8/12 [00:01<00:00,  9.86it/s]100%|██████████| 12/12 [00:01<00:00,  9.10it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 7, 1: 127, 2: 46}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 50, 2: 32}
Labeled set distribution: 
Number of samples  720
{0: 191, 1: 320, 2: 209}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2920, agreement = 0.2731, f1 = 0.2615, spec = 0.7746, sens = 0.1724 Class Acc: [0.56687898 0.11494253 0.17241379]
Initial model on validation dataset: acc = 0.5200, agreement = 0.5200, f1 = 0.3849, spec = 0.8824, sens = 0.2500 Class Acc: [0.11111111 0.84       0.25      ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:37,  3.41s/it]  2%|▏         | 2/100 [00:08<07:01,  4.30s/it]  3%|▎         | 3/100 [00:11<06:19,  3.91s/it]  4%|▍         | 4/100 [00:16<06:58,  4.36s/it]  5%|▌         | 5/100 [00:24<08:51,  5.60s/it]Epoch 5: Train acc/f1 = 0.7306 / 0.6489 / 0.8239 / 0.9378/ [0.20942408 0.90625    0.93779904] 
                Val acc/f1/spec/sens = 0.7600 / 0.6979 / 0.9559 / 0.8125/ [0.38888889 0.86       0.8125    ]
                Test acc/f1/spec/sens = 0.3529 / 0.2945 / 0.8156 / 0.4052/ [0.01273885 0.82758621 0.40517241]
  6%|▌         | 6/100 [00:28<08:05,  5.16s/it]  7%|▋         | 7/100 [00:32<07:05,  4.58s/it]  8%|▊         | 8/100 [00:36<06:55,  4.52s/it]  9%|▉         | 9/100 [00:40<06:18,  4.16s/it] 10%|█         | 10/100 [00:49<08:37,  5.75s/it]Epoch 10: Train acc/f1 = 0.8861 / 0.8745 / 0.9315 / 0.9282/ [0.7486911  0.940625   0.92822967] 
                Val acc/f1/spec/sens = 0.8500 / 0.7554 / 0.9265 / 0.9062/ [0.33333333 1.         0.90625   ]
                Test acc/f1/spec/sens = 0.2689 / 0.2702 / 0.7910 / 0.1853/ [0.07643312 0.83908046 0.18534483]
 11%|█         | 11/100 [00:53<07:34,  5.10s/it] 12%|█▏        | 12/100 [00:57<07:13,  4.92s/it] 13%|█▎        | 13/100 [01:01<06:29,  4.48s/it] 14%|█▍        | 14/100 [01:05<06:23,  4.46s/it] 15%|█▌        | 15/100 [01:13<07:51,  5.54s/it]Epoch 15: Train acc/f1 = 0.8639 / 0.8538 / 0.9883 / 0.7416/ [0.89528796 0.925      0.74162679] 
                Val acc/f1/spec/sens = 0.8000 / 0.6169 / 0.9118 / 0.9062/ [0.05555556 1.         0.90625   ]
                Test acc/f1/spec/sens = 0.2836 / 0.2812 / 0.9754 / 0.1509/ [0.0955414  0.97701149 0.15086207]
 16%|█▌        | 16/100 [01:17<07:18,  5.22s/it] 17%|█▋        | 17/100 [01:21<06:39,  4.81s/it] 18%|█▊        | 18/100 [01:26<06:41,  4.90s/it] 19%|█▉        | 19/100 [01:30<06:01,  4.46s/it] 20%|██        | 20/100 [01:39<07:41,  5.77s/it]Epoch 20: Train acc/f1 = 0.8806 / 0.8613 / 1.0000 / 0.6459/ [0.97905759 0.975      0.64593301] 
                Val acc/f1/spec/sens = 0.7600 / 0.7096 / 1.0000 / 0.5312/ [0.72222222 0.92       0.53125   ]
                Test acc/f1/spec/sens = 0.1555 / 0.1395 / 0.9959 / 0.0086/ [0.0955414  0.65517241 0.00862069]
 21%|██        | 21/100 [01:42<06:40,  5.07s/it] 22%|██▏       | 22/100 [01:47<06:19,  4.87s/it] 23%|██▎       | 23/100 [01:50<05:39,  4.41s/it] 24%|██▍       | 24/100 [01:55<05:42,  4.51s/it] 25%|██▌       | 25/100 [02:03<06:57,  5.56s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7929 / 0.9559 / 0.9375/ [0.5    0.92   0.9375]
                Test acc/f1/spec/sens = 0.2416 / 0.2433 / 0.8934 / 0.2328/ [0.06369427 0.5862069  0.23275862]
 26%|██▌       | 26/100 [02:08<06:39,  5.39s/it] 27%|██▋       | 27/100 [02:12<06:05,  5.00s/it] 28%|██▊       | 28/100 [02:17<06:02,  5.04s/it] 29%|██▉       | 29/100 [02:21<05:35,  4.73s/it] 30%|███       | 30/100 [02:32<07:37,  6.54s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2479 / 0.2447 / 0.9016 / 0.2284/ [0.06369427 0.63218391 0.22844828]
 31%|███       | 31/100 [02:36<06:39,  5.79s/it] 32%|███▏      | 32/100 [02:41<06:29,  5.72s/it] 33%|███▎      | 33/100 [02:46<05:58,  5.35s/it] 34%|███▍      | 34/100 [02:51<05:51,  5.32s/it] 35%|███▌      | 35/100 [03:01<07:21,  6.80s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2584 / 0.2568 / 0.9057 / 0.2500/ [0.06369427 0.63218391 0.25      ]
 36%|███▌      | 36/100 [03:07<06:48,  6.38s/it] 37%|███▋      | 37/100 [03:11<05:58,  5.69s/it] 38%|███▊      | 38/100 [03:16<05:49,  5.63s/it] 39%|███▉      | 39/100 [03:20<05:16,  5.19s/it] 40%|████      | 40/100 [03:31<06:46,  6.78s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2458 / 0.2464 / 0.9098 / 0.2241/ [0.07006369 0.62068966 0.22413793]
 41%|████      | 41/100 [03:35<05:54,  6.01s/it] 42%|████▏     | 42/100 [03:41<05:39,  5.85s/it] 43%|████▎     | 43/100 [03:45<05:04,  5.35s/it] 44%|████▍     | 44/100 [03:50<05:05,  5.45s/it] 45%|████▌     | 45/100 [04:00<06:06,  6.66s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2626 / 0.2609 / 0.9057 / 0.2543/ [0.06369427 0.64367816 0.25431034]
 46%|████▌     | 46/100 [04:05<05:40,  6.30s/it] 47%|████▋     | 47/100 [04:10<05:02,  5.71s/it] 48%|████▊     | 48/100 [04:15<04:48,  5.56s/it] 49%|████▉     | 49/100 [04:19<04:20,  5.10s/it] 50%|█████     | 50/100 [04:29<05:35,  6.71s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2563 / 0.2540 / 0.9016 / 0.2241/ [0.07006369 0.67816092 0.22413793]
 51%|█████     | 51/100 [04:34<04:53,  5.99s/it] 52%|█████▏    | 52/100 [04:39<04:41,  5.85s/it] 53%|█████▎    | 53/100 [04:43<04:12,  5.37s/it] 54%|█████▍    | 54/100 [04:49<04:05,  5.34s/it] 55%|█████▌    | 55/100 [04:58<04:56,  6.59s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2647 / 0.2612 / 0.9016 / 0.2586/ [0.06369427 0.64367816 0.25862069]
 56%|█████▌    | 56/100 [05:04<04:33,  6.20s/it] 57%|█████▋    | 57/100 [05:08<03:59,  5.56s/it] 58%|█████▊    | 58/100 [05:13<03:50,  5.48s/it] 59%|█████▉    | 59/100 [05:17<03:28,  5.09s/it] 60%|██████    | 60/100 [05:28<04:33,  6.84s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2605 / 0.2601 / 0.8975 / 0.2414/ [0.07006369 0.65517241 0.24137931]
 61%|██████    | 61/100 [05:32<03:54,  6.02s/it] 62%|██████▏   | 62/100 [05:38<03:42,  5.86s/it] 63%|██████▎   | 63/100 [05:42<03:20,  5.41s/it] 64%|██████▍   | 64/100 [05:47<03:14,  5.41s/it] 65%|██████▌   | 65/100 [05:57<03:49,  6.57s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2500 / 0.2493 / 0.8893 / 0.2328/ [0.06369427 0.63218391 0.23275862]
 66%|██████▌   | 66/100 [06:03<03:37,  6.39s/it] 67%|██████▋   | 67/100 [06:07<03:10,  5.78s/it] 68%|██████▊   | 68/100 [06:12<03:02,  5.70s/it] 69%|██████▉   | 69/100 [06:17<02:41,  5.21s/it] 70%|███████   | 70/100 [06:27<03:22,  6.76s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2521 / 0.2508 / 0.9098 / 0.2241/ [0.07006369 0.65517241 0.22413793]
 71%|███████   | 71/100 [06:31<02:50,  5.88s/it] 72%|███████▏  | 72/100 [06:36<02:42,  5.81s/it] 73%|███████▎  | 73/100 [06:40<02:18,  5.13s/it] 74%|███████▍  | 74/100 [06:44<02:08,  4.96s/it] 75%|███████▌  | 75/100 [06:52<02:25,  5.81s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2353 / 0.2364 / 0.9180 / 0.1940/ [0.07006369 0.64367816 0.19396552]
 76%|███████▌  | 76/100 [06:57<02:09,  5.40s/it] 77%|███████▋  | 77/100 [07:00<01:50,  4.82s/it] 78%|███████▊  | 78/100 [07:05<01:45,  4.80s/it] 79%|███████▉  | 79/100 [07:08<01:31,  4.37s/it] 80%|████████  | 80/100 [07:18<01:57,  5.89s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2605 / 0.2579 / 0.9016 / 0.2500/ [0.06369427 0.64367816 0.25      ]
 81%|████████  | 81/100 [07:22<01:41,  5.35s/it] 82%|████████▏ | 82/100 [07:27<01:35,  5.28s/it] 83%|████████▎ | 83/100 [07:31<01:21,  4.77s/it] 84%|████████▍ | 84/100 [07:35<01:16,  4.81s/it] 85%|████████▌ | 85/100 [07:43<01:26,  5.74s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2500 / 0.2465 / 0.9180 / 0.2155/ [0.07006369 0.66666667 0.21551724]
 86%|████████▌ | 86/100 [07:48<01:14,  5.35s/it] 87%|████████▋ | 87/100 [07:51<01:01,  4.70s/it] 88%|████████▊ | 88/100 [07:56<00:56,  4.67s/it] 89%|████████▉ | 89/100 [07:59<00:46,  4.27s/it] 90%|█████████ | 90/100 [08:08<00:56,  5.68s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8025 / 0.9559 / 0.9375/ [0.5    0.94   0.9375]
                Test acc/f1/spec/sens = 0.2626 / 0.2623 / 0.9016 / 0.2500/ [0.06369427 0.65517241 0.25      ]
 91%|█████████ | 91/100 [08:12<00:47,  5.27s/it] 92%|█████████▏| 92/100 [08:18<00:42,  5.34s/it] 93%|█████████▎| 93/100 [08:22<00:35,  5.02s/it] 94%|█████████▍| 94/100 [08:27<00:30,  5.13s/it] 95%|█████████▌| 95/100 [08:37<00:32,  6.42s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7909 / 0.9559 / 0.9062/ [0.5     0.94    0.90625]
                Test acc/f1/spec/sens = 0.2437 / 0.2427 / 0.9180 / 0.2026/ [0.07006369 0.66666667 0.20258621]
 96%|█████████▌| 96/100 [08:42<00:24,  6.06s/it] 97%|█████████▋| 97/100 [08:46<00:16,  5.50s/it] 98%|█████████▊| 98/100 [08:52<00:11,  5.57s/it] 99%|█████████▉| 99/100 [08:56<00:05,  5.17s/it]100%|██████████| 100/100 [09:07<00:00,  6.82s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7909 / 0.9559 / 0.9062/ [0.5     0.94    0.90625]
                Test acc/f1/spec/sens = 0.2584 / 0.2571 / 0.8852 / 0.2586/ [0.06369427 0.6091954  0.25862069]
Trial 1, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8500 / 0.7909 / 0.9559 / 0.9062/ [0.5     0.94    0.90625]
Test acc/f1/spec/sens = 0.2584 / 0.2571 / 0.8852 / 0.2586/ [0.06369427 0.6091954  0.25862069]
>> Finished.
Acc, agreement for latest model:  0.25840336134453784 0.33403361344537813 [0.06369427 0.6091954  0.25862069]
Load best checkpoint for thief model
Acc, agreement for best model:  0.226890756302521 0.29831932773109243 [0.22929936 0.75862069 0.02586207]
Trial 0/1 || Cycle 4/5 || Label set size 720 || Test acc 0.2269 || Test agreement 0.2983 || Spec 0.8975 || Sens 0.0259 Class Acc: [0.22929936 0.75862069 0.02586207]
**************************************************************************************************** 

  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:02<00:12,  2.48s/it] 33%|███▎      | 2/6 [00:02<00:04,  1.16s/it] 67%|██████▋   | 4/6 [00:02<00:00,  2.06it/s] 83%|████████▎ | 5/6 [00:04<00:00,  1.33it/s]100%|██████████| 6/6 [00:04<00:00,  1.32it/s]
labeled set:  900
unlabeled set:  533
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.23it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.37it/s] 50%|█████     | 6/12 [00:01<00:00,  7.13it/s] 67%|██████▋   | 8/12 [00:01<00:00,  9.46it/s] 83%|████████▎ | 10/12 [00:01<00:00, 11.02it/s]100%|██████████| 12/12 [00:01<00:00,  7.47it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 30, 1: 66, 2: 84}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 50, 2: 32}
Labeled set distribution: 
Number of samples  900
{0: 221, 1: 386, 2: 293}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2668, agreement = 0.2899, f1 = 0.2356, spec = 0.9672, sens = 0.0043 Class Acc: [0.56050955 0.43678161 0.00431034]
Initial model on validation dataset: acc = 0.4000, agreement = 0.4000, f1 = 0.2145, spec = 1.0000, sens = 0.0000 Class Acc: [0.05555556 0.78       0.        ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:57,  4.82s/it]  2%|▏         | 2/100 [00:10<09:02,  5.54s/it]  3%|▎         | 3/100 [00:15<08:27,  5.23s/it]  4%|▍         | 4/100 [00:22<09:07,  5.71s/it]  5%|▌         | 5/100 [00:32<11:42,  7.40s/it]Epoch 5: Train acc/f1 = 0.8411 / 0.8306 / 0.8567 / 0.9556/ [0.74208145 0.81088083 0.9556314 ] 
                Val acc/f1/spec/sens = 0.8600 / 0.7946 / 0.9706 / 0.8750/ [0.44444444 1.         0.875     ]
                Test acc/f1/spec/sens = 0.6092 / 0.4993 / 0.7951 / 0.8707/ [0.05095541 0.91954023 0.87068966]
  6%|▌         | 6/100 [00:38<10:55,  6.98s/it]  7%|▋         | 7/100 [00:43<09:41,  6.26s/it]  8%|▊         | 8/100 [00:49<09:35,  6.25s/it]  9%|▉         | 9/100 [00:54<08:44,  5.76s/it] 10%|█         | 10/100 [01:06<11:23,  7.60s/it]Epoch 10: Train acc/f1 = 0.9133 / 0.9050 / 0.9473 / 0.9556/ [0.83257919 0.92746114 0.9556314 ] 
                Val acc/f1/spec/sens = 0.8500 / 0.7857 / 0.9118 / 1.0000/ [0.44444444 0.9        1.        ]
                Test acc/f1/spec/sens = 0.4223 / 0.3885 / 0.8730 / 0.4698/ [0.06369427 0.94252874 0.46982759]
 11%|█         | 11/100 [01:10<09:58,  6.73s/it] 12%|█▏        | 12/100 [01:17<09:39,  6.59s/it] 13%|█▎        | 13/100 [01:21<08:45,  6.04s/it] 14%|█▍        | 14/100 [01:27<08:32,  5.96s/it] 15%|█▌        | 15/100 [01:37<10:16,  7.26s/it]Epoch 15: Train acc/f1 = 0.9644 / 0.9610 / 0.9835 / 0.9863/ [0.92760181 0.96891192 0.98634812] 
                Val acc/f1/spec/sens = 0.8100 / 0.7721 / 0.9412 / 0.8125/ [0.66666667 0.86       0.8125    ]
                Test acc/f1/spec/sens = 0.2290 / 0.1846 / 0.8934 / 0.0517/ [0.07006369 0.98850575 0.05172414]
 16%|█▌        | 16/100 [01:43<09:31,  6.80s/it] 17%|█▋        | 17/100 [01:48<08:34,  6.20s/it] 18%|█▊        | 18/100 [01:54<08:25,  6.16s/it] 19%|█▉        | 19/100 [01:59<07:43,  5.72s/it] 20%|██        | 20/100 [02:10<09:59,  7.50s/it]Epoch 20: Train acc/f1 = 0.8944 / 0.8904 / 0.9951 / 0.8703/ [0.98190045 0.8626943  0.87030717] 
                Val acc/f1/spec/sens = 0.7900 / 0.7599 / 0.9853 / 0.7188/ [0.77777778 0.84       0.71875   ]
                Test acc/f1/spec/sens = 0.2374 / 0.2309 / 0.7582 / 0.1250/ [0.10828025 0.77011494 0.125     ]
 21%|██        | 21/100 [02:15<08:45,  6.65s/it] 22%|██▏       | 22/100 [02:21<08:20,  6.42s/it] 23%|██▎       | 23/100 [02:26<07:34,  5.90s/it] 24%|██▍       | 24/100 [02:32<07:28,  5.91s/it] 25%|██▌       | 25/100 [02:42<09:09,  7.32s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8030 / 0.9559 / 0.8750/ [0.55555556 0.94       0.875     ]
                Test acc/f1/spec/sens = 0.4370 / 0.3773 / 0.7787 / 0.5302/ [0.03184713 0.91954023 0.53017241]
 26%|██▌       | 26/100 [02:48<08:27,  6.86s/it] 27%|██▋       | 27/100 [02:53<07:37,  6.26s/it] 28%|██▊       | 28/100 [02:59<07:29,  6.24s/it] 29%|██▉       | 29/100 [03:04<06:48,  5.76s/it] 30%|███       | 30/100 [03:15<08:43,  7.48s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8184 / 0.9559 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.3340 / 0.3068 / 0.7459 / 0.3534/ [0.03184713 0.82758621 0.35344828]
 31%|███       | 31/100 [03:20<07:40,  6.68s/it] 32%|███▏      | 32/100 [03:26<07:19,  6.46s/it] 33%|███▎      | 33/100 [03:31<06:34,  5.89s/it] 34%|███▍      | 34/100 [03:36<06:30,  5.92s/it] 35%|███▌      | 35/100 [03:47<07:47,  7.19s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8079 / 0.9853 / 0.8438/ [0.61111111 0.94       0.84375   ]
                Test acc/f1/spec/sens = 0.3235 / 0.2951 / 0.7828 / 0.3060/ [0.03184713 0.89655172 0.30603448]
 36%|███▌      | 36/100 [03:53<07:17,  6.83s/it] 37%|███▋      | 37/100 [03:58<06:37,  6.32s/it] 38%|███▊      | 38/100 [04:04<06:27,  6.25s/it] 39%|███▉      | 39/100 [04:09<05:54,  5.81s/it] 40%|████      | 40/100 [04:21<07:43,  7.72s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8361 / 0.9706 / 0.9062/ [0.66666667 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.3088 / 0.2806 / 0.7992 / 0.2759/ [0.03184713 0.89655172 0.27586207]
 41%|████      | 41/100 [04:26<06:44,  6.86s/it] 42%|████▏     | 42/100 [04:32<06:20,  6.57s/it] 43%|████▎     | 43/100 [04:36<05:44,  6.04s/it] 44%|████▍     | 44/100 [04:42<05:35,  6.00s/it] 45%|████▌     | 45/100 [04:53<06:43,  7.34s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8240 / 0.9706 / 0.8750/ [0.66666667 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.3487 / 0.3159 / 0.7336 / 0.3966/ [0.03184713 0.79310345 0.39655172]
 46%|████▌     | 46/100 [04:59<06:13,  6.91s/it] 47%|████▋     | 47/100 [05:03<05:33,  6.29s/it] 48%|████▊     | 48/100 [05:09<05:19,  6.15s/it] 49%|████▉     | 49/100 [05:14<04:52,  5.73s/it] 50%|█████     | 50/100 [05:26<06:18,  7.57s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8361 / 0.9706 / 0.9062/ [0.66666667 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.3866 / 0.3416 / 0.7623 / 0.4440/ [0.03184713 0.87356322 0.44396552]
 51%|█████     | 51/100 [05:31<05:29,  6.72s/it] 52%|█████▏    | 52/100 [05:37<05:17,  6.62s/it] 53%|█████▎    | 53/100 [05:42<04:44,  6.05s/it] 54%|█████▍    | 54/100 [05:48<04:41,  6.13s/it] 55%|█████▌    | 55/100 [05:59<05:35,  7.46s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8447 / 0.9706 / 0.9375/ [0.66666667 0.92       0.9375    ]
                Test acc/f1/spec/sens = 0.3466 / 0.3099 / 0.7869 / 0.3534/ [0.03184713 0.89655172 0.35344828]
 56%|█████▌    | 56/100 [06:05<05:10,  7.06s/it] 57%|█████▋    | 57/100 [06:09<04:31,  6.31s/it] 58%|█████▊    | 58/100 [06:15<04:18,  6.16s/it] 59%|█████▉    | 59/100 [06:20<03:55,  5.73s/it] 60%|██████    | 60/100 [06:32<05:08,  7.72s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7995 / 0.9706 / 0.8438/ [0.61111111 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3340 / 0.2993 / 0.8279 / 0.3103/ [0.03184713 0.94252874 0.31034483]
 61%|██████    | 61/100 [06:37<04:28,  6.88s/it] 62%|██████▏   | 62/100 [06:43<04:10,  6.59s/it] 63%|██████▎   | 63/100 [06:48<03:44,  6.06s/it] 64%|██████▍   | 64/100 [06:54<03:39,  6.09s/it] 65%|██████▌   | 65/100 [07:05<04:20,  7.45s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8203 / 0.9706 / 0.9062/ [0.61111111 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.3151 / 0.2873 / 0.7869 / 0.2888/ [0.03184713 0.89655172 0.2887931 ]
 66%|██████▌   | 66/100 [07:11<03:59,  7.05s/it] 67%|██████▋   | 67/100 [07:16<03:31,  6.41s/it] 68%|██████▊   | 68/100 [07:23<03:29,  6.56s/it] 69%|██████▉   | 69/100 [07:27<03:05,  5.99s/it] 70%|███████   | 70/100 [07:39<03:50,  7.69s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7995 / 0.9706 / 0.8438/ [0.61111111 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3109 / 0.2823 / 0.8115 / 0.2672/ [0.03184713 0.93103448 0.26724138]
 71%|███████   | 71/100 [07:44<03:19,  6.88s/it] 72%|███████▏  | 72/100 [07:50<03:04,  6.60s/it] 73%|███████▎  | 73/100 [07:55<02:45,  6.13s/it] 74%|███████▍  | 74/100 [08:01<02:36,  6.03s/it] 75%|███████▌  | 75/100 [08:11<03:02,  7.29s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8150 / 0.9706 / 0.8438/ [0.66666667 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3403 / 0.3091 / 0.7377 / 0.3750/ [0.03184713 0.8045977  0.375     ]
 76%|███████▌  | 76/100 [08:17<02:44,  6.87s/it] 77%|███████▋  | 77/100 [08:22<02:23,  6.23s/it] 78%|███████▊  | 78/100 [08:28<02:15,  6.18s/it] 79%|███████▉  | 79/100 [08:32<01:59,  5.70s/it] 80%|████████  | 80/100 [08:44<02:29,  7.50s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8240 / 0.9706 / 0.8750/ [0.66666667 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.3088 / 0.2814 / 0.7910 / 0.2759/ [0.03184713 0.89655172 0.27586207]
 81%|████████  | 81/100 [08:48<02:05,  6.62s/it] 82%|████████▏ | 82/100 [08:55<01:56,  6.48s/it] 83%|████████▎ | 83/100 [09:00<01:43,  6.06s/it] 84%|████████▍ | 84/100 [09:06<01:37,  6.08s/it] 85%|████████▌ | 85/100 [09:16<01:51,  7.44s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8447 / 0.9706 / 0.9375/ [0.66666667 0.92       0.9375    ]
                Test acc/f1/spec/sens = 0.2962 / 0.2683 / 0.8115 / 0.2457/ [0.03184713 0.90804598 0.24568966]
 86%|████████▌ | 86/100 [09:22<01:37,  6.99s/it] 87%|████████▋ | 87/100 [09:27<01:21,  6.28s/it] 88%|████████▊ | 88/100 [09:33<01:14,  6.24s/it] 89%|████████▉ | 89/100 [09:38<01:02,  5.71s/it] 90%|█████████ | 90/100 [09:49<01:15,  7.55s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8361 / 0.9706 / 0.9062/ [0.66666667 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.3592 / 0.3210 / 0.7705 / 0.3836/ [0.03184713 0.88505747 0.38362069]
 91%|█████████ | 91/100 [09:54<01:00,  6.75s/it] 92%|█████████▏| 92/100 [10:00<00:52,  6.52s/it] 93%|█████████▎| 93/100 [10:05<00:41,  5.99s/it] 94%|█████████▍| 94/100 [10:11<00:36,  6.01s/it] 95%|█████████▌| 95/100 [10:22<00:37,  7.42s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8240 / 0.9706 / 0.8750/ [0.66666667 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.3445 / 0.3106 / 0.7746 / 0.3534/ [0.03184713 0.88505747 0.35344828]
 96%|█████████▌| 96/100 [10:28<00:28,  7.00s/it] 97%|█████████▋| 97/100 [10:33<00:18,  6.32s/it] 98%|█████████▊| 98/100 [10:39<00:12,  6.23s/it] 99%|█████████▉| 99/100 [10:43<00:05,  5.80s/it]100%|██████████| 100/100 [10:55<00:00,  7.57s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8447 / 0.9706 / 0.9375/ [0.66666667 0.92       0.9375    ]
                Test acc/f1/spec/sens = 0.3004 / 0.2720 / 0.7951 / 0.2586/ [0.03184713 0.89655172 0.25862069]
Trial 1, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8800 / 0.8447 / 0.9706 / 0.9375/ [0.66666667 0.92       0.9375    ]
Test acc/f1/spec/sens = 0.3004 / 0.2720 / 0.7951 / 0.2586/ [0.03184713 0.89655172 0.25862069]
>> Finished.
Acc, agreement for latest model:  0.3004201680672269 0.3739495798319328 [0.03184713 0.89655172 0.25862069]
Load best checkpoint for thief model
Acc, agreement for best model:  0.32142857142857145 0.39285714285714285 [0.03184713 0.89655172 0.30172414]
Trial 0/1 || Cycle 5/5 || Label set size 900 || Test acc 0.3214 || Test agreement 0.3929 || Spec 0.7828 || Sens 0.3017 Class Acc: [0.03184713 0.89655172 0.30172414]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.34it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.14it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.11it/s]100%|██████████| 12/12 [00:01<00:00,  7.84it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:04,  1.35it/s] 71%|███████▏  | 5/7 [00:00<00:00,  6.65it/s]100%|██████████| 7/7 [00:01<00:00,  6.00it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.1963, -1.2100, -1.1895]), tensor([0.8552, 0.8523, 0.8571]))
Val set stats: mean/std =  (tensor([-1.2438, -1.2589, -1.2352]), tensor([0.8555, 0.8507, 0.8582]))
Validation set distribution: 
Number of samples  100
{0: 16, 1: 45, 2: 39}
Labeled set distribution: 
Number of samples  180
{0: 27, 1: 74, 2: 79}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.5105, agreement = 0.5147, f1 = 0.4996, spec = 0.8361, sens = 0.3362 Class Acc: [0.78343949 0.48275862 0.3362069 ]
Initial model on validation dataset: acc = 0.3100, agreement = 0.3100, f1 = 0.2904, spec = 0.7049, sens = 0.5128 Class Acc: [0.4375     0.08888889 0.51282051]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:48,  1.70s/it]  2%|▏         | 2/100 [00:04<04:07,  2.53s/it]  3%|▎         | 3/100 [00:06<03:22,  2.08s/it]  4%|▍         | 4/100 [00:09<03:44,  2.34s/it]  5%|▌         | 5/100 [00:13<04:48,  3.03s/it]Epoch 5: Train acc/f1 = 0.4167 / 0.2057 / 1.0000 / 0.0127/ [0.         1.         0.01265823] 
                Val acc/f1/spec/sens = 0.2800 / 0.2544 / 0.9672 / 0.0513/ [0.8125     0.28888889 0.05128205]
                Test acc/f1/spec/sens = 0.1849 / 0.1066 / 0.9877 / 0.0043/ [0.         1.         0.00431034]
  6%|▌         | 6/100 [00:16<04:50,  3.09s/it]  7%|▋         | 7/100 [00:18<04:05,  2.64s/it]  8%|▊         | 8/100 [00:21<04:17,  2.80s/it]  9%|▉         | 9/100 [00:22<03:38,  2.40s/it] 10%|█         | 10/100 [00:28<05:07,  3.41s/it]Epoch 10: Train acc/f1 = 0.9389 / 0.9223 / 0.9406 / 0.9494/ [0.88888889 0.94594595 0.94936709] 
                Val acc/f1/spec/sens = 0.8400 / 0.7512 / 0.8689 / 0.9487/ [0.375      0.91111111 0.94871795]
                Test acc/f1/spec/sens = 0.6197 / 0.5530 / 0.7418 / 0.8319/ [0.24203822 0.73563218 0.83189655]
 11%|█         | 11/100 [00:30<04:12,  2.84s/it] 12%|█▏        | 12/100 [00:33<04:17,  2.92s/it] 13%|█▎        | 13/100 [00:34<03:38,  2.51s/it] 14%|█▍        | 14/100 [00:38<03:52,  2.71s/it] 15%|█▌        | 15/100 [00:42<04:26,  3.13s/it]Epoch 15: Train acc/f1 = 0.9667 / 0.9503 / 0.9703 / 0.9620/ [0.88888889 1.         0.96202532] 
                Val acc/f1/spec/sens = 0.8600 / 0.7548 / 0.8852 / 0.9744/ [0.3125     0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.3130 / 0.2981 / 0.9631 / 0.0948/ [0.25477707 1.         0.09482759]
 16%|█▌        | 16/100 [00:45<04:20,  3.11s/it] 17%|█▋        | 17/100 [00:46<03:38,  2.64s/it] 18%|█▊        | 18/100 [00:50<03:52,  2.84s/it] 19%|█▉        | 19/100 [00:51<03:21,  2.49s/it] 20%|██        | 20/100 [00:57<04:37,  3.47s/it]Epoch 20: Train acc/f1 = 0.9944 / 0.9915 / 1.0000 / 1.0000/ [0.96296296 1.         1.        ] 
                Val acc/f1/spec/sens = 0.8700 / 0.7627 / 0.9016 / 1.0000/ [0.3125     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.5735 / 0.4948 / 0.8443 / 0.7328/ [0.11464968 0.97701149 0.73275862]
 21%|██        | 21/100 [00:59<03:51,  2.93s/it] 22%|██▏       | 22/100 [01:02<03:49,  2.94s/it] 23%|██▎       | 23/100 [01:03<03:17,  2.56s/it] 24%|██▍       | 24/100 [01:06<03:26,  2.72s/it] 25%|██▌       | 25/100 [01:11<03:55,  3.15s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.5504 / 0.4882 / 0.8484 / 0.6767/ [0.13375796 0.96551724 0.67672414]
 26%|██▌       | 26/100 [01:13<03:42,  3.00s/it] 27%|██▋       | 27/100 [01:15<03:06,  2.56s/it] 28%|██▊       | 28/100 [01:17<03:06,  2.59s/it] 29%|██▉       | 29/100 [01:19<02:42,  2.29s/it] 30%|███       | 30/100 [01:24<03:43,  3.19s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7666 / 0.9180 / 0.9487/ [0.375      0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.4118 / 0.3964 / 0.9098 / 0.3534/ [0.18471338 0.97701149 0.35344828]
 31%|███       | 31/100 [01:26<03:05,  2.69s/it] 32%|███▏      | 32/100 [01:29<03:04,  2.71s/it] 33%|███▎      | 33/100 [01:30<02:39,  2.38s/it] 34%|███▍      | 34/100 [01:33<02:46,  2.53s/it] 35%|███▌      | 35/100 [01:37<03:17,  3.04s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7787 / 0.9344 / 0.9231/ [0.4375     0.95555556 0.92307692]
                Test acc/f1/spec/sens = 0.5357 / 0.4949 / 0.9016 / 0.6034/ [0.1910828  0.97701149 0.60344828]
 36%|███▌      | 36/100 [01:40<03:11,  2.99s/it] 37%|███▋      | 37/100 [01:42<02:42,  2.57s/it] 38%|███▊      | 38/100 [01:45<02:47,  2.71s/it] 39%|███▉      | 39/100 [01:46<02:26,  2.41s/it] 40%|████      | 40/100 [01:52<03:28,  3.48s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8005 / 0.9344 / 0.9744/ [0.4375     0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.5462 / 0.4966 / 0.8811 / 0.6379/ [0.17197452 0.97701149 0.63793103]
 41%|████      | 41/100 [01:54<02:51,  2.91s/it] 42%|████▏     | 42/100 [01:57<02:47,  2.88s/it] 43%|████▎     | 43/100 [01:58<02:22,  2.50s/it] 44%|████▍     | 44/100 [02:01<02:27,  2.63s/it] 45%|████▌     | 45/100 [02:06<02:54,  3.18s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.4433 / 0.4144 / 0.8975 / 0.4397/ [0.15286624 0.97701149 0.43965517]
 46%|████▌     | 46/100 [02:09<02:46,  3.09s/it] 47%|████▋     | 47/100 [02:10<02:22,  2.69s/it] 48%|████▊     | 48/100 [02:14<02:26,  2.81s/it] 49%|████▉     | 49/100 [02:15<02:06,  2.47s/it] 50%|█████     | 50/100 [02:21<02:54,  3.49s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.4727 / 0.4247 / 0.8811 / 0.5259/ [0.11464968 0.97701149 0.52586207]
 51%|█████     | 51/100 [02:23<02:24,  2.95s/it] 52%|█████▏    | 52/100 [02:26<02:21,  2.95s/it] 53%|█████▎    | 53/100 [02:27<02:00,  2.57s/it] 54%|█████▍    | 54/100 [02:30<02:03,  2.68s/it] 55%|█████▌    | 55/100 [02:35<02:26,  3.25s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.4811 / 0.4412 / 0.8811 / 0.5216/ [0.14649682 0.97701149 0.52155172]
 56%|█████▌    | 56/100 [02:38<02:19,  3.18s/it] 57%|█████▋    | 57/100 [02:40<01:57,  2.73s/it] 58%|█████▊    | 58/100 [02:43<01:58,  2.82s/it] 59%|█████▉    | 59/100 [02:44<01:41,  2.47s/it] 60%|██████    | 60/100 [02:50<02:20,  3.50s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.4412 / 0.4076 / 0.9016 / 0.4483/ [0.13375796 0.97701149 0.44827586]
 61%|██████    | 61/100 [02:52<01:56,  3.00s/it] 62%|██████▏   | 62/100 [02:55<01:52,  2.96s/it] 63%|██████▎   | 63/100 [02:56<01:33,  2.53s/it] 64%|██████▍   | 64/100 [02:59<01:33,  2.60s/it] 65%|██████▌   | 65/100 [03:04<01:49,  3.14s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.4748 / 0.4329 / 0.8934 / 0.5172/ [0.13375796 0.97701149 0.51724138]
 66%|██████▌   | 66/100 [03:06<01:43,  3.06s/it] 67%|██████▋   | 67/100 [03:08<01:27,  2.66s/it] 68%|██████▊   | 68/100 [03:11<01:28,  2.75s/it] 69%|██████▉   | 69/100 [03:13<01:15,  2.43s/it] 70%|███████   | 70/100 [03:19<01:44,  3.50s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.5378 / 0.4792 / 0.8607 / 0.6466/ [0.14012739 0.96551724 0.64655172]
 71%|███████   | 71/100 [03:20<01:25,  2.95s/it] 72%|███████▏  | 72/100 [03:23<01:22,  2.96s/it] 73%|███████▎  | 73/100 [03:25<01:10,  2.59s/it] 74%|███████▍  | 74/100 [03:28<01:10,  2.70s/it] 75%|███████▌  | 75/100 [03:32<01:19,  3.19s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.4685 / 0.4281 / 0.8852 / 0.5043/ [0.13375796 0.97701149 0.50431034]
 76%|███████▌  | 76/100 [03:35<01:14,  3.11s/it] 77%|███████▋  | 77/100 [03:37<01:01,  2.68s/it] 78%|███████▊  | 78/100 [03:40<00:59,  2.73s/it] 79%|███████▉  | 79/100 [03:42<00:50,  2.39s/it] 80%|████████  | 80/100 [03:47<01:08,  3.44s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.4622 / 0.4329 / 0.8934 / 0.4698/ [0.1656051  0.97701149 0.46982759]
 81%|████████  | 81/100 [03:49<00:55,  2.91s/it] 82%|████████▏ | 82/100 [03:52<00:52,  2.91s/it] 83%|████████▎ | 83/100 [03:54<00:43,  2.56s/it] 84%|████████▍ | 84/100 [03:57<00:42,  2.68s/it] 85%|████████▌ | 85/100 [04:01<00:47,  3.13s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.5567 / 0.4980 / 0.8730 / 0.6724/ [0.15286624 0.97701149 0.67241379]
 86%|████████▌ | 86/100 [04:04<00:42,  3.05s/it] 87%|████████▋ | 87/100 [04:05<00:34,  2.62s/it] 88%|████████▊ | 88/100 [04:08<00:31,  2.66s/it] 89%|████████▉ | 89/100 [04:10<00:25,  2.33s/it] 90%|█████████ | 90/100 [04:15<00:32,  3.25s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.5273 / 0.4858 / 0.8975 / 0.5948/ [0.17834395 0.97701149 0.59482759]
 91%|█████████ | 91/100 [04:17<00:24,  2.73s/it] 92%|█████████▏| 92/100 [04:19<00:21,  2.75s/it] 93%|█████████▎| 93/100 [04:21<00:16,  2.38s/it] 94%|█████████▍| 94/100 [04:24<00:14,  2.49s/it] 95%|█████████▌| 95/100 [04:28<00:14,  2.93s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.4979 / 0.4512 / 0.8689 / 0.5603/ [0.14012739 0.97701149 0.56034483]
 96%|█████████▌| 96/100 [04:30<00:11,  2.84s/it] 97%|█████████▋| 97/100 [04:32<00:07,  2.42s/it] 98%|█████████▊| 98/100 [04:34<00:05,  2.52s/it] 99%|█████████▉| 99/100 [04:36<00:02,  2.24s/it]100%|██████████| 100/100 [04:42<00:00,  3.37s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.5063 / 0.4674 / 0.8852 / 0.5560/ [0.17197452 0.97701149 0.55603448]
Trial 2, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8700 / 0.7894 / 0.9344 / 0.9487/ [0.4375     0.95555556 0.94871795]
Test acc/f1/spec/sens = 0.5063 / 0.4674 / 0.8852 / 0.5560/ [0.17197452 0.97701149 0.55603448]
>> Finished.
Acc, agreement for latest model:  0.5063025210084033 0.5630252100840336 [0.17197452 0.97701149 0.55603448]
Load best checkpoint for thief model
Acc, agreement for best model:  0.5462184873949579 0.6029411764705882 [0.17197452 0.97701149 0.63793103]
Trial 1/1 || Cycle 1/5 || Label set size 180 || Test acc 0.5462 || Test agreement 0.6029 || Spec 0.8811 || Sens 0.6379 Class Acc: [0.17197452 0.97701149 0.63793103]
**************************************************************************************************** 

  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:02<00:19,  2.18s/it] 30%|███       | 3/10 [00:02<00:04,  1.60it/s] 50%|█████     | 5/10 [00:03<00:03,  1.65it/s] 70%|███████   | 7/10 [00:03<00:01,  2.59it/s] 90%|█████████ | 9/10 [00:04<00:00,  2.06it/s]100%|██████████| 10/10 [00:05<00:00,  1.89it/s]
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.30it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.19it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.07it/s]100%|██████████| 12/12 [00:01<00:00,  7.92it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 67, 1: 39, 2: 74}
Validation set distribution: 
Number of samples  100
{0: 16, 1: 45, 2: 39}
Labeled set distribution: 
Number of samples  360
{0: 94, 1: 113, 2: 153}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.5000, agreement = 0.4706, f1 = 0.3659, spec = 0.3852, sens = 0.8664 Class Acc: [0.0955414  0.25287356 0.86637931]
Initial model on validation dataset: acc = 0.3100, agreement = 0.3100, f1 = 0.2182, spec = 0.3443, sens = 0.6410 Class Acc: [0.         0.13333333 0.64102564]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<03:40,  2.23s/it]  2%|▏         | 2/100 [00:05<05:05,  3.12s/it]  3%|▎         | 3/100 [00:08<04:28,  2.77s/it]  4%|▍         | 4/100 [00:12<05:16,  3.29s/it]  5%|▌         | 5/100 [00:18<07:02,  4.44s/it]Epoch 5: Train acc/f1 = 0.7111 / 0.7176 / 1.0000 / 0.4183/ [0.9893617  0.87610619 0.41830065] 
                Val acc/f1/spec/sens = 0.8200 / 0.7632 / 0.9672 / 0.7436/ [0.625      0.95555556 0.74358974]
                Test acc/f1/spec/sens = 0.2437 / 0.2251 / 0.9754 / 0.0905/ [0.05095541 1.         0.09051724]
  6%|▌         | 6/100 [00:22<06:40,  4.26s/it]  7%|▋         | 7/100 [00:25<05:43,  3.69s/it]  8%|▊         | 8/100 [00:29<05:56,  3.88s/it]  9%|▉         | 9/100 [00:32<05:12,  3.43s/it] 10%|█         | 10/100 [00:39<07:07,  4.75s/it]Epoch 10: Train acc/f1 = 0.9139 / 0.9113 / 0.9807 / 0.8693/ [0.91489362 0.97345133 0.86928105] 
                Val acc/f1/spec/sens = 0.8600 / 0.7524 / 0.9016 / 0.9744/ [0.3125     0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2542 / 0.2494 / 0.8934 / 0.1595/ [0.06369427 0.85057471 0.15948276]
 11%|█         | 11/100 [00:42<06:03,  4.08s/it] 12%|█▏        | 12/100 [00:46<05:53,  4.01s/it] 13%|█▎        | 13/100 [00:48<05:10,  3.57s/it] 14%|█▍        | 14/100 [00:52<05:13,  3.65s/it] 15%|█▌        | 15/100 [00:58<06:18,  4.45s/it]Epoch 15: Train acc/f1 = 0.9222 / 0.9212 / 0.9758 / 0.8824/ [0.89361702 1.         0.88235294] 
                Val acc/f1/spec/sens = 0.8700 / 0.7627 / 0.9016 / 1.0000/ [0.3125     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.2437 / 0.2047 / 0.9221 / 0.1121/ [0.05095541 0.94252874 0.11206897]
 16%|█▌        | 16/100 [01:02<06:01,  4.31s/it] 17%|█▋        | 17/100 [01:05<05:11,  3.75s/it] 18%|█▊        | 18/100 [01:09<05:09,  3.78s/it] 19%|█▉        | 19/100 [01:11<04:36,  3.42s/it] 20%|██        | 20/100 [01:19<06:14,  4.68s/it]Epoch 20: Train acc/f1 = 0.9083 / 0.8968 / 0.8551 / 1.0000/ [0.67021277 0.98230088 1.        ] 
                Val acc/f1/spec/sens = 0.8300 / 0.6665 / 0.8361 / 1.0000/ [0.125      0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.3718 / 0.3608 / 0.8770 / 0.3707/ [0.07006369 0.91954023 0.37068966]
 21%|██        | 21/100 [01:21<05:20,  4.06s/it] 22%|██▏       | 22/100 [01:25<05:13,  4.02s/it] 23%|██▎       | 23/100 [01:28<04:33,  3.55s/it] 24%|██▍       | 24/100 [01:32<04:36,  3.63s/it] 25%|██▌       | 25/100 [01:38<05:38,  4.52s/it]Epoch 25: Train acc/f1 = 0.9972 / 0.9968 / 1.0000 / 1.0000/ [1.         0.99115044 1.        ] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2500 / 0.2438 / 0.9344 / 0.1034/ [0.07006369 0.96551724 0.10344828]
 26%|██▌       | 26/100 [01:42<05:17,  4.29s/it] 27%|██▋       | 27/100 [01:44<04:33,  3.75s/it] 28%|██▊       | 28/100 [01:48<04:33,  3.79s/it] 29%|██▉       | 29/100 [01:51<04:04,  3.44s/it] 30%|███       | 30/100 [01:58<05:24,  4.63s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2458 / 0.2373 / 0.9385 / 0.1034/ [0.06369427 0.95402299 0.10344828]
 31%|███       | 31/100 [02:01<04:34,  3.98s/it] 32%|███▏      | 32/100 [02:05<04:30,  3.98s/it] 33%|███▎      | 33/100 [02:07<03:58,  3.56s/it] 34%|███▍      | 34/100 [02:11<04:01,  3.66s/it] 35%|███▌      | 35/100 [02:18<04:47,  4.42s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7666 / 0.9180 / 0.9487/ [0.375      0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.2563 / 0.2573 / 0.8975 / 0.1422/ [0.06369427 0.90804598 0.14224138]
 36%|███▌      | 36/100 [02:21<04:31,  4.24s/it] 37%|███▋      | 37/100 [02:24<03:54,  3.72s/it] 38%|███▊      | 38/100 [02:28<03:52,  3.75s/it] 39%|███▉      | 39/100 [02:30<03:27,  3.40s/it] 40%|████      | 40/100 [02:38<04:41,  4.69s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.7882 / 0.9180 / 1.0000/ [0.375      0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.2689 / 0.2657 / 0.9139 / 0.1552/ [0.06369427 0.94252874 0.15517241]
 41%|████      | 41/100 [02:41<03:59,  4.07s/it] 42%|████▏     | 42/100 [02:44<03:47,  3.93s/it] 43%|████▎     | 43/100 [02:47<03:23,  3.58s/it] 44%|████▍     | 44/100 [02:51<03:23,  3.64s/it] 45%|████▌     | 45/100 [02:57<04:04,  4.45s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2542 / 0.2542 / 0.9057 / 0.1336/ [0.06369427 0.91954023 0.13362069]
 46%|████▌     | 46/100 [03:01<03:52,  4.30s/it] 47%|████▋     | 47/100 [03:04<03:19,  3.77s/it] 48%|████▊     | 48/100 [03:08<03:19,  3.84s/it] 49%|████▉     | 49/100 [03:10<02:57,  3.47s/it] 50%|█████     | 50/100 [03:18<03:56,  4.73s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2542 / 0.2572 / 0.8934 / 0.1379/ [0.06369427 0.90804598 0.13793103]
 51%|█████     | 51/100 [03:20<03:19,  4.06s/it] 52%|█████▏    | 52/100 [03:24<03:14,  4.05s/it] 53%|█████▎    | 53/100 [03:27<02:51,  3.65s/it] 54%|█████▍    | 54/100 [03:31<02:52,  3.75s/it] 55%|█████▌    | 55/100 [03:37<03:20,  4.46s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2500 / 0.2476 / 0.9180 / 0.1121/ [0.07006369 0.94252874 0.11206897]
 56%|█████▌    | 56/100 [03:41<03:07,  4.25s/it] 57%|█████▋    | 57/100 [03:43<02:40,  3.73s/it] 58%|█████▊    | 58/100 [03:47<02:36,  3.74s/it] 59%|█████▉    | 59/100 [03:49<02:15,  3.30s/it] 60%|██████    | 60/100 [03:57<03:00,  4.52s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2542 / 0.2557 / 0.9016 / 0.1336/ [0.06369427 0.91954023 0.13362069]
 61%|██████    | 61/100 [03:59<02:31,  3.89s/it] 62%|██████▏   | 62/100 [04:03<02:26,  3.86s/it] 63%|██████▎   | 63/100 [04:06<02:08,  3.48s/it] 64%|██████▍   | 64/100 [04:09<02:09,  3.59s/it] 65%|██████▌   | 65/100 [04:16<02:33,  4.39s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2500 / 0.2536 / 0.8975 / 0.1293/ [0.06369427 0.90804598 0.12931034]
 66%|██████▌   | 66/100 [04:20<02:24,  4.25s/it] 67%|██████▋   | 67/100 [04:22<02:03,  3.76s/it] 68%|██████▊   | 68/100 [04:26<02:00,  3.77s/it] 69%|██████▉   | 69/100 [04:29<01:44,  3.37s/it] 70%|███████   | 70/100 [04:36<02:18,  4.62s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2605 / 0.2621 / 0.8934 / 0.1509/ [0.06369427 0.90804598 0.15086207]
 71%|███████   | 71/100 [04:39<01:57,  4.04s/it] 72%|███████▏  | 72/100 [04:42<01:50,  3.95s/it] 73%|███████▎  | 73/100 [04:45<01:35,  3.55s/it] 74%|███████▍  | 74/100 [04:49<01:34,  3.65s/it] 75%|███████▌  | 75/100 [04:55<01:51,  4.45s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.7882 / 0.9180 / 1.0000/ [0.375      0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.2710 / 0.2756 / 0.8893 / 0.1724/ [0.06369427 0.90804598 0.17241379]
 76%|███████▌  | 76/100 [04:59<01:43,  4.32s/it] 77%|███████▋  | 77/100 [05:02<01:26,  3.76s/it] 78%|███████▊  | 78/100 [05:06<01:23,  3.79s/it] 79%|███████▉  | 79/100 [05:08<01:11,  3.40s/it] 80%|████████  | 80/100 [05:16<01:32,  4.63s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.7882 / 0.9180 / 1.0000/ [0.375      0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.2773 / 0.2798 / 0.9098 / 0.1681/ [0.07006369 0.94252874 0.16810345]
 81%|████████  | 81/100 [05:18<01:15,  3.98s/it] 82%|████████▏ | 82/100 [05:22<01:09,  3.86s/it] 83%|████████▎ | 83/100 [05:24<00:57,  3.37s/it] 84%|████████▍ | 84/100 [05:27<00:53,  3.35s/it] 85%|████████▌ | 85/100 [05:33<00:59,  3.99s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2584 / 0.2632 / 0.9057 / 0.1379/ [0.07006369 0.91954023 0.13793103]
 86%|████████▌ | 86/100 [05:36<00:54,  3.86s/it] 87%|████████▋ | 87/100 [05:38<00:43,  3.35s/it] 88%|████████▊ | 88/100 [05:42<00:40,  3.35s/it] 89%|████████▉ | 89/100 [05:44<00:33,  3.07s/it] 90%|█████████ | 90/100 [05:51<00:41,  4.15s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2605 / 0.2606 / 0.9139 / 0.1336/ [0.07006369 0.94252874 0.13362069]
 91%|█████████ | 91/100 [05:53<00:32,  3.57s/it] 92%|█████████▏| 92/100 [05:57<00:28,  3.57s/it] 93%|█████████▎| 93/100 [05:59<00:22,  3.17s/it] 94%|█████████▍| 94/100 [06:03<00:19,  3.32s/it] 95%|█████████▌| 95/100 [06:08<00:20,  4.05s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2458 / 0.2438 / 0.9139 / 0.1034/ [0.07006369 0.94252874 0.10344828]
 96%|█████████▌| 96/100 [06:12<00:15,  3.85s/it] 97%|█████████▋| 97/100 [06:14<00:10,  3.35s/it] 98%|█████████▊| 98/100 [06:17<00:06,  3.38s/it] 99%|█████████▉| 99/100 [06:20<00:03,  3.04s/it]100%|██████████| 100/100 [06:26<00:00,  4.21s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.2605 / 0.2593 / 0.9139 / 0.1336/ [0.07006369 0.94252874 0.13362069]
Trial 2, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
Test acc/f1/spec/sens = 0.2605 / 0.2593 / 0.9139 / 0.1336/ [0.07006369 0.94252874 0.13362069]
>> Finished.
Acc, agreement for latest model:  0.2605042016806723 0.3319327731092437 [0.07006369 0.94252874 0.13362069]
Load best checkpoint for thief model
Acc, agreement for best model:  0.24369747899159663 0.27521008403361347 [0.01273885 0.73563218 0.21551724]
Trial 1/1 || Cycle 2/5 || Label set size 360 || Test acc 0.2437 || Test agreement 0.2752 || Spec 0.7336 || Sens 0.2155 Class Acc: [0.01273885 0.73563218 0.21551724]
**************************************************************************************************** 

  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:02<00:18,  2.36s/it] 22%|██▏       | 2/9 [00:02<00:07,  1.03s/it] 44%|████▍     | 4/9 [00:02<00:02,  2.27it/s] 56%|█████▌    | 5/9 [00:03<00:02,  1.48it/s] 78%|███████▊  | 7/9 [00:04<00:00,  2.50it/s]100%|██████████| 9/9 [00:04<00:00,  3.06it/s]100%|██████████| 9/9 [00:04<00:00,  1.90it/s]
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.24it/s] 42%|████▏     | 5/12 [00:01<00:01,  5.64it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.65it/s]100%|██████████| 12/12 [00:01<00:00,  6.86it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 90, 1: 31, 2: 59}
Validation set distribution: 
Number of samples  100
{0: 16, 1: 45, 2: 39}
Labeled set distribution: 
Number of samples  540
{0: 184, 1: 144, 2: 212}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.4517, agreement = 0.4286, f1 = 0.3146, spec = 0.3975, sens = 0.8017 Class Acc: [0.01273885 0.31034483 0.80172414]
Initial model on validation dataset: acc = 0.4000, agreement = 0.4000, f1 = 0.3002, spec = 0.4426, sens = 0.5128 Class Acc: [0.         0.44444444 0.51282051]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:23,  3.26s/it]  2%|▏         | 2/100 [00:07<06:14,  3.82s/it]  3%|▎         | 3/100 [00:10<05:27,  3.38s/it]  4%|▍         | 4/100 [00:14<06:05,  3.81s/it]  5%|▌         | 5/100 [00:21<07:50,  4.95s/it]Epoch 5: Train acc/f1 = 0.5852 / 0.5660 / 1.0000 / 0.2547/ [0.73913043 0.875      0.25471698] 
                Val acc/f1/spec/sens = 0.4500 / 0.2069 / 1.0000 / 0.0000/ [0. 1. 0.]
                Test acc/f1/spec/sens = 0.1828 / 0.1051 / 1.0000 / 0.0000/ [0. 1. 0.]
  6%|▌         | 6/100 [00:25<07:19,  4.68s/it]  7%|▋         | 7/100 [00:28<06:21,  4.10s/it]  8%|▊         | 8/100 [00:32<06:15,  4.08s/it]  9%|▉         | 9/100 [00:35<05:43,  3.77s/it] 10%|█         | 10/100 [00:44<07:55,  5.28s/it]Epoch 10: Train acc/f1 = 0.6148 / 0.5789 / 0.3902 / 0.9858/ [0.19565217 0.60416667 0.98584906] 
                Val acc/f1/spec/sens = 0.7800 / 0.6012 / 0.7049 / 1.0000/ [0.0625     0.84444444 1.        ]
                Test acc/f1/spec/sens = 0.6303 / 0.4784 / 0.5656 / 0.9957/ [0.01273885 0.77011494 0.99568966]
 11%|█         | 11/100 [00:47<06:57,  4.69s/it] 12%|█▏        | 12/100 [00:52<06:53,  4.69s/it] 13%|█▎        | 13/100 [00:56<06:13,  4.30s/it] 14%|█▍        | 14/100 [01:00<06:22,  4.45s/it] 15%|█▌        | 15/100 [01:07<07:22,  5.21s/it]Epoch 15: Train acc/f1 = 0.9426 / 0.9401 / 0.9909 / 0.9575/ [0.96195652 0.89583333 0.95754717] 
                Val acc/f1/spec/sens = 0.9100 / 0.8458 / 0.9508 / 0.9744/ [0.5        1.         0.97435897]
                Test acc/f1/spec/sens = 0.2143 / 0.1533 / 0.9877 / 0.0517/ [0.01910828 1.         0.05172414]
 16%|█▌        | 16/100 [01:11<06:48,  4.86s/it] 17%|█▋        | 17/100 [01:14<05:51,  4.23s/it] 18%|█▊        | 18/100 [01:18<05:41,  4.16s/it] 19%|█▉        | 19/100 [01:21<05:01,  3.72s/it] 20%|██        | 20/100 [01:29<06:44,  5.06s/it]Epoch 20: Train acc/f1 = 0.7796 / 0.7739 / 0.6738 / 1.0000/ [0.4673913  0.85416667 1.        ] 
                Val acc/f1/spec/sens = 0.8000 / 0.5799 / 0.7541 / 1.0000/ [0.         0.91111111 1.        ]
                Test acc/f1/spec/sens = 0.6092 / 0.4576 / 0.6680 / 0.9655/ [0.01910828 0.72413793 0.96551724]
 21%|██        | 21/100 [01:32<05:45,  4.37s/it] 22%|██▏       | 22/100 [01:36<05:34,  4.29s/it] 23%|██▎       | 23/100 [01:39<04:56,  3.85s/it] 24%|██▍       | 24/100 [01:43<05:11,  4.10s/it] 25%|██▌       | 25/100 [01:51<06:19,  5.06s/it]Epoch 25: Train acc/f1 = 0.9963 / 0.9959 / 1.0000 / 1.0000/ [0.99456522 0.99305556 1.        ] 
                Val acc/f1/spec/sens = 0.9300 / 0.8808 / 0.9672 / 1.0000/ [0.5625 1.     1.    ]
                Test acc/f1/spec/sens = 0.2584 / 0.2225 / 0.9303 / 0.1121/ [0.07643312 0.97701149 0.11206897]
 26%|██▌       | 26/100 [01:55<05:55,  4.80s/it] 27%|██▋       | 27/100 [01:58<05:10,  4.26s/it] 28%|██▊       | 28/100 [02:02<05:04,  4.22s/it] 29%|██▉       | 29/100 [02:05<04:35,  3.88s/it] 30%|███       | 30/100 [02:14<06:12,  5.32s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8808 / 0.9672 / 1.0000/ [0.5625 1.     1.    ]
                Test acc/f1/spec/sens = 0.2647 / 0.2276 / 0.9344 / 0.1207/ [0.07006369 1.         0.12068966]
 31%|███       | 31/100 [02:17<05:19,  4.63s/it] 32%|███▏      | 32/100 [02:21<05:03,  4.47s/it] 33%|███▎      | 33/100 [02:24<04:29,  4.02s/it] 34%|███▍      | 34/100 [02:28<04:25,  4.02s/it] 35%|███▌      | 35/100 [02:35<05:18,  4.90s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
                Test acc/f1/spec/sens = 0.2542 / 0.2159 / 0.9139 / 0.1164/ [0.06369427 0.96551724 0.11637931]
 36%|███▌      | 36/100 [02:39<04:56,  4.64s/it] 37%|███▋      | 37/100 [02:42<04:20,  4.14s/it] 38%|███▊      | 38/100 [02:46<04:17,  4.15s/it] 39%|███▉      | 39/100 [02:49<04:00,  3.94s/it] 40%|████      | 40/100 [02:59<05:28,  5.48s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8808 / 0.9672 / 1.0000/ [0.5625 1.     1.    ]
                Test acc/f1/spec/sens = 0.2668 / 0.2296 / 0.9221 / 0.1336/ [0.06369427 0.98850575 0.13362069]
 41%|████      | 41/100 [03:02<04:41,  4.77s/it] 42%|████▏     | 42/100 [03:06<04:21,  4.51s/it] 43%|████▎     | 43/100 [03:08<03:47,  3.99s/it] 44%|████▍     | 44/100 [03:12<03:42,  3.97s/it] 45%|████▌     | 45/100 [03:19<04:22,  4.77s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
                Test acc/f1/spec/sens = 0.2458 / 0.2070 / 0.9139 / 0.0991/ [0.06369427 0.96551724 0.09913793]
 46%|████▌     | 46/100 [03:23<04:03,  4.51s/it] 47%|████▋     | 47/100 [03:25<03:30,  3.97s/it] 48%|████▊     | 48/100 [03:29<03:23,  3.92s/it] 49%|████▉     | 49/100 [03:32<03:02,  3.58s/it] 50%|█████     | 50/100 [03:40<04:00,  4.81s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
                Test acc/f1/spec/sens = 0.2584 / 0.2213 / 0.9057 / 0.1250/ [0.06369427 0.96551724 0.125     ]
 51%|█████     | 51/100 [03:43<03:25,  4.20s/it] 52%|█████▏    | 52/100 [03:47<03:18,  4.13s/it] 53%|█████▎    | 53/100 [03:49<02:56,  3.75s/it] 54%|█████▍    | 54/100 [03:53<02:56,  3.84s/it] 55%|█████▌    | 55/100 [04:00<03:30,  4.69s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
                Test acc/f1/spec/sens = 0.2521 / 0.2148 / 0.9180 / 0.1121/ [0.06369427 0.96551724 0.11206897]
 56%|█████▌    | 56/100 [04:04<03:16,  4.46s/it] 57%|█████▋    | 57/100 [04:07<02:49,  3.95s/it] 58%|█████▊    | 58/100 [04:11<02:46,  3.97s/it] 59%|█████▉    | 59/100 [04:14<02:28,  3.62s/it] 60%|██████    | 60/100 [04:21<03:14,  4.86s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8808 / 0.9672 / 1.0000/ [0.5625 1.     1.    ]
                Test acc/f1/spec/sens = 0.2605 / 0.2239 / 0.9180 / 0.1293/ [0.06369427 0.96551724 0.12931034]
 61%|██████    | 61/100 [04:24<02:44,  4.23s/it] 62%|██████▏   | 62/100 [04:28<02:36,  4.12s/it] 63%|██████▎   | 63/100 [04:31<02:17,  3.70s/it] 64%|██████▍   | 64/100 [04:35<02:15,  3.77s/it] 65%|██████▌   | 65/100 [04:41<02:39,  4.57s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
                Test acc/f1/spec/sens = 0.2437 / 0.2021 / 0.9262 / 0.0862/ [0.06369427 0.98850575 0.0862069 ]
 66%|██████▌   | 66/100 [04:45<02:26,  4.32s/it] 67%|██████▋   | 67/100 [04:48<02:07,  3.85s/it] 68%|██████▊   | 68/100 [04:51<02:02,  3.83s/it] 69%|██████▉   | 69/100 [04:54<01:48,  3.50s/it] 70%|███████   | 70/100 [05:02<02:23,  4.78s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
                Test acc/f1/spec/sens = 0.2374 / 0.1972 / 0.9180 / 0.0819/ [0.06369427 0.96551724 0.08189655]
 71%|███████   | 71/100 [05:05<02:01,  4.17s/it] 72%|███████▏  | 72/100 [05:09<01:54,  4.10s/it] 73%|███████▎  | 73/100 [05:11<01:40,  3.73s/it] 74%|███████▍  | 74/100 [05:15<01:38,  3.77s/it] 75%|███████▌  | 75/100 [05:22<01:55,  4.64s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8808 / 0.9672 / 1.0000/ [0.5625 1.     1.    ]
                Test acc/f1/spec/sens = 0.2521 / 0.2120 / 0.9262 / 0.1034/ [0.06369427 0.98850575 0.10344828]
 76%|███████▌  | 76/100 [05:26<01:45,  4.41s/it] 77%|███████▋  | 77/100 [05:29<01:30,  3.94s/it] 78%|███████▊  | 78/100 [05:32<01:25,  3.91s/it] 79%|███████▉  | 79/100 [05:35<01:15,  3.58s/it] 80%|████████  | 80/100 [05:43<01:37,  4.86s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
                Test acc/f1/spec/sens = 0.2563 / 0.2171 / 0.9221 / 0.1121/ [0.06369427 0.98850575 0.11206897]
 81%|████████  | 81/100 [05:46<01:20,  4.24s/it] 82%|████████▏ | 82/100 [05:50<01:14,  4.13s/it] 83%|████████▎ | 83/100 [05:53<01:03,  3.72s/it] 84%|████████▍ | 84/100 [05:57<01:00,  3.79s/it] 85%|████████▌ | 85/100 [06:03<01:09,  4.60s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
                Test acc/f1/spec/sens = 0.2521 / 0.2150 / 0.9139 / 0.1121/ [0.06369427 0.96551724 0.11206897]
 86%|████████▌ | 86/100 [06:07<01:01,  4.36s/it] 87%|████████▋ | 87/100 [06:10<00:50,  3.88s/it] 88%|████████▊ | 88/100 [06:13<00:46,  3.85s/it] 89%|████████▉ | 89/100 [06:16<00:38,  3.53s/it] 90%|█████████ | 90/100 [06:24<00:47,  4.75s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
                Test acc/f1/spec/sens = 0.2458 / 0.2074 / 0.9180 / 0.0991/ [0.06369427 0.96551724 0.09913793]
 91%|█████████ | 91/100 [06:27<00:37,  4.17s/it] 92%|█████████▏| 92/100 [06:30<00:32,  4.05s/it] 93%|█████████▎| 93/100 [06:34<00:26,  3.82s/it] 94%|█████████▍| 94/100 [06:38<00:23,  4.00s/it] 95%|█████████▌| 95/100 [06:45<00:25,  5.04s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
                Test acc/f1/spec/sens = 0.2752 / 0.2406 / 0.9098 / 0.1595/ [0.06369427 0.96551724 0.15948276]
 96%|█████████▌| 96/100 [06:50<00:18,  4.75s/it] 97%|█████████▋| 97/100 [06:52<00:12,  4.18s/it] 98%|█████████▊| 98/100 [06:56<00:08,  4.08s/it] 99%|█████████▉| 99/100 [06:59<00:03,  3.68s/it]100%|██████████| 100/100 [07:07<00:00,  4.88s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
                Test acc/f1/spec/sens = 0.2458 / 0.2051 / 0.9262 / 0.0905/ [0.06369427 0.98850575 0.09051724]
Trial 2, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9200 / 0.8672 / 0.9672 / 0.9744/ [0.5625     1.         0.97435897]
Test acc/f1/spec/sens = 0.2458 / 0.2051 / 0.9262 / 0.0905/ [0.06369427 0.98850575 0.09051724]
>> Finished.
Acc, agreement for latest model:  0.24579831932773108 0.31512605042016806 [0.06369427 0.98850575 0.09051724]
Load best checkpoint for thief model
Acc, agreement for best model:  0.25 0.3088235294117647 [0.08280255 0.96551724 0.09482759]
Trial 1/1 || Cycle 3/5 || Label set size 540 || Test acc 0.2500 || Test agreement 0.3088 || Spec 0.9262 || Sens 0.0948 Class Acc: [0.08280255 0.96551724 0.09482759]
**************************************************************************************************** 

  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:01<00:10,  1.74s/it] 43%|████▎     | 3/7 [00:01<00:02,  1.96it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.98it/s]100%|██████████| 7/7 [00:03<00:00,  3.12it/s]100%|██████████| 7/7 [00:03<00:00,  2.15it/s]
labeled set:  720
unlabeled set:  713
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.48it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.24it/s] 75%|███████▌  | 9/12 [00:01<00:00, 11.38it/s]100%|██████████| 12/12 [00:01<00:00,  8.85it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 22, 1: 92, 2: 66}
Validation set distribution: 
Number of samples  100
{0: 16, 1: 45, 2: 39}
Labeled set distribution: 
Number of samples  720
{0: 206, 1: 236, 2: 278}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.4496, agreement = 0.4202, f1 = 0.3315, spec = 0.8033, sens = 0.3664 Class Acc: [0.82165605 0.         0.36637931]
Initial model on validation dataset: acc = 0.1700, agreement = 0.1700, f1 = 0.1612, spec = 0.6230, sens = 0.0769 Class Acc: [0.6875     0.06666667 0.07692308]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:26,  3.30s/it]  2%|▏         | 2/100 [00:07<06:34,  4.03s/it]  3%|▎         | 3/100 [00:11<05:52,  3.64s/it]  4%|▍         | 4/100 [00:15<06:31,  4.08s/it]  5%|▌         | 5/100 [00:23<08:29,  5.36s/it]Epoch 5: Train acc/f1 = 0.4778 / 0.4241 / 0.9932 / 0.2338/ [0.20873786 1.         0.23381295] 
                Val acc/f1/spec/sens = 0.8500 / 0.7810 / 0.9508 / 0.8718/ [0.5        0.95555556 0.87179487]
                Test acc/f1/spec/sens = 0.1828 / 0.1030 / 1.0000 / 0.0000/ [0. 1. 0.]
  6%|▌         | 6/100 [00:27<07:52,  5.02s/it]  7%|▋         | 7/100 [00:30<06:52,  4.43s/it]  8%|▊         | 8/100 [00:35<07:00,  4.57s/it]  9%|▉         | 9/100 [00:39<06:18,  4.16s/it] 10%|█         | 10/100 [00:47<08:19,  5.55s/it]Epoch 10: Train acc/f1 = 0.7764 / 0.7342 / 0.7579 / 0.9568/ [0.35436893 0.93220339 0.95683453] 
                Val acc/f1/spec/sens = 0.8300 / 0.6374 / 0.8197 / 1.0000/ [0.0625     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4601 / 0.3763 / 0.9426 / 0.5948/ [0.00636943 0.91954023 0.59482759]
 11%|█         | 11/100 [00:51<07:13,  4.87s/it] 12%|█▏        | 12/100 [00:55<06:53,  4.70s/it] 13%|█▎        | 13/100 [00:58<06:10,  4.26s/it] 14%|█▍        | 14/100 [01:03<06:10,  4.30s/it] 15%|█▌        | 15/100 [01:10<07:32,  5.33s/it]Epoch 15: Train acc/f1 = 0.7306 / 0.6728 / 0.7534 / 0.8921/ [0.26213592 0.94915254 0.89208633] 
                Val acc/f1/spec/sens = 0.7200 / 0.6194 / 0.7541 / 1.0000/ [0.25       0.64444444 1.        ]
                Test acc/f1/spec/sens = 0.4307 / 0.3569 / 0.9713 / 0.5216/ [0.00636943 0.95402299 0.52155172]
 16%|█▌        | 16/100 [01:15<07:03,  5.04s/it] 17%|█▋        | 17/100 [01:18<06:15,  4.53s/it] 18%|█▊        | 18/100 [01:23<06:18,  4.62s/it] 19%|█▉        | 19/100 [01:26<05:49,  4.31s/it] 20%|██        | 20/100 [01:36<07:52,  5.90s/it]Epoch 20: Train acc/f1 = 0.3569 / 0.2177 / 0.9796 / 0.0683/ [0.00970874 1.         0.06834532] 
                Val acc/f1/spec/sens = 0.4900 / 0.2748 / 1.0000 / 0.1026/ [0.        1.        0.1025641]
                Test acc/f1/spec/sens = 0.1828 / 0.1030 / 1.0000 / 0.0000/ [0. 1. 0.]
 21%|██        | 21/100 [01:40<06:50,  5.20s/it] 22%|██▏       | 22/100 [01:45<06:41,  5.14s/it] 23%|██▎       | 23/100 [01:48<05:55,  4.62s/it] 24%|██▍       | 24/100 [01:53<05:50,  4.61s/it] 25%|██▌       | 25/100 [02:01<07:06,  5.69s/it]Epoch 25: Train acc/f1 = 0.9972 / 0.9970 / 1.0000 / 1.0000/ [0.99029126 1.         1.        ] 
                Val acc/f1/spec/sens = 0.9200 / 0.8729 / 0.9508 / 0.9487/ [0.625      1.         0.94871795]
                Test acc/f1/spec/sens = 0.2941 / 0.2756 / 0.9426 / 0.1940/ [0.10828025 0.89655172 0.19396552]
 26%|██▌       | 26/100 [02:05<06:34,  5.33s/it] 27%|██▋       | 27/100 [02:09<05:46,  4.75s/it] 28%|██▊       | 28/100 [02:13<05:40,  4.73s/it] 29%|██▉       | 29/100 [02:17<05:06,  4.32s/it] 30%|███       | 30/100 [02:26<06:49,  5.85s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8602 / 0.9508 / 0.9231/ [0.625      1.         0.92307692]
                Test acc/f1/spec/sens = 0.2941 / 0.2767 / 0.9467 / 0.1897/ [0.12101911 0.88505747 0.18965517]
 31%|███       | 31/100 [02:30<06:00,  5.23s/it] 32%|███▏      | 32/100 [02:35<05:50,  5.15s/it] 33%|███▎      | 33/100 [02:38<05:10,  4.64s/it] 34%|███▍      | 34/100 [02:43<05:05,  4.63s/it] 35%|███▌      | 35/100 [02:51<06:04,  5.61s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8862 / 0.9508 / 0.9744/ [0.625      1.         0.97435897]
                Test acc/f1/spec/sens = 0.3004 / 0.2820 / 0.9426 / 0.1940/ [0.12101911 0.90804598 0.19396552]
 36%|███▌      | 36/100 [02:56<05:46,  5.42s/it] 37%|███▋      | 37/100 [02:59<05:04,  4.83s/it] 38%|███▊      | 38/100 [03:04<04:57,  4.80s/it] 39%|███▉      | 39/100 [03:08<04:30,  4.43s/it] 40%|████      | 40/100 [03:17<05:54,  5.92s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8862 / 0.9508 / 0.9744/ [0.625      1.         0.97435897]
                Test acc/f1/spec/sens = 0.2647 / 0.2359 / 0.9754 / 0.1422/ [0.08280255 0.91954023 0.14224138]
 41%|████      | 41/100 [03:21<05:10,  5.26s/it] 42%|████▏     | 42/100 [03:26<04:58,  5.14s/it] 43%|████▎     | 43/100 [03:29<04:23,  4.63s/it] 44%|████▍     | 44/100 [03:34<04:19,  4.64s/it] 45%|████▌     | 45/100 [03:41<05:08,  5.61s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8862 / 0.9508 / 0.9744/ [0.625      1.         0.97435897]
                Test acc/f1/spec/sens = 0.2773 / 0.2549 / 0.9631 / 0.1552/ [0.10828025 0.90804598 0.15517241]
 46%|████▌     | 46/100 [03:46<04:46,  5.31s/it] 47%|████▋     | 47/100 [03:49<04:10,  4.73s/it] 48%|████▊     | 48/100 [03:54<04:02,  4.66s/it] 49%|████▉     | 49/100 [03:57<03:39,  4.30s/it] 50%|█████     | 50/100 [04:07<04:48,  5.77s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8729 / 0.9508 / 0.9487/ [0.625      1.         0.94871795]
                Test acc/f1/spec/sens = 0.2521 / 0.2184 / 0.9836 / 0.1293/ [0.06369427 0.91954023 0.12931034]
 51%|█████     | 51/100 [04:10<04:07,  5.06s/it] 52%|█████▏    | 52/100 [04:15<03:57,  4.95s/it] 53%|█████▎    | 53/100 [04:18<03:34,  4.56s/it] 54%|█████▍    | 54/100 [04:23<03:31,  4.59s/it] 55%|█████▌    | 55/100 [04:31<04:10,  5.57s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8862 / 0.9508 / 0.9744/ [0.625      1.         0.97435897]
                Test acc/f1/spec/sens = 0.2647 / 0.2347 / 0.9754 / 0.1466/ [0.07643312 0.91954023 0.14655172]
 56%|█████▌    | 56/100 [04:36<03:52,  5.28s/it] 57%|█████▋    | 57/100 [04:39<03:22,  4.72s/it] 58%|█████▊    | 58/100 [04:43<03:16,  4.67s/it] 59%|█████▉    | 59/100 [04:47<02:54,  4.26s/it] 60%|██████    | 60/100 [04:57<03:59,  5.99s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8602 / 0.9508 / 0.9231/ [0.625      1.         0.92307692]
                Test acc/f1/spec/sens = 0.2647 / 0.2394 / 0.9754 / 0.1336/ [0.10191083 0.90804598 0.13362069]
 61%|██████    | 61/100 [05:00<03:25,  5.27s/it] 62%|██████▏   | 62/100 [05:05<03:12,  5.07s/it] 63%|██████▎   | 63/100 [05:09<02:52,  4.66s/it] 64%|██████▍   | 64/100 [05:13<02:47,  4.66s/it] 65%|██████▌   | 65/100 [05:21<03:18,  5.66s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8862 / 0.9508 / 0.9744/ [0.625      1.         0.97435897]
                Test acc/f1/spec/sens = 0.2584 / 0.2276 / 0.9795 / 0.1336/ [0.07643312 0.91954023 0.13362069]
 66%|██████▌   | 66/100 [05:26<02:59,  5.28s/it] 67%|██████▋   | 67/100 [05:29<02:37,  4.78s/it] 68%|██████▊   | 68/100 [05:34<02:31,  4.73s/it] 69%|██████▉   | 69/100 [05:37<02:15,  4.36s/it] 70%|███████   | 70/100 [05:47<02:57,  5.90s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8729 / 0.9508 / 0.9487/ [0.625      1.         0.94871795]
                Test acc/f1/spec/sens = 0.2752 / 0.2503 / 0.9713 / 0.1509/ [0.10191083 0.91954023 0.15086207]
 71%|███████   | 71/100 [05:50<02:30,  5.18s/it] 72%|███████▏  | 72/100 [05:55<02:19,  4.99s/it] 73%|███████▎  | 73/100 [05:58<02:01,  4.48s/it] 74%|███████▍  | 74/100 [06:03<01:56,  4.49s/it] 75%|███████▌  | 75/100 [06:11<02:18,  5.52s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8862 / 0.9508 / 0.9744/ [0.625      1.         0.97435897]
                Test acc/f1/spec/sens = 0.2668 / 0.2347 / 0.9754 / 0.1509/ [0.07006369 0.93103448 0.15086207]
 76%|███████▌  | 76/100 [06:15<02:04,  5.18s/it] 77%|███████▋  | 77/100 [06:18<01:46,  4.62s/it] 78%|███████▊  | 78/100 [06:23<01:41,  4.62s/it] 79%|███████▉  | 79/100 [06:27<01:29,  4.28s/it] 80%|████████  | 80/100 [06:35<01:53,  5.65s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8729 / 0.9508 / 0.9487/ [0.625      1.         0.94871795]
                Test acc/f1/spec/sens = 0.2605 / 0.2295 / 0.9754 / 0.1422/ [0.07006369 0.91954023 0.14224138]
 81%|████████  | 81/100 [06:39<01:34,  4.99s/it] 82%|████████▏ | 82/100 [06:44<01:28,  4.89s/it] 83%|████████▎ | 83/100 [06:47<01:15,  4.42s/it] 84%|████████▍ | 84/100 [06:52<01:13,  4.57s/it] 85%|████████▌ | 85/100 [07:00<01:25,  5.67s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8862 / 0.9508 / 0.9744/ [0.625      1.         0.97435897]
                Test acc/f1/spec/sens = 0.2458 / 0.2084 / 0.9877 / 0.1164/ [0.05732484 0.93103448 0.11637931]
 86%|████████▌ | 86/100 [07:04<01:14,  5.32s/it] 87%|████████▋ | 87/100 [07:08<01:01,  4.77s/it] 88%|████████▊ | 88/100 [07:13<00:56,  4.73s/it] 89%|████████▉ | 89/100 [07:16<00:47,  4.33s/it] 90%|█████████ | 90/100 [07:25<00:57,  5.71s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8862 / 0.9508 / 0.9744/ [0.625      1.         0.97435897]
                Test acc/f1/spec/sens = 0.2710 / 0.2420 / 0.9713 / 0.1595/ [0.07643312 0.91954023 0.15948276]
 91%|█████████ | 91/100 [07:28<00:45,  5.04s/it] 92%|█████████▏| 92/100 [07:33<00:39,  4.93s/it] 93%|█████████▎| 93/100 [07:37<00:31,  4.52s/it] 94%|█████████▍| 94/100 [07:41<00:27,  4.53s/it] 95%|█████████▌| 95/100 [07:49<00:27,  5.54s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8729 / 0.9508 / 0.9487/ [0.625      1.         0.94871795]
                Test acc/f1/spec/sens = 0.2836 / 0.2628 / 0.9549 / 0.1638/ [0.11464968 0.90804598 0.1637931 ]
 96%|█████████▌| 96/100 [07:54<00:21,  5.40s/it] 97%|█████████▋| 97/100 [07:58<00:14,  4.85s/it] 98%|█████████▊| 98/100 [08:02<00:09,  4.80s/it] 99%|█████████▉| 99/100 [08:06<00:04,  4.44s/it]100%|██████████| 100/100 [08:15<00:00,  5.84s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8729 / 0.9508 / 0.9487/ [0.625      1.         0.94871795]
                Test acc/f1/spec/sens = 0.2605 / 0.2276 / 0.9754 / 0.1466/ [0.06369427 0.91954023 0.14655172]
Trial 2, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9200 / 0.8729 / 0.9508 / 0.9487/ [0.625      1.         0.94871795]
Test acc/f1/spec/sens = 0.2605 / 0.2276 / 0.9754 / 0.1466/ [0.06369427 0.91954023 0.14655172]
>> Finished.
Acc, agreement for latest model:  0.2605042016806723 0.3277310924369748 [0.06369427 0.91954023 0.14655172]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3025210084033613 0.34663865546218486 [0.10828025 0.89655172 0.2112069 ]
Trial 1/1 || Cycle 4/5 || Label set size 720 || Test acc 0.3025 || Test agreement 0.3466 || Spec 0.9221 || Sens 0.2112 Class Acc: [0.10828025 0.89655172 0.2112069 ]
**************************************************************************************************** 

  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:01<00:08,  1.71s/it] 33%|███▎      | 2/6 [00:01<00:03,  1.26it/s] 67%|██████▋   | 4/6 [00:02<00:00,  2.88it/s] 83%|████████▎ | 5/6 [00:02<00:00,  2.04it/s]100%|██████████| 6/6 [00:03<00:00,  1.92it/s]
labeled set:  900
unlabeled set:  533
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.35it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.79it/s] 75%|███████▌  | 9/12 [00:01<00:00, 11.35it/s]100%|██████████| 12/12 [00:01<00:00,  9.28it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 15, 1: 92, 2: 73}
Validation set distribution: 
Number of samples  100
{0: 16, 1: 45, 2: 39}
Labeled set distribution: 
Number of samples  900
{0: 221, 1: 328, 2: 351}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2185, agreement = 0.2773, f1 = 0.1933, spec = 1.0000, sens = 0.0000 Class Acc: [0.21656051 0.8045977  0.        ]
Initial model on validation dataset: acc = 0.3900, agreement = 0.3900, f1 = 0.2508, spec = 1.0000, sens = 0.0000 Class Acc: [0.1875 0.8    0.    ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<06:49,  4.14s/it]  2%|▏         | 2/100 [00:09<08:04,  4.94s/it]  3%|▎         | 3/100 [00:13<07:22,  4.56s/it]  4%|▍         | 4/100 [00:19<07:50,  4.90s/it]  5%|▌         | 5/100 [00:28<10:06,  6.39s/it]Epoch 5: Train acc/f1 = 0.6911 / 0.5723 / 0.5920 / 0.9658/ [0.08144796 0.80792683 0.96581197] 
                Val acc/f1/spec/sens = 0.8600 / 0.7969 / 0.9672 / 0.8462/ [0.5625     0.97777778 0.84615385]
                Test acc/f1/spec/sens = 0.5651 / 0.4261 / 0.6066 / 0.8664/ [0.00636943 0.77011494 0.86637931]
  6%|▌         | 6/100 [00:33<09:34,  6.11s/it]  7%|▋         | 7/100 [00:37<08:19,  5.37s/it]  8%|▊         | 8/100 [00:42<08:10,  5.34s/it]  9%|▉         | 9/100 [00:46<07:22,  4.86s/it] 10%|█         | 10/100 [00:56<09:28,  6.32s/it]Epoch 10: Train acc/f1 = 0.9167 / 0.9118 / 0.9818 / 0.8946/ [0.92307692 0.93597561 0.89458689] 
                Val acc/f1/spec/sens = 0.9000 / 0.8608 / 0.9672 / 0.8974/ [0.75       0.95555556 0.8974359 ]
                Test acc/f1/spec/sens = 0.2080 / 0.1442 / 1.0000 / 0.0345/ [0.02547771 1.         0.03448276]
 11%|█         | 11/100 [01:00<08:13,  5.54s/it] 12%|█▏        | 12/100 [01:04<07:50,  5.35s/it] 13%|█▎        | 13/100 [01:08<07:04,  4.87s/it] 14%|█▍        | 14/100 [01:13<07:01,  4.90s/it] 15%|█▌        | 15/100 [01:22<08:29,  6.00s/it]Epoch 15: Train acc/f1 = 0.8722 / 0.8623 / 0.8251 / 0.9915/ [0.68778281 0.86890244 0.99145299] 
                Val acc/f1/spec/sens = 0.8700 / 0.8231 / 0.9836 / 0.8718/ [0.625      0.95555556 0.87179487]
                Test acc/f1/spec/sens = 0.6050 / 0.4636 / 0.6475 / 0.9440/ [0.03821656 0.72413793 0.94396552]
 16%|█▌        | 16/100 [01:27<07:56,  5.67s/it] 17%|█▋        | 17/100 [01:30<07:02,  5.10s/it] 18%|█▊        | 18/100 [01:36<07:01,  5.14s/it] 19%|█▉        | 19/100 [01:39<06:23,  4.73s/it] 20%|██        | 20/100 [01:49<08:13,  6.17s/it]Epoch 20: Train acc/f1 = 0.9056 / 0.9014 / 0.9982 / 0.8091/ [0.94117647 0.9847561  0.80911681] 
                Val acc/f1/spec/sens = 0.7900 / 0.7218 / 0.9836 / 0.6923/ [0.5        0.97777778 0.69230769]
                Test acc/f1/spec/sens = 0.1891 / 0.1161 / 1.0000 / 0.0000/ [0.01910828 1.         0.        ]
 21%|██        | 21/100 [01:53<07:09,  5.44s/it] 22%|██▏       | 22/100 [01:58<06:53,  5.30s/it] 23%|██▎       | 23/100 [02:02<06:18,  4.91s/it] 24%|██▍       | 24/100 [02:07<06:17,  4.97s/it] 25%|██▌       | 25/100 [02:16<07:43,  6.18s/it]Epoch 25: Train acc/f1 = 0.9989 / 0.9987 / 1.0000 / 1.0000/ [1.         0.99695122 1.        ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8300 / 0.9508 / 0.9231/ [0.5625     0.97777778 0.92307692]
                Test acc/f1/spec/sens = 0.3529 / 0.3150 / 0.9754 / 0.3060/ [0.06369427 1.         0.30603448]
 26%|██▌       | 26/100 [02:21<07:12,  5.85s/it] 27%|██▋       | 27/100 [02:25<06:23,  5.25s/it] 28%|██▊       | 28/100 [02:30<06:16,  5.22s/it] 29%|██▉       | 29/100 [02:34<05:41,  4.81s/it] 30%|███       | 30/100 [02:44<07:22,  6.32s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8339 / 0.9508 / 0.9744/ [0.5        0.97777778 0.97435897]
                Test acc/f1/spec/sens = 0.2773 / 0.2323 / 0.9877 / 0.1681/ [0.03821656 1.         0.16810345]
 31%|███       | 31/100 [02:48<06:26,  5.60s/it] 32%|███▏      | 32/100 [02:53<06:12,  5.48s/it] 33%|███▎      | 33/100 [02:57<05:34,  5.00s/it] 34%|███▍      | 34/100 [03:02<05:29,  5.00s/it] 35%|███▌      | 35/100 [03:10<06:37,  6.12s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8543 / 0.9508 / 0.9744/ [0.5625     0.97777778 0.97435897]
                Test acc/f1/spec/sens = 0.2731 / 0.2295 / 0.9959 / 0.1552/ [0.04458599 1.         0.15517241]
 36%|███▌      | 36/100 [03:16<06:14,  5.86s/it] 37%|███▋      | 37/100 [03:20<05:34,  5.31s/it] 38%|███▊      | 38/100 [03:25<05:23,  5.21s/it] 39%|███▉      | 39/100 [03:29<04:56,  4.85s/it] 40%|████      | 40/100 [03:39<06:28,  6.47s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8615 / 0.9672 / 0.9487/ [0.625      0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.3256 / 0.2836 / 0.9836 / 0.2629/ [0.04458599 1.         0.26293103]
 41%|████      | 41/100 [03:43<05:39,  5.75s/it] 42%|████▏     | 42/100 [03:48<05:24,  5.59s/it] 43%|████▎     | 43/100 [03:52<04:51,  5.12s/it] 44%|████▍     | 44/100 [03:58<04:51,  5.20s/it] 45%|████▌     | 45/100 [04:06<05:45,  6.28s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8802 / 0.9836 / 0.9487/ [0.6875     0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.2794 / 0.2348 / 0.9959 / 0.1724/ [0.03821656 1.         0.17241379]
 46%|████▌     | 46/100 [04:11<05:18,  5.90s/it] 47%|████▋     | 47/100 [04:15<04:40,  5.29s/it] 48%|████▊     | 48/100 [04:20<04:31,  5.22s/it] 49%|████▉     | 49/100 [04:24<04:07,  4.84s/it] 50%|█████     | 50/100 [04:34<05:22,  6.45s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8615 / 0.9672 / 0.9487/ [0.625      0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.2962 / 0.2568 / 0.9959 / 0.1983/ [0.05095541 1.         0.19827586]
 51%|█████     | 51/100 [04:38<04:39,  5.70s/it] 52%|█████▏    | 52/100 [04:44<04:25,  5.53s/it] 53%|█████▎    | 53/100 [04:48<03:58,  5.07s/it] 54%|█████▍    | 54/100 [04:53<04:00,  5.23s/it] 55%|█████▌    | 55/100 [05:02<04:47,  6.38s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8867 / 0.9672 / 0.9744/ [0.625      1.         0.97435897]
                Test acc/f1/spec/sens = 0.2878 / 0.2454 / 0.9877 / 0.1853/ [0.04458599 1.         0.18534483]
 56%|█████▌    | 56/100 [05:07<04:23,  5.99s/it] 57%|█████▋    | 57/100 [05:11<03:52,  5.40s/it] 58%|█████▊    | 58/100 [05:17<03:46,  5.39s/it] 59%|█████▉    | 59/100 [05:21<03:24,  4.99s/it] 60%|██████    | 60/100 [05:31<04:22,  6.55s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8615 / 0.9672 / 0.9487/ [0.625      0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.3025 / 0.2566 / 0.9836 / 0.2241/ [0.03184713 1.         0.22413793]
 61%|██████    | 61/100 [05:35<03:46,  5.81s/it] 62%|██████▏   | 62/100 [05:40<03:32,  5.58s/it] 63%|██████▎   | 63/100 [05:44<03:06,  5.04s/it] 64%|██████▍   | 64/100 [05:49<03:04,  5.14s/it] 65%|██████▌   | 65/100 [05:59<03:44,  6.40s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8615 / 0.9672 / 0.9487/ [0.625      0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.3151 / 0.2731 / 0.9795 / 0.2414/ [0.04458599 1.         0.24137931]
 66%|██████▌   | 66/100 [06:04<03:26,  6.07s/it] 67%|██████▋   | 67/100 [06:08<03:01,  5.51s/it] 68%|██████▊   | 68/100 [06:13<02:53,  5.41s/it] 69%|██████▉   | 69/100 [06:17<02:33,  4.97s/it] 70%|███████   | 70/100 [06:27<03:13,  6.46s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8615 / 0.9672 / 0.9487/ [0.625      0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.3382 / 0.2953 / 0.9795 / 0.2888/ [0.04458599 1.         0.2887931 ]
 71%|███████   | 71/100 [06:31<02:44,  5.66s/it] 72%|███████▏  | 72/100 [06:36<02:36,  5.57s/it] 73%|███████▎  | 73/100 [06:41<02:20,  5.20s/it] 74%|███████▍  | 74/100 [06:46<02:14,  5.16s/it] 75%|███████▌  | 75/100 [06:54<02:36,  6.25s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8615 / 0.9672 / 0.9487/ [0.625      0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.2857 / 0.2393 / 0.9877 / 0.1897/ [0.03184713 1.         0.18965517]
 76%|███████▌  | 76/100 [07:00<02:23,  6.00s/it] 77%|███████▋  | 77/100 [07:04<02:04,  5.42s/it] 78%|███████▊  | 78/100 [07:09<01:57,  5.34s/it] 79%|███████▉  | 79/100 [07:13<01:43,  4.94s/it] 80%|████████  | 80/100 [07:23<02:08,  6.43s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8615 / 0.9672 / 0.9487/ [0.625      0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.2794 / 0.2349 / 0.9959 / 0.1724/ [0.03821656 1.         0.17241379]
 81%|████████  | 81/100 [07:27<01:48,  5.69s/it] 82%|████████▏ | 82/100 [07:32<01:39,  5.51s/it] 83%|████████▎ | 83/100 [07:36<01:26,  5.09s/it] 84%|████████▍ | 84/100 [07:41<01:21,  5.09s/it] 85%|████████▌ | 85/100 [07:50<01:33,  6.26s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8218 / 0.9508 / 0.9487/ [0.5        0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.2731 / 0.2258 / 0.9918 / 0.1638/ [0.03184713 1.         0.1637931 ]
 86%|████████▌ | 86/100 [07:55<01:22,  5.90s/it] 87%|████████▋ | 87/100 [07:59<01:08,  5.29s/it] 88%|████████▊ | 88/100 [08:04<01:02,  5.19s/it] 89%|████████▉ | 89/100 [08:08<00:52,  4.80s/it] 90%|█████████ | 90/100 [08:18<01:04,  6.48s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8615 / 0.9672 / 0.9487/ [0.625      0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.2878 / 0.2457 / 0.9959 / 0.1853/ [0.04458599 1.         0.18534483]
 91%|█████████ | 91/100 [08:22<00:51,  5.73s/it] 92%|█████████▏| 92/100 [08:27<00:43,  5.49s/it] 93%|█████████▎| 93/100 [08:31<00:34,  4.97s/it] 94%|█████████▍| 94/100 [08:36<00:29,  4.99s/it] 95%|█████████▌| 95/100 [08:45<00:30,  6.12s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8426 / 0.9672 / 0.9487/ [0.5625     0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.2731 / 0.2276 / 0.9877 / 0.1595/ [0.03821656 1.         0.15948276]
 96%|█████████▌| 96/100 [08:50<00:23,  5.78s/it] 97%|█████████▋| 97/100 [08:54<00:15,  5.27s/it] 98%|█████████▊| 98/100 [08:59<00:10,  5.18s/it] 99%|█████████▉| 99/100 [09:03<00:04,  4.80s/it]100%|██████████| 100/100 [09:13<00:00,  6.34s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8615 / 0.9672 / 0.9487/ [0.625      0.97777778 0.94871795]
                Test acc/f1/spec/sens = 0.2857 / 0.2393 / 0.9877 / 0.1897/ [0.03184713 1.         0.18965517]
Trial 2, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9100 / 0.8615 / 0.9672 / 0.9487/ [0.625      0.97777778 0.94871795]
Test acc/f1/spec/sens = 0.2857 / 0.2393 / 0.9877 / 0.1897/ [0.03184713 1.         0.18965517]
>> Finished.
Acc, agreement for latest model:  0.2857142857142857 0.32563025210084034 [0.03184713 1.         0.18965517]
Load best checkpoint for thief model
Acc, agreement for best model:  0.2689075630252101 0.31092436974789917 [0.03184713 1.         0.15517241]
Trial 1/1 || Cycle 5/5 || Label set size 900 || Test acc 0.2689 || Test agreement 0.3109 || Spec 0.9918 || Sens 0.1552 Class Acc: [0.03184713 1.         0.15517241]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.50it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.46it/s] 75%|███████▌  | 9/12 [00:01<00:00, 11.64it/s]100%|██████████| 12/12 [00:01<00:00,  9.70it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.53it/s] 71%|███████▏  | 5/7 [00:00<00:00,  7.79it/s]100%|██████████| 7/7 [00:00<00:00, 10.00it/s]100%|██████████| 7/7 [00:01<00:00,  6.25it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2182, -1.2345, -1.2098]), tensor([0.8466, 0.8422, 0.8494]))
Val set stats: mean/std =  (tensor([-1.2028, -1.2164, -1.1960]), tensor([0.8576, 0.8534, 0.8604]))
Validation set distribution: 
Number of samples  100
{0: 17, 1: 37, 2: 46}
Labeled set distribution: 
Number of samples  180
{0: 32, 1: 85, 2: 63}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.1891, agreement = 0.1576, f1 = 0.1472, spec = 0.8074, sens = 0.0172 Class Acc: [0.49681529 0.09195402 0.01724138]
Initial model on validation dataset: acc = 0.3700, agreement = 0.3700, f1 = 0.3795, spec = 0.9074, sens = 0.2609 Class Acc: [0.76470588 0.32432432 0.26086957]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:25,  1.47s/it]  2%|▏         | 2/100 [00:04<03:39,  2.24s/it]  3%|▎         | 3/100 [00:05<03:02,  1.88s/it]  4%|▍         | 4/100 [00:08<03:40,  2.30s/it]  5%|▌         | 5/100 [00:12<04:35,  2.90s/it]Epoch 5: Train acc/f1 = 0.8333 / 0.7952 / 0.9915 / 0.6508/ [0.75       1.         0.65079365] 
                Val acc/f1/spec/sens = 0.7900 / 0.6830 / 0.8889 / 0.8261/ [0.23529412 1.         0.82608696]
                Test acc/f1/spec/sens = 0.3403 / 0.3370 / 0.9344 / 0.1983/ [0.21019108 0.95402299 0.19827586]
  6%|▌         | 6/100 [00:15<04:32,  2.90s/it]  7%|▋         | 7/100 [00:17<03:47,  2.45s/it]  8%|▊         | 8/100 [00:20<04:03,  2.65s/it]  9%|▉         | 9/100 [00:21<03:27,  2.28s/it] 10%|█         | 10/100 [00:26<04:50,  3.22s/it]Epoch 10: Train acc/f1 = 0.9611 / 0.9476 / 1.0000 / 0.9048/ [0.96875   1.        0.9047619] 
                Val acc/f1/spec/sens = 0.8800 / 0.8584 / 0.9630 / 0.8043/ [0.88235294 0.97297297 0.80434783]
                Test acc/f1/spec/sens = 0.4748 / 0.4191 / 0.6926 / 0.6638/ [0.07006369 0.70114943 0.6637931 ]
 11%|█         | 11/100 [00:28<03:58,  2.68s/it] 12%|█▏        | 12/100 [00:30<03:51,  2.63s/it] 13%|█▎        | 13/100 [00:32<03:17,  2.27s/it] 14%|█▍        | 14/100 [00:34<03:22,  2.35s/it] 15%|█▌        | 15/100 [00:38<04:00,  2.83s/it]Epoch 15: Train acc/f1 = 0.7333 / 0.7101 / 1.0000 / 0.4603/ [0.5625     1.         0.46031746] 
                Val acc/f1/spec/sens = 0.8300 / 0.7882 / 0.9259 / 0.8043/ [0.58823529 0.97297297 0.80434783]
                Test acc/f1/spec/sens = 0.1912 / 0.1188 / 0.9959 / 0.0086/ [0.01273885 1.         0.00862069]
 16%|█▌        | 16/100 [00:41<03:52,  2.76s/it] 17%|█▋        | 17/100 [00:42<03:19,  2.40s/it] 18%|█▊        | 18/100 [00:45<03:21,  2.46s/it] 19%|█▉        | 19/100 [00:46<02:53,  2.14s/it] 20%|██        | 20/100 [00:51<04:00,  3.01s/it]Epoch 20: Train acc/f1 = 0.8611 / 0.7638 / 0.9915 / 0.9683/ [0.28125    1.         0.96825397] 
                Val acc/f1/spec/sens = 0.7800 / 0.6699 / 0.9630 / 0.8043/ [0.23529412 1.         0.80434783]
                Test acc/f1/spec/sens = 0.5798 / 0.4464 / 0.7254 / 0.8362/ [0.         0.94252874 0.8362069 ]
 21%|██        | 21/100 [00:53<03:20,  2.53s/it] 22%|██▏       | 22/100 [00:56<03:28,  2.67s/it] 23%|██▎       | 23/100 [00:57<02:56,  2.30s/it] 24%|██▍       | 24/100 [01:00<03:08,  2.48s/it] 25%|██▌       | 25/100 [01:04<03:38,  2.92s/it]Epoch 25: Train acc/f1 = 0.9944 / 0.9922 / 1.0000 / 0.9841/ [1.         1.         0.98412698] 
                Val acc/f1/spec/sens = 0.9300 / 0.9153 / 1.0000 / 0.8696/ [0.94117647 1.         0.86956522]
                Test acc/f1/spec/sens = 0.5420 / 0.4466 / 0.7213 / 0.7198/ [0.04458599 0.96551724 0.71982759]
 26%|██▌       | 26/100 [01:07<03:27,  2.80s/it] 27%|██▋       | 27/100 [01:08<02:54,  2.39s/it] 28%|██▊       | 28/100 [01:11<02:55,  2.44s/it] 29%|██▉       | 29/100 [01:12<02:29,  2.11s/it] 30%|███       | 30/100 [01:17<03:29,  2.99s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9153 / 1.0000 / 0.8696/ [0.94117647 1.         0.86956522]
                Test acc/f1/spec/sens = 0.5189 / 0.4302 / 0.7049 / 0.6897/ [0.04458599 0.91954023 0.68965517]
 31%|███       | 31/100 [01:18<02:54,  2.53s/it] 32%|███▏      | 32/100 [01:21<02:51,  2.52s/it] 33%|███▎      | 33/100 [01:22<02:27,  2.20s/it] 34%|███▍      | 34/100 [01:25<02:33,  2.32s/it] 35%|███▌      | 35/100 [01:29<03:01,  2.80s/it]Epoch 35: Train acc/f1 = 0.9944 / 0.9922 / 1.0000 / 0.9841/ [1.         1.         0.98412698] 
                Val acc/f1/spec/sens = 0.9100 / 0.8958 / 1.0000 / 0.8261/ [1.         0.97297297 0.82608696]
                Test acc/f1/spec/sens = 0.5252 / 0.4431 / 0.7336 / 0.6940/ [0.06369427 0.90804598 0.69396552]
 36%|███▌      | 36/100 [01:32<02:54,  2.72s/it] 37%|███▋      | 37/100 [01:33<02:26,  2.33s/it] 38%|███▊      | 38/100 [01:36<02:38,  2.55s/it] 39%|███▉      | 39/100 [01:38<02:16,  2.24s/it] 40%|████      | 40/100 [01:42<03:03,  3.06s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8958 / 1.0000 / 0.8261/ [1.         0.97297297 0.82608696]
                Test acc/f1/spec/sens = 0.4727 / 0.3981 / 0.7787 / 0.5733/ [0.04458599 0.97701149 0.57327586]
 41%|████      | 41/100 [01:44<02:31,  2.57s/it] 42%|████▏     | 42/100 [01:46<02:28,  2.55s/it] 43%|████▎     | 43/100 [01:48<02:06,  2.22s/it] 44%|████▍     | 44/100 [01:50<02:10,  2.33s/it] 45%|████▌     | 45/100 [01:54<02:32,  2.77s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9177 / 1.0000 / 0.8696/ [1.         0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.4202 / 0.3563 / 0.7828 / 0.4612/ [0.03821656 1.         0.4612069 ]
 46%|████▌     | 46/100 [01:57<02:25,  2.70s/it] 47%|████▋     | 47/100 [01:58<02:03,  2.33s/it] 48%|████▊     | 48/100 [02:01<02:04,  2.39s/it] 49%|████▉     | 49/100 [02:02<01:48,  2.13s/it] 50%|█████     | 50/100 [02:07<02:30,  3.01s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9066 / 1.0000 / 0.8478/ [1.         0.97297297 0.84782609]
                Test acc/f1/spec/sens = 0.4853 / 0.4072 / 0.7746 / 0.6034/ [0.04458599 0.96551724 0.60344828]
 51%|█████     | 51/100 [02:09<02:05,  2.56s/it] 52%|█████▏    | 52/100 [02:11<02:03,  2.57s/it] 53%|█████▎    | 53/100 [02:13<01:45,  2.24s/it] 54%|█████▍    | 54/100 [02:16<01:48,  2.35s/it] 55%|█████▌    | 55/100 [02:20<02:08,  2.85s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9066 / 1.0000 / 0.8478/ [1.         0.97297297 0.84782609]
                Test acc/f1/spec/sens = 0.4706 / 0.3958 / 0.7664 / 0.5862/ [0.04458599 0.93103448 0.5862069 ]
 56%|█████▌    | 56/100 [02:22<02:02,  2.79s/it] 57%|█████▋    | 57/100 [02:24<01:43,  2.42s/it] 58%|█████▊    | 58/100 [02:26<01:42,  2.45s/it] 59%|█████▉    | 59/100 [02:28<01:28,  2.17s/it] 60%|██████    | 60/100 [02:33<02:01,  3.05s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9177 / 1.0000 / 0.8696/ [1.         0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.4664 / 0.3931 / 0.7787 / 0.5603/ [0.04458599 0.97701149 0.56034483]
 61%|██████    | 61/100 [02:35<01:42,  2.62s/it] 62%|██████▏   | 62/100 [02:37<01:41,  2.66s/it] 63%|██████▎   | 63/100 [02:39<01:25,  2.30s/it] 64%|██████▍   | 64/100 [02:41<01:26,  2.41s/it] 65%|██████▌   | 65/100 [02:46<01:42,  2.92s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9177 / 1.0000 / 0.8696/ [1.         0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.4748 / 0.3991 / 0.7664 / 0.5991/ [0.04458599 0.91954023 0.59913793]
 66%|██████▌   | 66/100 [02:48<01:35,  2.81s/it] 67%|██████▋   | 67/100 [02:50<01:20,  2.42s/it] 68%|██████▊   | 68/100 [02:52<01:19,  2.48s/it] 69%|██████▉   | 69/100 [02:54<01:08,  2.20s/it] 70%|███████   | 70/100 [02:59<01:33,  3.11s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9066 / 1.0000 / 0.8478/ [1.         0.97297297 0.84782609]
                Test acc/f1/spec/sens = 0.4748 / 0.3996 / 0.7746 / 0.5776/ [0.04458599 0.97701149 0.57758621]
 71%|███████   | 71/100 [03:01<01:17,  2.68s/it] 72%|███████▏  | 72/100 [03:04<01:16,  2.74s/it] 73%|███████▎  | 73/100 [03:05<01:05,  2.41s/it] 74%|███████▍  | 74/100 [03:08<01:05,  2.52s/it] 75%|███████▌  | 75/100 [03:12<01:16,  3.07s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9066 / 1.0000 / 0.8478/ [1.         0.97297297 0.84782609]
                Test acc/f1/spec/sens = 0.4727 / 0.3971 / 0.7705 / 0.5905/ [0.04458599 0.93103448 0.59051724]
 76%|███████▌  | 76/100 [03:15<01:12,  3.04s/it] 77%|███████▋  | 77/100 [03:17<01:00,  2.64s/it] 78%|███████▊  | 78/100 [03:20<00:59,  2.73s/it] 79%|███████▉  | 79/100 [03:22<00:50,  2.41s/it] 80%|████████  | 80/100 [03:27<01:08,  3.43s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9177 / 1.0000 / 0.8696/ [1.         0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.5168 / 0.4287 / 0.7582 / 0.6767/ [0.04458599 0.94252874 0.67672414]
 81%|████████  | 81/100 [03:29<00:54,  2.87s/it] 82%|████████▏ | 82/100 [03:32<00:51,  2.85s/it] 83%|████████▎ | 83/100 [03:33<00:42,  2.51s/it] 84%|████████▍ | 84/100 [03:36<00:42,  2.64s/it] 85%|████████▌ | 85/100 [03:41<00:48,  3.20s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8958 / 1.0000 / 0.8261/ [1.         0.97297297 0.82608696]
                Test acc/f1/spec/sens = 0.5210 / 0.4309 / 0.7623 / 0.6853/ [0.04458599 0.94252874 0.68534483]
 86%|████████▌ | 86/100 [03:44<00:44,  3.17s/it] 87%|████████▋ | 87/100 [03:46<00:35,  2.70s/it] 88%|████████▊ | 88/100 [03:49<00:33,  2.81s/it] 89%|████████▉ | 89/100 [03:50<00:26,  2.45s/it] 90%|█████████ | 90/100 [03:56<00:35,  3.57s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8958 / 1.0000 / 0.8261/ [1.         0.97297297 0.82608696]
                Test acc/f1/spec/sens = 0.4286 / 0.3654 / 0.7787 / 0.4871/ [0.04458599 0.96551724 0.48706897]
 91%|█████████ | 91/100 [03:58<00:26,  2.98s/it] 92%|█████████▏| 92/100 [04:01<00:23,  2.95s/it] 93%|█████████▎| 93/100 [04:03<00:17,  2.55s/it] 94%|█████████▍| 94/100 [04:05<00:15,  2.65s/it] 95%|█████████▌| 95/100 [04:10<00:15,  3.17s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9177 / 1.0000 / 0.8696/ [1.         0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.4349 / 0.3728 / 0.7787 / 0.4957/ [0.05095541 0.96551724 0.49568966]
 96%|█████████▌| 96/100 [04:13<00:12,  3.16s/it] 97%|█████████▋| 97/100 [04:15<00:08,  2.70s/it] 98%|█████████▊| 98/100 [04:17<00:05,  2.74s/it] 99%|█████████▉| 99/100 [04:19<00:02,  2.43s/it]100%|██████████| 100/100 [04:25<00:00,  3.40s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8958 / 1.0000 / 0.8261/ [1.         0.97297297 0.82608696]
                Test acc/f1/spec/sens = 0.5168 / 0.4292 / 0.7746 / 0.6638/ [0.04458599 0.97701149 0.6637931 ]
Trial 3, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9100 / 0.8958 / 1.0000 / 0.8261/ [1.         0.97297297 0.82608696]
Test acc/f1/spec/sens = 0.5168 / 0.4292 / 0.7746 / 0.6638/ [0.04458599 0.97701149 0.6637931 ]
>> Finished.
Acc, agreement for latest model:  0.5168067226890757 0.5651260504201681 [0.04458599 0.97701149 0.6637931 ]
Load best checkpoint for thief model
Acc, agreement for best model:  0.5651260504201681 0.6113445378151261 [0.06369427 0.88505747 0.78448276]
Trial 2/1 || Cycle 1/5 || Label set size 180 || Test acc 0.5651 || Test agreement 0.6113 || Spec 0.7049 || Sens 0.7845 Class Acc: [0.06369427 0.88505747 0.78448276]
**************************************************************************************************** 

  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:02<00:20,  2.28s/it] 20%|██        | 2/10 [00:02<00:08,  1.00s/it] 40%|████      | 4/10 [00:02<00:02,  2.34it/s] 50%|█████     | 5/10 [00:04<00:03,  1.26it/s] 70%|███████   | 7/10 [00:04<00:01,  2.18it/s] 90%|█████████ | 9/10 [00:05<00:00,  1.78it/s]100%|██████████| 10/10 [00:06<00:00,  1.65it/s]
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.29it/s] 25%|██▌       | 3/12 [00:00<00:02,  3.98it/s] 58%|█████▊    | 7/12 [00:01<00:00,  8.11it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.46it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.54it/s]100%|██████████| 12/12 [00:01<00:00,  7.08it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 68, 1: 54, 2: 58}
Validation set distribution: 
Number of samples  100
{0: 17, 1: 37, 2: 46}
Labeled set distribution: 
Number of samples  360
{0: 100, 1: 139, 2: 121}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2059, agreement = 0.2710, f1 = 0.1487, spec = 1.0000, sens = 0.0000 Class Acc: [0.07006369 1.         0.        ]
Initial model on validation dataset: acc = 0.3700, agreement = 0.3700, f1 = 0.2129, spec = 1.0000, sens = 0.0000 Class Acc: [0.05882353 0.97297297 0.        ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:09,  2.52s/it]  2%|▏         | 2/100 [00:06<05:28,  3.35s/it]  3%|▎         | 3/100 [00:09<04:54,  3.04s/it]  4%|▍         | 4/100 [00:12<05:20,  3.34s/it]  5%|▌         | 5/100 [00:18<06:45,  4.27s/it]Epoch 5: Train acc/f1 = 0.4667 / 0.3547 / 1.0000 / 0.1653/ [0.11       0.98561151 0.16528926] 
                Val acc/f1/spec/sens = 0.7900 / 0.6096 / 0.7963 / 0.8913/ [0.05882353 1.         0.89130435]
                Test acc/f1/spec/sens = 0.1891 / 0.1121 / 1.0000 / 0.0129/ [0.         1.         0.01293103]
  6%|▌         | 6/100 [00:22<06:29,  4.14s/it]  7%|▋         | 7/100 [00:25<05:31,  3.57s/it]  8%|▊         | 8/100 [00:29<05:37,  3.67s/it]  9%|▉         | 9/100 [00:31<05:00,  3.30s/it] 10%|█         | 10/100 [00:38<06:42,  4.48s/it]Epoch 10: Train acc/f1 = 0.8611 / 0.8378 / 0.8996 / 0.9587/ [0.56       0.99280576 0.95867769] 
                Val acc/f1/spec/sens = 0.8700 / 0.8107 / 0.9074 / 0.9130/ [0.47058824 1.         0.91304348]
                Test acc/f1/spec/sens = 0.3172 / 0.2894 / 0.9754 / 0.2457/ [0.04458599 1.         0.24568966]
 11%|█         | 11/100 [00:41<05:42,  3.84s/it] 12%|█▏        | 12/100 [00:44<05:33,  3.79s/it] 13%|█▎        | 13/100 [00:47<04:53,  3.38s/it] 14%|█▍        | 14/100 [00:50<04:55,  3.44s/it] 15%|█▌        | 15/100 [00:56<05:58,  4.21s/it]Epoch 15: Train acc/f1 = 0.9167 / 0.9146 / 1.0000 / 0.8430/ [1.         0.92086331 0.84297521] 
                Val acc/f1/spec/sens = 0.8500 / 0.8304 / 1.0000 / 0.7174/ [0.94117647 0.97297297 0.7173913 ]
                Test acc/f1/spec/sens = 0.2332 / 0.1842 / 1.0000 / 0.0690/ [0.05095541 1.         0.06896552]
 16%|█▌        | 16/100 [01:00<05:43,  4.09s/it] 17%|█▋        | 17/100 [01:02<04:54,  3.55s/it] 18%|█▊        | 18/100 [01:06<04:55,  3.61s/it] 19%|█▉        | 19/100 [01:08<04:21,  3.23s/it] 20%|██        | 20/100 [01:16<05:55,  4.44s/it]Epoch 20: Train acc/f1 = 0.7528 / 0.7418 / 0.7950 / 0.9174/ [0.6        0.71942446 0.91735537] 
                Val acc/f1/spec/sens = 0.8000 / 0.7692 / 0.9815 / 0.7826/ [0.76470588 0.83783784 0.7826087 ]
                Test acc/f1/spec/sens = 0.6786 / 0.6120 / 0.6557 / 0.9353/ [0.31847134 0.64367816 0.93534483]
 21%|██        | 21/100 [01:18<04:59,  3.79s/it] 22%|██▏       | 22/100 [01:21<04:49,  3.71s/it] 23%|██▎       | 23/100 [01:24<04:15,  3.31s/it] 24%|██▍       | 24/100 [01:27<04:18,  3.40s/it] 25%|██▌       | 25/100 [01:34<05:17,  4.24s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9007 / 1.0000 / 0.8696/ [0.88235294 1.         0.86956522]
                Test acc/f1/spec/sens = 0.3571 / 0.3609 / 0.9590 / 0.1509/ [0.30573248 1.         0.15086207]
 26%|██▌       | 26/100 [01:38<05:08,  4.17s/it] 27%|██▋       | 27/100 [01:40<04:28,  3.68s/it] 28%|██▊       | 28/100 [01:44<04:23,  3.67s/it] 29%|██▉       | 29/100 [01:46<03:55,  3.31s/it] 30%|███       | 30/100 [01:54<05:14,  4.50s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9007 / 1.0000 / 0.8696/ [0.88235294 1.         0.86956522]
                Test acc/f1/spec/sens = 0.3761 / 0.3792 / 0.9631 / 0.2328/ [0.24203822 1.         0.23275862]
 31%|███       | 31/100 [01:56<04:24,  3.84s/it] 32%|███▏      | 32/100 [02:00<04:17,  3.78s/it] 33%|███▎      | 33/100 [02:02<03:44,  3.35s/it] 34%|███▍      | 34/100 [02:06<03:48,  3.46s/it] 35%|███▌      | 35/100 [02:11<04:32,  4.19s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9089 / 1.0000 / 0.9130/ [0.82352941 1.         0.91304348]
                Test acc/f1/spec/sens = 0.3235 / 0.3200 / 0.9631 / 0.1853/ [0.15286624 1.         0.18534483]
 36%|███▌      | 36/100 [02:15<04:20,  4.07s/it] 37%|███▋      | 37/100 [02:18<03:43,  3.55s/it] 38%|███▊      | 38/100 [02:21<03:41,  3.57s/it] 39%|███▉      | 39/100 [02:23<03:14,  3.19s/it] 40%|████      | 40/100 [02:31<04:24,  4.41s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
                Test acc/f1/spec/sens = 0.3382 / 0.3368 / 0.9590 / 0.2069/ [0.1656051  1.         0.20689655]
 41%|████      | 41/100 [02:33<03:46,  3.84s/it] 42%|████▏     | 42/100 [02:37<03:39,  3.78s/it] 43%|████▎     | 43/100 [02:39<03:11,  3.36s/it] 44%|████▍     | 44/100 [02:43<03:12,  3.43s/it] 45%|████▌     | 45/100 [02:49<03:46,  4.12s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
                Test acc/f1/spec/sens = 0.3613 / 0.3610 / 0.9549 / 0.2500/ [0.17197452 1.         0.25      ]
 46%|████▌     | 46/100 [02:52<03:32,  3.93s/it] 47%|████▋     | 47/100 [02:55<03:08,  3.56s/it] 48%|████▊     | 48/100 [02:58<03:04,  3.55s/it] 49%|████▉     | 49/100 [03:01<02:46,  3.26s/it] 50%|█████     | 50/100 [03:08<03:41,  4.43s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
                Test acc/f1/spec/sens = 0.3718 / 0.3692 / 0.9549 / 0.2802/ [0.15923567 1.         0.28017241]
 51%|█████     | 51/100 [03:10<03:05,  3.79s/it] 52%|█████▏    | 52/100 [03:14<02:58,  3.73s/it] 53%|█████▎    | 53/100 [03:17<02:42,  3.45s/it] 54%|█████▍    | 54/100 [03:20<02:40,  3.49s/it] 55%|█████▌    | 55/100 [03:26<03:09,  4.22s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8856 / 1.0000 / 0.8696/ [0.82352941 1.         0.86956522]
                Test acc/f1/spec/sens = 0.3739 / 0.3726 / 0.9549 / 0.2759/ [0.17197452 1.         0.27586207]
 56%|█████▌    | 56/100 [03:30<03:00,  4.09s/it] 57%|█████▋    | 57/100 [03:32<02:34,  3.59s/it] 58%|█████▊    | 58/100 [03:36<02:30,  3.59s/it] 59%|█████▉    | 59/100 [03:38<02:10,  3.19s/it] 60%|██████    | 60/100 [03:45<02:53,  4.34s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
                Test acc/f1/spec/sens = 0.3319 / 0.3260 / 0.9631 / 0.2112/ [0.14012739 1.         0.2112069 ]
 61%|██████    | 61/100 [03:48<02:27,  3.78s/it] 62%|██████▏   | 62/100 [03:52<02:24,  3.81s/it] 63%|██████▎   | 63/100 [03:54<02:08,  3.47s/it] 64%|██████▍   | 64/100 [03:58<02:06,  3.51s/it] 65%|██████▌   | 65/100 [04:04<02:27,  4.22s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
                Test acc/f1/spec/sens = 0.3761 / 0.3756 / 0.9549 / 0.2802/ [0.17197452 1.         0.28017241]
 66%|██████▌   | 66/100 [04:07<02:17,  4.03s/it] 67%|██████▋   | 67/100 [04:10<01:56,  3.53s/it] 68%|██████▊   | 68/100 [04:13<01:53,  3.56s/it] 69%|██████▉   | 69/100 [04:16<01:38,  3.19s/it] 70%|███████   | 70/100 [04:23<02:10,  4.36s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8856 / 1.0000 / 0.8696/ [0.82352941 1.         0.86956522]
                Test acc/f1/spec/sens = 0.4118 / 0.4051 / 0.9508 / 0.3578/ [0.1656051  1.         0.35775862]
 71%|███████   | 71/100 [04:25<01:50,  3.82s/it] 72%|███████▏  | 72/100 [04:29<01:45,  3.77s/it] 73%|███████▎  | 73/100 [04:32<01:31,  3.39s/it] 74%|███████▍  | 74/100 [04:35<01:29,  3.45s/it] 75%|███████▌  | 75/100 [04:41<01:44,  4.16s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
                Test acc/f1/spec/sens = 0.3613 / 0.3547 / 0.9590 / 0.2716/ [0.14012739 1.         0.27155172]
 76%|███████▌  | 76/100 [04:44<01:34,  3.96s/it] 77%|███████▋  | 77/100 [04:47<01:21,  3.55s/it] 78%|███████▊  | 78/100 [04:51<01:18,  3.55s/it] 79%|███████▉  | 79/100 [04:53<01:08,  3.25s/it] 80%|████████  | 80/100 [05:00<01:29,  4.46s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
                Test acc/f1/spec/sens = 0.3634 / 0.3559 / 0.9631 / 0.2802/ [0.13375796 1.         0.28017241]
 81%|████████  | 81/100 [05:03<01:12,  3.82s/it] 82%|████████▏ | 82/100 [05:07<01:08,  3.80s/it] 83%|████████▎ | 83/100 [05:09<00:58,  3.44s/it] 84%|████████▍ | 84/100 [05:13<00:57,  3.58s/it] 85%|████████▌ | 85/100 [05:19<01:03,  4.23s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
                Test acc/f1/spec/sens = 0.3887 / 0.3693 / 0.9590 / 0.3621/ [0.08917197 1.         0.36206897]
 86%|████████▌ | 86/100 [05:22<00:56,  4.06s/it] 87%|████████▋ | 87/100 [05:25<00:46,  3.54s/it] 88%|████████▊ | 88/100 [05:28<00:42,  3.55s/it] 89%|████████▉ | 89/100 [05:31<00:35,  3.23s/it] 90%|█████████ | 90/100 [05:38<00:44,  4.42s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
                Test acc/f1/spec/sens = 0.3046 / 0.2941 / 0.9672 / 0.1810/ [0.10191083 1.         0.18103448]
 91%|█████████ | 91/100 [05:40<00:34,  3.80s/it] 92%|█████████▏| 92/100 [05:44<00:30,  3.81s/it] 93%|█████████▎| 93/100 [05:47<00:23,  3.42s/it] 94%|█████████▍| 94/100 [05:50<00:20,  3.45s/it] 95%|█████████▌| 95/100 [05:56<00:20,  4.17s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
                Test acc/f1/spec/sens = 0.3718 / 0.3758 / 0.9508 / 0.2371/ [0.22292994 1.         0.23706897]
 96%|█████████▌| 96/100 [06:00<00:16,  4.11s/it] 97%|█████████▋| 97/100 [06:03<00:10,  3.65s/it] 98%|█████████▊| 98/100 [06:06<00:07,  3.66s/it] 99%|█████████▉| 99/100 [06:09<00:03,  3.33s/it]100%|██████████| 100/100 [06:16<00:00,  4.47s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
                Test acc/f1/spec/sens = 0.3592 / 0.3579 / 0.9549 / 0.2500/ [0.1656051 1.        0.25     ]
Trial 3, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9000 / 0.8744 / 1.0000 / 0.8478/ [0.82352941 1.         0.84782609]
Test acc/f1/spec/sens = 0.3592 / 0.3579 / 0.9549 / 0.2500/ [0.1656051 1.        0.25     ]
>> Finished.
Acc, agreement for latest model:  0.3592436974789916 0.42436974789915966 [0.1656051 1.        0.25     ]
Load best checkpoint for thief model
Acc, agreement for best model:  0.6428571428571429 0.7058823529411765 [0.06369427 0.95402299 0.91810345]
Trial 2/1 || Cycle 2/5 || Label set size 360 || Test acc 0.6429 || Test agreement 0.7059 || Spec 0.7787 || Sens 0.9181 Class Acc: [0.06369427 0.95402299 0.91810345]
**************************************************************************************************** 

  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:02<00:18,  2.30s/it] 33%|███▎      | 3/9 [00:02<00:03,  1.51it/s] 56%|█████▌    | 5/9 [00:03<00:02,  1.47it/s] 78%|███████▊  | 7/9 [00:04<00:00,  2.35it/s]100%|██████████| 9/9 [00:04<00:00,  2.94it/s]100%|██████████| 9/9 [00:04<00:00,  1.92it/s]
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:09,  1.17it/s] 42%|████▏     | 5/12 [00:01<00:01,  5.39it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.05it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.53it/s]100%|██████████| 12/12 [00:01<00:00,  7.09it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 79, 1: 71, 2: 30}
Validation set distribution: 
Number of samples  100
{0: 17, 1: 37, 2: 46}
Labeled set distribution: 
Number of samples  540
{0: 179, 1: 210, 2: 151}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.1849, agreement = 0.2500, f1 = 0.1205, spec = 0.9918, sens = 0.0000 Class Acc: [0.02547771 0.96551724 0.        ]
Initial model on validation dataset: acc = 0.2500, agreement = 0.2500, f1 = 0.2108, spec = 0.9815, sens = 0.0217 Class Acc: [0.35294118 0.48648649 0.02173913]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:10,  3.14s/it]  2%|▏         | 2/100 [00:07<06:24,  3.93s/it]  3%|▎         | 3/100 [00:10<05:44,  3.55s/it]  4%|▍         | 4/100 [00:15<06:20,  3.96s/it]  5%|▌         | 5/100 [00:22<08:17,  5.24s/it]Epoch 5: Train acc/f1 = 0.7407 / 0.6905 / 0.9974 / 0.3179/ [0.83798883 0.96190476 0.31788079] 
                Val acc/f1/spec/sens = 0.8300 / 0.7297 / 0.8333 / 0.9130/ [0.29411765 0.97297297 0.91304348]
                Test acc/f1/spec/sens = 0.1828 / 0.1309 / 1.0000 / 0.0000/ [0. 1. 0.]
  6%|▌         | 6/100 [00:27<08:00,  5.11s/it]  7%|▋         | 7/100 [00:30<06:52,  4.44s/it]  8%|▊         | 8/100 [00:35<06:54,  4.51s/it]  9%|▉         | 9/100 [00:38<06:11,  4.09s/it] 10%|█         | 10/100 [00:47<08:12,  5.47s/it]Epoch 10: Train acc/f1 = 0.7833 / 0.7692 / 0.7558 / 1.0000/ [0.5027933  0.86666667 1.        ] 
                Val acc/f1/spec/sens = 0.8500 / 0.7928 / 0.8148 / 1.0000/ [0.47058824 0.83783784 1.        ]
                Test acc/f1/spec/sens = 0.5168 / 0.4279 / 0.7336 / 0.7543/ [0.04458599 0.73563218 0.75431034]
 11%|█         | 11/100 [00:50<06:58,  4.71s/it] 12%|█▏        | 12/100 [00:54<06:47,  4.64s/it] 13%|█▎        | 13/100 [00:57<06:02,  4.16s/it] 14%|█▍        | 14/100 [01:01<06:01,  4.21s/it] 15%|█▌        | 15/100 [01:09<07:18,  5.16s/it]Epoch 15: Train acc/f1 = 0.9019 / 0.8996 / 1.0000 / 0.7947/ [0.94413408 0.94285714 0.79470199] 
                Val acc/f1/spec/sens = 0.8100 / 0.7743 / 1.0000 / 0.6957/ [0.70588235 1.         0.69565217]
                Test acc/f1/spec/sens = 0.2059 / 0.1733 / 0.9959 / 0.0302/ [0.02547771 1.         0.03017241]
 16%|█▌        | 16/100 [01:13<06:54,  4.93s/it] 17%|█▋        | 17/100 [01:17<06:10,  4.47s/it] 18%|█▊        | 18/100 [01:21<06:02,  4.43s/it] 19%|█▉        | 19/100 [01:24<05:26,  4.03s/it] 20%|██        | 20/100 [01:33<07:17,  5.47s/it]Epoch 20: Train acc/f1 = 0.9426 / 0.9431 / 0.9871 / 0.9735/ [0.86592179 0.98571429 0.97350993] 
                Val acc/f1/spec/sens = 0.8700 / 0.8375 / 1.0000 / 0.8043/ [0.76470588 1.         0.80434783]
                Test acc/f1/spec/sens = 0.2668 / 0.2629 / 0.9631 / 0.0776/ [0.14012739 1.         0.07758621]
 21%|██        | 21/100 [01:36<06:15,  4.75s/it] 22%|██▏       | 22/100 [01:40<05:59,  4.61s/it] 23%|██▎       | 23/100 [01:43<05:19,  4.15s/it] 24%|██▍       | 24/100 [01:48<05:23,  4.26s/it] 25%|██▌       | 25/100 [01:55<06:33,  5.24s/it]Epoch 25: Train acc/f1 = 0.9981 / 0.9980 / 1.0000 / 0.9934/ [1.         1.         0.99337748] 
                Val acc/f1/spec/sens = 0.8700 / 0.8373 / 1.0000 / 0.8261/ [0.76470588 0.97297297 0.82608696]
                Test acc/f1/spec/sens = 0.2458 / 0.2365 / 0.9549 / 0.0862/ [0.07006369 0.98850575 0.0862069 ]
 26%|██▌       | 26/100 [02:00<06:07,  4.97s/it] 27%|██▋       | 27/100 [02:03<05:22,  4.41s/it] 28%|██▊       | 28/100 [02:07<05:14,  4.37s/it] 29%|██▉       | 29/100 [02:10<04:41,  3.97s/it] 30%|███       | 30/100 [02:19<06:15,  5.36s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8428 / 0.9815 / 0.8696/ [0.70588235 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2395 / 0.2244 / 0.9754 / 0.0690/ [0.07006369 1.         0.06896552]
 31%|███       | 31/100 [02:22<05:23,  4.69s/it] 32%|███▏      | 32/100 [02:26<05:12,  4.59s/it] 33%|███▎      | 33/100 [02:29<04:35,  4.12s/it] 34%|███▍      | 34/100 [02:34<04:36,  4.19s/it] 35%|███▌      | 35/100 [02:41<05:32,  5.12s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9815 / 0.8696/ [0.70588235 1.         0.86956522]
                Test acc/f1/spec/sens = 0.2416 / 0.2252 / 0.9672 / 0.0733/ [0.07006369 1.         0.07327586]
 36%|███▌      | 36/100 [02:45<05:13,  4.89s/it] 37%|███▋      | 37/100 [02:49<04:38,  4.43s/it] 38%|███▊      | 38/100 [02:53<04:32,  4.40s/it] 39%|███▉      | 39/100 [02:56<04:04,  4.00s/it] 40%|████      | 40/100 [03:05<05:32,  5.55s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9815 / 0.8696/ [0.70588235 1.         0.86956522]
                Test acc/f1/spec/sens = 0.2563 / 0.2442 / 0.9590 / 0.0991/ [0.07643312 1.         0.09913793]
 41%|████      | 41/100 [03:08<04:46,  4.85s/it] 42%|████▏     | 42/100 [03:13<04:39,  4.82s/it] 43%|████▎     | 43/100 [03:16<04:06,  4.32s/it] 44%|████▍     | 44/100 [03:21<04:01,  4.32s/it] 45%|████▌     | 45/100 [03:28<04:44,  5.18s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9815 / 0.8696/ [0.70588235 1.         0.86956522]
                Test acc/f1/spec/sens = 0.2416 / 0.2236 / 0.9877 / 0.0733/ [0.07006369 1.         0.07327586]
 46%|████▌     | 46/100 [03:32<04:28,  4.97s/it] 47%|████▋     | 47/100 [03:35<03:55,  4.45s/it] 48%|████▊     | 48/100 [03:40<03:50,  4.44s/it] 49%|████▉     | 49/100 [03:43<03:27,  4.07s/it] 50%|█████     | 50/100 [03:52<04:33,  5.48s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9815 / 0.8696/ [0.70588235 1.         0.86956522]
                Test acc/f1/spec/sens = 0.2479 / 0.2323 / 0.9590 / 0.0819/ [0.07643312 1.         0.08189655]
 51%|█████     | 51/100 [03:55<03:53,  4.76s/it] 52%|█████▏    | 52/100 [04:00<03:46,  4.72s/it] 53%|█████▎    | 53/100 [04:03<03:20,  4.27s/it] 54%|█████▍    | 54/100 [04:07<03:17,  4.30s/it] 55%|█████▌    | 55/100 [04:15<04:01,  5.36s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9815 / 0.8696/ [0.70588235 1.         0.86956522]
                Test acc/f1/spec/sens = 0.2500 / 0.2370 / 0.9590 / 0.0862/ [0.07643312 1.         0.0862069 ]
 56%|█████▌    | 56/100 [04:19<03:42,  5.06s/it] 57%|█████▋    | 57/100 [04:22<03:12,  4.47s/it] 58%|█████▊    | 58/100 [04:27<03:06,  4.43s/it] 59%|█████▉    | 59/100 [04:30<02:45,  4.05s/it] 60%|██████    | 60/100 [04:38<03:36,  5.40s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9815 / 0.8696/ [0.70588235 1.         0.86956522]
                Test acc/f1/spec/sens = 0.2500 / 0.2355 / 0.9590 / 0.0862/ [0.07643312 1.         0.0862069 ]
 61%|██████    | 61/100 [04:42<03:05,  4.75s/it] 62%|██████▏   | 62/100 [04:46<02:54,  4.59s/it] 63%|██████▎   | 63/100 [04:49<02:32,  4.11s/it] 64%|██████▍   | 64/100 [04:54<02:35,  4.32s/it] 65%|██████▌   | 65/100 [05:02<03:08,  5.38s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9815 / 0.8696/ [0.70588235 1.         0.86956522]
                Test acc/f1/spec/sens = 0.2416 / 0.2256 / 0.9672 / 0.0733/ [0.07006369 1.         0.07327586]
 66%|██████▌   | 66/100 [05:06<02:54,  5.15s/it] 67%|██████▋   | 67/100 [05:09<02:29,  4.54s/it] 68%|██████▊   | 68/100 [05:14<02:24,  4.51s/it] 69%|██████▉   | 69/100 [05:17<02:06,  4.08s/it] 70%|███████   | 70/100 [05:25<02:42,  5.40s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9815 / 0.8696/ [0.70588235 1.         0.86956522]
                Test acc/f1/spec/sens = 0.2416 / 0.2254 / 0.9795 / 0.0690/ [0.07643312 1.         0.06896552]
 71%|███████   | 71/100 [05:28<02:16,  4.69s/it] 72%|███████▏  | 72/100 [05:33<02:09,  4.63s/it] 73%|███████▎  | 73/100 [05:36<01:53,  4.20s/it] 74%|███████▍  | 74/100 [05:40<01:50,  4.26s/it] 75%|███████▌  | 75/100 [05:48<02:10,  5.22s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8699 / 1.0000 / 0.8696/ [0.76470588 1.         0.86956522]
                Test acc/f1/spec/sens = 0.2479 / 0.2333 / 0.9672 / 0.0819/ [0.07643312 1.         0.08189655]
 76%|███████▌  | 76/100 [05:52<01:58,  4.92s/it] 77%|███████▋  | 77/100 [05:55<01:40,  4.35s/it] 78%|███████▊  | 78/100 [06:00<01:37,  4.41s/it] 79%|███████▉  | 79/100 [06:03<01:24,  4.03s/it] 80%|████████  | 80/100 [06:12<01:49,  5.46s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8481 / 1.0000 / 0.8261/ [0.76470588 1.         0.82608696]
                Test acc/f1/spec/sens = 0.2374 / 0.2207 / 0.9877 / 0.0647/ [0.07006369 1.         0.06465517]
 81%|████████  | 81/100 [06:15<01:30,  4.78s/it] 82%|████████▏ | 82/100 [06:19<01:24,  4.72s/it] 83%|████████▎ | 83/100 [06:23<01:12,  4.28s/it] 84%|████████▍ | 84/100 [06:27<01:08,  4.29s/it] 85%|████████▌ | 85/100 [06:35<01:20,  5.34s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8431 / 0.9815 / 0.8478/ [0.70588235 1.         0.84782609]
                Test acc/f1/spec/sens = 0.2479 / 0.2331 / 0.9590 / 0.0819/ [0.07643312 1.         0.08189655]
 86%|████████▌ | 86/100 [06:39<01:11,  5.07s/it] 87%|████████▋ | 87/100 [06:42<00:58,  4.49s/it] 88%|████████▊ | 88/100 [06:47<00:53,  4.48s/it] 89%|████████▉ | 89/100 [06:50<00:44,  4.05s/it] 90%|█████████ | 90/100 [06:59<00:54,  5.48s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9815 / 0.8696/ [0.70588235 1.         0.86956522]
                Test acc/f1/spec/sens = 0.2437 / 0.2246 / 0.9836 / 0.0776/ [0.07006369 1.         0.07758621]
 91%|█████████ | 91/100 [07:02<00:42,  4.77s/it] 92%|█████████▏| 92/100 [07:06<00:37,  4.72s/it] 93%|█████████▎| 93/100 [07:09<00:29,  4.21s/it] 94%|█████████▍| 94/100 [07:14<00:25,  4.23s/it] 95%|█████████▌| 95/100 [07:21<00:26,  5.31s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8431 / 0.9815 / 0.8478/ [0.70588235 1.         0.84782609]
                Test acc/f1/spec/sens = 0.2500 / 0.2374 / 0.9590 / 0.0862/ [0.07643312 1.         0.0862069 ]
 96%|█████████▌| 96/100 [07:26<00:19,  4.99s/it] 97%|█████████▋| 97/100 [07:29<00:13,  4.48s/it] 98%|█████████▊| 98/100 [07:33<00:08,  4.44s/it] 99%|█████████▉| 99/100 [07:37<00:04,  4.13s/it]100%|██████████| 100/100 [07:45<00:00,  5.45s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9815 / 0.8696/ [0.70588235 1.         0.86956522]
                Test acc/f1/spec/sens = 0.2437 / 0.2277 / 0.9672 / 0.0776/ [0.07006369 1.         0.07758621]
Trial 3, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8900 / 0.8540 / 0.9815 / 0.8696/ [0.70588235 1.         0.86956522]
Test acc/f1/spec/sens = 0.2437 / 0.2277 / 0.9672 / 0.0776/ [0.07006369 1.         0.07758621]
>> Finished.
Acc, agreement for latest model:  0.24369747899159663 0.29411764705882354 [0.07006369 1.         0.07758621]
Load best checkpoint for thief model
Acc, agreement for best model:  0.296218487394958 0.3445378151260504 [0.04458599 0.98850575 0.20689655]
Trial 2/1 || Cycle 3/5 || Label set size 540 || Test acc 0.2962 || Test agreement 0.3445 || Spec 0.9590 || Sens 0.2069 Class Acc: [0.04458599 0.98850575 0.20689655]
**************************************************************************************************** 

  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:02<00:13,  2.22s/it] 43%|████▎     | 3/7 [00:02<00:02,  1.57it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.47it/s]100%|██████████| 7/7 [00:03<00:00,  2.35it/s]100%|██████████| 7/7 [00:04<00:00,  1.64it/s]
labeled set:  720
unlabeled set:  713
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.44it/s] 25%|██▌       | 3/12 [00:00<00:01,  4.55it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.05it/s] 75%|███████▌  | 9/12 [00:01<00:00, 11.84it/s]100%|██████████| 12/12 [00:01<00:00, 15.25it/s]100%|██████████| 12/12 [00:01<00:00,  8.11it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 47, 1: 35, 2: 98}
Validation set distribution: 
Number of samples  100
{0: 17, 1: 37, 2: 46}
Labeled set distribution: 
Number of samples  720
{0: 226, 1: 245, 2: 249}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2626, agreement = 0.2353, f1 = 0.2633, spec = 0.9959, sens = 0.1595 Class Acc: [0.22292994 0.6091954  0.15948276]
Initial model on validation dataset: acc = 0.3300, agreement = 0.3300, f1 = 0.1918, spec = 0.9074, sens = 0.0435 Class Acc: [0.         0.83783784 0.04347826]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:05,  3.70s/it]  2%|▏         | 2/100 [00:08<07:21,  4.50s/it]  3%|▎         | 3/100 [00:12<06:41,  4.14s/it]  4%|▍         | 4/100 [00:17<07:17,  4.56s/it]  5%|▌         | 5/100 [00:26<09:32,  6.03s/it]Epoch 5: Train acc/f1 = 0.8111 / 0.8122 / 0.9512 / 0.8474/ [0.87168142 0.71836735 0.84738956] 
                Val acc/f1/spec/sens = 0.8500 / 0.7981 / 0.7963 / 1.0000/ [0.47058824 0.83783784 1.        ]
                Test acc/f1/spec/sens = 0.5567 / 0.5175 / 0.8402 / 0.6207/ [0.21656051 1.         0.62068966]
  6%|▌         | 6/100 [00:31<08:59,  5.74s/it]  7%|▋         | 7/100 [00:35<07:49,  5.05s/it]  8%|▊         | 8/100 [00:40<07:54,  5.16s/it]  9%|▉         | 9/100 [00:44<07:09,  4.72s/it] 10%|█         | 10/100 [00:54<09:36,  6.41s/it]Epoch 10: Train acc/f1 = 0.8806 / 0.8798 / 0.9958 / 0.8313/ [0.8539823  0.95510204 0.8313253 ] 
                Val acc/f1/spec/sens = 0.8400 / 0.8071 / 1.0000 / 0.7609/ [0.76470588 0.97297297 0.76086957]
                Test acc/f1/spec/sens = 0.2311 / 0.1965 / 0.9918 / 0.0862/ [0.03184713 0.97701149 0.0862069 ]
 11%|█         | 11/100 [00:58<08:20,  5.63s/it] 12%|█▏        | 12/100 [01:03<07:57,  5.43s/it] 13%|█▎        | 13/100 [01:06<07:04,  4.87s/it] 14%|█▍        | 14/100 [01:11<07:02,  4.92s/it] 15%|█▌        | 15/100 [01:20<08:22,  5.92s/it]Epoch 15: Train acc/f1 = 0.5861 / 0.5512 / 0.9809 / 0.5502/ [0.2079646  0.97142857 0.5502008 ] 
                Val acc/f1/spec/sens = 0.7200 / 0.6898 / 1.0000 / 0.4783/ [0.76470588 1.         0.47826087]
                Test acc/f1/spec/sens = 0.1828 / 0.1032 / 1.0000 / 0.0000/ [0. 1. 0.]
 16%|█▌        | 16/100 [01:25<07:53,  5.64s/it] 17%|█▋        | 17/100 [01:28<07:00,  5.06s/it] 18%|█▊        | 18/100 [01:33<06:51,  5.02s/it] 19%|█▉        | 19/100 [01:37<06:17,  4.66s/it] 20%|██        | 20/100 [01:47<08:10,  6.13s/it]Epoch 20: Train acc/f1 = 0.8264 / 0.8173 / 0.7792 / 0.9598/ [0.5619469  0.93469388 0.95983936] 
                Val acc/f1/spec/sens = 0.8300 / 0.7406 / 0.8704 / 0.9130/ [0.35294118 0.94594595 0.91304348]
                Test acc/f1/spec/sens = 0.5462 / 0.4253 / 0.8033 / 0.8319/ [0.01273885 0.74712644 0.83189655]
 21%|██        | 21/100 [01:50<07:07,  5.41s/it] 22%|██▏       | 22/100 [01:56<07:02,  5.42s/it] 23%|██▎       | 23/100 [02:00<06:20,  4.94s/it] 24%|██▍       | 24/100 [02:05<06:15,  4.94s/it] 25%|██▌       | 25/100 [02:13<07:38,  6.12s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8482 / 0.9815 / 0.8478/ [0.76470588 0.97297297 0.84782609]
                Test acc/f1/spec/sens = 0.3151 / 0.2885 / 0.9549 / 0.3060/ [0.05095541 0.81609195 0.30603448]
 26%|██▌       | 26/100 [02:18<07:06,  5.76s/it] 27%|██▋       | 27/100 [02:22<06:15,  5.14s/it] 28%|██▊       | 28/100 [02:27<06:09,  5.13s/it] 29%|██▉       | 29/100 [02:31<05:33,  4.70s/it] 30%|███       | 30/100 [02:40<07:12,  6.18s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8478 / 0.9815 / 0.8696/ [0.76470588 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3046 / 0.2818 / 0.9549 / 0.2845/ [0.05732484 0.8045977  0.28448276]
 31%|███       | 31/100 [02:44<06:18,  5.48s/it] 32%|███▏      | 32/100 [02:49<06:02,  5.33s/it] 33%|███▎      | 33/100 [02:53<05:24,  4.84s/it] 34%|███▍      | 34/100 [02:58<05:22,  4.89s/it] 35%|███▌      | 35/100 [03:07<06:30,  6.00s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8613 / 0.9815 / 0.8913/ [0.76470588 0.94594595 0.89130435]
                Test acc/f1/spec/sens = 0.2857 / 0.2632 / 0.9877 / 0.2672/ [0.03821656 0.7816092  0.26724138]
 36%|███▌      | 36/100 [03:12<06:11,  5.81s/it] 37%|███▋      | 37/100 [03:16<05:27,  5.19s/it] 38%|███▊      | 38/100 [03:21<05:21,  5.19s/it] 39%|███▉      | 39/100 [03:25<04:52,  4.80s/it] 40%|████      | 40/100 [03:35<06:24,  6.41s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8808 / 0.9815 / 0.8696/ [0.88235294 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3151 / 0.2930 / 0.9672 / 0.3491/ [0.04458599 0.71264368 0.34913793]
 41%|████      | 41/100 [03:39<05:31,  5.62s/it] 42%|████▏     | 42/100 [03:44<05:19,  5.50s/it] 43%|████▎     | 43/100 [03:48<04:44,  5.00s/it] 44%|████▍     | 44/100 [03:53<04:47,  5.13s/it] 45%|████▌     | 45/100 [04:02<05:39,  6.17s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8658 / 0.9815 / 0.8696/ [0.82352941 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3277 / 0.3055 / 0.9549 / 0.3621/ [0.05732484 0.72413793 0.36206897]
 46%|████▌     | 46/100 [04:07<05:16,  5.85s/it] 47%|████▋     | 47/100 [04:11<04:36,  5.21s/it] 48%|████▊     | 48/100 [04:16<04:27,  5.14s/it] 49%|████▉     | 49/100 [04:19<03:59,  4.70s/it] 50%|█████     | 50/100 [04:29<05:10,  6.22s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8658 / 0.9815 / 0.8696/ [0.82352941 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.2899 / 0.2696 / 0.9590 / 0.2931/ [0.04458599 0.72413793 0.29310345]
 51%|█████     | 51/100 [04:33<04:29,  5.51s/it] 52%|█████▏    | 52/100 [04:38<04:20,  5.42s/it] 53%|█████▎    | 53/100 [04:42<03:55,  5.01s/it] 54%|█████▍    | 54/100 [04:47<03:53,  5.08s/it] 55%|█████▌    | 55/100 [04:56<04:34,  6.10s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8503 / 0.9815 / 0.8696/ [0.76470588 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3298 / 0.3054 / 0.9590 / 0.3578/ [0.05095541 0.75862069 0.35775862]
 56%|█████▌    | 56/100 [05:01<04:12,  5.75s/it] 57%|█████▋    | 57/100 [05:05<03:42,  5.18s/it] 58%|█████▊    | 58/100 [05:10<03:32,  5.07s/it] 59%|█████▉    | 59/100 [05:13<03:11,  4.67s/it] 60%|██████    | 60/100 [05:22<03:56,  5.91s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8503 / 0.9815 / 0.8696/ [0.76470588 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3109 / 0.2823 / 0.9631 / 0.2974/ [0.03821656 0.83908046 0.29741379]
 61%|██████    | 61/100 [05:26<03:24,  5.25s/it] 62%|██████▏   | 62/100 [05:31<03:15,  5.14s/it] 63%|██████▎   | 63/100 [05:34<02:53,  4.69s/it] 64%|██████▍   | 64/100 [05:39<02:52,  4.79s/it] 65%|██████▌   | 65/100 [05:47<03:22,  5.78s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8658 / 0.9815 / 0.8696/ [0.82352941 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.2605 / 0.2353 / 0.9795 / 0.2069/ [0.03821656 0.8045977  0.20689655]
 66%|██████▌   | 66/100 [05:52<03:08,  5.55s/it] 67%|██████▋   | 67/100 [05:56<02:43,  4.96s/it] 68%|██████▊   | 68/100 [06:01<02:38,  4.95s/it] 69%|██████▉   | 69/100 [06:05<02:22,  4.59s/it] 70%|███████   | 70/100 [06:14<02:58,  5.95s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8503 / 0.9815 / 0.8696/ [0.76470588 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3025 / 0.2745 / 0.9754 / 0.2802/ [0.03821656 0.83908046 0.28017241]
 71%|███████   | 71/100 [06:18<02:34,  5.33s/it] 72%|███████▏  | 72/100 [06:22<02:24,  5.17s/it] 73%|███████▎  | 73/100 [06:26<02:08,  4.77s/it] 74%|███████▍  | 74/100 [06:31<02:04,  4.80s/it] 75%|███████▌  | 75/100 [06:39<02:22,  5.69s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8503 / 0.9815 / 0.8696/ [0.76470588 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3004 / 0.2818 / 0.9549 / 0.3233/ [0.05095541 0.68965517 0.32327586]
 76%|███████▌  | 76/100 [06:44<02:08,  5.37s/it] 77%|███████▋  | 77/100 [06:47<01:48,  4.70s/it] 78%|███████▊  | 78/100 [06:51<01:40,  4.58s/it] 79%|███████▉  | 79/100 [06:54<01:27,  4.15s/it] 80%|████████  | 80/100 [07:03<01:48,  5.44s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8782 / 0.9815 / 0.8696/ [0.88235294 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3004 / 0.2793 / 0.9713 / 0.3017/ [0.05095541 0.74712644 0.30172414]
 81%|████████  | 81/100 [07:06<01:30,  4.76s/it] 82%|████████▏ | 82/100 [07:10<01:22,  4.58s/it] 83%|████████▎ | 83/100 [07:13<01:10,  4.16s/it] 84%|████████▍ | 84/100 [07:17<01:06,  4.18s/it] 85%|████████▌ | 85/100 [07:24<01:16,  5.07s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8658 / 0.9815 / 0.8696/ [0.82352941 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3046 / 0.2797 / 0.9672 / 0.3060/ [0.03821656 0.7816092  0.30603448]
 86%|████████▌ | 86/100 [07:29<01:07,  4.79s/it] 87%|████████▋ | 87/100 [07:32<00:55,  4.26s/it] 88%|████████▊ | 88/100 [07:36<00:51,  4.29s/it] 89%|████████▉ | 89/100 [07:39<00:43,  3.97s/it] 90%|█████████ | 90/100 [07:48<00:53,  5.33s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8658 / 0.9815 / 0.8696/ [0.82352941 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.2941 / 0.2725 / 0.9877 / 0.2802/ [0.04458599 0.7816092  0.28017241]
 91%|█████████ | 91/100 [07:51<00:42,  4.69s/it] 92%|█████████▏| 92/100 [07:55<00:36,  4.58s/it] 93%|█████████▎| 93/100 [07:58<00:29,  4.17s/it] 94%|█████████▍| 94/100 [08:03<00:25,  4.22s/it] 95%|█████████▌| 95/100 [08:10<00:26,  5.26s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8503 / 0.9815 / 0.8696/ [0.76470588 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3088 / 0.2831 / 0.9672 / 0.3147/ [0.03821656 0.7816092  0.31465517]
 96%|█████████▌| 96/100 [08:15<00:19,  4.96s/it] 97%|█████████▋| 97/100 [08:18<00:13,  4.43s/it] 98%|█████████▊| 98/100 [08:22<00:08,  4.36s/it] 99%|█████████▉| 99/100 [08:25<00:03,  3.96s/it]100%|██████████| 100/100 [08:34<00:00,  5.29s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8478 / 0.9815 / 0.8696/ [0.76470588 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3403 / 0.3149 / 0.9549 / 0.3793/ [0.05095541 0.75862069 0.37931034]
Trial 3, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8800 / 0.8478 / 0.9815 / 0.8696/ [0.76470588 0.94594595 0.86956522]
Test acc/f1/spec/sens = 0.3403 / 0.3149 / 0.9549 / 0.3793/ [0.05095541 0.75862069 0.37931034]
>> Finished.
Acc, agreement for latest model:  0.3403361344537815 0.4096638655462185 [0.05095541 0.75862069 0.37931034]
Load best checkpoint for thief model
Acc, agreement for best model:  0.31512605042016806 0.37815126050420167 [0.04458599 0.71264368 0.34913793]
Trial 2/1 || Cycle 4/5 || Label set size 720 || Test acc 0.3151 || Test agreement 0.3782 || Spec 0.9672 || Sens 0.3491 Class Acc: [0.04458599 0.71264368 0.34913793]
**************************************************************************************************** 

  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:01<00:09,  1.85s/it] 50%|█████     | 3/6 [00:02<00:01,  1.84it/s] 83%|████████▎ | 5/6 [00:03<00:00,  1.84it/s]100%|██████████| 6/6 [00:03<00:00,  1.77it/s]
labeled set:  900
unlabeled set:  533
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.63it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.65it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.59it/s]100%|██████████| 12/12 [00:01<00:00,  9.46it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 2, 1: 78, 2: 100}
Validation set distribution: 
Number of samples  100
{0: 17, 1: 37, 2: 46}
Labeled set distribution: 
Number of samples  900
{0: 228, 1: 323, 2: 349}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2395, agreement = 0.2416, f1 = 0.2290, spec = 0.9918, sens = 0.0043 Class Acc: [0.42675159 0.52873563 0.00431034]
Initial model on validation dataset: acc = 0.3100, agreement = 0.3100, f1 = 0.1701, spec = 0.9815, sens = 0.0217 Class Acc: [0.         0.81081081 0.02173913]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:16,  3.80s/it]  2%|▏         | 2/100 [00:08<07:26,  4.56s/it]  3%|▎         | 3/100 [00:12<06:58,  4.32s/it]  4%|▍         | 4/100 [00:18<07:35,  4.74s/it]  5%|▌         | 5/100 [00:26<09:38,  6.09s/it]Epoch 5: Train acc/f1 = 0.8611 / 0.8494 / 0.9456 / 0.8825/ [0.74122807 0.92260062 0.88252149] 
                Val acc/f1/spec/sens = 0.8500 / 0.8139 / 0.9444 / 0.8478/ [0.70588235 0.91891892 0.84782609]
                Test acc/f1/spec/sens = 0.6092 / 0.4893 / 0.8115 / 0.8448/ [0.04458599 1.         0.84482759]
  6%|▌         | 6/100 [00:31<08:50,  5.65s/it]  7%|▋         | 7/100 [00:35<07:46,  5.01s/it]  8%|▊         | 8/100 [00:40<07:42,  5.03s/it]  9%|▉         | 9/100 [00:44<06:59,  4.61s/it] 10%|█         | 10/100 [00:53<09:13,  6.15s/it]Epoch 10: Train acc/f1 = 0.8889 / 0.8842 / 0.9583 / 0.9226/ [0.94298246 0.81424149 0.9226361 ] 
                Val acc/f1/spec/sens = 0.9100 / 0.8858 / 0.9815 / 0.9130/ [0.88235294 0.91891892 0.91304348]
                Test acc/f1/spec/sens = 0.3193 / 0.3214 / 0.9508 / 0.2069/ [0.1910828  0.85057471 0.20689655]
 11%|█         | 11/100 [00:57<08:04,  5.44s/it] 12%|█▏        | 12/100 [01:02<07:41,  5.24s/it] 13%|█▎        | 13/100 [01:05<06:54,  4.76s/it] 14%|█▍        | 14/100 [01:10<06:51,  4.79s/it] 15%|█▌        | 15/100 [01:19<08:19,  5.87s/it]Epoch 15: Train acc/f1 = 0.7933 / 0.7529 / 0.6969 / 1.0000/ [0.39035088 0.85448916 1.        ] 
                Val acc/f1/spec/sens = 0.8500 / 0.7834 / 0.8889 / 0.8913/ [0.47058824 0.97297297 0.89130435]
                Test acc/f1/spec/sens = 0.6597 / 0.5629 / 0.5451 / 0.9784/ [0.15286624 0.72413793 0.97844828]
 16%|█▌        | 16/100 [01:23<07:44,  5.53s/it] 17%|█▋        | 17/100 [01:27<06:51,  4.95s/it] 18%|█▊        | 18/100 [01:32<06:41,  4.90s/it] 19%|█▉        | 19/100 [01:36<06:08,  4.55s/it] 20%|██        | 20/100 [01:45<08:04,  6.05s/it]Epoch 20: Train acc/f1 = 0.9644 / 0.9625 / 0.9982 / 0.9456/ [0.95175439 0.99380805 0.94555874] 
                Val acc/f1/spec/sens = 0.8700 / 0.8400 / 0.9815 / 0.8261/ [0.76470588 0.97297297 0.82608696]
                Test acc/f1/spec/sens = 0.2101 / 0.1863 / 0.9221 / 0.0948/ [0.03184713 0.83908046 0.09482759]
 21%|██        | 21/100 [01:49<06:59,  5.31s/it] 22%|██▏       | 22/100 [01:53<06:41,  5.14s/it] 23%|██▎       | 23/100 [01:57<06:01,  4.70s/it] 24%|██▍       | 24/100 [02:02<05:57,  4.71s/it] 25%|██▌       | 25/100 [02:10<07:13,  5.78s/it]Epoch 25: Train acc/f1 = 0.9967 / 0.9966 / 0.9982 / 0.9971/ [0.99561404 0.99690402 0.99713467] 
                Val acc/f1/spec/sens = 0.8800 / 0.8394 / 0.9630 / 0.9130/ [0.64705882 0.94594595 0.91304348]
                Test acc/f1/spec/sens = 0.2584 / 0.2412 / 0.9016 / 0.1767/ [0.05095541 0.85057471 0.17672414]
 26%|██▌       | 26/100 [02:15<06:44,  5.47s/it] 27%|██▋       | 27/100 [02:18<05:59,  4.92s/it] 28%|██▊       | 28/100 [02:23<05:49,  4.85s/it] 29%|██▉       | 29/100 [02:27<05:19,  4.50s/it] 30%|███       | 30/100 [02:36<06:58,  5.98s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8399 / 0.9444 / 0.9130/ [0.64705882 0.94594595 0.91304348]
                Test acc/f1/spec/sens = 0.3046 / 0.2920 / 0.8730 / 0.2716/ [0.07643312 0.8045977  0.27155172]
 31%|███       | 31/100 [02:40<06:05,  5.30s/it] 32%|███▏      | 32/100 [02:45<05:46,  5.10s/it] 33%|███▎      | 33/100 [02:48<05:12,  4.67s/it] 34%|███▍      | 34/100 [02:53<05:09,  4.68s/it] 35%|███▌      | 35/100 [03:01<06:15,  5.77s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8692 / 0.9815 / 0.9130/ [0.76470588 0.94594595 0.91304348]
                Test acc/f1/spec/sens = 0.2878 / 0.2684 / 0.8934 / 0.2328/ [0.04458599 0.87356322 0.23275862]
 36%|███▌      | 36/100 [03:06<05:50,  5.48s/it] 37%|███▋      | 37/100 [03:10<05:12,  4.96s/it] 38%|███▊      | 38/100 [03:15<05:04,  4.91s/it] 39%|███▉      | 39/100 [03:18<04:36,  4.54s/it] 40%|████      | 40/100 [03:28<05:58,  5.98s/it]Epoch 40: Train acc/f1 = 0.9989 / 0.9988 / 1.0000 / 1.0000/ [1.         0.99690402 1.        ] 
                Val acc/f1/spec/sens = 0.8800 / 0.8478 / 0.9815 / 0.8696/ [0.76470588 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3109 / 0.2899 / 0.9221 / 0.2500/ [0.05095541 0.94252874 0.25      ]
 41%|████      | 41/100 [03:31<05:12,  5.30s/it] 42%|████▏     | 42/100 [03:36<04:57,  5.13s/it] 43%|████▎     | 43/100 [03:40<04:26,  4.68s/it] 44%|████▍     | 44/100 [03:45<04:23,  4.71s/it] 45%|████▌     | 45/100 [03:53<05:21,  5.84s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8374 / 0.9815 / 0.8478/ [0.76470588 0.94594595 0.84782609]
                Test acc/f1/spec/sens = 0.3193 / 0.3062 / 0.9016 / 0.2629/ [0.08917197 0.88505747 0.26293103]
 46%|████▌     | 46/100 [03:58<04:59,  5.56s/it] 47%|████▋     | 47/100 [04:02<04:24,  4.99s/it] 48%|████▊     | 48/100 [04:06<04:18,  4.96s/it] 49%|████▉     | 49/100 [04:10<03:54,  4.61s/it] 50%|█████     | 50/100 [04:20<05:02,  6.05s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8625 / 0.9815 / 0.8913/ [0.82352941 0.91891892 0.89130435]
                Test acc/f1/spec/sens = 0.3592 / 0.3399 / 0.8689 / 0.3578/ [0.10191083 0.82758621 0.35775862]
 51%|█████     | 51/100 [04:23<04:21,  5.34s/it] 52%|█████▏    | 52/100 [04:28<04:08,  5.18s/it] 53%|█████▎    | 53/100 [04:32<03:43,  4.76s/it] 54%|█████▍    | 54/100 [04:37<03:39,  4.78s/it] 55%|█████▌    | 55/100 [04:45<04:24,  5.87s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8521 / 0.9815 / 0.8696/ [0.82352941 0.91891892 0.86956522]
                Test acc/f1/spec/sens = 0.2773 / 0.2545 / 0.9098 / 0.2026/ [0.03821656 0.90804598 0.20258621]
 56%|█████▌    | 56/100 [04:50<04:02,  5.52s/it] 57%|█████▋    | 57/100 [04:54<03:35,  5.01s/it] 58%|█████▊    | 58/100 [04:58<03:28,  4.95s/it] 59%|█████▉    | 59/100 [05:02<03:08,  4.59s/it] 60%|██████    | 60/100 [05:12<04:01,  6.03s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8589 / 0.9815 / 0.8696/ [0.76470588 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2983 / 0.2773 / 0.9180 / 0.2284/ [0.05095541 0.93103448 0.22844828]
 61%|██████    | 61/100 [05:15<03:27,  5.33s/it] 62%|██████▏   | 62/100 [05:20<03:16,  5.16s/it] 63%|██████▎   | 63/100 [05:24<02:54,  4.71s/it] 64%|██████▍   | 64/100 [05:29<02:50,  4.74s/it] 65%|██████▌   | 65/100 [05:37<03:24,  5.84s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8632 / 0.9815 / 0.8696/ [0.82352941 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3130 / 0.2909 / 0.9139 / 0.2500/ [0.05732484 0.94252874 0.25      ]
 66%|██████▌   | 66/100 [05:42<03:07,  5.51s/it] 67%|██████▋   | 67/100 [05:45<02:43,  4.95s/it] 68%|██████▊   | 68/100 [05:50<02:35,  4.87s/it] 69%|██████▉   | 69/100 [05:54<02:20,  4.53s/it] 70%|███████   | 70/100 [06:03<02:59,  5.97s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8521 / 0.9815 / 0.8696/ [0.82352941 0.91891892 0.86956522]
                Test acc/f1/spec/sens = 0.3004 / 0.2830 / 0.9016 / 0.2457/ [0.05732484 0.88505747 0.24568966]
 71%|███████   | 71/100 [06:07<02:33,  5.30s/it] 72%|███████▏  | 72/100 [06:12<02:25,  5.19s/it] 73%|███████▎  | 73/100 [06:15<02:07,  4.73s/it] 74%|███████▍  | 74/100 [06:20<02:02,  4.71s/it] 75%|███████▌  | 75/100 [06:28<02:24,  5.79s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8478 / 0.9815 / 0.8696/ [0.76470588 0.94594595 0.86956522]
                Test acc/f1/spec/sens = 0.3193 / 0.3040 / 0.9221 / 0.2328/ [0.10191083 0.94252874 0.23275862]
 76%|███████▌  | 76/100 [06:33<02:11,  5.49s/it] 77%|███████▋  | 77/100 [06:37<01:54,  4.98s/it] 78%|███████▊  | 78/100 [06:42<01:48,  4.93s/it] 79%|███████▉  | 79/100 [06:46<01:36,  4.58s/it] 80%|████████  | 80/100 [06:55<02:01,  6.07s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8699 / 0.9815 / 0.8913/ [0.76470588 0.97297297 0.89130435]
                Test acc/f1/spec/sens = 0.3130 / 0.2927 / 0.9016 / 0.2759/ [0.05095541 0.88505747 0.27586207]
 81%|████████  | 81/100 [06:59<01:41,  5.33s/it] 82%|████████▏ | 82/100 [07:03<01:32,  5.14s/it] 83%|████████▎ | 83/100 [07:07<01:20,  4.73s/it] 84%|████████▍ | 84/100 [07:12<01:15,  4.74s/it] 85%|████████▌ | 85/100 [07:20<01:27,  5.80s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8589 / 0.9815 / 0.8696/ [0.76470588 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.3340 / 0.3195 / 0.8852 / 0.2931/ [0.10191083 0.86206897 0.29310345]
 86%|████████▌ | 86/100 [07:25<01:16,  5.49s/it] 87%|████████▋ | 87/100 [07:29<01:04,  4.94s/it] 88%|████████▊ | 88/100 [07:33<00:59,  4.92s/it] 89%|████████▉ | 89/100 [07:37<00:50,  4.57s/it] 90%|█████████ | 90/100 [07:47<01:00,  6.00s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8746 / 0.9815 / 0.8696/ [0.82352941 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.3025 / 0.2835 / 0.9057 / 0.2586/ [0.03821656 0.89655172 0.25862069]
 91%|█████████ | 91/100 [07:50<00:47,  5.28s/it] 92%|█████████▏| 92/100 [07:55<00:40,  5.10s/it] 93%|█████████▎| 93/100 [07:59<00:32,  4.66s/it] 94%|█████████▍| 94/100 [08:03<00:28,  4.67s/it] 95%|█████████▌| 95/100 [08:12<00:28,  5.80s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8541 / 0.9630 / 0.8913/ [0.70588235 0.97297297 0.89130435]
                Test acc/f1/spec/sens = 0.3172 / 0.2951 / 0.8852 / 0.2974/ [0.03821656 0.87356322 0.29741379]
 96%|█████████▌| 96/100 [08:17<00:22,  5.55s/it] 97%|█████████▋| 97/100 [08:20<00:15,  5.02s/it] 98%|█████████▊| 98/100 [08:25<00:09,  4.95s/it] 99%|█████████▉| 99/100 [08:29<00:04,  4.54s/it]100%|██████████| 100/100 [08:38<00:00,  5.96s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8857 / 0.9815 / 0.8913/ [0.82352941 0.97297297 0.89130435]
                Test acc/f1/spec/sens = 0.3193 / 0.3020 / 0.9016 / 0.2759/ [0.07006369 0.88505747 0.27586207]
Trial 3, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9100 / 0.8857 / 0.9815 / 0.8913/ [0.82352941 0.97297297 0.89130435]
Test acc/f1/spec/sens = 0.3193 / 0.3020 / 0.9016 / 0.2759/ [0.07006369 0.88505747 0.27586207]
>> Finished.
Acc, agreement for latest model:  0.31932773109243695 0.3760504201680672 [0.07006369 0.88505747 0.27586207]
Load best checkpoint for thief model
Acc, agreement for best model:  0.23739495798319327 0.3067226890756303 [0.01910828 0.97701149 0.10775862]
Trial 2/1 || Cycle 5/5 || Label set size 900 || Test acc 0.2374 || Test agreement 0.3067 || Spec 0.9918 || Sens 0.1078 Class Acc: [0.01910828 0.97701149 0.10775862]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.54it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.36it/s] 75%|███████▌  | 9/12 [00:01<00:00, 11.69it/s]100%|██████████| 12/12 [00:01<00:00,  9.49it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:04,  1.49it/s] 71%|███████▏  | 5/7 [00:00<00:00,  7.07it/s]100%|██████████| 7/7 [00:01<00:00,  6.37it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2441, -1.2616, -1.2352]), tensor([0.8425, 0.8373, 0.8456]))
Val set stats: mean/std =  (tensor([-1.2709, -1.2825, -1.2655]), tensor([0.8425, 0.8374, 0.8453]))
Validation set distribution: 
Number of samples  100
{0: 14, 1: 39, 2: 47}
Labeled set distribution: 
Number of samples  180
{0: 35, 1: 70, 2: 75}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.5798, agreement = 0.5378, f1 = 0.4384, spec = 0.4303, sens = 0.9741 Class Acc: [0.0955414  0.40229885 0.97413793]
Initial model on validation dataset: acc = 0.3500, agreement = 0.3500, f1 = 0.2080, spec = 0.3019, sens = 0.7234 Class Acc: [0.07142857 0.         0.72340426]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:25,  1.47s/it]  2%|▏         | 2/100 [00:04<03:34,  2.19s/it]  3%|▎         | 3/100 [00:05<03:00,  1.86s/it]  4%|▍         | 4/100 [00:08<03:37,  2.27s/it]  5%|▌         | 5/100 [00:12<04:29,  2.83s/it]Epoch 5: Train acc/f1 = 0.8167 / 0.7136 / 0.7143 / 0.9867/ [0.22857143 0.92857143 0.98666667] 
                Val acc/f1/spec/sens = 0.7100 / 0.5483 / 0.7170 / 0.8723/ [0.07142857 0.74358974 0.87234043]
                Test acc/f1/spec/sens = 0.6134 / 0.4653 / 0.5369 / 0.9698/ [0.         0.77011494 0.96982759]
  6%|▌         | 6/100 [00:15<04:27,  2.85s/it]  7%|▋         | 7/100 [00:16<03:41,  2.39s/it]  8%|▊         | 8/100 [00:19<03:43,  2.43s/it]  9%|▉         | 9/100 [00:20<03:12,  2.12s/it] 10%|█         | 10/100 [00:25<04:28,  2.98s/it]Epoch 10: Train acc/f1 = 0.9111 / 0.9010 / 0.9810 / 0.8133/ [1.         0.97142857 0.81333333] 
                Val acc/f1/spec/sens = 0.8500 / 0.8233 / 0.9811 / 0.7660/ [1.         0.8974359  0.76595745]
                Test acc/f1/spec/sens = 0.5357 / 0.4952 / 0.9426 / 0.5991/ [0.18471338 1.         0.59913793]
 11%|█         | 11/100 [00:26<03:42,  2.50s/it] 12%|█▏        | 12/100 [00:29<03:42,  2.53s/it] 13%|█▎        | 13/100 [00:30<03:10,  2.19s/it] 14%|█▍        | 14/100 [00:33<03:17,  2.30s/it] 15%|█▌        | 15/100 [00:37<03:53,  2.74s/it]Epoch 15: Train acc/f1 = 0.9389 / 0.9315 / 0.9619 / 0.9467/ [0.94285714 0.92857143 0.94666667] 
                Val acc/f1/spec/sens = 0.8600 / 0.7675 / 0.8302 / 0.9574/ [0.35714286 0.92307692 0.95744681]
                Test acc/f1/spec/sens = 0.5630 / 0.5388 / 0.9180 / 0.6552/ [0.30573248 0.7816092  0.65517241]
 16%|█▌        | 16/100 [00:40<03:55,  2.80s/it] 17%|█▋        | 17/100 [00:41<03:18,  2.39s/it] 18%|█▊        | 18/100 [00:44<03:20,  2.45s/it] 19%|█▉        | 19/100 [00:45<02:53,  2.14s/it] 20%|██        | 20/100 [00:51<04:08,  3.11s/it]Epoch 20: Train acc/f1 = 0.9833 / 0.9792 / 0.9905 / 0.9733/ [0.97142857 1.         0.97333333] 
                Val acc/f1/spec/sens = 0.9200 / 0.8862 / 0.9245 / 0.9362/ [0.78571429 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.3004 / 0.2485 / 0.9467 / 0.2284/ [0.01910828 1.         0.22844828]
 21%|██        | 21/100 [00:52<03:26,  2.61s/it] 22%|██▏       | 22/100 [00:55<03:31,  2.71s/it] 23%|██▎       | 23/100 [00:56<02:58,  2.32s/it] 24%|██▍       | 24/100 [00:59<03:02,  2.40s/it] 25%|██▌       | 25/100 [01:03<03:31,  2.83s/it]Epoch 25: Train acc/f1 = 0.9889 / 0.9862 / 1.0000 / 0.9733/ [1.         1.         0.97333333] 
                Val acc/f1/spec/sens = 0.9300 / 0.9033 / 0.9434 / 0.9362/ [0.85714286 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.4790 / 0.4102 / 0.9262 / 0.5690/ [0.05732484 1.         0.56896552]
 26%|██▌       | 26/100 [01:06<03:32,  2.87s/it] 27%|██▋       | 27/100 [01:07<02:59,  2.45s/it] 28%|██▊       | 28/100 [01:10<02:58,  2.48s/it] 29%|██▉       | 29/100 [01:11<02:33,  2.16s/it] 30%|███       | 30/100 [01:16<03:31,  3.02s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8862 / 0.9245 / 0.9362/ [0.78571429 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.5735 / 0.4718 / 0.9057 / 0.7716/ [0.04458599 1.         0.77155172]
 31%|███       | 31/100 [01:18<02:54,  2.53s/it] 32%|███▏      | 32/100 [01:20<02:52,  2.54s/it] 33%|███▎      | 33/100 [01:22<02:28,  2.22s/it] 34%|███▍      | 34/100 [01:24<02:34,  2.34s/it] 35%|███▌      | 35/100 [01:28<03:02,  2.81s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9084 / 0.9245 / 0.9574/ [0.85714286 0.92307692 0.95744681]
                Test acc/f1/spec/sens = 0.6050 / 0.4921 / 0.9221 / 0.8319/ [0.05095541 1.         0.83189655]
 36%|███▌      | 36/100 [01:31<02:55,  2.74s/it] 37%|███▋      | 37/100 [01:32<02:27,  2.34s/it] 38%|███▊      | 38/100 [01:35<02:30,  2.43s/it] 39%|███▉      | 39/100 [01:36<02:08,  2.11s/it] 40%|████      | 40/100 [01:41<02:59,  2.99s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9084 / 0.9245 / 0.9574/ [0.85714286 0.92307692 0.95744681]
                Test acc/f1/spec/sens = 0.5966 / 0.4833 / 0.9180 / 0.8190/ [0.04458599 1.         0.81896552]
 41%|████      | 41/100 [01:43<02:28,  2.52s/it] 42%|████▏     | 42/100 [01:45<02:26,  2.53s/it] 43%|████▎     | 43/100 [01:47<02:04,  2.19s/it] 44%|████▍     | 44/100 [01:49<02:09,  2.32s/it] 45%|████▌     | 45/100 [01:53<02:32,  2.77s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9084 / 0.9245 / 0.9574/ [0.85714286 0.92307692 0.95744681]
                Test acc/f1/spec/sens = 0.5798 / 0.4757 / 0.9262 / 0.7802/ [0.05095541 1.         0.78017241]
 46%|████▌     | 46/100 [01:55<02:25,  2.69s/it] 47%|████▋     | 47/100 [01:57<02:03,  2.32s/it] 48%|████▊     | 48/100 [01:59<02:04,  2.40s/it] 49%|████▉     | 49/100 [02:01<01:47,  2.11s/it] 50%|█████     | 50/100 [02:06<02:27,  2.96s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9162 / 0.9434 / 0.9574/ [0.85714286 0.94871795 0.95744681]
                Test acc/f1/spec/sens = 0.5147 / 0.4358 / 0.9344 / 0.6422/ [0.05732484 1.         0.64224138]
 51%|█████     | 51/100 [02:07<02:02,  2.50s/it] 52%|█████▏    | 52/100 [02:10<02:03,  2.56s/it] 53%|█████▎    | 53/100 [02:11<01:45,  2.23s/it] 54%|█████▍    | 54/100 [02:14<01:47,  2.33s/it] 55%|█████▌    | 55/100 [02:18<02:04,  2.77s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8784 / 0.9057 / 0.9362/ [0.78571429 0.92307692 0.93617021]
                Test acc/f1/spec/sens = 0.4769 / 0.4127 / 0.9426 / 0.5603/ [0.06369427 1.         0.56034483]
 56%|█████▌    | 56/100 [02:20<01:58,  2.70s/it] 57%|█████▋    | 57/100 [02:22<01:40,  2.33s/it] 58%|█████▊    | 58/100 [02:24<01:40,  2.39s/it] 59%|█████▉    | 59/100 [02:26<01:26,  2.11s/it] 60%|██████    | 60/100 [02:31<01:58,  2.97s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9084 / 0.9245 / 0.9574/ [0.85714286 0.92307692 0.95744681]
                Test acc/f1/spec/sens = 0.5882 / 0.4779 / 0.9180 / 0.8017/ [0.04458599 1.         0.80172414]
 61%|██████    | 61/100 [02:32<01:38,  2.54s/it] 62%|██████▏   | 62/100 [02:35<01:37,  2.57s/it] 63%|██████▎   | 63/100 [02:36<01:22,  2.23s/it] 64%|██████▍   | 64/100 [02:39<01:24,  2.35s/it] 65%|██████▌   | 65/100 [02:43<01:37,  2.78s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9162 / 0.9434 / 0.9574/ [0.85714286 0.94871795 0.95744681]
                Test acc/f1/spec/sens = 0.4685 / 0.4040 / 0.9385 / 0.5474/ [0.05732484 1.         0.54741379]
 66%|██████▌   | 66/100 [02:45<01:32,  2.71s/it] 67%|██████▋   | 67/100 [02:47<01:16,  2.33s/it] 68%|██████▊   | 68/100 [02:49<01:16,  2.39s/it] 69%|██████▉   | 69/100 [02:51<01:05,  2.11s/it] 70%|███████   | 70/100 [02:56<01:29,  2.99s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9162 / 0.9434 / 0.9574/ [0.85714286 0.94871795 0.95744681]
                Test acc/f1/spec/sens = 0.5399 / 0.4467 / 0.9262 / 0.7026/ [0.04458599 1.         0.70258621]
 71%|███████   | 71/100 [02:57<01:13,  2.53s/it] 72%|███████▏  | 72/100 [03:00<01:10,  2.53s/it] 73%|███████▎  | 73/100 [03:01<00:59,  2.19s/it] 74%|███████▍  | 74/100 [03:04<00:59,  2.31s/it] 75%|███████▌  | 75/100 [03:08<01:09,  2.76s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9162 / 0.9434 / 0.9574/ [0.85714286 0.94871795 0.95744681]
                Test acc/f1/spec/sens = 0.4454 / 0.3839 / 0.9344 / 0.5043/ [0.05095541 1.         0.50431034]
 76%|███████▌  | 76/100 [03:10<01:05,  2.71s/it] 77%|███████▋  | 77/100 [03:12<00:53,  2.34s/it] 78%|███████▊  | 78/100 [03:14<00:52,  2.40s/it] 79%|███████▉  | 79/100 [03:16<00:44,  2.12s/it] 80%|████████  | 80/100 [03:21<01:00,  3.01s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8912 / 0.9057 / 0.9574/ [0.78571429 0.92307692 0.95744681]
                Test acc/f1/spec/sens = 0.5021 / 0.4266 / 0.9262 / 0.6164/ [0.05732484 1.         0.61637931]
 81%|████████  | 81/100 [03:22<00:48,  2.54s/it] 82%|████████▏ | 82/100 [03:25<00:45,  2.55s/it] 83%|████████▎ | 83/100 [03:26<00:37,  2.20s/it] 84%|████████▍ | 84/100 [03:29<00:37,  2.35s/it] 85%|████████▌ | 85/100 [03:33<00:41,  2.80s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9162 / 0.9434 / 0.9574/ [0.85714286 0.94871795 0.95744681]
                Test acc/f1/spec/sens = 0.5273 / 0.4446 / 0.9385 / 0.6681/ [0.05732484 1.         0.66810345]
 86%|████████▌ | 86/100 [03:35<00:38,  2.72s/it] 87%|████████▋ | 87/100 [03:37<00:30,  2.33s/it] 88%|████████▊ | 88/100 [03:39<00:28,  2.41s/it] 89%|████████▉ | 89/100 [03:41<00:23,  2.12s/it] 90%|█████████ | 90/100 [03:46<00:29,  2.96s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9162 / 0.9434 / 0.9574/ [0.85714286 0.94871795 0.95744681]
                Test acc/f1/spec/sens = 0.4790 / 0.4141 / 0.9426 / 0.5647/ [0.06369427 1.         0.56465517]
 91%|█████████ | 91/100 [03:47<00:22,  2.52s/it] 92%|█████████▏| 92/100 [03:50<00:20,  2.52s/it] 93%|█████████▎| 93/100 [03:51<00:15,  2.19s/it] 94%|█████████▍| 94/100 [03:54<00:13,  2.30s/it] 95%|█████████▌| 95/100 [03:58<00:13,  2.79s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8990 / 0.9245 / 0.9574/ [0.78571429 0.94871795 0.95744681]
                Test acc/f1/spec/sens = 0.5945 / 0.4819 / 0.9180 / 0.8147/ [0.04458599 1.         0.81465517]
 96%|█████████▌| 96/100 [04:00<00:11,  2.75s/it] 97%|█████████▋| 97/100 [04:02<00:07,  2.35s/it] 98%|█████████▊| 98/100 [04:04<00:04,  2.43s/it] 99%|█████████▉| 99/100 [04:06<00:02,  2.13s/it]100%|██████████| 100/100 [04:11<00:00,  3.00s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9084 / 0.9245 / 0.9574/ [0.85714286 0.92307692 0.95744681]
                Test acc/f1/spec/sens = 0.5651 / 0.4695 / 0.9303 / 0.7457/ [0.05732484 1.         0.74568966]
Trial 4, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9300 / 0.9084 / 0.9245 / 0.9574/ [0.85714286 0.92307692 0.95744681]
Test acc/f1/spec/sens = 0.5651 / 0.4695 / 0.9303 / 0.7457/ [0.05732484 1.         0.74568966]
>> Finished.
Acc, agreement for latest model:  0.5651260504201681 0.6176470588235294 [0.05732484 1.         0.74568966]
Load best checkpoint for thief model
Acc, agreement for best model:  0.5714285714285714 0.6176470588235294 [0.04458599 1.         0.76724138]
Trial 3/1 || Cycle 1/5 || Label set size 180 || Test acc 0.5714 || Test agreement 0.6176 || Spec 0.9057 || Sens 0.7672 Class Acc: [0.04458599 1.         0.76724138]
**************************************************************************************************** 

  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:15,  1.77s/it] 20%|██        | 2/10 [00:01<00:06,  1.17it/s] 40%|████      | 4/10 [00:02<00:02,  2.68it/s] 50%|█████     | 5/10 [00:03<00:02,  1.87it/s] 60%|██████    | 6/10 [00:03<00:01,  2.27it/s] 80%|████████  | 8/10 [00:03<00:00,  3.71it/s] 90%|█████████ | 9/10 [00:04<00:00,  2.15it/s]100%|██████████| 10/10 [00:04<00:00,  2.10it/s]
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.70it/s] 25%|██▌       | 3/12 [00:00<00:01,  5.26it/s] 50%|█████     | 6/12 [00:00<00:00, 10.54it/s] 67%|██████▋   | 8/12 [00:00<00:00, 11.49it/s] 83%|████████▎ | 10/12 [00:01<00:00, 12.32it/s]100%|██████████| 12/12 [00:01<00:00,  8.61it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 81, 1: 51, 2: 48}
Validation set distribution: 
Number of samples  100
{0: 14, 1: 39, 2: 47}
Labeled set distribution: 
Number of samples  360
{0: 116, 1: 121, 2: 123}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.5126, agreement = 0.4622, f1 = 0.3979, spec = 0.6475, sens = 0.6293 Class Acc: [0.59872611 0.04597701 0.62931034]
Initial model on validation dataset: acc = 0.1700, agreement = 0.1700, f1 = 0.1355, spec = 0.9245, sens = 0.0638 Class Acc: [0.92857143 0.02564103 0.06382979]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<03:20,  2.03s/it]  2%|▏         | 2/100 [00:05<04:25,  2.71s/it]  3%|▎         | 3/100 [00:07<03:53,  2.40s/it]  4%|▍         | 4/100 [00:10<04:32,  2.84s/it]  5%|▌         | 5/100 [00:15<05:40,  3.59s/it]Epoch 5: Train acc/f1 = 0.7972 / 0.7958 / 0.7764 / 0.9512/ [0.65517241 0.7768595  0.95121951] 
                Val acc/f1/spec/sens = 0.7800 / 0.7436 / 0.7547 / 0.8936/ [0.57142857 0.71794872 0.89361702]
                Test acc/f1/spec/sens = 0.5924 / 0.4849 / 0.7377 / 0.8276/ [0.06369427 0.91954023 0.82758621]
  6%|▌         | 6/100 [00:19<05:31,  3.53s/it]  7%|▋         | 7/100 [00:21<04:41,  3.02s/it]  8%|▊         | 8/100 [00:24<04:41,  3.06s/it]  9%|▉         | 9/100 [00:26<04:09,  2.74s/it] 10%|█         | 10/100 [00:32<05:49,  3.88s/it]Epoch 10: Train acc/f1 = 0.9056 / 0.9060 / 0.9620 / 0.9187/ [0.94827586 0.85123967 0.91869919] 
                Val acc/f1/spec/sens = 0.9100 / 0.8686 / 0.9434 / 0.9362/ [0.78571429 0.92307692 0.93617021]
                Test acc/f1/spec/sens = 0.4307 / 0.4290 / 0.8893 / 0.4138/ [0.22929936 0.83908046 0.4137931 ]
 11%|█         | 11/100 [00:34<04:52,  3.29s/it] 12%|█▏        | 12/100 [00:37<04:45,  3.24s/it] 13%|█▎        | 13/100 [00:39<04:07,  2.85s/it] 14%|█▍        | 14/100 [00:42<04:11,  2.92s/it] 15%|█▌        | 15/100 [00:47<05:00,  3.54s/it]Epoch 15: Train acc/f1 = 0.9528 / 0.9529 / 0.9916 / 0.9431/ [0.98275862 0.9338843  0.94308943] 
                Val acc/f1/spec/sens = 0.8400 / 0.7865 / 0.8491 / 0.9149/ [0.64285714 0.82051282 0.91489362]
                Test acc/f1/spec/sens = 0.2584 / 0.2379 / 0.9467 / 0.1207/ [0.06369427 0.97701149 0.12068966]
 16%|█▌        | 16/100 [00:51<04:54,  3.50s/it] 17%|█▋        | 17/100 [00:53<04:13,  3.05s/it] 18%|█▊        | 18/100 [00:56<04:12,  3.07s/it] 19%|█▉        | 19/100 [00:58<03:43,  2.76s/it] 20%|██        | 20/100 [01:04<05:03,  3.79s/it]Epoch 20: Train acc/f1 = 0.9444 / 0.9447 / 0.9958 / 0.9187/ [0.97413793 0.94214876 0.91869919] 
                Val acc/f1/spec/sens = 0.9000 / 0.8780 / 0.9623 / 0.8723/ [0.92857143 0.92307692 0.87234043]
                Test acc/f1/spec/sens = 0.2731 / 0.2598 / 0.9262 / 0.1595/ [0.06369427 0.95402299 0.15948276]
 21%|██        | 21/100 [01:06<04:16,  3.24s/it] 22%|██▏       | 22/100 [01:10<04:21,  3.35s/it] 23%|██▎       | 23/100 [01:12<03:45,  2.93s/it] 24%|██▍       | 24/100 [01:15<03:47,  2.99s/it] 25%|██▌       | 25/100 [01:20<04:32,  3.63s/it]Epoch 25: Train acc/f1 = 0.9972 / 0.9972 / 1.0000 / 0.9919/ [1.         1.         0.99186992] 
                Val acc/f1/spec/sens = 0.9300 / 0.9116 / 0.9434 / 0.9362/ [0.92857143 0.92307692 0.93617021]
                Test acc/f1/spec/sens = 0.4853 / 0.4529 / 0.9221 / 0.5345/ [0.1656051  0.93103448 0.53448276]
 26%|██▌       | 26/100 [01:23<04:19,  3.50s/it] 27%|██▋       | 27/100 [01:25<03:44,  3.07s/it] 28%|██▊       | 28/100 [01:28<03:45,  3.14s/it] 29%|██▉       | 29/100 [01:31<03:21,  2.84s/it] 30%|███       | 30/100 [01:37<04:28,  3.84s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9116 / 0.9434 / 0.9362/ [0.92857143 0.92307692 0.93617021]
                Test acc/f1/spec/sens = 0.4727 / 0.4366 / 0.9221 / 0.5172/ [0.13375796 0.96551724 0.51724138]
 31%|███       | 31/100 [01:39<03:47,  3.29s/it] 32%|███▏      | 32/100 [01:42<03:41,  3.25s/it] 33%|███▎      | 33/100 [01:44<03:12,  2.87s/it] 34%|███▍      | 34/100 [01:47<03:15,  2.97s/it] 35%|███▌      | 35/100 [01:52<03:54,  3.60s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9116 / 0.9434 / 0.9362/ [0.92857143 0.92307692 0.93617021]
                Test acc/f1/spec/sens = 0.5021 / 0.4763 / 0.9180 / 0.5345/ [0.21656051 0.93103448 0.53448276]
 36%|███▌      | 36/100 [01:55<03:41,  3.46s/it] 37%|███▋      | 37/100 [01:57<03:10,  3.02s/it] 38%|███▊      | 38/100 [02:01<03:17,  3.19s/it] 39%|███▉      | 39/100 [02:03<02:52,  2.83s/it] 40%|████      | 40/100 [02:09<03:48,  3.81s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9195 / 0.9623 / 0.9362/ [0.92857143 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.4895 / 0.4610 / 0.9221 / 0.5259/ [0.18471338 0.94252874 0.52586207]
 41%|████      | 41/100 [02:11<03:13,  3.29s/it] 42%|████▏     | 42/100 [02:14<03:07,  3.23s/it] 43%|████▎     | 43/100 [02:16<02:44,  2.88s/it] 44%|████▍     | 44/100 [02:19<02:45,  2.95s/it] 45%|████▌     | 45/100 [02:24<03:15,  3.56s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9195 / 0.9623 / 0.9362/ [0.92857143 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.4937 / 0.4504 / 0.9221 / 0.5647/ [0.12738854 0.96551724 0.56465517]
 46%|████▌     | 46/100 [02:27<03:05,  3.43s/it] 47%|████▋     | 47/100 [02:29<02:40,  3.03s/it] 48%|████▊     | 48/100 [02:33<02:41,  3.10s/it] 49%|████▉     | 49/100 [02:35<02:21,  2.77s/it] 50%|█████     | 50/100 [02:41<03:10,  3.81s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9116 / 0.9434 / 0.9362/ [0.92857143 0.92307692 0.93617021]
                Test acc/f1/spec/sens = 0.4832 / 0.4559 / 0.9221 / 0.5129/ [0.18471338 0.94252874 0.51293103]
 51%|█████     | 51/100 [02:43<02:39,  3.27s/it] 52%|█████▏    | 52/100 [02:46<02:34,  3.22s/it] 53%|█████▎    | 53/100 [02:48<02:15,  2.87s/it] 54%|█████▍    | 54/100 [02:51<02:16,  2.96s/it] 55%|█████▌    | 55/100 [02:56<02:41,  3.58s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9195 / 0.9623 / 0.9362/ [0.92857143 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.4979 / 0.4703 / 0.9221 / 0.5302/ [0.19745223 0.95402299 0.53017241]
 56%|█████▌    | 56/100 [02:59<02:31,  3.44s/it] 57%|█████▋    | 57/100 [03:01<02:08,  2.98s/it] 58%|█████▊    | 58/100 [03:05<02:07,  3.04s/it] 59%|█████▉    | 59/100 [03:07<01:51,  2.72s/it] 60%|██████    | 60/100 [03:13<02:29,  3.74s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9116 / 0.9434 / 0.9362/ [0.92857143 0.92307692 0.93617021]
                Test acc/f1/spec/sens = 0.4874 / 0.4557 / 0.9221 / 0.5259/ [0.1656051  0.96551724 0.52586207]
 61%|██████    | 61/100 [03:15<02:05,  3.21s/it] 62%|██████▏   | 62/100 [03:18<02:00,  3.18s/it] 63%|██████▎   | 63/100 [03:20<01:45,  2.85s/it] 64%|██████▍   | 64/100 [03:23<01:46,  2.95s/it] 65%|██████▌   | 65/100 [03:28<02:04,  3.57s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9195 / 0.9623 / 0.9362/ [0.92857143 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.4706 / 0.4435 / 0.9262 / 0.4871/ [0.17197452 0.96551724 0.48706897]
 66%|██████▌   | 66/100 [03:31<01:57,  3.45s/it] 67%|██████▋   | 67/100 [03:33<01:39,  3.01s/it] 68%|██████▊   | 68/100 [03:36<01:37,  3.06s/it] 69%|██████▉   | 69/100 [03:38<01:25,  2.75s/it] 70%|███████   | 70/100 [03:44<01:52,  3.74s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9195 / 0.9623 / 0.9362/ [0.92857143 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.4832 / 0.4510 / 0.9221 / 0.5216/ [0.15923567 0.96551724 0.52155172]
 71%|███████   | 71/100 [03:47<01:34,  3.25s/it] 72%|███████▏  | 72/100 [03:50<01:30,  3.22s/it] 73%|███████▎  | 73/100 [03:52<01:17,  2.86s/it] 74%|███████▍  | 74/100 [03:55<01:16,  2.94s/it] 75%|███████▌  | 75/100 [04:00<01:28,  3.55s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9116 / 0.9434 / 0.9362/ [0.92857143 0.92307692 0.93617021]
                Test acc/f1/spec/sens = 0.5084 / 0.4727 / 0.9180 / 0.5733/ [0.17197452 0.94252874 0.57327586]
 76%|███████▌  | 76/100 [04:03<01:21,  3.42s/it] 77%|███████▋  | 77/100 [04:05<01:08,  2.99s/it] 78%|███████▊  | 78/100 [04:08<01:06,  3.04s/it] 79%|███████▉  | 79/100 [04:10<00:57,  2.74s/it] 80%|████████  | 80/100 [04:16<01:15,  3.76s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9195 / 0.9623 / 0.9362/ [0.92857143 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.4601 / 0.4296 / 0.9262 / 0.4828/ [0.14649682 0.96551724 0.48275862]
 81%|████████  | 81/100 [04:18<01:01,  3.25s/it] 82%|████████▏ | 82/100 [04:21<00:57,  3.21s/it] 83%|████████▎ | 83/100 [04:23<00:48,  2.85s/it] 84%|████████▍ | 84/100 [04:27<00:47,  2.95s/it] 85%|████████▌ | 85/100 [04:32<00:53,  3.59s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9195 / 0.9623 / 0.9362/ [0.92857143 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.4748 / 0.4431 / 0.9221 / 0.5086/ [0.15286624 0.96551724 0.50862069]
 86%|████████▌ | 86/100 [04:35<00:48,  3.44s/it] 87%|████████▋ | 87/100 [04:37<00:39,  3.02s/it] 88%|████████▊ | 88/100 [04:40<00:37,  3.09s/it] 89%|████████▉ | 89/100 [04:42<00:30,  2.79s/it] 90%|█████████ | 90/100 [04:48<00:37,  3.80s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9116 / 0.9434 / 0.9362/ [0.92857143 0.92307692 0.93617021]
                Test acc/f1/spec/sens = 0.5126 / 0.4829 / 0.9180 / 0.5603/ [0.20382166 0.94252874 0.56034483]
 91%|█████████ | 91/100 [04:50<00:29,  3.25s/it] 92%|█████████▏| 92/100 [04:53<00:25,  3.21s/it] 93%|█████████▎| 93/100 [04:55<00:19,  2.85s/it] 94%|█████████▍| 94/100 [04:59<00:17,  2.94s/it] 95%|█████████▌| 95/100 [05:04<00:18,  3.62s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9195 / 0.9623 / 0.9362/ [0.92857143 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.5084 / 0.4697 / 0.9180 / 0.5733/ [0.15923567 0.96551724 0.57327586]
 96%|█████████▌| 96/100 [05:07<00:13,  3.46s/it] 97%|█████████▋| 97/100 [05:09<00:09,  3.04s/it] 98%|█████████▊| 98/100 [05:12<00:06,  3.09s/it] 99%|█████████▉| 99/100 [05:14<00:02,  2.76s/it]100%|██████████| 100/100 [05:20<00:00,  3.76s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9116 / 0.9434 / 0.9362/ [0.92857143 0.92307692 0.93617021]
                Test acc/f1/spec/sens = 0.5021 / 0.4711 / 0.9221 / 0.5474/ [0.18471338 0.95402299 0.54741379]
Trial 4, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9300 / 0.9116 / 0.9434 / 0.9362/ [0.92857143 0.92307692 0.93617021]
Test acc/f1/spec/sens = 0.5021 / 0.4711 / 0.9221 / 0.5474/ [0.18471338 0.95402299 0.54741379]
>> Finished.
Acc, agreement for latest model:  0.5021008403361344 0.5714285714285714 [0.18471338 0.95402299 0.54741379]
Load best checkpoint for thief model
Acc, agreement for best model:  0.47058823529411764 0.5357142857142857 [0.14649682 0.96551724 0.50431034]
Trial 3/1 || Cycle 2/5 || Label set size 360 || Test acc 0.4706 || Test agreement 0.5357 || Spec 0.9221 || Sens 0.5043 Class Acc: [0.14649682 0.96551724 0.50431034]
**************************************************************************************************** 

  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:01<00:15,  1.98s/it] 33%|███▎      | 3/9 [00:02<00:03,  1.74it/s] 56%|█████▌    | 5/9 [00:03<00:02,  1.76it/s] 78%|███████▊  | 7/9 [00:03<00:00,  2.78it/s]100%|██████████| 9/9 [00:03<00:00,  3.52it/s]100%|██████████| 9/9 [00:03<00:00,  2.28it/s]
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.51it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.74it/s] 75%|███████▌  | 9/12 [00:01<00:00, 10.78it/s]100%|██████████| 12/12 [00:01<00:00,  8.98it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 53, 1: 51, 2: 76}
Validation set distribution: 
Number of samples  100
{0: 14, 1: 39, 2: 47}
Labeled set distribution: 
Number of samples  540
{0: 169, 1: 172, 2: 199}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.4874, agreement = 0.4601, f1 = 0.2188, spec = 0.0041, sens = 1.0000 Class Acc: [0. 0. 1.]
Initial model on validation dataset: acc = 0.4500, agreement = 0.4500, f1 = 0.2098, spec = 0.0377, sens = 0.9574 Class Acc: [0.         0.         0.95744681]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:19,  2.63s/it]  2%|▏         | 2/100 [00:06<05:24,  3.31s/it]  3%|▎         | 3/100 [00:08<04:48,  2.97s/it]  4%|▍         | 4/100 [00:12<05:23,  3.37s/it]  5%|▌         | 5/100 [00:19<07:00,  4.43s/it]Epoch 5: Train acc/f1 = 0.5667 / 0.4950 / 0.8152 / 0.6382/ [0.10650888 0.93604651 0.63819095] 
                Val acc/f1/spec/sens = 0.8600 / 0.8251 / 0.9057 / 0.9149/ [0.64285714 0.87179487 0.91489362]
                Test acc/f1/spec/sens = 0.5798 / 0.4698 / 0.6189 / 0.8621/ [0.08280255 0.72413793 0.86206897]
  6%|▌         | 6/100 [00:22<06:32,  4.18s/it]  7%|▋         | 7/100 [00:25<05:40,  3.66s/it]  8%|▊         | 8/100 [00:29<05:52,  3.83s/it]  9%|▉         | 9/100 [00:32<05:14,  3.45s/it] 10%|█         | 10/100 [00:39<06:57,  4.64s/it]Epoch 10: Train acc/f1 = 0.9315 / 0.9320 / 0.9971 / 0.8894/ [0.97633136 0.93604651 0.88944724] 
                Val acc/f1/spec/sens = 0.9100 / 0.8767 / 0.9811 / 0.9149/ [0.85714286 0.92307692 0.91489362]
                Test acc/f1/spec/sens = 0.3529 / 0.3672 / 0.9221 / 0.2155/ [0.22929936 0.94252874 0.21551724]
 11%|█         | 11/100 [00:42<05:57,  4.01s/it] 12%|█▏        | 12/100 [00:46<05:46,  3.94s/it] 13%|█▎        | 13/100 [00:48<05:07,  3.53s/it] 14%|█▍        | 14/100 [00:52<05:09,  3.60s/it] 15%|█▌        | 15/100 [00:58<06:12,  4.39s/it]Epoch 15: Train acc/f1 = 0.9315 / 0.9308 / 0.9531 / 0.9598/ [0.9112426  0.91860465 0.95979899] 
                Val acc/f1/spec/sens = 0.9000 / 0.8689 / 0.9811 / 0.8723/ [0.78571429 0.97435897 0.87234043]
                Test acc/f1/spec/sens = 0.3235 / 0.3467 / 0.9098 / 0.1379/ [0.3566879  0.75862069 0.13793103]
 16%|█▌        | 16/100 [01:02<05:51,  4.19s/it] 17%|█▋        | 17/100 [01:04<05:07,  3.71s/it] 18%|█▊        | 18/100 [01:08<05:07,  3.75s/it] 19%|█▉        | 19/100 [01:11<04:36,  3.42s/it] 20%|██        | 20/100 [01:18<06:03,  4.55s/it]Epoch 20: Train acc/f1 = 0.9796 / 0.9795 / 1.0000 / 0.9648/ [0.97633136 1.         0.96482412] 
                Val acc/f1/spec/sens = 0.9200 / 0.8795 / 0.9623 / 0.9149/ [0.71428571 1.         0.91489362]
                Test acc/f1/spec/sens = 0.2080 / 0.2008 / 0.9795 / 0.1078/ [0.01910828 0.81609195 0.10775862]
 21%|██        | 21/100 [01:21<05:11,  3.94s/it] 22%|██▏       | 22/100 [01:24<05:01,  3.87s/it] 23%|██▎       | 23/100 [01:27<04:27,  3.47s/it] 24%|██▍       | 24/100 [01:31<04:37,  3.65s/it] 25%|██▌       | 25/100 [01:37<05:35,  4.47s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8977 / 1.0000 / 0.8936/ [0.85714286 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2458 / 0.2495 / 0.9754 / 0.0819/ [0.17197452 0.81609195 0.08189655]
 26%|██▌       | 26/100 [01:41<05:13,  4.24s/it] 27%|██▋       | 27/100 [01:44<04:32,  3.73s/it] 28%|██▊       | 28/100 [01:47<04:29,  3.74s/it] 29%|██▉       | 29/100 [01:50<04:01,  3.40s/it] 30%|███       | 30/100 [01:57<05:23,  4.62s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8806 / 0.9811 / 0.8936/ [0.78571429 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2437 / 0.2471 / 0.9795 / 0.0819/ [0.1656051  0.81609195 0.08189655]
 31%|███       | 31/100 [02:00<04:36,  4.01s/it] 32%|███▏      | 32/100 [02:04<04:27,  3.94s/it] 33%|███▎      | 33/100 [02:06<03:55,  3.51s/it] 34%|███▍      | 34/100 [02:10<03:57,  3.60s/it] 35%|███▌      | 35/100 [02:16<04:46,  4.40s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8806 / 0.9811 / 0.8936/ [0.78571429 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2458 / 0.2484 / 0.9754 / 0.0819/ [0.17197452 0.81609195 0.08189655]
 36%|███▌      | 36/100 [02:20<04:29,  4.21s/it] 37%|███▋      | 37/100 [02:23<03:54,  3.73s/it] 38%|███▊      | 38/100 [02:26<03:51,  3.73s/it] 39%|███▉      | 39/100 [02:29<03:29,  3.43s/it] 40%|████      | 40/100 [02:37<04:36,  4.60s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8806 / 0.9811 / 0.8936/ [0.78571429 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2458 / 0.2476 / 0.9754 / 0.0819/ [0.15923567 0.83908046 0.08189655]
 41%|████      | 41/100 [02:39<03:57,  4.02s/it] 42%|████▏     | 42/100 [02:43<03:49,  3.95s/it] 43%|████▎     | 43/100 [02:46<03:21,  3.54s/it] 44%|████▍     | 44/100 [02:49<03:22,  3.61s/it] 45%|████▌     | 45/100 [02:56<04:02,  4.40s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8806 / 0.9811 / 0.8936/ [0.78571429 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2458 / 0.2476 / 0.9754 / 0.0819/ [0.15923567 0.83908046 0.08189655]
 46%|████▌     | 46/100 [02:59<03:49,  4.25s/it] 47%|████▋     | 47/100 [03:02<03:19,  3.77s/it] 48%|████▊     | 48/100 [03:06<03:15,  3.77s/it] 49%|████▉     | 49/100 [03:09<02:55,  3.44s/it] 50%|█████     | 50/100 [03:16<03:53,  4.66s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8806 / 0.9811 / 0.8936/ [0.78571429 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2395 / 0.2420 / 0.9754 / 0.0819/ [0.15286624 0.81609195 0.08189655]
 51%|█████     | 51/100 [03:19<03:18,  4.05s/it] 52%|█████▏    | 52/100 [03:22<03:10,  3.96s/it] 53%|█████▎    | 53/100 [03:25<02:47,  3.57s/it] 54%|█████▍    | 54/100 [03:29<02:46,  3.62s/it] 55%|█████▌    | 55/100 [03:35<03:19,  4.44s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8806 / 0.9811 / 0.8936/ [0.78571429 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2395 / 0.2417 / 0.9795 / 0.0819/ [0.15286624 0.81609195 0.08189655]
 56%|█████▌    | 56/100 [03:39<03:05,  4.22s/it] 57%|█████▋    | 57/100 [03:42<02:40,  3.74s/it] 58%|█████▊    | 58/100 [03:45<02:36,  3.73s/it] 59%|█████▉    | 59/100 [03:48<02:19,  3.41s/it] 60%|██████    | 60/100 [03:55<03:02,  4.57s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8806 / 0.9811 / 0.8936/ [0.78571429 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2437 / 0.2455 / 0.9754 / 0.0862/ [0.14649682 0.83908046 0.0862069 ]
 61%|██████    | 61/100 [03:58<02:34,  3.97s/it] 62%|██████▏   | 62/100 [04:02<02:28,  3.91s/it] 63%|██████▎   | 63/100 [04:04<02:09,  3.50s/it] 64%|██████▍   | 64/100 [04:08<02:08,  3.56s/it] 65%|██████▌   | 65/100 [04:14<02:32,  4.36s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8929 / 0.9811 / 0.9149/ [0.78571429 1.         0.91489362]
                Test acc/f1/spec/sens = 0.2353 / 0.2332 / 0.9795 / 0.0819/ [0.12101911 0.85057471 0.08189655]
 66%|██████▌   | 66/100 [04:18<02:22,  4.19s/it] 67%|██████▋   | 67/100 [04:20<02:03,  3.73s/it] 68%|██████▊   | 68/100 [04:24<02:00,  3.76s/it] 69%|██████▉   | 69/100 [04:27<01:46,  3.43s/it] 70%|███████   | 70/100 [04:34<02:19,  4.64s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8806 / 0.9811 / 0.8936/ [0.78571429 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2395 / 0.2411 / 0.9836 / 0.0819/ [0.14649682 0.82758621 0.08189655]
 71%|███████   | 71/100 [04:37<01:56,  4.01s/it] 72%|███████▏  | 72/100 [04:41<01:49,  3.89s/it] 73%|███████▎  | 73/100 [04:43<01:34,  3.50s/it] 74%|███████▍  | 74/100 [04:47<01:32,  3.57s/it] 75%|███████▌  | 75/100 [04:53<01:49,  4.36s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8806 / 0.9811 / 0.8936/ [0.78571429 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2416 / 0.2423 / 0.9795 / 0.0819/ [0.14649682 0.83908046 0.08189655]
 76%|███████▌  | 76/100 [04:57<01:40,  4.17s/it] 77%|███████▋  | 77/100 [04:59<01:25,  3.71s/it] 78%|███████▊  | 78/100 [05:03<01:22,  3.75s/it] 79%|███████▉  | 79/100 [05:06<01:12,  3.43s/it] 80%|████████  | 80/100 [05:13<01:32,  4.61s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8929 / 0.9811 / 0.9149/ [0.78571429 1.         0.91489362]
                Test acc/f1/spec/sens = 0.2416 / 0.2441 / 0.9754 / 0.0819/ [0.15923567 0.81609195 0.08189655]
 81%|████████  | 81/100 [05:16<01:15,  3.99s/it] 82%|████████▏ | 82/100 [05:20<01:11,  3.95s/it] 83%|████████▎ | 83/100 [05:22<01:00,  3.53s/it] 84%|████████▍ | 84/100 [05:26<00:57,  3.59s/it] 85%|████████▌ | 85/100 [05:32<01:06,  4.41s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8806 / 0.9811 / 0.8936/ [0.78571429 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2437 / 0.2466 / 0.9754 / 0.0819/ [0.1656051  0.81609195 0.08189655]
 86%|████████▌ | 86/100 [05:36<00:58,  4.18s/it] 87%|████████▋ | 87/100 [05:39<00:48,  3.75s/it] 88%|████████▊ | 88/100 [05:42<00:44,  3.72s/it] 89%|████████▉ | 89/100 [05:45<00:37,  3.38s/it] 90%|█████████ | 90/100 [05:53<00:46,  4.63s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8929 / 0.9811 / 0.9149/ [0.78571429 1.         0.91489362]
                Test acc/f1/spec/sens = 0.2416 / 0.2434 / 0.9754 / 0.0862/ [0.14012739 0.83908046 0.0862069 ]
 91%|█████████ | 91/100 [05:55<00:36,  4.03s/it] 92%|█████████▏| 92/100 [05:59<00:31,  3.93s/it] 93%|█████████▎| 93/100 [06:02<00:24,  3.56s/it] 94%|█████████▍| 94/100 [06:05<00:21,  3.63s/it] 95%|█████████▌| 95/100 [06:12<00:22,  4.41s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8806 / 0.9811 / 0.8936/ [0.78571429 1.         0.89361702]
                Test acc/f1/spec/sens = 0.2563 / 0.2605 / 0.9754 / 0.0948/ [0.17834395 0.82758621 0.09482759]
 96%|█████████▌| 96/100 [06:15<00:16,  4.22s/it] 97%|█████████▋| 97/100 [06:18<00:11,  3.72s/it] 98%|█████████▊| 98/100 [06:22<00:07,  3.72s/it] 99%|█████████▉| 99/100 [06:24<00:03,  3.38s/it]100%|██████████| 100/100 [06:32<00:00,  4.57s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8929 / 0.9811 / 0.9149/ [0.78571429 1.         0.91489362]
                Test acc/f1/spec/sens = 0.2500 / 0.2537 / 0.9754 / 0.0948/ [0.1656051  0.81609195 0.09482759]
Trial 4, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9300 / 0.8929 / 0.9811 / 0.9149/ [0.78571429 1.         0.91489362]
Test acc/f1/spec/sens = 0.2500 / 0.2537 / 0.9754 / 0.0948/ [0.1656051  0.81609195 0.09482759]
>> Finished.
Acc, agreement for latest model:  0.25 0.30462184873949577 [0.1656051  0.81609195 0.09482759]
Load best checkpoint for thief model
Acc, agreement for best model:  0.25 0.3088235294117647 [0.17197452 0.81609195 0.09051724]
Trial 3/1 || Cycle 3/5 || Label set size 540 || Test acc 0.2500 || Test agreement 0.3088 || Spec 0.9754 || Sens 0.0905 Class Acc: [0.17197452 0.81609195 0.09051724]
**************************************************************************************************** 

  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:01<00:11,  1.87s/it] 43%|████▎     | 3/7 [00:02<00:02,  1.84it/s] 71%|███████▏  | 5/7 [00:03<00:01,  1.94it/s]100%|██████████| 7/7 [00:03<00:00,  3.05it/s]100%|██████████| 7/7 [00:03<00:00,  2.08it/s]
labeled set:  720
unlabeled set:  713
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.45it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.36it/s] 75%|███████▌  | 9/12 [00:01<00:00, 10.52it/s]100%|██████████| 12/12 [00:01<00:00,  8.87it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 38, 1: 66, 2: 76}
Validation set distribution: 
Number of samples  100
{0: 14, 1: 39, 2: 47}
Labeled set distribution: 
Number of samples  720
{0: 207, 1: 238, 2: 275}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2080, agreement = 0.2479, f1 = 0.1794, spec = 0.8320, sens = 0.0129 Class Acc: [0.12738854 0.87356322 0.01293103]
Initial model on validation dataset: acc = 0.1400, agreement = 0.1400, f1 = 0.1221, spec = 1.0000, sens = 0.0000 Class Acc: [0.42857143 0.20512821 0.        ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:12,  3.16s/it]  2%|▏         | 2/100 [00:07<06:27,  3.96s/it]  3%|▎         | 3/100 [00:10<05:53,  3.65s/it]  4%|▍         | 4/100 [00:15<06:13,  3.89s/it]  5%|▌         | 5/100 [00:22<08:10,  5.16s/it]Epoch 5: Train acc/f1 = 0.8042 / 0.7810 / 0.9348 / 0.8836/ [0.50724638 0.97058824 0.88363636] 
                Val acc/f1/spec/sens = 0.5500 / 0.4171 / 1.0000 / 0.3191/ [0.07142857 1.         0.31914894]
                Test acc/f1/spec/sens = 0.4811 / 0.4073 / 0.8443 / 0.5776/ [0.05095541 1.         0.57758621]
  6%|▌         | 6/100 [00:27<07:52,  5.02s/it]  7%|▋         | 7/100 [00:30<06:48,  4.40s/it]  8%|▊         | 8/100 [00:34<06:41,  4.37s/it]  9%|▉         | 9/100 [00:38<06:05,  4.02s/it] 10%|█         | 10/100 [00:47<08:19,  5.55s/it]Epoch 10: Train acc/f1 = 0.8333 / 0.8328 / 0.9933 / 0.8145/ [0.91304348 0.78571429 0.81454545] 
                Val acc/f1/spec/sens = 0.9300 / 0.9015 / 1.0000 / 0.9149/ [0.92857143 0.94871795 0.91489362]
                Test acc/f1/spec/sens = 0.4181 / 0.4276 / 0.6148 / 0.4181/ [0.21656051 0.7816092  0.41810345]
 11%|█         | 11/100 [00:50<07:09,  4.83s/it] 12%|█▏        | 12/100 [00:54<06:49,  4.66s/it] 13%|█▎        | 13/100 [00:57<06:09,  4.24s/it] 14%|█▍        | 14/100 [01:02<06:09,  4.30s/it] 15%|█▌        | 15/100 [01:09<07:27,  5.27s/it]Epoch 15: Train acc/f1 = 0.9333 / 0.9297 / 0.9685 / 0.9745/ [0.84541063 0.96218487 0.97454545] 
                Val acc/f1/spec/sens = 0.9000 / 0.8379 / 0.9811 / 0.9149/ [0.57142857 1.         0.91489362]
                Test acc/f1/spec/sens = 0.6134 / 0.4760 / 0.7049 / 0.9440/ [0.04458599 0.75862069 0.94396552]
 16%|█▌        | 16/100 [01:13<06:57,  4.97s/it] 17%|█▋        | 17/100 [01:17<06:06,  4.42s/it] 18%|█▊        | 18/100 [01:21<05:56,  4.35s/it] 19%|█▉        | 19/100 [01:24<05:24,  4.01s/it] 20%|██        | 20/100 [01:32<07:07,  5.35s/it]Epoch 20: Train acc/f1 = 0.9653 / 0.9648 / 0.9753 / 0.9745/ [0.96618357 0.95378151 0.97454545] 
                Val acc/f1/spec/sens = 0.9200 / 0.8802 / 0.9623 / 0.9362/ [0.78571429 0.94871795 0.93617021]
                Test acc/f1/spec/sens = 0.3992 / 0.3711 / 0.9385 / 0.4353/ [0.08917197 0.86206897 0.43534483]
 21%|██        | 21/100 [01:36<06:11,  4.70s/it] 22%|██▏       | 22/100 [01:40<06:00,  4.62s/it] 23%|██▎       | 23/100 [01:43<05:22,  4.19s/it] 24%|██▍       | 24/100 [01:48<05:24,  4.27s/it] 25%|██▌       | 25/100 [01:56<06:39,  5.32s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.5483 / 0.4553 / 0.8238 / 0.7155/ [0.05732484 0.98850575 0.71551724]
 26%|██▌       | 26/100 [02:00<06:17,  5.10s/it] 27%|██▋       | 27/100 [02:03<05:30,  4.53s/it] 28%|██▊       | 28/100 [02:08<05:23,  4.50s/it] 29%|██▉       | 29/100 [02:11<04:53,  4.14s/it] 30%|███       | 30/100 [02:20<06:20,  5.44s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4937 / 0.4192 / 0.8279 / 0.6034/ [0.05732484 0.98850575 0.60344828]
 31%|███       | 31/100 [02:23<05:27,  4.75s/it] 32%|███▏      | 32/100 [02:27<05:17,  4.66s/it] 33%|███▎      | 33/100 [02:30<04:42,  4.22s/it] 34%|███▍      | 34/100 [02:35<04:39,  4.23s/it] 35%|███▌      | 35/100 [02:42<05:38,  5.20s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.5105 / 0.4320 / 0.8238 / 0.6379/ [0.05732484 0.98850575 0.63793103]
 36%|███▌      | 36/100 [02:46<05:15,  4.93s/it] 37%|███▋      | 37/100 [02:50<04:37,  4.41s/it] 38%|███▊      | 38/100 [02:54<04:34,  4.42s/it] 39%|███▉      | 39/100 [02:57<04:11,  4.12s/it] 40%|████      | 40/100 [03:06<05:28,  5.48s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4475 / 0.3855 / 0.8279 / 0.5086/ [0.05732484 0.98850575 0.50862069]
 41%|████      | 41/100 [03:09<04:45,  4.83s/it] 42%|████▏     | 42/100 [03:14<04:32,  4.70s/it] 43%|████▎     | 43/100 [03:17<04:03,  4.27s/it] 44%|████▍     | 44/100 [03:21<04:02,  4.33s/it] 45%|████▌     | 45/100 [03:29<04:55,  5.37s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4958 / 0.4167 / 0.8197 / 0.6121/ [0.05095541 0.98850575 0.61206897]
 46%|████▌     | 46/100 [03:34<04:33,  5.07s/it] 47%|████▋     | 47/100 [03:37<04:00,  4.54s/it] 48%|████▊     | 48/100 [03:41<03:52,  4.46s/it] 49%|████▉     | 49/100 [03:44<03:28,  4.08s/it] 50%|█████     | 50/100 [03:53<04:31,  5.44s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4790 / 0.4056 / 0.8197 / 0.5776/ [0.05095541 0.98850575 0.57758621]
 51%|█████     | 51/100 [03:56<03:52,  4.74s/it] 52%|█████▏    | 52/100 [04:00<03:41,  4.61s/it] 53%|█████▎    | 53/100 [04:04<03:17,  4.20s/it] 54%|█████▍    | 54/100 [04:08<03:17,  4.29s/it] 55%|█████▌    | 55/100 [04:16<03:54,  5.21s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4517 / 0.3892 / 0.8279 / 0.5172/ [0.05732484 0.98850575 0.51724138]
 56%|█████▌    | 56/100 [04:20<03:38,  4.98s/it] 57%|█████▋    | 57/100 [04:23<03:11,  4.45s/it] 58%|█████▊    | 58/100 [04:28<03:06,  4.45s/it] 59%|█████▉    | 59/100 [04:31<02:46,  4.05s/it] 60%|██████    | 60/100 [04:40<03:38,  5.47s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4853 / 0.4106 / 0.8238 / 0.5905/ [0.05095541 0.98850575 0.59051724]
 61%|██████    | 61/100 [04:43<03:06,  4.78s/it] 62%|██████▏   | 62/100 [04:47<02:55,  4.63s/it] 63%|██████▎   | 63/100 [04:50<02:35,  4.20s/it] 64%|██████▍   | 64/100 [04:55<02:32,  4.23s/it] 65%|██████▌   | 65/100 [05:02<03:02,  5.21s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.5252 / 0.4413 / 0.8238 / 0.6681/ [0.05732484 0.98850575 0.66810345]
 66%|██████▌   | 66/100 [05:06<02:47,  4.94s/it] 67%|██████▋   | 67/100 [05:10<02:26,  4.42s/it] 68%|██████▊   | 68/100 [05:14<02:19,  4.36s/it] 69%|██████▉   | 69/100 [05:17<02:05,  4.05s/it] 70%|███████   | 70/100 [05:26<02:43,  5.43s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4496 / 0.3878 / 0.8279 / 0.5129/ [0.05732484 0.98850575 0.51293103]
 71%|███████   | 71/100 [05:29<02:17,  4.75s/it] 72%|███████▏  | 72/100 [05:33<02:09,  4.62s/it] 73%|███████▎  | 73/100 [05:36<01:53,  4.19s/it] 74%|███████▍  | 74/100 [05:41<01:50,  4.25s/it] 75%|███████▌  | 75/100 [05:48<02:10,  5.23s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4118 / 0.3582 / 0.8279 / 0.4353/ [0.05732484 0.98850575 0.43534483]
 76%|███████▌  | 76/100 [05:53<01:59,  4.97s/it] 77%|███████▋  | 77/100 [05:56<01:42,  4.45s/it] 78%|███████▊  | 78/100 [06:00<01:38,  4.46s/it] 79%|███████▉  | 79/100 [06:04<01:25,  4.08s/it] 80%|████████  | 80/100 [06:12<01:50,  5.52s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.5294 / 0.4459 / 0.8238 / 0.6767/ [0.05732484 0.98850575 0.67672414]
 81%|████████  | 81/100 [06:16<01:32,  4.86s/it] 82%|████████▏ | 82/100 [06:20<01:24,  4.67s/it] 83%|████████▎ | 83/100 [06:23<01:12,  4.24s/it] 84%|████████▍ | 84/100 [06:28<01:09,  4.32s/it] 85%|████████▌ | 85/100 [06:35<01:19,  5.30s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4685 / 0.4013 / 0.8279 / 0.5517/ [0.05732484 0.98850575 0.55172414]
 86%|████████▌ | 86/100 [06:40<01:10,  5.03s/it] 87%|████████▋ | 87/100 [06:43<00:58,  4.51s/it] 88%|████████▊ | 88/100 [06:47<00:53,  4.49s/it] 89%|████████▉ | 89/100 [06:51<00:45,  4.16s/it] 90%|█████████ | 90/100 [07:00<00:56,  5.64s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4685 / 0.4019 / 0.8238 / 0.5517/ [0.05732484 0.98850575 0.55172414]
 91%|█████████ | 91/100 [07:03<00:44,  4.92s/it] 92%|█████████▏| 92/100 [07:08<00:37,  4.74s/it] 93%|█████████▎| 93/100 [07:11<00:30,  4.32s/it] 94%|█████████▍| 94/100 [07:15<00:25,  4.32s/it] 95%|█████████▌| 95/100 [07:23<00:26,  5.28s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8980 / 0.9623 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.5210 / 0.4392 / 0.8238 / 0.6595/ [0.05732484 0.98850575 0.65948276]
 96%|█████████▌| 96/100 [07:27<00:20,  5.10s/it] 97%|█████████▋| 97/100 [07:31<00:13,  4.56s/it] 98%|█████████▊| 98/100 [07:35<00:09,  4.54s/it] 99%|█████████▉| 99/100 [07:38<00:04,  4.17s/it]100%|██████████| 100/100 [07:47<00:00,  5.55s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4034 / 0.3504 / 0.8279 / 0.4138/ [0.05732484 1.         0.4137931 ]
Trial 4, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9300 / 0.8924 / 0.9811 / 0.9362/ [0.78571429 0.97435897 0.93617021]
Test acc/f1/spec/sens = 0.4034 / 0.3504 / 0.8279 / 0.4138/ [0.05732484 1.         0.4137931 ]
>> Finished.
Acc, agreement for latest model:  0.40336134453781514 0.46638655462184875 [0.05732484 1.         0.4137931 ]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4180672268907563 0.45588235294117646 [0.21656051 0.7816092  0.41810345]
Trial 3/1 || Cycle 4/5 || Label set size 720 || Test acc 0.4181 || Test agreement 0.4559 || Spec 0.6148 || Sens 0.4181 Class Acc: [0.21656051 0.7816092  0.41810345]
**************************************************************************************************** 

  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:01<00:08,  1.68s/it] 50%|█████     | 3/6 [00:01<00:01,  2.03it/s] 83%|████████▎ | 5/6 [00:02<00:00,  2.02it/s]100%|██████████| 6/6 [00:03<00:00,  1.93it/s]
labeled set:  900
unlabeled set:  533
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.68it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.90it/s] 75%|███████▌  | 9/12 [00:00<00:00, 14.56it/s]100%|██████████| 12/12 [00:01<00:00, 11.05it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 8, 1: 87, 2: 85}
Validation set distribution: 
Number of samples  100
{0: 14, 1: 39, 2: 47}
Labeled set distribution: 
Number of samples  900
{0: 215, 1: 325, 2: 360}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.3088, agreement = 0.2773, f1 = 0.1888, spec = 0.9672, sens = 0.0129 Class Acc: [0.89171975 0.04597701 0.01293103]
Initial model on validation dataset: acc = 0.2200, agreement = 0.2200, f1 = 0.2098, spec = 1.0000, sens = 0.0426 Class Acc: [0.92857143 0.17948718 0.04255319]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:14,  3.78s/it]  2%|▏         | 2/100 [00:08<07:12,  4.41s/it]  3%|▎         | 3/100 [00:12<06:39,  4.11s/it]  4%|▍         | 4/100 [00:17<07:13,  4.52s/it]  5%|▌         | 5/100 [00:25<09:18,  5.88s/it]Epoch 5: Train acc/f1 = 0.7900 / 0.7783 / 0.9778 / 0.7056/ [0.75348837 0.90769231 0.70555556] 
                Val acc/f1/spec/sens = 0.8900 / 0.8453 / 0.9623 / 0.9149/ [0.71428571 0.92307692 0.91489362]
                Test acc/f1/spec/sens = 0.2206 / 0.1846 / 0.9631 / 0.0345/ [0.06369427 1.         0.03448276]
  6%|▌         | 6/100 [00:30<08:48,  5.63s/it]  7%|▋         | 7/100 [00:34<07:44,  4.99s/it]  8%|▊         | 8/100 [00:39<07:35,  4.95s/it]  9%|▉         | 9/100 [00:43<06:54,  4.56s/it] 10%|█         | 10/100 [00:52<09:10,  6.12s/it]Epoch 10: Train acc/f1 = 0.8389 / 0.8112 / 0.9222 / 0.9111/ [0.54883721 0.95076923 0.91111111] 
                Val acc/f1/spec/sens = 0.8700 / 0.7480 / 0.9245 / 0.9362/ [0.28571429 1.         0.93617021]
                Test acc/f1/spec/sens = 0.5672 / 0.4687 / 0.9385 / 0.7543/ [0.05095541 1.         0.75431034]
 11%|█         | 11/100 [00:56<08:00,  5.40s/it] 12%|█▏        | 12/100 [01:01<07:43,  5.27s/it] 13%|█▎        | 13/100 [01:05<06:59,  4.82s/it] 14%|█▍        | 14/100 [01:10<06:54,  4.82s/it] 15%|█▌        | 15/100 [01:18<08:15,  5.83s/it]Epoch 15: Train acc/f1 = 0.9322 / 0.9283 / 0.9963 / 0.8972/ [0.95348837 0.95692308 0.89722222] 
                Val acc/f1/spec/sens = 0.8700 / 0.8111 / 0.9811 / 0.8936/ [0.64285714 0.92307692 0.89361702]
                Test acc/f1/spec/sens = 0.2647 / 0.2536 / 0.9672 / 0.1078/ [0.08917197 1.         0.10775862]
 16%|█▌        | 16/100 [01:23<07:51,  5.62s/it] 17%|█▋        | 17/100 [01:27<06:57,  5.03s/it] 18%|█▊        | 18/100 [01:31<06:46,  4.96s/it] 19%|█▉        | 19/100 [01:35<06:09,  4.56s/it] 20%|██        | 20/100 [01:44<07:59,  5.99s/it]Epoch 20: Train acc/f1 = 0.7667 / 0.7684 / 0.9963 / 0.7306/ [1.         0.65230769 0.73055556] 
                Val acc/f1/spec/sens = 0.7500 / 0.7287 / 1.0000 / 0.7234/ [1.         0.69230769 0.72340426]
                Test acc/f1/spec/sens = 0.3550 / 0.3188 / 1.0000 / 0.0172/ [0.70063694 0.63218391 0.01724138]
 21%|██        | 21/100 [01:48<06:57,  5.28s/it] 22%|██▏       | 22/100 [01:53<06:46,  5.22s/it] 23%|██▎       | 23/100 [01:57<06:04,  4.74s/it] 24%|██▍       | 24/100 [02:02<06:02,  4.77s/it] 25%|██▌       | 25/100 [02:10<07:16,  5.82s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9154 / 0.9811 / 0.9362/ [0.85714286 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4286 / 0.3797 / 0.9672 / 0.4612/ [0.06369427 1.         0.4612069 ]
 26%|██▌       | 26/100 [02:15<06:47,  5.50s/it] 27%|██▋       | 27/100 [02:18<06:01,  4.95s/it] 28%|██▊       | 28/100 [02:23<05:52,  4.90s/it] 29%|██▉       | 29/100 [02:27<05:21,  4.53s/it] 30%|███       | 30/100 [02:36<07:00,  6.01s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9052 / 1.0000 / 0.9362/ [0.78571429 1.         0.93617021]
                Test acc/f1/spec/sens = 0.3971 / 0.3557 / 0.9795 / 0.4009/ [0.05732484 1.         0.40086207]
 31%|███       | 31/100 [02:40<06:05,  5.29s/it] 32%|███▏      | 32/100 [02:44<05:48,  5.12s/it] 33%|███▎      | 33/100 [02:48<05:12,  4.66s/it] 34%|███▍      | 34/100 [02:53<05:10,  4.71s/it] 35%|███▌      | 35/100 [03:01<06:16,  5.79s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9114 / 0.9623 / 0.9574/ [0.78571429 0.97435897 0.95744681]
                Test acc/f1/spec/sens = 0.4454 / 0.3909 / 0.9672 / 0.5000/ [0.05732484 1.         0.5       ]
 36%|███▌      | 36/100 [03:06<05:54,  5.53s/it] 37%|███▋      | 37/100 [03:10<05:13,  4.97s/it] 38%|███▊      | 38/100 [03:15<05:06,  4.95s/it] 39%|███▉      | 39/100 [03:18<04:38,  4.57s/it] 40%|████      | 40/100 [03:28<06:04,  6.08s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9161 / 0.9623 / 0.9362/ [0.85714286 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4286 / 0.3807 / 0.9672 / 0.4655/ [0.05732484 1.         0.46551724]
 41%|████      | 41/100 [03:32<05:19,  5.41s/it] 42%|████▏     | 42/100 [03:37<05:04,  5.25s/it] 43%|████▎     | 43/100 [03:40<04:33,  4.80s/it] 44%|████▍     | 44/100 [03:45<04:30,  4.82s/it] 45%|████▌     | 45/100 [03:54<05:22,  5.87s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8980 / 0.9623 / 0.9362/ [0.78571429 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.3950 / 0.3554 / 0.9672 / 0.3966/ [0.05732484 1.         0.39655172]
 46%|████▌     | 46/100 [03:59<05:05,  5.66s/it] 47%|████▋     | 47/100 [04:02<04:27,  5.05s/it] 48%|████▊     | 48/100 [04:07<04:19,  5.00s/it] 49%|████▉     | 49/100 [04:11<03:55,  4.62s/it] 50%|█████     | 50/100 [04:20<05:02,  6.06s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9296 / 0.9623 / 0.9574/ [0.85714286 0.97435897 0.95744681]
                Test acc/f1/spec/sens = 0.4370 / 0.3918 / 0.9590 / 0.4871/ [0.05095541 1.         0.48706897]
 51%|█████     | 51/100 [04:24<04:21,  5.34s/it] 52%|█████▏    | 52/100 [04:29<04:08,  5.18s/it] 53%|█████▎    | 53/100 [04:33<03:41,  4.71s/it] 54%|█████▍    | 54/100 [04:37<03:38,  4.75s/it] 55%|█████▌    | 55/100 [04:46<04:23,  5.86s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9161 / 0.9623 / 0.9362/ [0.85714286 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4391 / 0.3890 / 0.9672 / 0.4871/ [0.05732484 1.         0.48706897]
 56%|█████▌    | 56/100 [04:51<04:05,  5.57s/it] 57%|█████▋    | 57/100 [04:55<03:36,  5.04s/it] 58%|█████▊    | 58/100 [04:59<03:27,  4.95s/it] 59%|█████▉    | 59/100 [05:03<03:06,  4.56s/it] 60%|██████    | 60/100 [05:12<03:59,  5.99s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9161 / 0.9623 / 0.9362/ [0.85714286 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4160 / 0.3827 / 0.9631 / 0.4353/ [0.06369427 1.         0.43534483]
 61%|██████    | 61/100 [05:16<03:27,  5.33s/it] 62%|██████▏   | 62/100 [05:21<03:17,  5.20s/it] 63%|██████▎   | 63/100 [05:25<03:02,  4.93s/it] 64%|██████▍   | 64/100 [05:30<02:58,  4.96s/it] 65%|██████▌   | 65/100 [05:39<03:31,  6.04s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9161 / 0.9623 / 0.9362/ [0.85714286 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4454 / 0.4119 / 0.9590 / 0.4784/ [0.08917197 1.         0.47844828]
 66%|██████▌   | 66/100 [05:44<03:15,  5.75s/it] 67%|██████▋   | 67/100 [05:48<02:49,  5.13s/it] 68%|██████▊   | 68/100 [05:52<02:41,  5.03s/it] 69%|██████▉   | 69/100 [05:56<02:24,  4.65s/it] 70%|███████   | 70/100 [06:06<03:04,  6.14s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9161 / 0.9623 / 0.9362/ [0.85714286 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4349 / 0.3882 / 0.9672 / 0.4784/ [0.05732484 1.         0.47844828]
 71%|███████   | 71/100 [06:09<02:36,  5.40s/it] 72%|███████▏  | 72/100 [06:14<02:27,  5.26s/it] 73%|███████▎  | 73/100 [06:18<02:09,  4.80s/it] 74%|███████▍  | 74/100 [06:23<02:04,  4.81s/it] 75%|███████▌  | 75/100 [06:31<02:27,  5.89s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8659 / 0.9811 / 0.9149/ [0.71428571 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.4391 / 0.3858 / 0.9672 / 0.4871/ [0.05732484 1.         0.48706897]
 76%|███████▌  | 76/100 [06:36<02:13,  5.58s/it] 77%|███████▋  | 77/100 [06:40<01:55,  5.03s/it] 78%|███████▊  | 78/100 [06:45<01:49,  4.96s/it] 79%|███████▉  | 79/100 [06:49<01:36,  4.60s/it] 80%|████████  | 80/100 [06:58<01:59,  5.97s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8785 / 0.9811 / 0.9362/ [0.71428571 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.4454 / 0.3908 / 0.9672 / 0.5000/ [0.05732484 1.         0.5       ]
 81%|████████  | 81/100 [07:01<01:39,  5.24s/it] 82%|████████▏ | 82/100 [07:06<01:31,  5.09s/it] 83%|████████▎ | 83/100 [07:10<01:19,  4.66s/it] 84%|████████▍ | 84/100 [07:14<01:14,  4.68s/it] 85%|████████▌ | 85/100 [07:23<01:26,  5.74s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9161 / 0.9623 / 0.9362/ [0.85714286 0.97435897 0.93617021]
                Test acc/f1/spec/sens = 0.3676 / 0.3429 / 0.9713 / 0.3319/ [0.07006369 1.         0.33189655]
 86%|████████▌ | 86/100 [07:27<01:15,  5.42s/it] 87%|████████▋ | 87/100 [07:31<01:04,  4.93s/it] 88%|████████▊ | 88/100 [07:36<00:58,  4.87s/it] 89%|████████▉ | 89/100 [07:39<00:49,  4.49s/it] 90%|█████████ | 90/100 [07:49<00:59,  5.91s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9030 / 0.9623 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.4223 / 0.3783 / 0.9672 / 0.4526/ [0.05732484 1.         0.45258621]
 91%|█████████ | 91/100 [07:52<00:47,  5.23s/it] 92%|█████████▏| 92/100 [07:57<00:40,  5.08s/it] 93%|█████████▎| 93/100 [08:01<00:32,  4.64s/it] 94%|█████████▍| 94/100 [08:05<00:28,  4.69s/it] 95%|█████████▌| 95/100 [08:14<00:28,  5.74s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9030 / 0.9623 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.4685 / 0.4196 / 0.9631 / 0.5431/ [0.06369427 1.         0.54310345]
 96%|█████████▌| 96/100 [08:18<00:21,  5.47s/it] 97%|█████████▋| 97/100 [08:22<00:14,  4.93s/it] 98%|█████████▊| 98/100 [08:27<00:09,  4.87s/it] 99%|█████████▉| 99/100 [08:30<00:04,  4.50s/it]100%|██████████| 100/100 [08:40<00:00,  5.96s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9030 / 0.9623 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.4307 / 0.3839 / 0.9672 / 0.4698/ [0.05732484 1.         0.46982759]
Trial 4, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9300 / 0.9030 / 0.9623 / 0.9149/ [0.85714286 0.97435897 0.91489362]
Test acc/f1/spec/sens = 0.4307 / 0.3839 / 0.9672 / 0.4698/ [0.05732484 1.         0.46982759]
>> Finished.
Acc, agreement for latest model:  0.43067226890756305 0.49789915966386555 [0.05732484 1.         0.46982759]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4726890756302521 0.542016806722689 [0.05095541 1.         0.56034483]
Trial 3/1 || Cycle 5/5 || Label set size 900 || Test acc 0.4727 || Test agreement 0.5420 || Spec 0.9549 || Sens 0.5603 Class Acc: [0.05095541 1.         0.56034483]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.64it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.79it/s] 75%|███████▌  | 9/12 [00:00<00:00, 12.21it/s]100%|██████████| 12/12 [00:01<00:00, 10.11it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:04,  1.47it/s] 71%|███████▏  | 5/7 [00:00<00:00,  7.15it/s]100%|██████████| 7/7 [00:01<00:00,  5.93it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.1680, -1.1900, -1.1579]), tensor([0.8611, 0.8568, 0.8641]))
Val set stats: mean/std =  (tensor([-1.2523, -1.2622, -1.2478]), tensor([0.8507, 0.8474, 0.8527]))
Validation set distribution: 
Number of samples  100
{0: 18, 1: 32, 2: 50}
Labeled set distribution: 
Number of samples  180
{0: 30, 1: 88, 2: 62}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2353, agreement = 0.2164, f1 = 0.2230, spec = 0.5410, sens = 0.2716 Class Acc: [0.1656051  0.26436782 0.27155172]
Initial model on validation dataset: acc = 0.2900, agreement = 0.2900, f1 = 0.1510, spec = 0.9200, sens = 0.0000 Class Acc: [0.      0.90625 0.     ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:19,  1.41s/it]  2%|▏         | 2/100 [00:04<03:37,  2.22s/it]  3%|▎         | 3/100 [00:05<02:59,  1.86s/it]  4%|▍         | 4/100 [00:08<03:38,  2.27s/it]  5%|▌         | 5/100 [00:12<04:26,  2.81s/it]Epoch 5: Train acc/f1 = 0.8667 / 0.7587 / 0.8898 / 0.9839/ [0.3        0.97727273 0.98387097] 
                Val acc/f1/spec/sens = 0.8100 / 0.6964 / 0.7400 / 0.9800/ [0.22222222 0.875      0.98      ]
                Test acc/f1/spec/sens = 0.6597 / 0.5979 / 0.7582 / 0.8664/ [0.22929936 0.88505747 0.86637931]
  6%|▌         | 6/100 [00:15<04:28,  2.86s/it]  7%|▋         | 7/100 [00:16<03:41,  2.38s/it]  8%|▊         | 8/100 [00:19<03:41,  2.41s/it]  9%|▉         | 9/100 [00:20<03:12,  2.11s/it] 10%|█         | 10/100 [00:25<04:28,  2.98s/it]Epoch 10: Train acc/f1 = 0.9444 / 0.9250 / 1.0000 / 0.9032/ [0.93333333 0.97727273 0.90322581] 
                Val acc/f1/spec/sens = 0.7800 / 0.7742 / 1.0000 / 0.6800/ [1.     0.8125 0.68  ]
                Test acc/f1/spec/sens = 0.1891 / 0.1838 / 1.0000 / 0.0560/ [0.1910828  0.54022989 0.05603448]
 11%|█         | 11/100 [00:26<03:41,  2.49s/it] 12%|█▏        | 12/100 [00:29<03:41,  2.52s/it] 13%|█▎        | 13/100 [00:30<03:11,  2.20s/it] 14%|█▍        | 14/100 [00:33<03:27,  2.41s/it] 15%|█▌        | 15/100 [00:37<03:57,  2.80s/it]Epoch 15: Train acc/f1 = 0.8944 / 0.8542 / 0.9322 / 1.0000/ [0.63333333 0.90909091 1.        ] 
                Val acc/f1/spec/sens = 0.8700 / 0.8499 / 0.9400 / 0.8400/ [0.83333333 0.9375     0.84      ]
                Test acc/f1/spec/sens = 0.3382 / 0.3211 / 0.7910 / 0.3922/ [0.07006369 0.67816092 0.39224138]
 16%|█▌        | 16/100 [00:40<03:47,  2.71s/it] 17%|█▋        | 17/100 [00:41<03:12,  2.32s/it] 18%|█▊        | 18/100 [00:44<03:16,  2.40s/it] 19%|█▉        | 19/100 [00:45<02:50,  2.10s/it] 20%|██        | 20/100 [00:50<03:52,  2.91s/it]Epoch 20: Train acc/f1 = 0.9722 / 0.9655 / 0.9915 / 0.9839/ [0.96666667 0.96590909 0.98387097] 
                Val acc/f1/spec/sens = 0.8200 / 0.8033 / 0.9400 / 0.8000/ [0.88888889 0.8125     0.8       ]
                Test acc/f1/spec/sens = 0.3256 / 0.3253 / 0.9754 / 0.1552/ [0.24203822 0.93103448 0.15517241]
 21%|██        | 21/100 [00:51<03:16,  2.48s/it] 22%|██▏       | 22/100 [00:54<03:15,  2.51s/it] 23%|██▎       | 23/100 [00:55<02:47,  2.18s/it] 24%|██▍       | 24/100 [00:58<02:54,  2.30s/it] 25%|██▌       | 25/100 [01:02<03:24,  2.73s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8338 / 0.9400 / 0.8200/ [0.88888889 0.875      0.82      ]
                Test acc/f1/spec/sens = 0.4580 / 0.4356 / 0.9016 / 0.4310/ [0.19745223 1.         0.43103448]
 26%|██▌       | 26/100 [01:04<03:18,  2.69s/it] 27%|██▋       | 27/100 [01:06<02:49,  2.33s/it] 28%|██▊       | 28/100 [01:08<02:51,  2.39s/it] 29%|██▉       | 29/100 [01:10<02:28,  2.09s/it] 30%|███       | 30/100 [01:14<03:26,  2.94s/it]Epoch 30: Train acc/f1 = 0.9889 / 0.9854 / 1.0000 / 1.0000/ [1.         0.97727273 1.        ] 
                Val acc/f1/spec/sens = 0.8600 / 0.8427 / 0.9600 / 0.8200/ [0.88888889 0.90625    0.82      ]
                Test acc/f1/spec/sens = 0.5693 / 0.5275 / 0.8566 / 0.6466/ [0.21656051 1.         0.64655172]
 31%|███       | 31/100 [01:16<02:51,  2.49s/it] 32%|███▏      | 32/100 [01:18<02:50,  2.51s/it] 33%|███▎      | 33/100 [01:20<02:26,  2.18s/it] 34%|███▍      | 34/100 [01:22<02:32,  2.31s/it] 35%|███▌      | 35/100 [01:26<02:58,  2.75s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8280 / 0.9600 / 0.8200/ [0.83333333 0.90625    0.82      ]
                Test acc/f1/spec/sens = 0.5441 / 0.4705 / 0.8320 / 0.6767/ [0.0955414  1.         0.67672414]
 36%|███▌      | 36/100 [01:29<02:52,  2.70s/it] 37%|███▋      | 37/100 [01:30<02:25,  2.31s/it] 38%|███▊      | 38/100 [01:33<02:26,  2.36s/it] 39%|███▉      | 39/100 [01:34<02:06,  2.07s/it] 40%|████      | 40/100 [01:39<02:55,  2.92s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8300 / 0.7975 / 0.9600 / 0.8200/ [0.72222222 0.90625    0.82      ]
                Test acc/f1/spec/sens = 0.3845 / 0.3792 / 0.8893 / 0.2716/ [0.21019108 1.         0.27155172]
 41%|████      | 41/100 [01:40<02:26,  2.48s/it] 42%|████▏     | 42/100 [01:43<02:25,  2.50s/it] 43%|████▎     | 43/100 [01:44<02:03,  2.16s/it] 44%|████▍     | 44/100 [01:47<02:07,  2.27s/it] 45%|████▌     | 45/100 [01:51<02:27,  2.69s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8309 / 0.9600 / 0.8600/ [0.77777778 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.3697 / 0.3580 / 0.9098 / 0.2672/ [0.17197452 1.         0.26724138]
 46%|████▌     | 46/100 [01:53<02:23,  2.65s/it] 47%|████▋     | 47/100 [01:55<02:00,  2.27s/it] 48%|████▊     | 48/100 [01:57<02:02,  2.36s/it] 49%|████▉     | 49/100 [01:59<01:45,  2.08s/it] 50%|█████     | 50/100 [02:03<02:26,  2.92s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7992 / 0.9600 / 0.8600/ [0.66666667 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.4181 / 0.4045 / 0.8852 / 0.3534/ [0.1910828  1.         0.35344828]
 51%|█████     | 51/100 [02:05<02:01,  2.48s/it] 52%|█████▏    | 52/100 [02:07<02:00,  2.50s/it] 53%|█████▎    | 53/100 [02:09<01:42,  2.18s/it] 54%|█████▍    | 54/100 [02:11<01:45,  2.29s/it] 55%|█████▌    | 55/100 [02:15<02:02,  2.73s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8152 / 0.9600 / 0.8600/ [0.72222222 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.4244 / 0.4079 / 0.8566 / 0.3836/ [0.1656051  1.         0.38362069]
 56%|█████▌    | 56/100 [02:18<01:57,  2.68s/it] 57%|█████▋    | 57/100 [02:19<01:39,  2.31s/it] 58%|█████▊    | 58/100 [02:22<01:40,  2.39s/it] 59%|█████▉    | 59/100 [02:23<01:25,  2.09s/it] 60%|██████    | 60/100 [02:28<01:57,  2.93s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7992 / 0.9600 / 0.8600/ [0.66666667 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.3761 / 0.3692 / 0.8730 / 0.2974/ [0.17197452 0.95402299 0.29741379]
 61%|██████    | 61/100 [02:29<01:36,  2.48s/it] 62%|██████▏   | 62/100 [02:32<01:35,  2.52s/it] 63%|██████▎   | 63/100 [02:33<01:20,  2.19s/it] 64%|██████▍   | 64/100 [02:36<01:22,  2.29s/it] 65%|██████▌   | 65/100 [02:40<01:35,  2.72s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7992 / 0.9600 / 0.8600/ [0.66666667 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.3761 / 0.3644 / 0.8893 / 0.2888/ [0.15923567 1.         0.2887931 ]
 66%|██████▌   | 66/100 [02:42<01:30,  2.67s/it] 67%|██████▋   | 67/100 [02:44<01:15,  2.30s/it] 68%|██████▊   | 68/100 [02:46<01:16,  2.38s/it] 69%|██████▉   | 69/100 [02:48<01:05,  2.11s/it] 70%|███████   | 70/100 [02:53<01:28,  2.95s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7992 / 0.9600 / 0.8600/ [0.66666667 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.3718 / 0.3604 / 0.8852 / 0.2888/ [0.14649682 1.         0.2887931 ]
 71%|███████   | 71/100 [02:54<01:11,  2.48s/it] 72%|███████▏  | 72/100 [02:57<01:10,  2.50s/it] 73%|███████▎  | 73/100 [02:58<00:58,  2.17s/it] 74%|███████▍  | 74/100 [03:00<00:58,  2.26s/it] 75%|███████▌  | 75/100 [03:04<01:08,  2.72s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7992 / 0.9600 / 0.8600/ [0.66666667 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.4349 / 0.4076 / 0.8893 / 0.4181/ [0.14649682 1.         0.41810345]
 76%|███████▌  | 76/100 [03:07<01:04,  2.68s/it] 77%|███████▋  | 77/100 [03:08<00:53,  2.31s/it] 78%|███████▊  | 78/100 [03:11<00:52,  2.37s/it] 79%|███████▉  | 79/100 [03:12<00:43,  2.09s/it] 80%|████████  | 80/100 [03:17<00:58,  2.94s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7992 / 0.9600 / 0.8600/ [0.66666667 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.3634 / 0.3507 / 0.9016 / 0.2672/ [0.15286624 1.         0.26724138]
 81%|████████  | 81/100 [03:19<00:47,  2.48s/it] 82%|████████▏ | 82/100 [03:21<00:45,  2.50s/it] 83%|████████▎ | 83/100 [03:23<00:37,  2.19s/it] 84%|████████▍ | 84/100 [03:25<00:37,  2.32s/it] 85%|████████▌ | 85/100 [03:29<00:41,  2.77s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8300 / 0.7904 / 0.9600 / 0.8400/ [0.66666667 0.90625    0.84      ]
                Test acc/f1/spec/sens = 0.3950 / 0.3857 / 0.8730 / 0.3276/ [0.17834395 0.96551724 0.32758621]
 86%|████████▌ | 86/100 [03:32<00:38,  2.71s/it] 87%|████████▋ | 87/100 [03:33<00:30,  2.31s/it] 88%|████████▊ | 88/100 [03:36<00:28,  2.39s/it] 89%|████████▉ | 89/100 [03:37<00:23,  2.09s/it] 90%|█████████ | 90/100 [03:42<00:29,  2.93s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7992 / 0.9600 / 0.8600/ [0.66666667 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.3887 / 0.3734 / 0.8811 / 0.3190/ [0.15286624 1.         0.31896552]
 91%|█████████ | 91/100 [03:43<00:22,  2.49s/it] 92%|█████████▏| 92/100 [03:46<00:19,  2.48s/it] 93%|█████████▎| 93/100 [03:47<00:15,  2.19s/it] 94%|█████████▍| 94/100 [03:50<00:13,  2.30s/it] 95%|█████████▌| 95/100 [03:54<00:13,  2.76s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7992 / 0.9600 / 0.8600/ [0.66666667 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.3718 / 0.3604 / 0.8689 / 0.2845/ [0.15286624 1.         0.28448276]
 96%|█████████▌| 96/100 [03:56<00:10,  2.69s/it] 97%|█████████▋| 97/100 [03:58<00:06,  2.29s/it] 98%|█████████▊| 98/100 [04:00<00:04,  2.39s/it] 99%|█████████▉| 99/100 [04:02<00:02,  2.08s/it]100%|██████████| 100/100 [04:06<00:00,  2.91s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7992 / 0.9600 / 0.8600/ [0.66666667 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.3887 / 0.3685 / 0.8934 / 0.3362/ [0.12738854 1.         0.3362069 ]
Trial 5, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8400 / 0.7992 / 0.9600 / 0.8600/ [0.66666667 0.90625    0.86      ]
Test acc/f1/spec/sens = 0.3887 / 0.3685 / 0.8934 / 0.3362/ [0.12738854 1.         0.3362069 ]
>> Finished.
Acc, agreement for latest model:  0.38865546218487396 0.43907563025210083 [0.12738854 1.         0.3362069 ]
Load best checkpoint for thief model
Acc, agreement for best model:  0.5294117647058824 0.5903361344537815 [0.42675159 0.73563218 0.52155172]
Trial 4/1 || Cycle 1/5 || Label set size 180 || Test acc 0.5294 || Test agreement 0.5903 || Spec 0.8402 || Sens 0.5216 Class Acc: [0.42675159 0.73563218 0.52155172]
**************************************************************************************************** 

  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:15,  1.74s/it] 20%|██        | 2/10 [00:01<00:06,  1.20it/s] 40%|████      | 4/10 [00:02<00:02,  2.78it/s] 50%|█████     | 5/10 [00:03<00:02,  1.74it/s] 60%|██████    | 6/10 [00:03<00:01,  2.28it/s] 80%|████████  | 8/10 [00:03<00:00,  3.75it/s] 90%|█████████ | 9/10 [00:04<00:00,  2.07it/s]100%|██████████| 10/10 [00:04<00:00,  2.07it/s]
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.46it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.37it/s] 50%|█████     | 6/12 [00:00<00:00,  8.08it/s] 75%|███████▌  | 9/12 [00:01<00:00, 11.95it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.50it/s]100%|██████████| 12/12 [00:01<00:00,  8.09it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 64, 1: 55, 2: 61}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 32, 2: 50}
Labeled set distribution: 
Number of samples  360
{0: 94, 1: 143, 2: 123}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2353, agreement = 0.2164, f1 = 0.1655, spec = 0.5410, sens = 0.1293 Class Acc: [0.52229299 0.         0.12931034]
Initial model on validation dataset: acc = 0.2700, agreement = 0.2700, f1 = 0.2626, spec = 0.9200, sens = 0.1600 Class Acc: [0.77777778 0.15625    0.16      ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<03:14,  1.97s/it]  2%|▏         | 2/100 [00:05<04:38,  2.84s/it]  3%|▎         | 3/100 [00:07<04:02,  2.50s/it]  4%|▍         | 4/100 [00:10<04:22,  2.73s/it]  5%|▌         | 5/100 [00:15<05:39,  3.57s/it]Epoch 5: Train acc/f1 = 0.7000 / 0.6983 / 0.9747 / 0.5122/ [0.91489362 0.72027972 0.51219512] 
                Val acc/f1/spec/sens = 0.8100 / 0.6945 / 0.8000 / 0.9400/ [0.22222222 0.9375     0.94      ]
                Test acc/f1/spec/sens = 0.3298 / 0.3393 / 0.9221 / 0.0776/ [0.42038217 0.83908046 0.07758621]
  6%|▌         | 6/100 [00:19<05:33,  3.55s/it]  7%|▋         | 7/100 [00:21<04:45,  3.07s/it]  8%|▊         | 8/100 [00:24<04:45,  3.11s/it]  9%|▉         | 9/100 [00:26<04:11,  2.76s/it] 10%|█         | 10/100 [00:33<05:55,  3.95s/it]Epoch 10: Train acc/f1 = 0.8889 / 0.8839 / 0.9789 / 0.9187/ [0.85106383 0.88811189 0.91869919] 
                Val acc/f1/spec/sens = 0.8900 / 0.8749 / 0.9400 / 0.8600/ [0.83333333 0.96875    0.86      ]
                Test acc/f1/spec/sens = 0.2164 / 0.2193 / 0.9467 / 0.0474/ [0.07006369 0.93103448 0.04741379]
 11%|█         | 11/100 [00:35<05:00,  3.38s/it] 12%|█▏        | 12/100 [00:38<05:03,  3.45s/it] 13%|█▎        | 13/100 [00:40<04:24,  3.04s/it] 14%|█▍        | 14/100 [00:44<04:26,  3.10s/it] 15%|█▌        | 15/100 [00:49<05:17,  3.73s/it]Epoch 15: Train acc/f1 = 0.9306 / 0.9239 / 0.9494 / 0.9756/ [0.80851064 0.97202797 0.97560976] 
                Val acc/f1/spec/sens = 0.8900 / 0.8660 / 0.9400 / 0.8800/ [0.77777778 0.96875    0.88      ]
                Test acc/f1/spec/sens = 0.2857 / 0.2625 / 0.9672 / 0.2026/ [0.02547771 0.97701149 0.20258621]
 16%|█▌        | 16/100 [00:52<04:59,  3.57s/it] 17%|█▋        | 17/100 [00:54<04:18,  3.11s/it] 18%|█▊        | 18/100 [00:57<04:19,  3.16s/it] 19%|█▉        | 19/100 [00:59<03:50,  2.85s/it] 20%|██        | 20/100 [01:06<05:13,  3.92s/it]Epoch 20: Train acc/f1 = 0.7389 / 0.7258 / 1.0000 / 0.4715/ [0.74468085 0.96503497 0.47154472] 
                Val acc/f1/spec/sens = 0.6200 / 0.6167 / 0.9800 / 0.4400/ [0.72222222 0.84375    0.44      ]
                Test acc/f1/spec/sens = 0.2038 / 0.1745 / 1.0000 / 0.0259/ [0.07006369 0.91954023 0.02586207]
 21%|██        | 21/100 [01:08<04:24,  3.34s/it] 22%|██▏       | 22/100 [01:11<04:18,  3.32s/it] 23%|██▎       | 23/100 [01:13<03:45,  2.93s/it] 24%|██▍       | 24/100 [01:16<03:50,  3.04s/it] 25%|██▌       | 25/100 [01:22<04:34,  3.66s/it]Epoch 25: Train acc/f1 = 0.9972 / 0.9971 / 1.0000 / 1.0000/ [0.9893617 1.        1.       ] 
                Val acc/f1/spec/sens = 0.9000 / 0.8840 / 0.9600 / 0.9000/ [0.94444444 0.875      0.9       ]
                Test acc/f1/spec/sens = 0.2374 / 0.2300 / 0.9508 / 0.0905/ [0.07006369 0.93103448 0.09051724]
 26%|██▌       | 26/100 [01:25<04:29,  3.64s/it] 27%|██▋       | 27/100 [01:27<03:50,  3.16s/it] 28%|██▊       | 28/100 [01:30<03:46,  3.14s/it] 29%|██▉       | 29/100 [01:32<03:18,  2.80s/it] 30%|███       | 30/100 [01:39<04:32,  3.89s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8813 / 0.9600 / 0.9000/ [0.88888889 0.90625    0.9       ]
                Test acc/f1/spec/sens = 0.2332 / 0.2234 / 0.9508 / 0.0862/ [0.06369427 0.93103448 0.0862069 ]
 31%|███       | 31/100 [01:41<03:50,  3.34s/it] 32%|███▏      | 32/100 [01:44<03:45,  3.32s/it] 33%|███▎      | 33/100 [01:46<03:16,  2.93s/it] 34%|███▍      | 34/100 [01:49<03:18,  3.01s/it] 35%|███▌      | 35/100 [01:54<03:55,  3.62s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8813 / 0.9600 / 0.9000/ [0.88888889 0.90625    0.9       ]
                Test acc/f1/spec/sens = 0.2311 / 0.2213 / 0.9508 / 0.0776/ [0.07006369 0.93103448 0.07758621]
 36%|███▌      | 36/100 [01:57<03:41,  3.46s/it] 37%|███▋      | 37/100 [02:00<03:13,  3.07s/it] 38%|███▊      | 38/100 [02:03<03:11,  3.09s/it] 39%|███▉      | 39/100 [02:05<02:48,  2.77s/it] 40%|████      | 40/100 [02:11<03:50,  3.84s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8861 / 0.9600 / 0.8800/ [0.94444444 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.2374 / 0.2301 / 0.9426 / 0.0905/ [0.07006369 0.93103448 0.09051724]
 41%|████      | 41/100 [02:13<03:13,  3.28s/it] 42%|████▏     | 42/100 [02:16<03:09,  3.27s/it] 43%|████▎     | 43/100 [02:18<02:44,  2.89s/it] 44%|████▍     | 44/100 [02:21<02:47,  3.00s/it] 45%|████▌     | 45/100 [02:27<03:19,  3.62s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8861 / 0.9600 / 0.8800/ [0.94444444 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.2332 / 0.2261 / 0.9508 / 0.0862/ [0.06369427 0.93103448 0.0862069 ]
 46%|████▌     | 46/100 [02:30<03:08,  3.49s/it] 47%|████▋     | 47/100 [02:32<02:43,  3.08s/it] 48%|████▊     | 48/100 [02:35<02:41,  3.11s/it] 49%|████▉     | 49/100 [02:37<02:28,  2.91s/it] 50%|█████     | 50/100 [02:44<03:17,  3.95s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8861 / 0.9600 / 0.8800/ [0.94444444 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.2353 / 0.2291 / 0.9508 / 0.0819/ [0.07643312 0.93103448 0.08189655]
 51%|█████     | 51/100 [02:46<02:45,  3.38s/it] 52%|█████▏    | 52/100 [02:49<02:39,  3.33s/it] 53%|█████▎    | 53/100 [02:51<02:20,  2.99s/it] 54%|█████▍    | 54/100 [02:55<02:20,  3.05s/it] 55%|█████▌    | 55/100 [03:00<02:46,  3.70s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8861 / 0.9600 / 0.8800/ [0.94444444 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.2311 / 0.2179 / 0.9508 / 0.0776/ [0.06369427 0.94252874 0.07758621]
 56%|█████▌    | 56/100 [03:03<02:37,  3.57s/it] 57%|█████▋    | 57/100 [03:05<02:15,  3.14s/it] 58%|█████▊    | 58/100 [03:08<02:13,  3.18s/it] 59%|█████▉    | 59/100 [03:11<01:57,  2.86s/it] 60%|██████    | 60/100 [03:17<02:36,  3.92s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8961 / 0.9600 / 0.9000/ [0.94444444 0.90625    0.9       ]
                Test acc/f1/spec/sens = 0.2374 / 0.2281 / 0.9508 / 0.0862/ [0.07643312 0.93103448 0.0862069 ]
 61%|██████    | 61/100 [03:19<02:12,  3.39s/it] 62%|██████▏   | 62/100 [03:22<02:08,  3.38s/it] 63%|██████▎   | 63/100 [03:25<01:50,  2.99s/it] 64%|██████▍   | 64/100 [03:28<01:53,  3.15s/it] 65%|██████▌   | 65/100 [03:33<02:13,  3.82s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8813 / 0.9600 / 0.9000/ [0.88888889 0.90625    0.9       ]
                Test acc/f1/spec/sens = 0.2269 / 0.2125 / 0.9508 / 0.0647/ [0.07006369 0.94252874 0.06465517]
 66%|██████▌   | 66/100 [03:37<02:02,  3.61s/it] 67%|██████▋   | 67/100 [03:39<01:44,  3.16s/it] 68%|██████▊   | 68/100 [03:42<01:42,  3.19s/it] 69%|██████▉   | 69/100 [03:44<01:30,  2.91s/it] 70%|███████   | 70/100 [03:51<02:02,  4.09s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8714 / 0.9600 / 0.8800/ [0.88888889 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.2353 / 0.2260 / 0.9467 / 0.0905/ [0.06369427 0.93103448 0.09051724]
 71%|███████   | 71/100 [03:53<01:42,  3.53s/it] 72%|███████▏  | 72/100 [03:57<01:37,  3.48s/it] 73%|███████▎  | 73/100 [03:59<01:23,  3.10s/it] 74%|███████▍  | 74/100 [04:02<01:23,  3.19s/it] 75%|███████▌  | 75/100 [04:08<01:37,  3.90s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8714 / 0.9600 / 0.8800/ [0.88888889 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.2269 / 0.2160 / 0.9508 / 0.0690/ [0.07006369 0.93103448 0.06896552]
 76%|███████▌  | 76/100 [04:11<01:30,  3.77s/it] 77%|███████▋  | 77/100 [04:14<01:17,  3.36s/it] 78%|███████▊  | 78/100 [04:17<01:16,  3.46s/it] 79%|███████▉  | 79/100 [04:20<01:04,  3.08s/it] 80%|████████  | 80/100 [04:26<01:22,  4.11s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8714 / 0.9600 / 0.8800/ [0.88888889 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.2353 / 0.2272 / 0.9508 / 0.0819/ [0.07643312 0.93103448 0.08189655]
 81%|████████  | 81/100 [04:28<01:06,  3.52s/it] 82%|████████▏ | 82/100 [04:31<01:01,  3.44s/it] 83%|████████▎ | 83/100 [04:34<00:52,  3.11s/it] 84%|████████▍ | 84/100 [04:37<00:52,  3.26s/it] 85%|████████▌ | 85/100 [04:43<00:58,  3.93s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8714 / 0.9600 / 0.8800/ [0.88888889 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.2416 / 0.2373 / 0.9385 / 0.0862/ [0.0955414  0.91954023 0.0862069 ]
 86%|████████▌ | 86/100 [04:46<00:51,  3.71s/it] 87%|████████▋ | 87/100 [04:48<00:41,  3.21s/it] 88%|████████▊ | 88/100 [04:51<00:38,  3.18s/it] 89%|████████▉ | 89/100 [04:53<00:31,  2.88s/it] 90%|█████████ | 90/100 [05:00<00:38,  3.89s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8861 / 0.9600 / 0.8800/ [0.94444444 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.2332 / 0.2237 / 0.9508 / 0.0819/ [0.07006369 0.93103448 0.08189655]
 91%|█████████ | 91/100 [05:02<00:30,  3.34s/it] 92%|█████████▏| 92/100 [05:05<00:26,  3.27s/it] 93%|█████████▎| 93/100 [05:07<00:20,  2.89s/it] 94%|█████████▍| 94/100 [05:10<00:17,  2.97s/it] 95%|█████████▌| 95/100 [05:15<00:17,  3.59s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8861 / 0.9600 / 0.8800/ [0.94444444 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.2332 / 0.2246 / 0.9508 / 0.0733/ [0.08280255 0.93103448 0.07327586]
 96%|█████████▌| 96/100 [05:18<00:13,  3.47s/it] 97%|█████████▋| 97/100 [05:20<00:09,  3.03s/it] 98%|█████████▊| 98/100 [05:23<00:06,  3.06s/it] 99%|█████████▉| 99/100 [05:25<00:02,  2.75s/it]100%|██████████| 100/100 [05:32<00:00,  3.82s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8626 / 0.9600 / 0.8600/ [0.88888889 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.2227 / 0.2037 / 0.9590 / 0.0603/ [0.06369427 0.94252874 0.06034483]
Trial 5, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8800 / 0.8626 / 0.9600 / 0.8600/ [0.88888889 0.90625    0.86      ]
Test acc/f1/spec/sens = 0.2227 / 0.2037 / 0.9590 / 0.0603/ [0.06369427 0.94252874 0.06034483]
>> Finished.
Acc, agreement for latest model:  0.22268907563025211 0.3004201680672269 [0.06369427 0.94252874 0.06034483]
Load best checkpoint for thief model
Acc, agreement for best model:  0.226890756302521 0.3004201680672269 [0.06369427 0.93103448 0.07327586]
Trial 4/1 || Cycle 2/5 || Label set size 360 || Test acc 0.2269 || Test agreement 0.3004 || Spec 0.9508 || Sens 0.0733 Class Acc: [0.06369427 0.93103448 0.07327586]
**************************************************************************************************** 

  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:01<00:14,  1.79s/it] 22%|██▏       | 2/9 [00:01<00:05,  1.23it/s] 44%|████▍     | 4/9 [00:02<00:01,  2.85it/s] 56%|█████▌    | 5/9 [00:03<00:02,  1.80it/s] 78%|███████▊  | 7/9 [00:03<00:00,  3.07it/s]100%|██████████| 9/9 [00:03<00:00,  4.04it/s]100%|██████████| 9/9 [00:03<00:00,  2.44it/s]
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.43it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.05it/s] 75%|███████▌  | 9/12 [00:01<00:00, 10.58it/s]100%|██████████| 12/12 [00:01<00:00,  8.86it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 64, 1: 41, 2: 75}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 32, 2: 50}
Labeled set distribution: 
Number of samples  540
{0: 158, 1: 184, 2: 198}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2416, agreement = 0.2206, f1 = 0.2291, spec = 0.8770, sens = 0.0388 Class Acc: [0.38216561 0.52873563 0.0387931 ]
Initial model on validation dataset: acc = 0.3000, agreement = 0.3000, f1 = 0.2638, spec = 1.0000, sens = 0.0200 Class Acc: [0.44444444 0.65625    0.02      ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:18,  2.61s/it]  2%|▏         | 2/100 [00:06<05:39,  3.46s/it]  3%|▎         | 3/100 [00:09<05:00,  3.10s/it]  4%|▍         | 4/100 [00:13<05:34,  3.49s/it]  5%|▌         | 5/100 [00:19<07:04,  4.47s/it]Epoch 5: Train acc/f1 = 0.8204 / 0.8116 / 0.9298 / 0.9091/ [0.6835443  0.8423913  0.90909091] 
                Val acc/f1/spec/sens = 0.8500 / 0.8146 / 0.9800 / 0.8600/ [0.72222222 0.90625    0.86      ]
                Test acc/f1/spec/sens = 0.2731 / 0.2202 / 0.8975 / 0.1897/ [0.01273885 0.96551724 0.18965517]
  6%|▌         | 6/100 [00:23<06:49,  4.35s/it]  7%|▋         | 7/100 [00:26<05:51,  3.78s/it]  8%|▊         | 8/100 [00:30<05:56,  3.88s/it]  9%|▉         | 9/100 [00:33<05:17,  3.49s/it] 10%|█         | 10/100 [00:40<07:03,  4.70s/it]Epoch 10: Train acc/f1 = 0.8815 / 0.8779 / 0.9035 / 0.9747/ [0.82911392 0.82608696 0.97474747] 
                Val acc/f1/spec/sens = 0.9100 / 0.8808 / 0.9000 / 0.9800/ [0.72222222 0.90625    0.98      ]
                Test acc/f1/spec/sens = 0.6282 / 0.5164 / 0.4918 / 0.9655/ [0.06369427 0.74712644 0.96551724]
 11%|█         | 11/100 [00:43<06:00,  4.05s/it] 12%|█▏        | 12/100 [00:47<05:54,  4.02s/it] 13%|█▎        | 13/100 [00:49<05:14,  3.62s/it] 14%|█▍        | 14/100 [00:53<05:13,  3.65s/it] 15%|█▌        | 15/100 [00:59<06:15,  4.41s/it]Epoch 15: Train acc/f1 = 0.8704 / 0.8666 / 0.8596 / 1.0000/ [0.79113924 0.79891304 1.        ] 
                Val acc/f1/spec/sens = 0.8800 / 0.8112 / 0.9000 / 0.9800/ [0.44444444 0.96875    0.98      ]
                Test acc/f1/spec/sens = 0.5504 / 0.4985 / 0.6762 / 0.6940/ [0.19745223 0.8045977  0.69396552]
 16%|█▌        | 16/100 [01:03<05:53,  4.20s/it] 17%|█▋        | 17/100 [01:05<05:08,  3.72s/it] 18%|█▊        | 18/100 [01:09<05:06,  3.74s/it] 19%|█▉        | 19/100 [01:12<04:38,  3.44s/it] 20%|██        | 20/100 [01:19<06:09,  4.62s/it]Epoch 20: Train acc/f1 = 0.9741 / 0.9735 / 0.9825 / 0.9949/ [0.9556962  0.9673913  0.99494949] 
                Val acc/f1/spec/sens = 0.8600 / 0.8344 / 0.8800 / 0.8800/ [0.72222222 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.3697 / 0.3835 / 0.6885 / 0.3362/ [0.20382166 0.75862069 0.3362069 ]
 21%|██        | 21/100 [01:22<05:16,  4.01s/it] 22%|██▏       | 22/100 [01:26<05:05,  3.92s/it] 23%|██▎       | 23/100 [01:28<04:32,  3.54s/it] 24%|██▍       | 24/100 [01:32<04:34,  3.61s/it] 25%|██▌       | 25/100 [01:38<05:32,  4.44s/it]Epoch 25: Train acc/f1 = 0.9981 / 0.9980 / 1.0000 / 1.0000/ [1.         0.99456522 1.        ] 
                Val acc/f1/spec/sens = 0.8600 / 0.8347 / 0.9600 / 0.8200/ [0.77777778 0.96875    0.82      ]
                Test acc/f1/spec/sens = 0.3718 / 0.3719 / 0.8033 / 0.2414/ [0.31847134 0.81609195 0.24137931]
 26%|██▌       | 26/100 [01:42<05:14,  4.25s/it] 27%|██▋       | 27/100 [01:45<04:36,  3.79s/it] 28%|██▊       | 28/100 [01:49<04:34,  3.81s/it] 29%|██▉       | 29/100 [01:51<04:04,  3.44s/it] 30%|███       | 30/100 [01:59<05:23,  4.62s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8542 / 0.9600 / 0.8600/ [0.77777778 0.96875    0.86      ]
                Test acc/f1/spec/sens = 0.3929 / 0.3938 / 0.7951 / 0.2500/ [0.36305732 0.82758621 0.25      ]
 31%|███       | 31/100 [02:01<04:38,  4.03s/it] 32%|███▏      | 32/100 [02:05<04:29,  3.96s/it] 33%|███▎      | 33/100 [02:08<03:57,  3.55s/it] 34%|███▍      | 34/100 [02:12<03:59,  3.63s/it] 35%|███▌      | 35/100 [02:18<04:45,  4.39s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8542 / 0.9600 / 0.8600/ [0.77777778 0.96875    0.86      ]
                Test acc/f1/spec/sens = 0.4034 / 0.4054 / 0.8033 / 0.2500/ [0.40127389 0.81609195 0.25      ]
 36%|███▌      | 36/100 [02:22<04:29,  4.21s/it] 37%|███▋      | 37/100 [02:24<03:55,  3.73s/it] 38%|███▊      | 38/100 [02:28<03:51,  3.73s/it] 39%|███▉      | 39/100 [02:31<03:26,  3.39s/it] 40%|████      | 40/100 [02:38<04:35,  4.60s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8542 / 0.9600 / 0.8600/ [0.77777778 0.96875    0.86      ]
                Test acc/f1/spec/sens = 0.3676 / 0.3663 / 0.8074 / 0.2328/ [0.30573248 0.83908046 0.23275862]
 41%|████      | 41/100 [02:40<03:55,  3.99s/it] 42%|████▏     | 42/100 [02:44<03:49,  3.95s/it] 43%|████▎     | 43/100 [02:47<03:21,  3.54s/it] 44%|████▍     | 44/100 [02:51<03:23,  3.63s/it] 45%|████▌     | 45/100 [02:57<04:06,  4.48s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8428 / 0.9600 / 0.8600/ [0.77777778 0.9375     0.86      ]
                Test acc/f1/spec/sens = 0.3803 / 0.3827 / 0.8033 / 0.2112/ [0.38853503 0.81609195 0.2112069 ]
 46%|████▌     | 46/100 [03:01<03:50,  4.27s/it] 47%|████▋     | 47/100 [03:04<03:20,  3.78s/it] 48%|████▊     | 48/100 [03:07<03:16,  3.78s/it] 49%|████▉     | 49/100 [03:10<02:55,  3.44s/it] 50%|█████     | 50/100 [03:18<03:52,  4.65s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8428 / 0.9600 / 0.8600/ [0.77777778 0.9375     0.86      ]
                Test acc/f1/spec/sens = 0.3739 / 0.3725 / 0.8156 / 0.2586/ [0.28025478 0.85057471 0.25862069]
 51%|█████     | 51/100 [03:20<03:18,  4.05s/it] 52%|█████▏    | 52/100 [03:24<03:09,  3.96s/it] 53%|█████▎    | 53/100 [03:27<02:47,  3.56s/it] 54%|█████▍    | 54/100 [03:30<02:45,  3.61s/it] 55%|█████▌    | 55/100 [03:37<03:25,  4.57s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8428 / 0.9600 / 0.8600/ [0.77777778 0.9375     0.86      ]
                Test acc/f1/spec/sens = 0.3739 / 0.3720 / 0.7910 / 0.2543/ [0.29299363 0.83908046 0.25431034]
 56%|█████▌    | 56/100 [03:41<03:12,  4.38s/it] 57%|█████▋    | 57/100 [03:44<02:51,  3.99s/it] 58%|█████▊    | 58/100 [03:48<02:49,  4.02s/it] 59%|█████▉    | 59/100 [03:51<02:28,  3.62s/it] 60%|██████    | 60/100 [03:58<03:11,  4.79s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8428 / 0.9600 / 0.8600/ [0.77777778 0.9375     0.86      ]
                Test acc/f1/spec/sens = 0.3697 / 0.3701 / 0.8074 / 0.2069/ [0.3566879  0.82758621 0.20689655]
 61%|██████    | 61/100 [04:01<02:41,  4.15s/it] 62%|██████▏   | 62/100 [04:05<02:34,  4.08s/it] 63%|██████▎   | 63/100 [04:08<02:15,  3.66s/it] 64%|██████▍   | 64/100 [04:11<02:12,  3.69s/it] 65%|██████▌   | 65/100 [04:18<02:37,  4.50s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8658 / 0.9600 / 0.8600/ [0.77777778 1.         0.86      ]
                Test acc/f1/spec/sens = 0.3718 / 0.3712 / 0.8361 / 0.2414/ [0.29936306 0.85057471 0.24137931]
 66%|██████▌   | 66/100 [04:22<02:26,  4.30s/it] 67%|██████▋   | 67/100 [04:24<02:05,  3.81s/it] 68%|██████▊   | 68/100 [04:28<02:00,  3.77s/it] 69%|██████▉   | 69/100 [04:31<01:46,  3.43s/it] 70%|███████   | 70/100 [04:38<02:19,  4.66s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8428 / 0.9600 / 0.8600/ [0.77777778 0.9375     0.86      ]
                Test acc/f1/spec/sens = 0.3824 / 0.3845 / 0.7910 / 0.2112/ [0.40764331 0.79310345 0.2112069 ]
 71%|███████   | 71/100 [04:41<01:57,  4.06s/it] 72%|███████▏  | 72/100 [04:45<01:51,  3.97s/it] 73%|███████▎  | 73/100 [04:47<01:36,  3.58s/it] 74%|███████▍  | 74/100 [04:51<01:34,  3.65s/it] 75%|███████▌  | 75/100 [04:58<01:52,  4.50s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8428 / 0.9600 / 0.8600/ [0.77777778 0.9375     0.86      ]
                Test acc/f1/spec/sens = 0.3908 / 0.3914 / 0.7992 / 0.2500/ [0.35031847 0.83908046 0.25      ]
 76%|███████▌  | 76/100 [05:01<01:43,  4.30s/it] 77%|███████▋  | 77/100 [05:04<01:27,  3.80s/it] 78%|███████▊  | 78/100 [05:08<01:23,  3.79s/it] 79%|███████▉  | 79/100 [05:10<01:12,  3.43s/it] 80%|████████  | 80/100 [05:18<01:32,  4.60s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8428 / 0.9600 / 0.8600/ [0.77777778 0.9375     0.86      ]
                Test acc/f1/spec/sens = 0.3845 / 0.3865 / 0.7951 / 0.2155/ [0.40764331 0.79310345 0.21551724]
 81%|████████  | 81/100 [05:20<01:15,  3.99s/it] 82%|████████▏ | 82/100 [05:24<01:10,  3.93s/it] 83%|████████▎ | 83/100 [05:27<01:00,  3.57s/it] 84%|████████▍ | 84/100 [05:30<00:57,  3.60s/it] 85%|████████▌ | 85/100 [05:37<01:06,  4.41s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8643 / 0.9600 / 0.8800/ [0.77777778 0.96875    0.88      ]
                Test acc/f1/spec/sens = 0.3824 / 0.3828 / 0.8033 / 0.2457/ [0.33121019 0.83908046 0.24568966]
 86%|████████▌ | 86/100 [05:40<00:58,  4.19s/it] 87%|████████▋ | 87/100 [05:43<00:48,  3.71s/it] 88%|████████▊ | 88/100 [05:47<00:44,  3.75s/it] 89%|████████▉ | 89/100 [05:50<00:37,  3.41s/it] 90%|█████████ | 90/100 [05:57<00:45,  4.60s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8428 / 0.9600 / 0.8600/ [0.77777778 0.9375     0.86      ]
                Test acc/f1/spec/sens = 0.4034 / 0.4062 / 0.7828 / 0.2543/ [0.39490446 0.81609195 0.25431034]
 91%|█████████ | 91/100 [05:59<00:35,  3.99s/it] 92%|█████████▏| 92/100 [06:03<00:31,  3.94s/it] 93%|█████████▎| 93/100 [06:06<00:24,  3.57s/it] 94%|█████████▍| 94/100 [06:10<00:21,  3.61s/it] 95%|█████████▌| 95/100 [06:16<00:22,  4.42s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8428 / 0.9600 / 0.8600/ [0.77777778 0.9375     0.86      ]
                Test acc/f1/spec/sens = 0.4013 / 0.4034 / 0.7869 / 0.2629/ [0.38853503 0.79310345 0.26293103]
 96%|█████████▌| 96/100 [06:20<00:16,  4.23s/it] 97%|█████████▋| 97/100 [06:23<00:11,  3.78s/it] 98%|█████████▊| 98/100 [06:26<00:07,  3.78s/it] 99%|█████████▉| 99/100 [06:29<00:03,  3.42s/it]100%|██████████| 100/100 [06:36<00:00,  4.59s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8428 / 0.9600 / 0.8600/ [0.77777778 0.9375     0.86      ]
                Test acc/f1/spec/sens = 0.3908 / 0.3927 / 0.7869 / 0.2414/ [0.38216561 0.8045977  0.24137931]
Trial 5, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8700 / 0.8428 / 0.9600 / 0.8600/ [0.77777778 0.9375     0.86      ]
Test acc/f1/spec/sens = 0.3908 / 0.3927 / 0.7869 / 0.2414/ [0.38216561 0.8045977  0.24137931]
>> Finished.
Acc, agreement for latest model:  0.3907563025210084 0.37184873949579833 [0.38216561 0.8045977  0.24137931]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3550420168067227 0.3382352941176471 [0.07643312 0.91954023 0.33189655]
Trial 4/1 || Cycle 3/5 || Label set size 540 || Test acc 0.3550 || Test agreement 0.3382 || Spec 0.7828 || Sens 0.3319 Class Acc: [0.07643312 0.91954023 0.33189655]
**************************************************************************************************** 

  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:01<00:10,  1.74s/it] 43%|████▎     | 3/7 [00:01<00:02,  1.94it/s] 71%|███████▏  | 5/7 [00:02<00:01,  1.98it/s]100%|██████████| 7/7 [00:03<00:00,  3.11it/s]100%|██████████| 7/7 [00:03<00:00,  2.14it/s]
labeled set:  720
unlabeled set:  713
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.38it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.95it/s] 75%|███████▌  | 9/12 [00:01<00:00, 11.64it/s]100%|██████████| 12/12 [00:01<00:00,  9.27it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 38, 1: 81, 2: 61}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 32, 2: 50}
Labeled set distribution: 
Number of samples  720
{0: 196, 1: 265, 2: 259}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.3824, agreement = 0.3382, f1 = 0.3062, spec = 0.8484, sens = 0.2328 Class Acc: [0.77707006 0.06896552 0.23275862]
Initial model on validation dataset: acc = 0.2700, agreement = 0.2700, f1 = 0.2233, spec = 0.8800, sens = 0.3000 Class Acc: [0.66666667 0.         0.3       ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:14,  3.17s/it]  2%|▏         | 2/100 [00:07<06:31,  3.99s/it]  3%|▎         | 3/100 [00:10<05:54,  3.66s/it]  4%|▍         | 4/100 [00:15<06:33,  4.09s/it]  5%|▌         | 5/100 [00:23<08:22,  5.29s/it]Epoch 5: Train acc/f1 = 0.4028 / 0.2845 / 1.0000 / 0.0193/ [0.17346939 0.94716981 0.01930502] 
                Val acc/f1/spec/sens = 0.8600 / 0.8166 / 0.9400 / 0.9200/ [0.66666667 0.875      0.92      ]
                Test acc/f1/spec/sens = 0.1828 / 0.1034 / 1.0000 / 0.0000/ [0. 1. 0.]
  6%|▌         | 6/100 [00:27<07:58,  5.09s/it]  7%|▋         | 7/100 [00:31<06:55,  4.47s/it]  8%|▊         | 8/100 [00:35<06:44,  4.39s/it]  9%|▉         | 9/100 [00:38<06:05,  4.02s/it] 10%|█         | 10/100 [00:47<08:07,  5.42s/it]Epoch 10: Train acc/f1 = 0.8681 / 0.8664 / 0.9696 / 0.8649/ [0.93367347 0.82264151 0.86486486] 
                Val acc/f1/spec/sens = 0.8500 / 0.8203 / 0.9600 / 0.8600/ [0.77777778 0.875      0.86      ]
                Test acc/f1/spec/sens = 0.3508 / 0.3530 / 0.9508 / 0.1810/ [0.26751592 0.95402299 0.18103448]
 11%|█         | 11/100 [00:50<07:01,  4.74s/it] 12%|█▏        | 12/100 [00:54<06:42,  4.58s/it] 13%|█▎        | 13/100 [00:57<06:03,  4.18s/it] 14%|█▍        | 14/100 [01:01<06:01,  4.20s/it] 15%|█▌        | 15/100 [01:09<07:25,  5.24s/it]Epoch 15: Train acc/f1 = 0.9347 / 0.9319 / 0.9935 / 0.9189/ [0.92857143 0.95471698 0.91891892] 
                Val acc/f1/spec/sens = 0.7900 / 0.7260 / 0.9600 / 0.8000/ [0.44444444 0.96875    0.8       ]
                Test acc/f1/spec/sens = 0.3214 / 0.3138 / 0.9057 / 0.2457/ [0.11464968 0.89655172 0.24568966]
 16%|█▌        | 16/100 [01:14<07:03,  5.04s/it] 17%|█▋        | 17/100 [01:17<06:13,  4.50s/it] 18%|█▊        | 18/100 [01:21<06:02,  4.41s/it] 19%|█▉        | 19/100 [01:24<05:29,  4.07s/it] 20%|██        | 20/100 [01:33<07:11,  5.40s/it]Epoch 20: Train acc/f1 = 0.9722 / 0.9709 / 1.0000 / 0.9614/ [0.98979592 0.96981132 0.96138996] 
                Val acc/f1/spec/sens = 0.8300 / 0.7877 / 0.9400 / 0.8200/ [0.61111111 0.96875    0.82      ]
                Test acc/f1/spec/sens = 0.3487 / 0.3489 / 0.8566 / 0.1724/ [0.4522293  0.63218391 0.17241379]
 21%|██        | 21/100 [01:36<06:14,  4.74s/it] 22%|██▏       | 22/100 [01:40<05:59,  4.61s/it] 23%|██▎       | 23/100 [01:44<05:22,  4.18s/it] 24%|██▍       | 24/100 [01:48<05:18,  4.19s/it] 25%|██▌       | 25/100 [01:55<06:30,  5.21s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8538 / 0.9400 / 0.9000/ [0.77777778 0.90625    0.9       ]
                Test acc/f1/spec/sens = 0.4664 / 0.4596 / 0.7664 / 0.4397/ [0.39490446 0.66666667 0.43965517]
 26%|██▌       | 26/100 [02:00<06:05,  4.93s/it] 27%|██▋       | 27/100 [02:03<05:24,  4.44s/it] 28%|██▊       | 28/100 [02:07<05:19,  4.43s/it] 29%|██▉       | 29/100 [02:11<04:47,  4.05s/it] 30%|███       | 30/100 [02:19<06:17,  5.39s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8661 / 0.9400 / 0.9000/ [0.77777778 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.4391 / 0.4358 / 0.7459 / 0.3966/ [0.38216561 0.65517241 0.39655172]
 31%|███       | 31/100 [02:22<05:26,  4.73s/it] 32%|███▏      | 32/100 [02:27<05:15,  4.64s/it] 33%|███▎      | 33/100 [02:30<04:40,  4.18s/it] 34%|███▍      | 34/100 [02:34<04:38,  4.22s/it] 35%|███▌      | 35/100 [02:41<05:36,  5.17s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8557 / 0.9400 / 0.8800/ [0.77777778 0.9375     0.88      ]
                Test acc/f1/spec/sens = 0.4328 / 0.4304 / 0.7787 / 0.3664/ [0.40764331 0.65517241 0.36637931]
 36%|███▌      | 36/100 [02:46<05:14,  4.92s/it] 37%|███▋      | 37/100 [02:49<04:36,  4.40s/it] 38%|███▊      | 38/100 [02:53<04:29,  4.35s/it] 39%|███▉      | 39/100 [02:56<04:03,  3.99s/it] 40%|████      | 40/100 [03:05<05:23,  5.39s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8383 / 0.9600 / 0.8800/ [0.72222222 0.9375     0.88      ]
                Test acc/f1/spec/sens = 0.4181 / 0.4171 / 0.7746 / 0.3405/ [0.40127389 0.65517241 0.34051724]
 41%|████      | 41/100 [03:08<04:40,  4.75s/it] 42%|████▏     | 42/100 [03:13<04:27,  4.62s/it] 43%|████▎     | 43/100 [03:16<03:58,  4.18s/it] 44%|████▍     | 44/100 [03:20<03:58,  4.27s/it] 45%|████▌     | 45/100 [03:28<04:48,  5.25s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8438 / 0.9400 / 0.8800/ [0.77777778 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.4286 / 0.4270 / 0.7582 / 0.3621/ [0.40127389 0.65517241 0.36206897]
 46%|████▌     | 46/100 [03:32<04:27,  4.95s/it] 47%|████▋     | 47/100 [03:35<03:54,  4.43s/it] 48%|████▊     | 48/100 [03:40<03:50,  4.44s/it] 49%|████▉     | 49/100 [03:43<03:27,  4.07s/it] 50%|█████     | 50/100 [03:52<04:32,  5.45s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8397 / 0.9400 / 0.8800/ [0.72222222 0.9375     0.88      ]
                Test acc/f1/spec/sens = 0.3950 / 0.3962 / 0.7787 / 0.2802/ [0.42038217 0.65517241 0.28017241]
 51%|█████     | 51/100 [03:55<03:53,  4.77s/it] 52%|█████▏    | 52/100 [03:59<03:41,  4.62s/it] 53%|█████▎    | 53/100 [04:02<03:17,  4.21s/it] 54%|█████▍    | 54/100 [04:07<03:14,  4.23s/it] 55%|█████▌    | 55/100 [04:14<03:52,  5.18s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8383 / 0.9600 / 0.8800/ [0.72222222 0.9375     0.88      ]
                Test acc/f1/spec/sens = 0.4349 / 0.4328 / 0.7828 / 0.3664/ [0.41401274 0.65517241 0.36637931]
 56%|█████▌    | 56/100 [04:18<03:35,  4.90s/it] 57%|█████▋    | 57/100 [04:21<03:08,  4.38s/it] 58%|█████▊    | 58/100 [04:26<03:03,  4.36s/it] 59%|█████▉    | 59/100 [04:29<02:45,  4.03s/it] 60%|██████    | 60/100 [04:37<03:34,  5.37s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8383 / 0.9600 / 0.8800/ [0.72222222 0.9375     0.88      ]
                Test acc/f1/spec/sens = 0.3803 / 0.3816 / 0.7828 / 0.2500/ [0.42675159 0.64367816 0.25      ]
 61%|██████    | 61/100 [04:41<03:03,  4.71s/it] 62%|██████▏   | 62/100 [04:45<02:53,  4.57s/it] 63%|██████▎   | 63/100 [04:48<02:33,  4.15s/it] 64%|██████▍   | 64/100 [04:52<02:30,  4.19s/it] 65%|██████▌   | 65/100 [05:00<03:01,  5.20s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8397 / 0.9400 / 0.8800/ [0.72222222 0.9375     0.88      ]
                Test acc/f1/spec/sens = 0.3887 / 0.3900 / 0.7623 / 0.2845/ [0.40127389 0.64367816 0.28448276]
 66%|██████▌   | 66/100 [05:04<02:48,  4.95s/it] 67%|██████▋   | 67/100 [05:08<02:26,  4.44s/it] 68%|██████▊   | 68/100 [05:12<02:20,  4.40s/it] 69%|██████▉   | 69/100 [05:15<02:04,  4.02s/it] 70%|███████   | 70/100 [05:23<02:41,  5.37s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8397 / 0.9400 / 0.8800/ [0.72222222 0.9375     0.88      ]
                Test acc/f1/spec/sens = 0.3887 / 0.3913 / 0.7582 / 0.2759/ [0.41401274 0.64367816 0.27586207]
 71%|███████   | 71/100 [05:27<02:17,  4.73s/it] 72%|███████▏  | 72/100 [05:31<02:09,  4.62s/it] 73%|███████▎  | 73/100 [05:34<01:53,  4.19s/it] 74%|███████▍  | 74/100 [05:39<01:49,  4.22s/it] 75%|███████▌  | 75/100 [05:46<02:10,  5.24s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8469 / 0.9800 / 0.8800/ [0.72222222 0.96875    0.88      ]
                Test acc/f1/spec/sens = 0.3739 / 0.3753 / 0.7746 / 0.2586/ [0.38853503 0.65517241 0.25862069]
 76%|███████▌  | 76/100 [05:51<01:59,  4.98s/it] 77%|███████▋  | 77/100 [05:54<01:42,  4.46s/it] 78%|███████▊  | 78/100 [05:58<01:38,  4.48s/it] 79%|███████▉  | 79/100 [06:02<01:27,  4.16s/it] 80%|████████  | 80/100 [06:10<01:50,  5.53s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8397 / 0.9400 / 0.8800/ [0.72222222 0.9375     0.88      ]
                Test acc/f1/spec/sens = 0.3824 / 0.3838 / 0.7787 / 0.2586/ [0.41401274 0.65517241 0.25862069]
 81%|████████  | 81/100 [06:14<01:31,  4.82s/it] 82%|████████▏ | 82/100 [06:18<01:24,  4.69s/it] 83%|████████▎ | 83/100 [06:21<01:12,  4.25s/it] 84%|████████▍ | 84/100 [06:26<01:08,  4.30s/it] 85%|████████▌ | 85/100 [06:33<01:18,  5.22s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8397 / 0.9400 / 0.8800/ [0.72222222 0.9375     0.88      ]
                Test acc/f1/spec/sens = 0.3971 / 0.3988 / 0.7500 / 0.3017/ [0.39490446 0.65517241 0.30172414]
 86%|████████▌ | 86/100 [06:37<01:09,  4.94s/it] 87%|████████▋ | 87/100 [06:41<00:57,  4.46s/it] 88%|████████▊ | 88/100 [06:45<00:53,  4.46s/it] 89%|████████▉ | 89/100 [06:48<00:44,  4.09s/it] 90%|█████████ | 90/100 [06:57<00:54,  5.46s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8266 / 0.9600 / 0.8800/ [0.72222222 0.90625    0.88      ]
                Test acc/f1/spec/sens = 0.3971 / 0.3975 / 0.7951 / 0.2845/ [0.42675159 0.64367816 0.28448276]
 91%|█████████ | 91/100 [07:00<00:43,  4.79s/it] 92%|█████████▏| 92/100 [07:05<00:37,  4.69s/it] 93%|█████████▎| 93/100 [07:08<00:30,  4.29s/it] 94%|█████████▍| 94/100 [07:13<00:26,  4.38s/it] 95%|█████████▌| 95/100 [07:20<00:26,  5.34s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8469 / 0.9800 / 0.8800/ [0.72222222 0.96875    0.88      ]
                Test acc/f1/spec/sens = 0.3845 / 0.3854 / 0.7787 / 0.2716/ [0.40764331 0.64367816 0.27155172]
 96%|█████████▌| 96/100 [07:25<00:20,  5.08s/it] 97%|█████████▋| 97/100 [07:28<00:13,  4.51s/it] 98%|█████████▊| 98/100 [07:32<00:08,  4.46s/it] 99%|█████████▉| 99/100 [07:35<00:04,  4.07s/it]100%|██████████| 100/100 [07:44<00:00,  5.42s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8397 / 0.9400 / 0.8800/ [0.72222222 0.9375     0.88      ]
                Test acc/f1/spec/sens = 0.4286 / 0.4267 / 0.7582 / 0.3664/ [0.40127389 0.64367816 0.36637931]
Trial 5, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8700 / 0.8397 / 0.9400 / 0.8800/ [0.72222222 0.9375     0.88      ]
Test acc/f1/spec/sens = 0.4286 / 0.4267 / 0.7582 / 0.3664/ [0.40127389 0.64367816 0.36637931]
>> Finished.
Acc, agreement for latest model:  0.42857142857142855 0.453781512605042 [0.40127389 0.64367816 0.36637931]
Load best checkpoint for thief model
Acc, agreement for best model:  0.32983193277310924 0.3403361344537815 [0.13375796 1.         0.2112069 ]
Trial 4/1 || Cycle 4/5 || Label set size 720 || Test acc 0.3298 || Test agreement 0.3403 || Spec 0.7705 || Sens 0.2112 Class Acc: [0.13375796 1.         0.2112069 ]
**************************************************************************************************** 

  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:01<00:08,  1.62s/it] 50%|█████     | 3/6 [00:01<00:01,  2.08it/s] 83%|████████▎ | 5/6 [00:02<00:00,  2.18it/s]100%|██████████| 6/6 [00:02<00:00,  2.05it/s]
labeled set:  900
unlabeled set:  533
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.63it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.86it/s] 67%|██████▋   | 8/12 [00:00<00:00, 11.95it/s] 92%|█████████▏| 11/12 [00:01<00:00, 14.65it/s]100%|██████████| 12/12 [00:01<00:00,  9.54it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 18, 1: 74, 2: 88}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 32, 2: 50}
Labeled set distribution: 
Number of samples  900
{0: 214, 1: 339, 2: 347}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.4076, agreement = 0.3697, f1 = 0.3072, spec = 0.6025, sens = 0.4483 Class Acc: [0.57324841 0.         0.44827586]
Initial model on validation dataset: acc = 0.3200, agreement = 0.3200, f1 = 0.2641, spec = 0.6800, sens = 0.4600 Class Acc: [0.44444444 0.03125    0.46      ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:08,  3.72s/it]  2%|▏         | 2/100 [00:08<07:18,  4.47s/it]  3%|▎         | 3/100 [00:12<06:40,  4.13s/it]  4%|▍         | 4/100 [00:17<07:19,  4.58s/it]  5%|▌         | 5/100 [00:26<09:24,  5.94s/it]Epoch 5: Train acc/f1 = 0.7111 / 0.6041 / 0.6130 / 0.9654/ [0.12616822 0.820059   0.96541787] 
                Val acc/f1/spec/sens = 0.8600 / 0.8257 / 0.9800 / 0.8600/ [0.72222222 0.9375     0.86      ]
                Test acc/f1/spec/sens = 0.5714 / 0.4164 / 0.6516 / 0.9181/ [0.         0.67816092 0.91810345]
  6%|▌         | 6/100 [00:30<08:42,  5.56s/it]  7%|▋         | 7/100 [00:34<07:38,  4.93s/it]  8%|▊         | 8/100 [00:39<07:28,  4.87s/it]  9%|▉         | 9/100 [00:43<06:52,  4.53s/it] 10%|█         | 10/100 [00:52<09:09,  6.10s/it]Epoch 10: Train acc/f1 = 0.8378 / 0.8160 / 0.8409 / 0.9683/ [0.62616822 0.83775811 0.96829971] 
                Val acc/f1/spec/sens = 0.8500 / 0.7871 / 0.8200 / 1.0000/ [0.5    0.8125 1.    ]
                Test acc/f1/spec/sens = 0.4517 / 0.3955 / 0.7787 / 0.5948/ [0.0955414  0.71264368 0.59482759]
 11%|█         | 11/100 [00:56<07:59,  5.39s/it] 12%|█▏        | 12/100 [01:01<07:49,  5.34s/it] 13%|█▎        | 13/100 [01:05<07:03,  4.86s/it] 14%|█▍        | 14/100 [01:10<07:07,  4.97s/it] 15%|█▌        | 15/100 [01:19<08:35,  6.07s/it]Epoch 15: Train acc/f1 = 0.8722 / 0.8685 / 0.9928 / 0.7925/ [0.8364486  0.97640118 0.7925072 ] 
                Val acc/f1/spec/sens = 0.9100 / 0.8897 / 0.9600 / 0.9000/ [0.77777778 1.         0.9       ]
                Test acc/f1/spec/sens = 0.1975 / 0.1306 / 1.0000 / 0.0086/ [0.03184713 1.         0.00862069]
 16%|█▌        | 16/100 [01:24<07:58,  5.70s/it] 17%|█▋        | 17/100 [01:27<07:04,  5.11s/it] 18%|█▊        | 18/100 [01:32<06:55,  5.07s/it] 19%|█▉        | 19/100 [01:36<06:20,  4.69s/it] 20%|██        | 20/100 [01:46<08:12,  6.16s/it]Epoch 20: Train acc/f1 = 0.9211 / 0.9118 / 0.9132 / 0.9885/ [0.81308411 0.92035398 0.98847262] 
                Val acc/f1/spec/sens = 0.8900 / 0.8598 / 0.9000 / 0.9400/ [0.72222222 0.90625    0.94      ]
                Test acc/f1/spec/sens = 0.4832 / 0.4215 / 0.8852 / 0.6034/ [0.05095541 0.94252874 0.60344828]
 21%|██        | 21/100 [01:49<07:07,  5.41s/it] 22%|██▏       | 22/100 [01:54<06:49,  5.25s/it] 23%|██▎       | 23/100 [01:58<06:10,  4.81s/it] 24%|██▍       | 24/100 [02:03<06:05,  4.82s/it] 25%|██▌       | 25/100 [02:11<07:21,  5.89s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8710 / 0.9600 / 0.9200/ [0.77777778 0.9375     0.92      ]
                Test acc/f1/spec/sens = 0.3214 / 0.2787 / 0.9262 / 0.2543/ [0.04458599 1.         0.25431034]
 26%|██▌       | 26/100 [02:16<06:51,  5.56s/it] 27%|██▋       | 27/100 [02:20<06:06,  5.02s/it] 28%|██▊       | 28/100 [02:25<06:01,  5.02s/it] 29%|██▉       | 29/100 [02:29<05:28,  4.63s/it] 30%|███       | 30/100 [02:38<07:07,  6.11s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8710 / 0.9600 / 0.9200/ [0.77777778 0.9375     0.92      ]
                Test acc/f1/spec/sens = 0.2899 / 0.2511 / 0.9590 / 0.1853/ [0.05095541 1.         0.18534483]
 31%|███       | 31/100 [02:42<06:11,  5.39s/it] 32%|███▏      | 32/100 [02:47<05:56,  5.25s/it] 33%|███▎      | 33/100 [02:51<05:22,  4.81s/it] 34%|███▍      | 34/100 [02:56<05:30,  5.00s/it] 35%|███▌      | 35/100 [03:05<06:34,  6.07s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8914 / 0.9600 / 0.9200/ [0.88888889 0.90625    0.92      ]
                Test acc/f1/spec/sens = 0.2899 / 0.2520 / 0.9672 / 0.1853/ [0.05095541 1.         0.18534483]
 36%|███▌      | 36/100 [03:09<06:04,  5.69s/it] 37%|███▋      | 37/100 [03:13<05:21,  5.11s/it] 38%|███▊      | 38/100 [03:18<05:12,  5.03s/it] 39%|███▉      | 39/100 [03:22<04:43,  4.64s/it] 40%|████      | 40/100 [03:31<06:06,  6.11s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8750 / 0.9800 / 0.9000/ [0.83333333 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.2836 / 0.2465 / 0.9631 / 0.1638/ [0.06369427 1.         0.1637931 ]
 41%|████      | 41/100 [03:35<05:18,  5.40s/it] 42%|████▏     | 42/100 [03:40<05:02,  5.22s/it] 43%|████▎     | 43/100 [03:43<04:31,  4.77s/it] 44%|████▍     | 44/100 [03:48<04:31,  4.84s/it] 45%|████▌     | 45/100 [03:57<05:24,  5.90s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8813 / 0.9600 / 0.9000/ [0.88888889 0.90625    0.9       ]
                Test acc/f1/spec/sens = 0.2941 / 0.2598 / 0.9590 / 0.1853/ [0.06369427 1.         0.18534483]
 46%|████▌     | 46/100 [04:02<05:02,  5.61s/it] 47%|████▋     | 47/100 [04:06<04:27,  5.04s/it] 48%|████▊     | 48/100 [04:10<04:21,  5.02s/it] 49%|████▉     | 49/100 [04:14<04:00,  4.72s/it] 50%|█████     | 50/100 [04:24<05:13,  6.26s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8767 / 0.9600 / 0.9000/ [0.83333333 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.2941 / 0.2570 / 0.9590 / 0.1897/ [0.05732484 1.         0.18965517]
 51%|█████     | 51/100 [04:28<04:34,  5.60s/it] 52%|█████▏    | 52/100 [04:34<04:22,  5.47s/it] 53%|█████▎    | 53/100 [04:37<03:54,  4.98s/it] 54%|█████▍    | 54/100 [04:42<03:48,  4.96s/it] 55%|█████▌    | 55/100 [04:51<04:32,  6.07s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8901 / 0.9800 / 0.9000/ [0.88888889 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.2815 / 0.2452 / 0.9631 / 0.1638/ [0.05732484 1.         0.1637931 ]
 56%|█████▌    | 56/100 [04:56<04:11,  5.72s/it] 57%|█████▋    | 57/100 [05:00<03:41,  5.15s/it] 58%|█████▊    | 58/100 [05:05<03:31,  5.04s/it] 59%|█████▉    | 59/100 [05:08<03:10,  4.64s/it] 60%|██████    | 60/100 [05:18<04:03,  6.10s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8767 / 0.9600 / 0.9000/ [0.83333333 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.2857 / 0.2470 / 0.9754 / 0.1767/ [0.05095541 1.         0.17672414]
 61%|██████    | 61/100 [05:21<03:30,  5.39s/it] 62%|██████▏   | 62/100 [05:26<03:19,  5.26s/it] 63%|██████▎   | 63/100 [05:30<02:58,  4.81s/it] 64%|██████▍   | 64/100 [05:35<02:53,  4.81s/it] 65%|██████▌   | 65/100 [05:43<03:24,  5.84s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8901 / 0.9800 / 0.9000/ [0.88888889 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.2920 / 0.2564 / 0.9590 / 0.1810/ [0.06369427 1.         0.18103448]
 66%|██████▌   | 66/100 [05:48<03:07,  5.52s/it] 67%|██████▋   | 67/100 [05:52<02:44,  4.98s/it] 68%|██████▊   | 68/100 [05:56<02:37,  4.92s/it] 69%|██████▉   | 69/100 [06:00<02:21,  4.56s/it] 70%|███████   | 70/100 [06:10<03:03,  6.10s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8767 / 0.9600 / 0.9000/ [0.83333333 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.2815 / 0.2449 / 0.9590 / 0.1638/ [0.05732484 1.         0.1637931 ]
 71%|███████   | 71/100 [06:14<02:35,  5.38s/it] 72%|███████▏  | 72/100 [06:19<02:27,  5.26s/it] 73%|███████▎  | 73/100 [06:23<02:12,  4.92s/it] 74%|███████▍  | 74/100 [06:28<02:11,  5.07s/it] 75%|███████▌  | 75/100 [06:37<02:35,  6.24s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8767 / 0.9600 / 0.9000/ [0.83333333 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.2878 / 0.2539 / 0.9590 / 0.1724/ [0.06369427 1.         0.17241379]
 76%|███████▌  | 76/100 [06:43<02:25,  6.08s/it] 77%|███████▋  | 77/100 [06:47<02:06,  5.51s/it] 78%|███████▊  | 78/100 [06:52<01:59,  5.41s/it] 79%|███████▉  | 79/100 [06:56<01:44,  4.98s/it] 80%|████████  | 80/100 [07:06<02:08,  6.43s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8710 / 0.9600 / 0.9200/ [0.77777778 0.9375     0.92      ]
                Test acc/f1/spec/sens = 0.2836 / 0.2423 / 0.9754 / 0.1767/ [0.04458599 1.         0.17672414]
 81%|████████  | 81/100 [07:10<01:47,  5.67s/it] 82%|████████▏ | 82/100 [07:15<01:39,  5.53s/it] 83%|████████▎ | 83/100 [07:19<01:24,  5.00s/it] 84%|████████▍ | 84/100 [07:24<01:19,  4.96s/it] 85%|████████▌ | 85/100 [07:32<01:29,  6.00s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8767 / 0.9600 / 0.9000/ [0.83333333 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.2899 / 0.2569 / 0.9631 / 0.1767/ [0.06369427 1.         0.17672414]
 86%|████████▌ | 86/100 [07:37<01:18,  5.61s/it] 87%|████████▋ | 87/100 [07:41<01:05,  5.06s/it] 88%|████████▊ | 88/100 [07:46<01:00,  5.03s/it] 89%|████████▉ | 89/100 [07:49<00:50,  4.62s/it] 90%|█████████ | 90/100 [07:59<01:00,  6.09s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8901 / 0.9800 / 0.9000/ [0.88888889 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.2857 / 0.2460 / 0.9795 / 0.1767/ [0.05095541 1.         0.17672414]
 91%|█████████ | 91/100 [08:03<00:48,  5.41s/it] 92%|█████████▏| 92/100 [08:07<00:42,  5.25s/it] 93%|█████████▎| 93/100 [08:11<00:33,  4.81s/it] 94%|█████████▍| 94/100 [08:16<00:29,  4.83s/it] 95%|█████████▌| 95/100 [08:25<00:29,  5.96s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8901 / 0.9800 / 0.9000/ [0.88888889 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.3025 / 0.2712 / 0.9590 / 0.2026/ [0.06369427 1.         0.20258621]
 96%|█████████▌| 96/100 [08:30<00:22,  5.64s/it] 97%|█████████▋| 97/100 [08:33<00:15,  5.10s/it] 98%|█████████▊| 98/100 [08:38<00:10,  5.06s/it] 99%|█████████▉| 99/100 [08:42<00:04,  4.69s/it]100%|██████████| 100/100 [08:52<00:00,  6.17s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8901 / 0.9800 / 0.9000/ [0.88888889 0.9375     0.9       ]
                Test acc/f1/spec/sens = 0.3067 / 0.2743 / 0.9549 / 0.2112/ [0.06369427 1.         0.2112069 ]
Trial 5, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9100 / 0.8901 / 0.9800 / 0.9000/ [0.88888889 0.9375     0.9       ]
Test acc/f1/spec/sens = 0.3067 / 0.2743 / 0.9549 / 0.2112/ [0.06369427 1.         0.2112069 ]
>> Finished.
Acc, agreement for latest model:  0.3067226890756303 0.3382352941176471 [0.06369427 1.         0.2112069 ]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3025210084033613 0.35084033613445376 [0.06369427 1.         0.20258621]
Trial 4/1 || Cycle 5/5 || Label set size 900 || Test acc 0.3025 || Test agreement 0.3508 || Spec 0.9549 || Sens 0.2026 Class Acc: [0.06369427 1.         0.20258621]
**************************************************************************************************** 

Number of samples  900
0.380672268907563 0.08649136956185759
        acc  ...                label dist
0  0.321429  ...  {0: 221, 1: 386, 2: 293}
1  0.268908  ...  {0: 221, 1: 328, 2: 351}
2  0.237395  ...  {0: 228, 1: 323, 2: 349}
3  0.472689  ...  {0: 215, 1: 325, 2: 360}
4  0.302521  ...  {0: 214, 1: 339, 2: 347}

[5 rows x 6 columns]
Results saved to  /home/ankita/scratch/data_msa_medical/results_ankita//pocus_resnet18/butterfly_resnet50/SGD/1000_val100/entropy_v4
