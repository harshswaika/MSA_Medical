nohup: ignoring input
[24/03/07 12:05:31] [conf.py:  298]: PyTorch Version: torch=1.11.0, cuda=11.3, cudnn=8200
[24/03/07 12:05:31] [conf.py:  300]: ACTIVE:
  ADDENDUM: 180
  ALPHA: 0.2
  AUGMENT: None
  BETA: 1.0
  BUDGET: 1000
  CUTMIX_PROB: 0.0
  CYCLES: 5
  INITIAL: 180
  LA: False
  METHOD: kcenter
  PRETRAINED_PATH: /home/ankita/scratch/data_msa_medical/ckpts/resnet50-imagenet1k.pth
  TEMP: 1.0
  TRO: 1.0
  USE_PRETRAINED: True
  VAL: 100
AM:
  SGR: 1000
  THRESHOLD: 0.5
CUDNN_BENCHMARK: True
DS_SEED: 123
EDM:
  HASH: /home/harsh_s/scratch/msacopy/exp/hash/alpha.pt
  NUM_MODELS: 5
  PATH1: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T0.pt
  PATH2: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T1.pt
  PATH3: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T2.pt
  PATH4: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T3.pt
  PATH5: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T4.pt
GR:
  EPSILON: 0.1
  SUR_PATH: /home/harsh_s/scratch/msacopy/GRAD2/batch_training/outputs/trained_models/imagenet_cifar10_to_cifar10_surrogate_10epochs.pt
LOG_DEST: resnet18_resnet50_pocus_240307_120531.txt
LOG_TIME: 240307_120531
METHOD_NAME: v4
OUT_DIR: /home/ankita/scratch/data_msa_medical/results_ankita/
PL:
  CLASS_BLNC: 10
  ITERATIONS: 20
  KAPPA_N: 0.005
  KAPPA_P: 0.05
  NO_PROGRESS: False
  NO_UNCERTAINTY: False
  TAU_N: 0.05
  TAU_P: 0.7
  TEMP_NL: 2.0
RNG_SEED: 1
SAVE_DIR: /home/ankita/scratch/data_msa_medical/results_ankita//pocus_resnet18/butterfly_resnet50/SGD/1000_val100/kcenter_v4
THIEF:
  ARCH: resnet50
  DATASET: butterfly
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/Butte
  HARD_LABELS: True
  NUM_TRAIN: 1281167
  SUBSET: 128116
TRAIN:
  BATCH: 16
  EPOCH: 100
  GAMMA: 0.1
  LR: 0.02
  MILESTONES: [20, 40, 60, 80]
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  WDECAY: 0.0005
TRIALS: 5
VICTIM:
  ARCH: resnet18
  DATASET: pocus
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/covid_5_fold
  HEIGHT: 224
  PATH: /home/ankita/scratch/data_msa_medical/victim_models/pocus_resnet18.pth.tar
  PATHIN: /home/harsh_s/scratch/msacopy/ckpts/cifar10-resnet32-inaccurate/checkpoint.pth.tar
  WIDTH: 224
Loaded target dataset of size 476 with 3 classes
target model keys:  122
checkpoint keys:  122

Target model acc = 0.8991596638655462
Val-Acc: 0.8992 Val-Spec: 0.9795 Val-Sens: 0.9224 Class Acc: [0.8343949  0.95402299 0.92241379]
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.68it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.20it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.76it/s]100%|██████████| 12/12 [00:01<00:00, 10.35it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.95it/s] 57%|█████▋    | 4/7 [00:00<00:00,  7.72it/s]100%|██████████| 7/7 [00:00<00:00,  7.59it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2587, -1.2742, -1.2515]), tensor([0.8385, 0.8326, 0.8417]))
Val set stats: mean/std =  (tensor([-1.1715, -1.1901, -1.1622]), tensor([0.8641, 0.8598, 0.8667]))
Validation set distribution: 
Number of samples  100
{0: 18, 1: 50, 2: 32}
Labeled set distribution: 
Number of samples  180
{0: 34, 1: 67, 2: 79}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.1975, agreement = 0.1933, f1 = 0.1590, spec = 0.6066, sens = 0.1595 Class Acc: [0.00636943 0.64367816 0.15948276]
Initial model on validation dataset: acc = 0.5300, agreement = 0.5300, f1 = 0.3449, spec = 0.9118, sens = 0.2812 Class Acc: [0.      0.88    0.28125]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:15,  1.37s/it]  2%|▏         | 2/100 [00:04<03:44,  2.29s/it]  3%|▎         | 3/100 [00:05<03:06,  1.92s/it]  4%|▍         | 4/100 [00:08<03:24,  2.13s/it]  5%|▌         | 5/100 [00:12<04:25,  2.80s/it]Epoch 5: Train acc/f1 = 0.5167 / 0.4545 / 1.0000 / 0.1899/ [0.32352941 1.         0.18987342] 
                Val acc/f1/spec/sens = 0.5500 / 0.3216 / 1.0000 / 0.1562/ [0.      1.      0.15625]
                Test acc/f1/spec/sens = 0.1891 / 0.1171 / 0.9836 / 0.0043/ [0.01273885 1.         0.00431034]
  6%|▌         | 6/100 [00:15<04:25,  2.82s/it]  7%|▋         | 7/100 [00:16<03:44,  2.41s/it]  8%|▊         | 8/100 [00:19<03:46,  2.47s/it]  9%|▉         | 9/100 [00:20<03:17,  2.17s/it] 10%|█         | 10/100 [00:25<04:31,  3.02s/it]Epoch 10: Train acc/f1 = 0.9111 / 0.8856 / 0.9208 / 0.9747/ [0.76470588 0.91044776 0.97468354] 
                Val acc/f1/spec/sens = 0.9000 / 0.8661 / 0.9412 / 0.9062/ [0.77777778 0.94       0.90625   ]
                Test acc/f1/spec/sens = 0.3803 / 0.3822 / 0.8320 / 0.2069/ [0.61783439 0.4137931  0.20689655]
 11%|█         | 11/100 [00:27<03:44,  2.53s/it] 12%|█▏        | 12/100 [00:29<03:41,  2.51s/it] 13%|█▎        | 13/100 [00:30<03:09,  2.18s/it] 14%|█▍        | 14/100 [00:33<03:13,  2.25s/it] 15%|█▌        | 15/100 [00:37<03:54,  2.76s/it]Epoch 15: Train acc/f1 = 0.9333 / 0.9077 / 0.9208 / 0.9873/ [0.70588235 0.98507463 0.98734177] 
                Val acc/f1/spec/sens = 0.7100 / 0.5289 / 0.6765 / 0.9375/ [0.     0.82   0.9375]
                Test acc/f1/spec/sens = 0.3298 / 0.3287 / 0.9303 / 0.2716/ [0.21656051 0.68965517 0.27155172]
 16%|█▌        | 16/100 [00:39<03:44,  2.67s/it] 17%|█▋        | 17/100 [00:41<03:13,  2.33s/it] 18%|█▊        | 18/100 [00:43<03:17,  2.41s/it] 19%|█▉        | 19/100 [00:45<02:54,  2.15s/it] 20%|██        | 20/100 [00:50<04:02,  3.03s/it]Epoch 20: Train acc/f1 = 0.9889 / 0.9858 / 1.0000 / 0.9873/ [1.         0.98507463 0.98734177] 
                Val acc/f1/spec/sens = 0.9000 / 0.8771 / 0.9853 / 0.8125/ [0.94444444 0.94       0.8125    ]
                Test acc/f1/spec/sens = 0.4244 / 0.3918 / 0.8525 / 0.4957/ [0.10191083 0.81609195 0.49568966]
 21%|██        | 21/100 [00:52<03:22,  2.56s/it] 22%|██▏       | 22/100 [00:54<03:22,  2.59s/it] 23%|██▎       | 23/100 [00:56<02:53,  2.25s/it] 24%|██▍       | 24/100 [00:58<02:55,  2.32s/it] 25%|██▌       | 25/100 [01:02<03:30,  2.81s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8393 / 0.9853 / 0.7812/ [0.94444444 0.88       0.78125   ]
                Test acc/f1/spec/sens = 0.3403 / 0.3514 / 0.8443 / 0.2543/ [0.24203822 0.74712644 0.25431034]
 26%|██▌       | 26/100 [01:05<03:22,  2.73s/it] 27%|██▋       | 27/100 [01:06<02:50,  2.34s/it] 28%|██▊       | 28/100 [01:09<02:53,  2.40s/it] 29%|██▉       | 29/100 [01:10<02:28,  2.09s/it] 30%|███       | 30/100 [01:15<03:24,  2.92s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8684 / 0.9706 / 0.8438/ [0.94444444 0.9        0.84375   ]
                Test acc/f1/spec/sens = 0.3319 / 0.3230 / 0.8607 / 0.2543/ [0.18471338 0.8045977  0.25431034]
 31%|███       | 31/100 [01:16<02:52,  2.50s/it] 32%|███▏      | 32/100 [01:19<02:51,  2.53s/it] 33%|███▎      | 33/100 [01:20<02:28,  2.22s/it] 34%|███▍      | 34/100 [01:23<02:34,  2.34s/it] 35%|███▌      | 35/100 [01:27<03:00,  2.78s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8684 / 0.9706 / 0.8438/ [0.94444444 0.9        0.84375   ]
                Test acc/f1/spec/sens = 0.3130 / 0.3148 / 0.8893 / 0.1983/ [0.18471338 0.85057471 0.19827586]
 36%|███▌      | 36/100 [01:29<02:53,  2.70s/it] 37%|███▋      | 37/100 [01:31<02:26,  2.32s/it] 38%|███▊      | 38/100 [01:33<02:26,  2.37s/it] 39%|███▉      | 39/100 [01:35<02:09,  2.12s/it] 40%|████      | 40/100 [01:40<03:03,  3.05s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8491 / 0.9412 / 0.8438/ [0.83333333 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3466 / 0.3418 / 0.8320 / 0.3017/ [0.17834395 0.77011494 0.30172414]
 41%|████      | 41/100 [01:42<02:32,  2.59s/it] 42%|████▏     | 42/100 [01:44<02:31,  2.61s/it] 43%|████▎     | 43/100 [01:46<02:07,  2.25s/it] 44%|████▍     | 44/100 [01:48<02:12,  2.37s/it] 45%|████▌     | 45/100 [01:52<02:37,  2.86s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8637 / 0.9559 / 0.8438/ [0.88888889 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3382 / 0.3368 / 0.8689 / 0.2672/ [0.17834395 0.81609195 0.26724138]
 46%|████▌     | 46/100 [01:55<02:34,  2.86s/it] 47%|████▋     | 47/100 [01:56<02:07,  2.41s/it] 48%|████▊     | 48/100 [01:59<02:08,  2.47s/it] 49%|████▉     | 49/100 [02:01<01:51,  2.20s/it] 50%|█████     | 50/100 [02:06<02:31,  3.02s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3340 / 0.3355 / 0.8648 / 0.2586/ [0.18471338 0.8045977  0.25862069]
 51%|█████     | 51/100 [02:07<02:06,  2.57s/it] 52%|█████▏    | 52/100 [02:10<02:03,  2.58s/it] 53%|█████▎    | 53/100 [02:11<01:46,  2.27s/it] 54%|█████▍    | 54/100 [02:14<01:47,  2.35s/it] 55%|█████▌    | 55/100 [02:18<02:05,  2.78s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3382 / 0.3325 / 0.8730 / 0.2543/ [0.18471338 0.83908046 0.25431034]
 56%|█████▌    | 56/100 [02:20<01:58,  2.69s/it] 57%|█████▋    | 57/100 [02:22<01:40,  2.35s/it] 58%|█████▊    | 58/100 [02:24<01:39,  2.37s/it] 59%|█████▉    | 59/100 [02:26<01:26,  2.11s/it] 60%|██████    | 60/100 [02:31<01:59,  2.98s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3361 / 0.3369 / 0.8689 / 0.2543/ [0.1910828  0.81609195 0.25431034]
 61%|██████    | 61/100 [02:32<01:37,  2.51s/it] 62%|██████▏   | 62/100 [02:34<01:34,  2.50s/it] 63%|██████▎   | 63/100 [02:36<01:20,  2.17s/it] 64%|██████▍   | 64/100 [02:38<01:20,  2.23s/it] 65%|██████▌   | 65/100 [02:42<01:37,  2.78s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3382 / 0.3374 / 0.8689 / 0.2629/ [0.18471338 0.81609195 0.26293103]
 66%|██████▌   | 66/100 [02:45<01:31,  2.70s/it] 67%|██████▋   | 67/100 [02:46<01:18,  2.38s/it] 68%|██████▊   | 68/100 [02:49<01:17,  2.41s/it] 69%|██████▉   | 69/100 [02:50<01:05,  2.11s/it] 70%|███████   | 70/100 [02:55<01:29,  2.98s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3298 / 0.3293 / 0.8443 / 0.2759/ [0.15923567 0.7816092  0.27586207]
 71%|███████   | 71/100 [02:57<01:12,  2.50s/it] 72%|███████▏  | 72/100 [02:59<01:08,  2.46s/it] 73%|███████▎  | 73/100 [03:00<00:58,  2.15s/it] 74%|███████▍  | 74/100 [03:03<00:57,  2.20s/it] 75%|███████▌  | 75/100 [03:07<01:07,  2.70s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8637 / 0.9559 / 0.8438/ [0.88888889 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3382 / 0.3385 / 0.8402 / 0.2759/ [0.18471338 0.7816092  0.27586207]
 76%|███████▌  | 76/100 [03:09<01:02,  2.62s/it] 77%|███████▋  | 77/100 [03:10<00:51,  2.25s/it] 78%|███████▊  | 78/100 [03:13<00:51,  2.33s/it] 79%|███████▉  | 79/100 [03:14<00:43,  2.07s/it] 80%|████████  | 80/100 [03:20<00:59,  2.98s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3214 / 0.3147 / 0.8852 / 0.2241/ [0.17834395 0.83908046 0.22413793]
 81%|████████  | 81/100 [03:21<00:48,  2.53s/it] 82%|████████▏ | 82/100 [03:23<00:44,  2.48s/it] 83%|████████▎ | 83/100 [03:25<00:36,  2.16s/it] 84%|████████▍ | 84/100 [03:27<00:36,  2.25s/it] 85%|████████▌ | 85/100 [03:31<00:41,  2.76s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3403 / 0.3414 / 0.8361 / 0.2759/ [0.1910828  0.7816092  0.27586207]
 86%|████████▌ | 86/100 [03:34<00:37,  2.68s/it] 87%|████████▋ | 87/100 [03:35<00:30,  2.32s/it] 88%|████████▊ | 88/100 [03:38<00:28,  2.35s/it] 89%|████████▉ | 89/100 [03:39<00:23,  2.09s/it] 90%|█████████ | 90/100 [03:44<00:29,  2.94s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8684 / 0.9706 / 0.8438/ [0.94444444 0.9        0.84375   ]
                Test acc/f1/spec/sens = 0.3130 / 0.3196 / 0.8689 / 0.2112/ [0.1910828 0.8045977 0.2112069]
 91%|█████████ | 91/100 [03:46<00:22,  2.51s/it] 92%|█████████▏| 92/100 [03:48<00:20,  2.54s/it] 93%|█████████▎| 93/100 [03:50<00:15,  2.24s/it] 94%|█████████▍| 94/100 [03:52<00:14,  2.35s/it] 95%|█████████▌| 95/100 [03:56<00:14,  2.81s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8781 / 0.9706 / 0.8438/ [0.94444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.3277 / 0.3292 / 0.8443 / 0.2586/ [0.18471338 0.77011494 0.25862069]
 96%|█████████▌| 96/100 [03:59<00:10,  2.71s/it] 97%|█████████▋| 97/100 [04:00<00:06,  2.30s/it] 98%|█████████▊| 98/100 [04:02<00:04,  2.35s/it] 99%|█████████▉| 99/100 [04:04<00:02,  2.09s/it]100%|██████████| 100/100 [04:09<00:00,  2.91s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8879 / 0.9706 / 0.8438/ [0.94444444 0.94       0.84375   ]
                Test acc/f1/spec/sens = 0.3298 / 0.3246 / 0.8689 / 0.2586/ [0.1656051  0.81609195 0.25862069]
Trial 1, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9100 / 0.8879 / 0.9706 / 0.8438/ [0.94444444 0.94       0.84375   ]
Test acc/f1/spec/sens = 0.3298 / 0.3246 / 0.8689 / 0.2586/ [0.1656051  0.81609195 0.25862069]
>> Finished.
Acc, agreement for latest model:  0.32983193277310924 0.3949579831932773 [0.1656051  0.81609195 0.25862069]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3235294117647059 0.3865546218487395 [0.17834395 0.86206897 0.21982759]
Trial 0/1 || Cycle 1/5 || Label set size 180 || Test acc 0.3235 || Test agreement 0.3866 || Spec 0.8934 || Sens 0.2198 Class Acc: [0.17834395 0.86206897 0.21982759]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.99s/it]100%|██████████| 2/2 [00:13<00:00,  5.41s/it]100%|██████████| 2/2 [00:13<00:00,  6.72s/it]
Maximum distance from cluster centers is 0.62
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.64it/s] 33%|███▎      | 4/12 [00:00<00:01,  6.81it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.05it/s] 92%|█████████▏| 11/12 [00:01<00:00, 15.45it/s]100%|██████████| 12/12 [00:01<00:00,  9.26it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 39, 1: 96, 2: 45}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 50, 2: 32}
Labeled set distribution: 
Number of samples  360
{0: 73, 1: 163, 2: 124}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2311, agreement = 0.2311, f1 = 0.2213, spec = 0.9098, sens = 0.0000 Class Acc: [0.29936306 0.72413793 0.        ]
Initial model on validation dataset: acc = 0.2500, agreement = 0.2500, f1 = 0.1889, spec = 1.0000, sens = 0.0000 Class Acc: [1.   0.14 0.  ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<03:13,  1.95s/it]  2%|▏         | 2/100 [00:05<04:32,  2.79s/it]  3%|▎         | 3/100 [00:07<03:52,  2.39s/it]  4%|▍         | 4/100 [00:10<04:27,  2.79s/it]  5%|▌         | 5/100 [00:15<05:34,  3.52s/it]Epoch 5: Train acc/f1 = 0.5306 / 0.3820 / 1.0000 / 0.0161/ [0.43835616 0.96319018 0.01612903] 
                Val acc/f1/spec/sens = 0.7800 / 0.7186 / 0.9412 / 0.7188/ [0.5     0.92    0.71875]
                Test acc/f1/spec/sens = 0.2038 / 0.1464 / 1.0000 / 0.0000/ [0.06369427 1.         0.        ]
  6%|▌         | 6/100 [00:18<05:24,  3.45s/it]  7%|▋         | 7/100 [00:20<04:35,  2.96s/it]  8%|▊         | 8/100 [00:24<04:47,  3.12s/it]  9%|▉         | 9/100 [00:26<04:10,  2.75s/it] 10%|█         | 10/100 [00:32<05:38,  3.77s/it]Epoch 10: Train acc/f1 = 0.8111 / 0.7903 / 1.0000 / 0.6048/ [0.97260274 0.89570552 0.60483871] 
                Val acc/f1/spec/sens = 0.8300 / 0.7975 / 1.0000 / 0.6250/ [0.94444444 0.92       0.625     ]
                Test acc/f1/spec/sens = 0.2311 / 0.1874 / 0.9508 / 0.0603/ [0.06369427 0.98850575 0.06034483]
 11%|█         | 11/100 [00:34<04:45,  3.21s/it] 12%|█▏        | 12/100 [00:37<04:35,  3.13s/it] 13%|█▎        | 13/100 [00:39<04:02,  2.79s/it] 14%|█▍        | 14/100 [00:42<04:05,  2.86s/it] 15%|█▌        | 15/100 [00:46<04:49,  3.41s/it]Epoch 15: Train acc/f1 = 0.9222 / 0.9122 / 0.9958 / 0.8790/ [0.94520548 0.94478528 0.87903226] 
                Val acc/f1/spec/sens = 0.8400 / 0.8221 / 0.9706 / 0.8125/ [0.94444444 0.82       0.8125    ]
                Test acc/f1/spec/sens = 0.2941 / 0.2902 / 0.9467 / 0.1207/ [0.24203822 0.85057471 0.12068966]
 16%|█▌        | 16/100 [00:49<04:37,  3.30s/it] 17%|█▋        | 17/100 [00:51<04:02,  2.92s/it] 18%|█▊        | 18/100 [00:55<04:11,  3.06s/it] 19%|█▉        | 19/100 [00:57<03:41,  2.74s/it] 20%|██        | 20/100 [01:03<04:52,  3.66s/it]Epoch 20: Train acc/f1 = 0.5806 / 0.4562 / 0.3644 / 1.0000/ [0.04109589 0.50306748 1.        ] 
                Val acc/f1/spec/sens = 0.5400 / 0.3942 / 0.3824 / 1.0000/ [0.   0.44 1.  ]
                Test acc/f1/spec/sens = 0.5378 / 0.3588 / 0.2828 / 0.9957/ [0.         0.28735632 0.99568966]
 21%|██        | 21/100 [01:05<04:09,  3.16s/it] 22%|██▏       | 22/100 [01:08<04:10,  3.22s/it] 23%|██▎       | 23/100 [01:10<03:37,  2.83s/it] 24%|██▍       | 24/100 [01:13<03:36,  2.84s/it] 25%|██▌       | 25/100 [01:18<04:20,  3.47s/it]Epoch 25: Train acc/f1 = 0.9944 / 0.9927 / 0.9958 / 0.9919/ [0.98630137 1.         0.99193548] 
                Val acc/f1/spec/sens = 0.8900 / 0.8704 / 0.9265 / 0.9375/ [0.83333333 0.88       0.9375    ]
                Test acc/f1/spec/sens = 0.3256 / 0.3250 / 0.8934 / 0.2026/ [0.24203822 0.8045977  0.20258621]
 26%|██▌       | 26/100 [01:21<04:11,  3.39s/it] 27%|██▋       | 27/100 [01:23<03:35,  2.95s/it] 28%|██▊       | 28/100 [01:26<03:32,  2.95s/it] 29%|██▉       | 29/100 [01:28<03:07,  2.63s/it] 30%|███       | 30/100 [01:33<04:12,  3.61s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8937 / 0.9559 / 0.9375/ [0.88888889 0.9        0.9375    ]
                Test acc/f1/spec/sens = 0.3088 / 0.3081 / 0.9098 / 0.1767/ [0.24203822 0.7816092  0.17672414]
 31%|███       | 31/100 [01:35<03:35,  3.13s/it] 32%|███▏      | 32/100 [01:38<03:27,  3.06s/it] 33%|███▎      | 33/100 [01:40<03:01,  2.71s/it] 34%|███▍      | 34/100 [01:43<03:05,  2.81s/it] 35%|███▌      | 35/100 [01:48<03:40,  3.40s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8937 / 0.9559 / 0.9375/ [0.88888889 0.9        0.9375    ]
                Test acc/f1/spec/sens = 0.3277 / 0.3292 / 0.8811 / 0.1983/ [0.28025478 0.75862069 0.19827586]
 36%|███▌      | 36/100 [01:51<03:26,  3.22s/it] 37%|███▋      | 37/100 [01:53<02:58,  2.83s/it] 38%|███▊      | 38/100 [01:56<02:57,  2.86s/it] 39%|███▉      | 39/100 [01:58<02:38,  2.60s/it] 40%|████      | 40/100 [02:04<03:36,  3.61s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8828 / 0.9706 / 0.9062/ [0.88888889 0.9        0.90625   ]
                Test acc/f1/spec/sens = 0.2815 / 0.2758 / 0.9057 / 0.0948/ [0.27388535 0.79310345 0.09482759]
 41%|████      | 41/100 [02:06<03:03,  3.10s/it] 42%|████▏     | 42/100 [02:09<03:04,  3.18s/it] 43%|████▎     | 43/100 [02:11<02:38,  2.78s/it] 44%|████▍     | 44/100 [02:14<02:38,  2.83s/it] 45%|████▌     | 45/100 [02:19<03:09,  3.44s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8826 / 0.9412 / 0.9375/ [0.83333333 0.9        0.9375    ]
                Test acc/f1/spec/sens = 0.3214 / 0.3187 / 0.8852 / 0.1552/ [0.29936306 0.8045977  0.15517241]
 46%|████▌     | 46/100 [02:22<02:59,  3.32s/it] 47%|████▋     | 47/100 [02:24<02:33,  2.90s/it] 48%|████▊     | 48/100 [02:27<02:32,  2.94s/it] 49%|████▉     | 49/100 [02:29<02:15,  2.65s/it] 50%|█████     | 50/100 [02:35<03:03,  3.66s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8699 / 0.9412 / 0.9062/ [0.83333333 0.9        0.90625   ]
                Test acc/f1/spec/sens = 0.3130 / 0.3065 / 0.9057 / 0.1336/ [0.29299363 0.82758621 0.13362069]
 51%|█████     | 51/100 [02:37<02:33,  3.14s/it] 52%|█████▏    | 52/100 [02:40<02:28,  3.09s/it] 53%|█████▎    | 53/100 [02:42<02:10,  2.78s/it] 54%|█████▍    | 54/100 [02:45<02:10,  2.83s/it] 55%|█████▌    | 55/100 [02:50<02:39,  3.54s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8953 / 0.9706 / 0.9375/ [0.88888889 0.9        0.9375    ]
                Test acc/f1/spec/sens = 0.3277 / 0.3269 / 0.8934 / 0.1638/ [0.31210191 0.79310345 0.1637931 ]
 56%|█████▌    | 56/100 [02:53<02:30,  3.42s/it] 57%|█████▋    | 57/100 [02:55<02:09,  3.01s/it] 58%|█████▊    | 58/100 [02:58<02:06,  3.01s/it] 59%|█████▉    | 59/100 [03:00<01:50,  2.69s/it] 60%|██████    | 60/100 [03:06<02:26,  3.67s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8801 / 0.9559 / 0.9375/ [0.83333333 0.9        0.9375    ]
                Test acc/f1/spec/sens = 0.2983 / 0.2963 / 0.9057 / 0.1250/ [0.29299363 0.77011494 0.125     ]
 61%|██████    | 61/100 [03:08<02:03,  3.16s/it] 62%|██████▏   | 62/100 [03:11<01:57,  3.10s/it] 63%|██████▎   | 63/100 [03:13<01:44,  2.81s/it] 64%|██████▍   | 64/100 [03:16<01:41,  2.82s/it] 65%|██████▌   | 65/100 [03:21<02:01,  3.46s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8801 / 0.9559 / 0.9375/ [0.83333333 0.9        0.9375    ]
                Test acc/f1/spec/sens = 0.3046 / 0.3018 / 0.9057 / 0.1422/ [0.27388535 0.79310345 0.14224138]
 66%|██████▌   | 66/100 [03:24<01:52,  3.32s/it] 67%|██████▋   | 67/100 [03:26<01:37,  2.95s/it] 68%|██████▊   | 68/100 [03:29<01:34,  2.95s/it] 69%|██████▉   | 69/100 [03:31<01:22,  2.67s/it] 70%|███████   | 70/100 [03:37<01:49,  3.64s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8826 / 0.9412 / 0.9375/ [0.83333333 0.9        0.9375    ]
                Test acc/f1/spec/sens = 0.3214 / 0.3158 / 0.8934 / 0.1466/ [0.29936306 0.82758621 0.14655172]
 71%|███████   | 71/100 [03:39<01:31,  3.14s/it] 72%|███████▏  | 72/100 [03:42<01:27,  3.13s/it] 73%|███████▎  | 73/100 [03:44<01:13,  2.73s/it] 74%|███████▍  | 74/100 [03:46<01:12,  2.80s/it] 75%|███████▌  | 75/100 [03:51<01:23,  3.34s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8594 / 0.9412 / 0.9062/ [0.83333333 0.88       0.90625   ]
                Test acc/f1/spec/sens = 0.2857 / 0.2783 / 0.9098 / 0.0991/ [0.27388535 0.8045977  0.09913793]
 76%|███████▌  | 76/100 [03:54<01:17,  3.22s/it] 77%|███████▋  | 77/100 [03:56<01:05,  2.87s/it] 78%|███████▊  | 78/100 [03:59<01:04,  2.95s/it] 79%|███████▉  | 79/100 [04:01<00:55,  2.64s/it] 80%|████████  | 80/100 [04:07<01:11,  3.56s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8826 / 0.9412 / 0.9375/ [0.83333333 0.9        0.9375    ]
                Test acc/f1/spec/sens = 0.3340 / 0.3320 / 0.8852 / 0.1810/ [0.29936306 0.8045977  0.18103448]
 81%|████████  | 81/100 [04:09<00:58,  3.10s/it] 82%|████████▏ | 82/100 [04:12<00:54,  3.05s/it] 83%|████████▎ | 83/100 [04:14<00:46,  2.71s/it] 84%|████████▍ | 84/100 [04:17<00:44,  2.80s/it] 85%|████████▌ | 85/100 [04:22<00:51,  3.41s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8717 / 0.9412 / 0.9375/ [0.83333333 0.88       0.9375    ]
                Test acc/f1/spec/sens = 0.3067 / 0.3003 / 0.9098 / 0.1379/ [0.27388535 0.81609195 0.13793103]
 86%|████████▌ | 86/100 [04:24<00:45,  3.27s/it] 87%|████████▋ | 87/100 [04:26<00:37,  2.86s/it] 88%|████████▊ | 88/100 [04:29<00:34,  2.85s/it] 89%|████████▉ | 89/100 [04:31<00:28,  2.56s/it] 90%|█████████ | 90/100 [04:37<00:35,  3.52s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8717 / 0.9412 / 0.9375/ [0.83333333 0.88       0.9375    ]
                Test acc/f1/spec/sens = 0.3256 / 0.3263 / 0.8975 / 0.1681/ [0.31210191 0.77011494 0.16810345]
 91%|█████████ | 91/100 [04:39<00:27,  3.05s/it] 92%|█████████▏| 92/100 [04:42<00:24,  3.03s/it] 93%|█████████▎| 93/100 [04:44<00:18,  2.69s/it] 94%|█████████▍| 94/100 [04:47<00:16,  2.74s/it] 95%|█████████▌| 95/100 [04:51<00:16,  3.38s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8801 / 0.9559 / 0.9375/ [0.83333333 0.9        0.9375    ]
                Test acc/f1/spec/sens = 0.3046 / 0.2998 / 0.9098 / 0.1422/ [0.2611465  0.81609195 0.14224138]
 96%|█████████▌| 96/100 [04:54<00:12,  3.24s/it] 97%|█████████▋| 97/100 [04:56<00:08,  2.83s/it] 98%|█████████▊| 98/100 [04:59<00:05,  2.81s/it] 99%|█████████▉| 99/100 [05:01<00:02,  2.55s/it]100%|██████████| 100/100 [05:07<00:00,  3.55s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8801 / 0.9559 / 0.9375/ [0.83333333 0.9        0.9375    ]
                Test acc/f1/spec/sens = 0.2983 / 0.2942 / 0.9098 / 0.1379/ [0.2611465  0.79310345 0.13793103]
Trial 1, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9000 / 0.8801 / 0.9559 / 0.9375/ [0.83333333 0.9        0.9375    ]
Test acc/f1/spec/sens = 0.2983 / 0.2942 / 0.9098 / 0.1379/ [0.2611465  0.79310345 0.13793103]
>> Finished.
Acc, agreement for latest model:  0.29831932773109243 0.33613445378151263 [0.2611465  0.79310345 0.13793103]
Load best checkpoint for thief model
Acc, agreement for best model:  0.28991596638655465 0.32563025210084034 [0.26751592 0.73563218 0.13793103]
Trial 0/1 || Cycle 2/5 || Label set size 360 || Test acc 0.2899 || Test agreement 0.3256 || Spec 0.9057 || Sens 0.1379 Class Acc: [0.26751592 0.73563218 0.13793103]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.25s/it]100%|██████████| 2/2 [00:12<00:00,  5.10s/it]100%|██████████| 2/2 [00:12<00:00,  6.31s/it]
Maximum distance from cluster centers is 0.55
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.75it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.35it/s] 50%|█████     | 6/12 [00:00<00:00, 10.15it/s] 75%|███████▌  | 9/12 [00:00<00:00, 13.55it/s]100%|██████████| 12/12 [00:01<00:00, 10.34it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 33, 1: 98, 2: 49}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 50, 2: 32}
Labeled set distribution: 
Number of samples  540
{0: 106, 1: 261, 2: 173}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.1744, agreement = 0.1954, f1 = 0.1542, spec = 1.0000, sens = 0.0043 Class Acc: [0.36305732 0.28735632 0.00431034]
Initial model on validation dataset: acc = 0.2200, agreement = 0.2200, f1 = 0.1703, spec = 0.9706, sens = 0.0625 Class Acc: [1.     0.04   0.0625]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:13,  2.56s/it]  2%|▏         | 2/100 [00:06<05:39,  3.47s/it]  3%|▎         | 3/100 [00:09<04:53,  3.03s/it]  4%|▍         | 4/100 [00:12<05:10,  3.23s/it]  5%|▌         | 5/100 [00:18<06:37,  4.19s/it]Epoch 5: Train acc/f1 = 0.8593 / 0.8359 / 0.9809 / 0.8266/ [0.81132075 0.90038314 0.8265896 ] 
                Val acc/f1/spec/sens = 0.8000 / 0.7380 / 0.9706 / 0.6875/ [0.5    0.98   0.6875]
                Test acc/f1/spec/sens = 0.4895 / 0.4396 / 0.9180 / 0.6336/ [0.07643312 0.85057471 0.63362069]
  6%|▌         | 6/100 [00:22<06:14,  3.98s/it]  7%|▋         | 7/100 [00:24<05:26,  3.51s/it]  8%|▊         | 8/100 [00:28<05:22,  3.50s/it]  9%|▉         | 9/100 [00:30<04:55,  3.24s/it] 10%|█         | 10/100 [00:38<06:39,  4.44s/it]Epoch 10: Train acc/f1 = 0.8889 / 0.8610 / 0.9864 / 0.8960/ [0.63207547 0.98850575 0.89595376] 
                Val acc/f1/spec/sens = 0.8400 / 0.7940 / 0.9853 / 0.7812/ [0.5     1.      0.78125]
                Test acc/f1/spec/sens = 0.2962 / 0.2679 / 0.8975 / 0.2155/ [0.06369427 0.93103448 0.21551724]
 11%|█         | 11/100 [00:40<05:43,  3.86s/it] 12%|█▏        | 12/100 [00:44<05:44,  3.92s/it] 13%|█▎        | 13/100 [00:47<05:04,  3.49s/it] 14%|█▍        | 14/100 [00:50<05:00,  3.49s/it] 15%|█▌        | 15/100 [00:56<05:59,  4.23s/it]Epoch 15: Train acc/f1 = 0.9333 / 0.9228 / 0.9755 / 0.9133/ [0.88679245 0.96551724 0.9132948 ] 
                Val acc/f1/spec/sens = 0.8300 / 0.7745 / 0.9265 / 0.9062/ [0.5     0.9     0.90625]
                Test acc/f1/spec/sens = 0.3445 / 0.3258 / 0.7787 / 0.3147/ [0.06369427 0.93103448 0.31465517]
 16%|█▌        | 16/100 [01:00<05:40,  4.05s/it] 17%|█▋        | 17/100 [01:02<04:58,  3.60s/it] 18%|█▊        | 18/100 [01:06<04:51,  3.55s/it] 19%|█▉        | 19/100 [01:08<04:23,  3.25s/it] 20%|██        | 20/100 [01:16<05:59,  4.49s/it]Epoch 20: Train acc/f1 = 0.9889 / 0.9863 / 1.0000 / 0.9942/ [0.96226415 0.99616858 0.99421965] 
                Val acc/f1/spec/sens = 0.8500 / 0.8065 / 0.9559 / 0.8750/ [0.61111111 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.4097 / 0.4089 / 0.8443 / 0.2716/ [0.32484076 0.93103448 0.27155172]
 21%|██        | 21/100 [01:18<05:08,  3.91s/it] 22%|██▏       | 22/100 [01:22<04:56,  3.80s/it] 23%|██▎       | 23/100 [01:24<04:22,  3.42s/it] 24%|██▍       | 24/100 [01:28<04:23,  3.47s/it] 25%|██▌       | 25/100 [01:34<05:12,  4.17s/it]Epoch 25: Train acc/f1 = 0.9981 / 0.9978 / 1.0000 / 1.0000/ [0.99056604 1.         1.        ] 
                Val acc/f1/spec/sens = 0.8500 / 0.8048 / 0.9412 / 0.8750/ [0.61111111 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.4454 / 0.4282 / 0.7131 / 0.4526/ [0.24203822 0.79310345 0.45258621]
 26%|██▌       | 26/100 [01:37<04:52,  3.95s/it] 27%|██▋       | 27/100 [01:40<04:16,  3.51s/it] 28%|██▊       | 28/100 [01:43<04:15,  3.55s/it] 29%|██▉       | 29/100 [01:46<03:51,  3.26s/it] 30%|███       | 30/100 [01:53<05:03,  4.33s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7965 / 0.9706 / 0.8438/ [0.61111111 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.4874 / 0.4579 / 0.7705 / 0.5259/ [0.21019108 0.88505747 0.52586207]
 31%|███       | 31/100 [01:55<04:24,  3.83s/it] 32%|███▏      | 32/100 [01:59<04:11,  3.69s/it] 33%|███▎      | 33/100 [02:01<03:43,  3.33s/it] 34%|███▍      | 34/100 [02:05<03:45,  3.41s/it] 35%|███▌      | 35/100 [02:11<04:32,  4.18s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7965 / 0.9706 / 0.8438/ [0.61111111 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.4286 / 0.4190 / 0.7213 / 0.4009/ [0.26751592 0.79310345 0.40086207]
 36%|███▌      | 36/100 [02:14<04:12,  3.95s/it] 37%|███▋      | 37/100 [02:16<03:37,  3.46s/it] 38%|███▊      | 38/100 [02:20<03:35,  3.47s/it] 39%|███▉      | 39/100 [02:22<03:15,  3.20s/it] 40%|████      | 40/100 [02:29<04:16,  4.28s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8100 / 0.7440 / 0.9559 / 0.8438/ [0.44444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.4097 / 0.3985 / 0.7418 / 0.3664/ [0.23566879 0.83908046 0.36637931]
 41%|████      | 41/100 [02:32<03:41,  3.75s/it] 42%|████▏     | 42/100 [02:35<03:35,  3.71s/it] 43%|████▎     | 43/100 [02:38<03:09,  3.33s/it] 44%|████▍     | 44/100 [02:41<03:07,  3.36s/it] 45%|████▌     | 45/100 [02:47<03:44,  4.09s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8200 / 0.7636 / 0.9706 / 0.8438/ [0.5     0.92    0.84375]
                Test acc/f1/spec/sens = 0.4622 / 0.4459 / 0.7418 / 0.4698/ [0.26751592 0.79310345 0.46982759]
 46%|████▌     | 46/100 [02:51<03:33,  3.96s/it] 47%|████▋     | 47/100 [02:53<03:06,  3.51s/it] 48%|████▊     | 48/100 [02:57<03:01,  3.48s/it] 49%|████▉     | 49/100 [02:59<02:42,  3.19s/it] 50%|█████     | 50/100 [03:06<03:37,  4.34s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8200 / 0.7599 / 0.9412 / 0.8438/ [0.5     0.92    0.84375]
                Test acc/f1/spec/sens = 0.4244 / 0.4129 / 0.7295 / 0.4052/ [0.25477707 0.7816092  0.40517241]
 51%|█████     | 51/100 [03:09<03:05,  3.79s/it] 52%|█████▏    | 52/100 [03:12<02:56,  3.67s/it] 53%|█████▎    | 53/100 [03:15<02:35,  3.31s/it] 54%|█████▍    | 54/100 [03:18<02:34,  3.35s/it] 55%|█████▌    | 55/100 [03:24<03:04,  4.10s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8200 / 0.7636 / 0.9706 / 0.8438/ [0.5     0.92    0.84375]
                Test acc/f1/spec/sens = 0.3908 / 0.3856 / 0.7951 / 0.2716/ [0.26751592 0.93103448 0.27155172]
 56%|█████▌    | 56/100 [03:27<02:53,  3.93s/it] 57%|█████▋    | 57/100 [03:30<02:32,  3.55s/it] 58%|█████▊    | 58/100 [03:33<02:27,  3.52s/it] 59%|█████▉    | 59/100 [03:36<02:11,  3.21s/it] 60%|██████    | 60/100 [03:43<02:51,  4.28s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8200 / 0.7636 / 0.9706 / 0.8438/ [0.5     0.92    0.84375]
                Test acc/f1/spec/sens = 0.4370 / 0.4263 / 0.7582 / 0.4052/ [0.26751592 0.82758621 0.40517241]
 61%|██████    | 61/100 [03:45<02:25,  3.74s/it] 62%|██████▏   | 62/100 [03:49<02:19,  3.68s/it] 63%|██████▎   | 63/100 [03:51<02:04,  3.36s/it] 64%|██████▍   | 64/100 [03:55<02:02,  3.40s/it] 65%|██████▌   | 65/100 [04:01<02:24,  4.12s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8200 / 0.7636 / 0.9706 / 0.8438/ [0.5     0.92    0.84375]
                Test acc/f1/spec/sens = 0.4139 / 0.4052 / 0.7500 / 0.3793/ [0.26751592 0.77011494 0.37931034]
 66%|██████▌   | 66/100 [04:04<02:13,  3.93s/it] 67%|██████▋   | 67/100 [04:07<01:55,  3.50s/it] 68%|██████▊   | 68/100 [04:10<01:50,  3.47s/it] 69%|██████▉   | 69/100 [04:13<01:38,  3.19s/it] 70%|███████   | 70/100 [04:19<02:07,  4.25s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8100 / 0.7422 / 0.9412 / 0.8438/ [0.44444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.4559 / 0.4358 / 0.7090 / 0.4741/ [0.22929936 0.81609195 0.47413793]
 71%|███████   | 71/100 [04:22<01:48,  3.73s/it] 72%|███████▏  | 72/100 [04:25<01:41,  3.64s/it] 73%|███████▎  | 73/100 [04:28<01:28,  3.29s/it] 74%|███████▍  | 74/100 [04:31<01:27,  3.37s/it] 75%|███████▌  | 75/100 [04:37<01:42,  4.11s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8200 / 0.7636 / 0.9706 / 0.8438/ [0.5     0.92    0.84375]
                Test acc/f1/spec/sens = 0.4265 / 0.4175 / 0.7582 / 0.3879/ [0.27388535 0.8045977  0.38793103]
 76%|███████▌  | 76/100 [04:41<01:34,  3.92s/it] 77%|███████▋  | 77/100 [04:43<01:21,  3.52s/it] 78%|███████▊  | 78/100 [04:47<01:18,  3.56s/it] 79%|███████▉  | 79/100 [04:49<01:08,  3.24s/it] 80%|████████  | 80/100 [04:56<01:26,  4.34s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8100 / 0.7440 / 0.9559 / 0.8438/ [0.44444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.4370 / 0.4251 / 0.7418 / 0.4138/ [0.2611465  0.81609195 0.4137931 ]
 81%|████████  | 81/100 [04:59<01:11,  3.77s/it] 82%|████████▏ | 82/100 [05:02<01:05,  3.66s/it] 83%|████████▎ | 83/100 [05:04<00:55,  3.27s/it] 84%|████████▍ | 84/100 [05:08<00:53,  3.33s/it] 85%|████████▌ | 85/100 [05:14<01:00,  4.05s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8100 / 0.7440 / 0.9559 / 0.8438/ [0.44444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.4328 / 0.4230 / 0.7582 / 0.3922/ [0.26751592 0.83908046 0.39224138]
 86%|████████▌ | 86/100 [05:17<00:54,  3.91s/it] 87%|████████▋ | 87/100 [05:20<00:45,  3.49s/it] 88%|████████▊ | 88/100 [05:23<00:41,  3.49s/it] 89%|████████▉ | 89/100 [05:26<00:35,  3.20s/it] 90%|█████████ | 90/100 [05:33<00:43,  4.32s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8200 / 0.7636 / 0.9706 / 0.8438/ [0.5     0.92    0.84375]
                Test acc/f1/spec/sens = 0.4286 / 0.4197 / 0.7582 / 0.3836/ [0.26751592 0.83908046 0.38362069]
 91%|█████████ | 91/100 [05:35<00:33,  3.75s/it] 92%|█████████▏| 92/100 [05:39<00:29,  3.71s/it] 93%|█████████▎| 93/100 [05:41<00:23,  3.36s/it] 94%|█████████▍| 94/100 [05:45<00:20,  3.44s/it] 95%|█████████▌| 95/100 [05:51<00:21,  4.21s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8100 / 0.7440 / 0.9559 / 0.8438/ [0.44444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.4328 / 0.4175 / 0.7131 / 0.4353/ [0.23566879 0.7816092  0.43534483]
 96%|█████████▌| 96/100 [05:54<00:15,  3.99s/it] 97%|█████████▋| 97/100 [05:57<00:10,  3.51s/it] 98%|█████████▊| 98/100 [06:00<00:07,  3.51s/it] 99%|█████████▉| 99/100 [06:03<00:03,  3.23s/it]100%|██████████| 100/100 [06:10<00:00,  4.28s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8100 / 0.7440 / 0.9559 / 0.8438/ [0.44444444 0.92       0.84375   ]
                Test acc/f1/spec/sens = 0.4181 / 0.4087 / 0.7623 / 0.3621/ [0.25477707 0.86206897 0.36206897]
Trial 1, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8100 / 0.7440 / 0.9559 / 0.8438/ [0.44444444 0.92       0.84375   ]
Test acc/f1/spec/sens = 0.4181 / 0.4087 / 0.7623 / 0.3621/ [0.25477707 0.86206897 0.36206897]
>> Finished.
Acc, agreement for latest model:  0.4180672268907563 0.47478991596638653 [0.25477707 0.86206897 0.36206897]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4096638655462185 0.46638655462184875 [0.32484076 0.93103448 0.27155172]
Trial 0/1 || Cycle 3/5 || Label set size 540 || Test acc 0.4097 || Test agreement 0.4664 || Spec 0.8443 || Sens 0.2716 Class Acc: [0.32484076 0.93103448 0.27155172]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.30s/it]100%|██████████| 2/2 [00:12<00:00,  5.12s/it]100%|██████████| 2/2 [00:12<00:00,  6.32s/it]
Maximum distance from cluster centers is 0.42
labeled set:  720
unlabeled set:  713
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:05,  1.88it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.55it/s] 67%|██████▋   | 8/12 [00:00<00:00, 13.43it/s] 92%|█████████▏| 11/12 [00:00<00:00, 16.73it/s]100%|██████████| 12/12 [00:01<00:00, 10.29it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 29, 1: 91, 2: 60}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 50, 2: 32}
Labeled set distribution: 
Number of samples  720
{0: 135, 1: 352, 2: 233}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2164, agreement = 0.1828, f1 = 0.1972, spec = 0.8320, sens = 0.0043 Class Acc: [0.51592357 0.24137931 0.00431034]
Initial model on validation dataset: acc = 0.2100, agreement = 0.2100, f1 = 0.1598, spec = 0.9265, sens = 0.0312 Class Acc: [0.94444444 0.06       0.03125   ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:09,  3.12s/it]  2%|▏         | 2/100 [00:07<06:27,  3.95s/it]  3%|▎         | 3/100 [00:10<05:48,  3.59s/it]  4%|▍         | 4/100 [00:15<06:18,  3.94s/it]  5%|▌         | 5/100 [00:22<07:56,  5.01s/it]Epoch 5: Train acc/f1 = 0.8236 / 0.8042 / 0.8768 / 0.9614/ [0.79259259 0.74431818 0.96137339] 
                Val acc/f1/spec/sens = 0.8600 / 0.8057 / 0.9853 / 0.8750/ [0.5   0.98  0.875]
                Test acc/f1/spec/sens = 0.6429 / 0.5223 / 0.6926 / 0.9784/ [0.10191083 0.72413793 0.97844828]
  6%|▌         | 6/100 [00:26<07:34,  4.83s/it]  7%|▋         | 7/100 [00:29<06:31,  4.21s/it]  8%|▊         | 8/100 [00:33<06:22,  4.16s/it]  9%|▉         | 9/100 [00:36<05:43,  3.77s/it] 10%|█         | 10/100 [00:44<07:43,  5.15s/it]Epoch 10: Train acc/f1 = 0.9250 / 0.9107 / 0.9671 / 0.9657/ [0.91851852 0.90056818 0.96566524] 
                Val acc/f1/spec/sens = 0.8600 / 0.8340 / 0.9559 / 0.8438/ [0.83333333 0.88       0.84375   ]
                Test acc/f1/spec/sens = 0.5378 / 0.4613 / 0.8811 / 0.7716/ [0.06369427 0.77011494 0.77155172]
 11%|█         | 11/100 [00:47<06:38,  4.47s/it] 12%|█▏        | 12/100 [00:51<06:25,  4.38s/it] 13%|█▎        | 13/100 [00:55<05:46,  3.98s/it] 14%|█▍        | 14/100 [00:59<05:50,  4.07s/it] 15%|█▌        | 15/100 [01:06<06:59,  4.93s/it]Epoch 15: Train acc/f1 = 0.9028 / 0.8908 / 0.9507 / 0.9700/ [0.9037037  0.85795455 0.96995708] 
                Val acc/f1/spec/sens = 0.8600 / 0.8231 / 0.9706 / 0.7812/ [0.66666667 0.98       0.78125   ]
                Test acc/f1/spec/sens = 0.3172 / 0.3389 / 0.8975 / 0.2284/ [0.21656051 0.73563218 0.22844828]
 16%|█▌        | 16/100 [01:10<06:37,  4.73s/it] 17%|█▋        | 17/100 [01:13<05:52,  4.25s/it] 18%|█▊        | 18/100 [01:17<05:42,  4.18s/it] 19%|█▉        | 19/100 [01:20<05:11,  3.85s/it] 20%|██        | 20/100 [01:28<06:47,  5.09s/it]Epoch 20: Train acc/f1 = 0.9097 / 0.8958 / 1.0000 / 0.8755/ [0.95555556 0.91477273 0.87553648] 
                Val acc/f1/spec/sens = 0.8300 / 0.8051 / 0.9853 / 0.7812/ [0.83333333 0.86       0.78125   ]
                Test acc/f1/spec/sens = 0.2290 / 0.2291 / 0.9590 / 0.0647/ [0.17197452 0.77011494 0.06465517]
 21%|██        | 21/100 [01:31<05:55,  4.50s/it] 22%|██▏       | 22/100 [01:36<05:48,  4.47s/it] 23%|██▎       | 23/100 [01:39<05:11,  4.05s/it] 24%|██▍       | 24/100 [01:43<05:19,  4.21s/it] 25%|██▌       | 25/100 [01:50<06:21,  5.08s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8495 / 0.9559 / 0.9062/ [0.72222222 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.3929 / 0.3794 / 0.9098 / 0.4138/ [0.06369427 0.93103448 0.4137931 ]
 26%|██▌       | 26/100 [01:55<05:56,  4.81s/it] 27%|██▋       | 27/100 [01:58<05:14,  4.30s/it] 28%|██▊       | 28/100 [02:02<05:09,  4.29s/it] 29%|██▉       | 29/100 [02:05<04:37,  3.91s/it] 30%|███       | 30/100 [02:13<05:58,  5.11s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8495 / 0.9559 / 0.9062/ [0.72222222 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.4979 / 0.4440 / 0.9180 / 0.6164/ [0.05095541 0.98850575 0.61637931]
 31%|███       | 31/100 [02:16<05:09,  4.48s/it] 32%|███▏      | 32/100 [02:20<04:54,  4.33s/it] 33%|███▎      | 33/100 [02:23<04:26,  3.98s/it] 34%|███▍      | 34/100 [02:27<04:25,  4.03s/it] 35%|███▌      | 35/100 [02:34<05:18,  4.90s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8372 / 0.9559 / 0.8750/ [0.72222222 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.4622 / 0.4226 / 0.9180 / 0.5517/ [0.05095541 0.96551724 0.55172414]
 36%|███▌      | 36/100 [02:38<05:00,  4.70s/it] 37%|███▋      | 37/100 [02:41<04:25,  4.21s/it] 38%|███▊      | 38/100 [02:46<04:27,  4.31s/it] 39%|███▉      | 39/100 [02:49<04:00,  3.93s/it] 40%|████      | 40/100 [02:57<05:07,  5.12s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8517 / 0.9559 / 0.8750/ [0.77777778 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.4223 / 0.4004 / 0.9098 / 0.4698/ [0.06369427 0.94252874 0.46982759]
 41%|████      | 41/100 [03:00<04:26,  4.52s/it] 42%|████▏     | 42/100 [03:05<04:23,  4.55s/it] 43%|████▎     | 43/100 [03:08<03:52,  4.09s/it] 44%|████▍     | 44/100 [03:12<03:47,  4.07s/it] 45%|████▌     | 45/100 [03:19<04:29,  4.91s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8641 / 0.9559 / 0.9062/ [0.77777778 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.4034 / 0.3898 / 0.9180 / 0.4224/ [0.07006369 0.95402299 0.42241379]
 46%|████▌     | 46/100 [03:23<04:14,  4.70s/it] 47%|████▋     | 47/100 [03:26<03:46,  4.27s/it] 48%|████▊     | 48/100 [03:30<03:38,  4.20s/it] 49%|████▉     | 49/100 [03:33<03:16,  3.86s/it] 50%|█████     | 50/100 [03:41<04:13,  5.08s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8495 / 0.9559 / 0.9062/ [0.72222222 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.5000 / 0.4498 / 0.9098 / 0.6207/ [0.07006369 0.95402299 0.62068966]
 51%|█████     | 51/100 [03:44<03:39,  4.49s/it] 52%|█████▏    | 52/100 [03:48<03:31,  4.40s/it] 53%|█████▎    | 53/100 [03:52<03:08,  4.02s/it] 54%|█████▍    | 54/100 [03:56<03:05,  4.03s/it] 55%|█████▌    | 55/100 [04:02<03:36,  4.81s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8641 / 0.9559 / 0.9062/ [0.77777778 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.4811 / 0.4365 / 0.9180 / 0.5819/ [0.05732484 0.97701149 0.58189655]
 56%|█████▌    | 56/100 [04:06<03:21,  4.59s/it] 57%|█████▋    | 57/100 [04:09<02:57,  4.12s/it] 58%|█████▊    | 58/100 [04:14<02:56,  4.21s/it] 59%|█████▉    | 59/100 [04:17<02:38,  3.88s/it] 60%|██████    | 60/100 [04:25<03:23,  5.09s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8641 / 0.9559 / 0.9062/ [0.77777778 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.4748 / 0.4337 / 0.9098 / 0.5690/ [0.06369427 0.96551724 0.56896552]
 61%|██████    | 61/100 [04:28<02:54,  4.48s/it] 62%|██████▏   | 62/100 [04:32<02:44,  4.34s/it] 63%|██████▎   | 63/100 [04:35<02:26,  3.95s/it] 64%|██████▍   | 64/100 [04:39<02:23,  3.99s/it] 65%|██████▌   | 65/100 [04:46<02:51,  4.91s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8517 / 0.9559 / 0.8750/ [0.77777778 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.4853 / 0.4398 / 0.9016 / 0.5991/ [0.07006369 0.93103448 0.59913793]
 66%|██████▌   | 66/100 [04:50<02:37,  4.63s/it] 67%|██████▋   | 67/100 [04:53<02:16,  4.15s/it] 68%|██████▊   | 68/100 [04:57<02:13,  4.17s/it] 69%|██████▉   | 69/100 [05:00<01:59,  3.85s/it] 70%|███████   | 70/100 [05:09<02:38,  5.30s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8641 / 0.9559 / 0.9062/ [0.77777778 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.4601 / 0.4259 / 0.9098 / 0.5431/ [0.07006369 0.94252874 0.54310345]
 71%|███████   | 71/100 [05:12<02:15,  4.69s/it] 72%|███████▏  | 72/100 [05:16<02:06,  4.52s/it] 73%|███████▎  | 73/100 [05:20<01:50,  4.10s/it] 74%|███████▍  | 74/100 [05:24<01:46,  4.09s/it] 75%|███████▌  | 75/100 [05:30<02:03,  4.93s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8641 / 0.9559 / 0.9062/ [0.77777778 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.4202 / 0.4015 / 0.9139 / 0.4526/ [0.07006369 0.96551724 0.45258621]
 76%|███████▌  | 76/100 [05:34<01:51,  4.64s/it] 77%|███████▋  | 77/100 [05:38<01:37,  4.22s/it] 78%|███████▊  | 78/100 [05:42<01:32,  4.21s/it] 79%|███████▉  | 79/100 [05:45<01:22,  3.91s/it] 80%|████████  | 80/100 [05:53<01:42,  5.11s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8517 / 0.9559 / 0.8750/ [0.77777778 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.4181 / 0.3998 / 0.9139 / 0.4526/ [0.07006369 0.95402299 0.45258621]
 81%|████████  | 81/100 [05:56<01:25,  4.48s/it] 82%|████████▏ | 82/100 [06:00<01:18,  4.35s/it] 83%|████████▎ | 83/100 [06:03<01:07,  3.98s/it] 84%|████████▍ | 84/100 [06:07<01:03,  3.98s/it] 85%|████████▌ | 85/100 [06:14<01:12,  4.81s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8517 / 0.9559 / 0.8750/ [0.77777778 0.92       0.875     ]
                Test acc/f1/spec/sens = 0.4349 / 0.4112 / 0.9139 / 0.4828/ [0.07006369 0.96551724 0.48275862]
 86%|████████▌ | 86/100 [06:18<01:04,  4.62s/it] 87%|████████▋ | 87/100 [06:21<00:54,  4.18s/it] 88%|████████▊ | 88/100 [06:25<00:50,  4.19s/it] 89%|████████▉ | 89/100 [06:29<00:42,  3.89s/it] 90%|█████████ | 90/100 [06:36<00:50,  5.08s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8343 / 0.9559 / 0.9062/ [0.66666667 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.4937 / 0.4416 / 0.9139 / 0.6121/ [0.05095541 0.97701149 0.61206897]
 91%|█████████ | 91/100 [06:40<00:40,  4.49s/it] 92%|█████████▏| 92/100 [06:44<00:34,  4.34s/it] 93%|█████████▎| 93/100 [06:47<00:27,  3.92s/it] 94%|█████████▍| 94/100 [06:51<00:23,  3.95s/it] 95%|█████████▌| 95/100 [06:58<00:24,  4.89s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8641 / 0.9559 / 0.9062/ [0.77777778 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.4748 / 0.4309 / 0.9180 / 0.5733/ [0.05095541 0.97701149 0.57327586]
 96%|█████████▌| 96/100 [07:02<00:18,  4.61s/it] 97%|█████████▋| 97/100 [07:04<00:12,  4.10s/it] 98%|█████████▊| 98/100 [07:09<00:08,  4.11s/it] 99%|█████████▉| 99/100 [07:12<00:03,  3.79s/it]100%|██████████| 100/100 [07:20<00:00,  5.03s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8641 / 0.9559 / 0.9062/ [0.77777778 0.92       0.90625   ]
                Test acc/f1/spec/sens = 0.4307 / 0.4074 / 0.9098 / 0.4828/ [0.07006369 0.94252874 0.48275862]
Trial 1, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8900 / 0.8641 / 0.9559 / 0.9062/ [0.77777778 0.92       0.90625   ]
Test acc/f1/spec/sens = 0.4307 / 0.4074 / 0.9098 / 0.4828/ [0.07006369 0.94252874 0.48275862]
>> Finished.
Acc, agreement for latest model:  0.43067226890756305 0.47478991596638653 [0.07006369 0.94252874 0.48275862]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4789915966386555 0.523109243697479 [0.07006369 0.95402299 0.57758621]
Trial 0/1 || Cycle 4/5 || Label set size 720 || Test acc 0.4790 || Test agreement 0.5231 || Spec 0.9098 || Sens 0.5776 Class Acc: [0.07006369 0.95402299 0.57758621]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.44s/it]100%|██████████| 2/2 [00:12<00:00,  5.19s/it]100%|██████████| 2/2 [00:12<00:00,  6.39s/it]
Maximum distance from cluster centers is 0.40
labeled set:  900
unlabeled set:  533
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.47it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.54it/s] 75%|███████▌  | 9/12 [00:01<00:00, 10.74it/s]100%|██████████| 12/12 [00:01<00:00,  9.28it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 43, 1: 45, 2: 92}
Validation set distribution: 
Number of samples  100
{0: 18, 1: 50, 2: 32}
Labeled set distribution: 
Number of samples  900
{0: 178, 1: 397, 2: 325}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.3403, agreement = 0.3508, f1 = 0.3185, spec = 0.8975, sens = 0.1897 Class Acc: [0.58598726 0.29885057 0.18965517]
Initial model on validation dataset: acc = 0.2300, agreement = 0.2300, f1 = 0.2350, spec = 0.8382, sens = 0.2188 Class Acc: [0.5     0.14    0.21875]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:53,  3.57s/it]  2%|▏         | 2/100 [00:08<07:08,  4.37s/it]  3%|▎         | 3/100 [00:12<06:35,  4.08s/it]  4%|▍         | 4/100 [00:17<07:11,  4.49s/it]  5%|▌         | 5/100 [00:25<09:06,  5.76s/it]Epoch 5: Train acc/f1 = 0.8744 / 0.8553 / 0.9774 / 0.8400/ [0.84831461 0.91435768 0.84      ] 
                Val acc/f1/spec/sens = 0.8100 / 0.7675 / 0.9118 / 0.8750/ [0.61111111 0.84       0.875     ]
                Test acc/f1/spec/sens = 0.5693 / 0.5394 / 0.8238 / 0.6595/ [0.23566879 0.93103448 0.65948276]
  6%|▌         | 6/100 [00:30<08:38,  5.52s/it]  7%|▋         | 7/100 [00:34<07:41,  4.96s/it]  8%|▊         | 8/100 [00:39<07:32,  4.92s/it]  9%|▉         | 9/100 [00:42<06:54,  4.55s/it] 10%|█         | 10/100 [00:52<09:10,  6.12s/it]Epoch 10: Train acc/f1 = 0.9122 / 0.8927 / 0.9809 / 0.9385/ [0.76966292 0.95465995 0.93846154] 
                Val acc/f1/spec/sens = 0.8700 / 0.8196 / 0.9853 / 0.8750/ [0.55555556 0.98       0.875     ]
                Test acc/f1/spec/sens = 0.3866 / 0.3599 / 0.8320 / 0.3879/ [0.11464968 0.87356322 0.38793103]
 11%|█         | 11/100 [00:55<07:54,  5.33s/it] 12%|█▏        | 12/100 [01:00<07:33,  5.15s/it] 13%|█▎        | 13/100 [01:04<06:56,  4.79s/it] 14%|█▍        | 14/100 [01:09<06:52,  4.80s/it] 15%|█▌        | 15/100 [01:17<08:11,  5.78s/it]Epoch 15: Train acc/f1 = 0.9144 / 0.8963 / 0.9774 / 0.8985/ [0.78651685 0.98488665 0.89846154] 
                Val acc/f1/spec/sens = 0.8100 / 0.7297 / 0.9118 / 0.9688/ [0.33333333 0.88       0.96875   ]
                Test acc/f1/spec/sens = 0.2752 / 0.2632 / 0.8484 / 0.1466/ [0.06369427 1.         0.14655172]
 16%|█▌        | 16/100 [01:22<07:35,  5.42s/it] 17%|█▋        | 17/100 [01:25<06:47,  4.91s/it] 18%|█▊        | 18/100 [01:30<06:38,  4.87s/it] 19%|█▉        | 19/100 [01:34<06:06,  4.53s/it] 20%|██        | 20/100 [01:43<07:47,  5.84s/it]Epoch 20: Train acc/f1 = 0.9700 / 0.9633 / 0.9878 / 0.9969/ [0.91011236 0.97481108 0.99692308] 
                Val acc/f1/spec/sens = 0.8300 / 0.7825 / 0.8529 / 0.9688/ [0.5     0.86    0.96875]
                Test acc/f1/spec/sens = 0.4937 / 0.4700 / 0.8320 / 0.5345/ [0.15286624 1.         0.53448276]
 21%|██        | 21/100 [01:46<06:49,  5.19s/it] 22%|██▏       | 22/100 [01:51<06:25,  4.95s/it] 23%|██▎       | 23/100 [01:54<05:49,  4.53s/it] 24%|██▍       | 24/100 [01:59<05:50,  4.61s/it] 25%|██▌       | 25/100 [02:07<07:04,  5.66s/it]Epoch 25: Train acc/f1 = 0.9978 / 0.9973 / 1.0000 / 1.0000/ [0.99438202 0.99748111 1.        ] 
                Val acc/f1/spec/sens = 0.8300 / 0.7873 / 0.9118 / 0.9062/ [0.55555556 0.88       0.90625   ]
                Test acc/f1/spec/sens = 0.5189 / 0.4891 / 0.7951 / 0.5862/ [0.19745223 0.91954023 0.5862069 ]
 26%|██▌       | 26/100 [02:12<06:39,  5.40s/it] 27%|██▋       | 27/100 [02:16<05:59,  4.93s/it] 28%|██▊       | 28/100 [02:21<05:53,  4.91s/it] 29%|██▉       | 29/100 [02:24<05:21,  4.52s/it] 30%|███       | 30/100 [02:34<06:58,  5.97s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8300 / 0.7942 / 0.8971 / 0.8750/ [0.61111111 0.88       0.875     ]
                Test acc/f1/spec/sens = 0.5105 / 0.4794 / 0.7623 / 0.6034/ [0.21019108 0.8045977  0.60344828]
 31%|███       | 31/100 [02:38<06:10,  5.38s/it] 32%|███▏      | 32/100 [02:43<05:53,  5.20s/it] 33%|███▎      | 33/100 [02:46<05:19,  4.77s/it] 34%|███▍      | 34/100 [02:51<05:13,  4.75s/it] 35%|███▌      | 35/100 [02:59<06:12,  5.74s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7999 / 0.9265 / 0.8750/ [0.61111111 0.9        0.875     ]
                Test acc/f1/spec/sens = 0.4832 / 0.4591 / 0.7746 / 0.5345/ [0.20382166 0.85057471 0.53448276]
 36%|███▌      | 36/100 [03:04<05:46,  5.42s/it] 37%|███▋      | 37/100 [03:07<05:07,  4.88s/it] 38%|███▊      | 38/100 [03:12<04:58,  4.81s/it] 39%|███▉      | 39/100 [03:16<04:33,  4.48s/it] 40%|████      | 40/100 [03:25<05:56,  5.94s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8211 / 0.9412 / 0.8750/ [0.66666667 0.9        0.875     ]
                Test acc/f1/spec/sens = 0.4622 / 0.4473 / 0.7869 / 0.4914/ [0.22929936 0.8045977  0.49137931]
 41%|████      | 41/100 [03:29<05:10,  5.27s/it] 42%|████▏     | 42/100 [03:33<04:55,  5.10s/it] 43%|████▎     | 43/100 [03:37<04:27,  4.69s/it] 44%|████▍     | 44/100 [03:42<04:21,  4.68s/it] 45%|████▌     | 45/100 [03:50<05:13,  5.69s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.8035 / 0.9265 / 0.8750/ [0.61111111 0.9        0.875     ]
                Test acc/f1/spec/sens = 0.4811 / 0.4587 / 0.7828 / 0.5302/ [0.21019108 0.83908046 0.53017241]
 46%|████▌     | 46/100 [03:55<04:51,  5.40s/it] 47%|████▋     | 47/100 [03:58<04:19,  4.89s/it] 48%|████▊     | 48/100 [04:03<04:13,  4.87s/it] 49%|████▉     | 49/100 [04:07<03:51,  4.54s/it] 50%|█████     | 50/100 [04:16<04:52,  5.85s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8162 / 0.9265 / 0.9062/ [0.61111111 0.9        0.90625   ]
                Test acc/f1/spec/sens = 0.5042 / 0.4766 / 0.7705 / 0.5776/ [0.21019108 0.83908046 0.57758621]
 51%|█████     | 51/100 [04:19<04:14,  5.20s/it] 52%|█████▏    | 52/100 [04:24<04:05,  5.10s/it] 53%|█████▎    | 53/100 [04:28<03:43,  4.76s/it] 54%|█████▍    | 54/100 [04:33<03:38,  4.75s/it] 55%|█████▌    | 55/100 [04:41<04:20,  5.79s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8200 / 0.7692 / 0.9265 / 0.8750/ [0.5   0.9   0.875]
                Test acc/f1/spec/sens = 0.4685 / 0.4485 / 0.7787 / 0.5086/ [0.21019108 0.82758621 0.50862069]
 56%|█████▌    | 56/100 [04:46<04:00,  5.46s/it] 57%|█████▋    | 57/100 [04:50<03:31,  4.92s/it] 58%|█████▊    | 58/100 [04:54<03:26,  4.90s/it] 59%|█████▉    | 59/100 [04:58<03:06,  4.54s/it] 60%|██████    | 60/100 [05:07<03:54,  5.85s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.8035 / 0.9265 / 0.8750/ [0.61111111 0.9        0.875     ]
                Test acc/f1/spec/sens = 0.4853 / 0.4604 / 0.7787 / 0.5431/ [0.20382166 0.83908046 0.54310345]
 61%|██████    | 61/100 [05:11<03:22,  5.18s/it] 62%|██████▏   | 62/100 [05:15<03:09,  4.98s/it] 63%|██████▎   | 63/100 [05:19<02:50,  4.61s/it] 64%|██████▍   | 64/100 [05:24<02:48,  4.67s/it] 65%|██████▌   | 65/100 [05:32<03:18,  5.67s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.8035 / 0.9265 / 0.8750/ [0.61111111 0.9        0.875     ]
                Test acc/f1/spec/sens = 0.4853 / 0.4610 / 0.7787 / 0.5388/ [0.20382166 0.85057471 0.5387931 ]
 66%|██████▌   | 66/100 [05:37<03:03,  5.40s/it] 67%|██████▋   | 67/100 [05:40<02:41,  4.89s/it] 68%|██████▊   | 68/100 [05:45<02:35,  4.87s/it] 69%|██████▉   | 69/100 [05:49<02:21,  4.56s/it] 70%|███████   | 70/100 [05:58<02:59,  5.99s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.8035 / 0.9265 / 0.8750/ [0.61111111 0.9        0.875     ]
                Test acc/f1/spec/sens = 0.4517 / 0.4355 / 0.7951 / 0.4741/ [0.21019108 0.82758621 0.47413793]
 71%|███████   | 71/100 [06:02<02:34,  5.31s/it] 72%|███████▏  | 72/100 [06:07<02:23,  5.11s/it] 73%|███████▎  | 73/100 [06:10<02:08,  4.75s/it] 74%|███████▍  | 74/100 [06:15<02:04,  4.79s/it] 75%|███████▌  | 75/100 [06:24<02:26,  5.88s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7999 / 0.9265 / 0.8750/ [0.61111111 0.9        0.875     ]
                Test acc/f1/spec/sens = 0.5000 / 0.4711 / 0.7664 / 0.5733/ [0.20382166 0.83908046 0.57327586]
 76%|███████▌  | 76/100 [06:29<02:14,  5.61s/it] 77%|███████▋  | 77/100 [06:33<01:57,  5.09s/it] 78%|███████▊  | 78/100 [06:38<01:56,  5.29s/it] 79%|███████▉  | 79/100 [06:43<01:44,  4.96s/it] 80%|████████  | 80/100 [06:53<02:12,  6.60s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.7999 / 0.9265 / 0.8750/ [0.61111111 0.9        0.875     ]
                Test acc/f1/spec/sens = 0.4979 / 0.4729 / 0.7746 / 0.5647/ [0.21019108 0.83908046 0.56465517]
 81%|████████  | 81/100 [06:57<01:52,  5.92s/it] 82%|████████▏ | 82/100 [07:03<01:43,  5.72s/it] 83%|████████▎ | 83/100 [07:06<01:25,  5.05s/it] 84%|████████▍ | 84/100 [07:11<01:19,  4.96s/it] 85%|████████▌ | 85/100 [07:19<01:29,  5.95s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8400 / 0.8035 / 0.9265 / 0.8750/ [0.61111111 0.9        0.875     ]
                Test acc/f1/spec/sens = 0.4790 / 0.4582 / 0.7787 / 0.5259/ [0.21656051 0.82758621 0.52586207]
 86%|████████▌ | 86/100 [07:24<01:16,  5.50s/it] 87%|████████▋ | 87/100 [07:27<01:03,  4.89s/it] 88%|████████▊ | 88/100 [07:32<00:57,  4.81s/it] 89%|████████▉ | 89/100 [07:35<00:48,  4.44s/it] 90%|█████████ | 90/100 [07:45<01:00,  6.08s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.8282 / 0.9265 / 0.9062/ [0.66666667 0.9        0.90625   ]
                Test acc/f1/spec/sens = 0.4811 / 0.4595 / 0.7705 / 0.5388/ [0.22292994 0.79310345 0.5387931 ]
 91%|█████████ | 91/100 [07:49<00:48,  5.40s/it] 92%|█████████▏| 92/100 [07:54<00:42,  5.32s/it] 93%|█████████▎| 93/100 [07:58<00:34,  4.90s/it] 94%|█████████▍| 94/100 [08:03<00:29,  4.89s/it] 95%|█████████▌| 95/100 [08:12<00:30,  6.05s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8173 / 0.9412 / 0.8750/ [0.66666667 0.9        0.875     ]
                Test acc/f1/spec/sens = 0.4664 / 0.4457 / 0.7828 / 0.5129/ [0.21019108 0.8045977  0.51293103]
 96%|█████████▌| 96/100 [08:17<00:23,  5.76s/it] 97%|█████████▋| 97/100 [08:21<00:15,  5.21s/it] 98%|█████████▊| 98/100 [08:26<00:10,  5.22s/it] 99%|█████████▉| 99/100 [08:30<00:04,  4.79s/it]100%|██████████| 100/100 [08:39<00:00,  6.24s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.8158 / 0.9265 / 0.8750/ [0.66666667 0.9        0.875     ]
                Test acc/f1/spec/sens = 0.4622 / 0.4431 / 0.7828 / 0.5043/ [0.21019108 0.8045977  0.50431034]
Trial 1, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8500 / 0.8158 / 0.9265 / 0.8750/ [0.66666667 0.9        0.875     ]
Test acc/f1/spec/sens = 0.4622 / 0.4431 / 0.7828 / 0.5043/ [0.21019108 0.8045977  0.50431034]
>> Finished.
Acc, agreement for latest model:  0.46218487394957986 0.5042016806722689 [0.21019108 0.8045977  0.50431034]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4810924369747899 0.523109243697479 [0.22292994 0.79310345 0.5387931 ]
Trial 0/1 || Cycle 5/5 || Label set size 900 || Test acc 0.4811 || Test agreement 0.5231 || Spec 0.7705 || Sens 0.5388 Class Acc: [0.22292994 0.79310345 0.5387931 ]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.56it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.50it/s] 67%|██████▋   | 8/12 [00:00<00:00, 11.59it/s] 92%|█████████▏| 11/12 [00:01<00:00, 14.03it/s]100%|██████████| 12/12 [00:01<00:00,  9.09it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.93it/s] 57%|█████▋    | 4/7 [00:00<00:00,  6.06it/s]100%|██████████| 7/7 [00:01<00:00,  6.26it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.1963, -1.2100, -1.1895]), tensor([0.8552, 0.8523, 0.8571]))
Val set stats: mean/std =  (tensor([-1.2437, -1.2589, -1.2352]), tensor([0.8555, 0.8507, 0.8582]))
Validation set distribution: 
Number of samples  100
{0: 16, 1: 45, 2: 39}
Labeled set distribution: 
Number of samples  180
{0: 27, 1: 74, 2: 79}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.1660, agreement = 0.2290, f1 = 0.1386, spec = 0.7992, sens = 0.0000 Class Acc: [0.08280255 0.75862069 0.        ]
Initial model on validation dataset: acc = 0.4500, agreement = 0.4500, f1 = 0.2069, spec = 1.0000, sens = 0.0000 Class Acc: [0. 1. 0.]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:01<02:23,  1.45s/it]  2%|▏         | 2/100 [00:03<03:24,  2.09s/it]  3%|▎         | 3/100 [00:05<02:53,  1.79s/it]  4%|▍         | 4/100 [00:08<03:27,  2.16s/it]  5%|▌         | 5/100 [00:11<04:18,  2.72s/it]Epoch 5: Train acc/f1 = 0.8778 / 0.8336 / 0.9307 / 0.9367/ [0.7037037  0.87837838 0.93670886] 
                Val acc/f1/spec/sens = 0.5500 / 0.5413 / 0.8852 / 0.6410/ [0.625      0.44444444 0.64102564]
                Test acc/f1/spec/sens = 0.2920 / 0.2931 / 0.9713 / 0.1250/ [0.19745223 0.90804598 0.125     ]
  6%|▌         | 6/100 [00:14<04:17,  2.74s/it]  7%|▋         | 7/100 [00:16<03:35,  2.32s/it]  8%|▊         | 8/100 [00:18<03:47,  2.47s/it]  9%|▉         | 9/100 [00:20<03:17,  2.17s/it] 10%|█         | 10/100 [00:25<04:38,  3.10s/it]Epoch 10: Train acc/f1 = 0.9111 / 0.9111 / 1.0000 / 0.7975/ [1.         1.         0.79746835] 
                Val acc/f1/spec/sens = 0.7900 / 0.7028 / 0.9508 / 0.7949/ [0.375      0.93333333 0.79487179]
                Test acc/f1/spec/sens = 0.2542 / 0.2321 / 0.9918 / 0.1336/ [0.05732484 0.93103448 0.13362069]
 11%|█         | 11/100 [00:27<03:53,  2.63s/it] 12%|█▏        | 12/100 [00:29<03:54,  2.66s/it] 13%|█▎        | 13/100 [00:31<03:24,  2.35s/it] 14%|█▍        | 14/100 [00:34<03:34,  2.49s/it] 15%|█▌        | 15/100 [00:38<04:23,  3.10s/it]Epoch 15: Train acc/f1 = 0.9722 / 0.9558 / 0.9505 / 1.0000/ [0.81481481 1.         1.        ] 
                Val acc/f1/spec/sens = 0.6400 / 0.5673 / 0.7541 / 0.9231/ [0.3125     0.51111111 0.92307692]
                Test acc/f1/spec/sens = 0.4454 / 0.4001 / 0.8115 / 0.5302/ [0.05732484 0.91954023 0.53017241]
 16%|█▌        | 16/100 [00:43<04:55,  3.52s/it] 17%|█▋        | 17/100 [00:45<04:12,  3.04s/it] 18%|█▊        | 18/100 [00:47<04:01,  2.95s/it] 19%|█▉        | 19/100 [00:49<03:24,  2.53s/it] 20%|██        | 20/100 [00:54<04:21,  3.26s/it]Epoch 20: Train acc/f1 = 0.9944 / 0.9916 / 0.9901 / 1.0000/ [0.96296296 1.         1.        ] 
                Val acc/f1/spec/sens = 0.8600 / 0.7353 / 0.8852 / 1.0000/ [0.25       0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.3151 / 0.2625 / 0.9139 / 0.2888/ [0.00636943 0.94252874 0.2887931 ]
 21%|██        | 21/100 [00:56<03:37,  2.76s/it] 22%|██▏       | 22/100 [00:58<03:35,  2.77s/it] 23%|██▎       | 23/100 [01:00<03:02,  2.37s/it] 24%|██▍       | 24/100 [01:02<03:05,  2.44s/it] 25%|██▌       | 25/100 [01:07<03:41,  2.95s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7524 / 0.9016 / 0.9744/ [0.3125     0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.3277 / 0.3242 / 0.7295 / 0.3103/ [0.06369427 0.85057471 0.31034483]
 26%|██▌       | 26/100 [01:09<03:24,  2.77s/it] 27%|██▋       | 27/100 [01:10<02:55,  2.41s/it] 28%|██▊       | 28/100 [01:13<02:54,  2.43s/it] 29%|██▉       | 29/100 [01:14<02:31,  2.13s/it] 30%|███       | 30/100 [01:20<03:39,  3.13s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8300 / 0.7234 / 0.9016 / 0.8974/ [0.3125     0.95555556 0.8974359 ]
                Test acc/f1/spec/sens = 0.2647 / 0.2715 / 0.8115 / 0.1767/ [0.07643312 0.83908046 0.17672414]
 31%|███       | 31/100 [01:21<03:04,  2.67s/it] 32%|███▏      | 32/100 [01:24<02:59,  2.65s/it] 33%|███▎      | 33/100 [01:25<02:30,  2.25s/it] 34%|███▍      | 34/100 [01:28<02:35,  2.35s/it] 35%|███▌      | 35/100 [01:32<03:01,  2.80s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8300 / 0.7241 / 0.9016 / 0.9231/ [0.3125     0.93333333 0.92307692]
                Test acc/f1/spec/sens = 0.3088 / 0.2619 / 0.8320 / 0.2716/ [0.02547771 0.91954023 0.27155172]
 36%|███▌      | 36/100 [01:34<02:54,  2.73s/it] 37%|███▋      | 37/100 [01:36<02:25,  2.32s/it] 38%|███▊      | 38/100 [01:38<02:31,  2.44s/it] 39%|███▉      | 39/100 [01:40<02:10,  2.14s/it] 40%|████      | 40/100 [01:45<02:55,  2.92s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3424 / 0.3122 / 0.7910 / 0.3319/ [0.05095541 0.89655172 0.33189655]
 41%|████      | 41/100 [01:46<02:25,  2.47s/it] 42%|████▏     | 42/100 [01:49<02:26,  2.52s/it] 43%|████▎     | 43/100 [01:50<02:06,  2.22s/it] 44%|████▍     | 44/100 [01:53<02:15,  2.43s/it] 45%|████▌     | 45/100 [01:58<02:47,  3.05s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3445 / 0.3093 / 0.7992 / 0.3362/ [0.04458599 0.90804598 0.3362069 ]
 46%|████▌     | 46/100 [02:01<02:42,  3.01s/it] 47%|████▋     | 47/100 [02:02<02:18,  2.62s/it] 48%|████▊     | 48/100 [02:05<02:20,  2.69s/it] 49%|████▉     | 49/100 [02:07<01:57,  2.31s/it] 50%|█████     | 50/100 [02:12<02:37,  3.16s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3445 / 0.3193 / 0.7992 / 0.3319/ [0.05095541 0.90804598 0.33189655]
 51%|█████     | 51/100 [02:13<02:12,  2.71s/it] 52%|█████▏    | 52/100 [02:16<02:15,  2.82s/it] 53%|█████▎    | 53/100 [02:18<01:55,  2.46s/it] 54%|█████▍    | 54/100 [02:21<01:59,  2.59s/it] 55%|█████▌    | 55/100 [02:25<02:18,  3.08s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3151 / 0.2880 / 0.8197 / 0.2759/ [0.04458599 0.90804598 0.27586207]
 56%|█████▌    | 56/100 [02:28<02:10,  2.96s/it] 57%|█████▋    | 57/100 [02:30<01:51,  2.59s/it] 58%|█████▊    | 58/100 [02:33<01:53,  2.70s/it] 59%|█████▉    | 59/100 [02:34<01:39,  2.44s/it] 60%|██████    | 60/100 [02:40<02:18,  3.47s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3487 / 0.3253 / 0.7869 / 0.3405/ [0.05095541 0.90804598 0.34051724]
 61%|██████    | 61/100 [02:42<01:55,  2.95s/it] 62%|██████▏   | 62/100 [02:45<01:56,  3.07s/it] 63%|██████▎   | 63/100 [02:47<01:40,  2.73s/it] 64%|██████▍   | 64/100 [02:50<01:43,  2.88s/it] 65%|██████▌   | 65/100 [02:55<01:59,  3.41s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8600 / 0.7524 / 0.9016 / 0.9744/ [0.3125     0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.3739 / 0.3385 / 0.7951 / 0.3879/ [0.05732484 0.90804598 0.38793103]
 66%|██████▌   | 66/100 [02:58<01:52,  3.31s/it] 67%|██████▋   | 67/100 [03:00<01:35,  2.91s/it] 68%|██████▊   | 68/100 [03:03<01:36,  3.02s/it] 69%|██████▉   | 69/100 [03:05<01:21,  2.63s/it] 70%|███████   | 70/100 [03:11<01:49,  3.64s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3466 / 0.3188 / 0.7951 / 0.3319/ [0.05732484 0.90804598 0.33189655]
 71%|███████   | 71/100 [03:13<01:27,  3.03s/it] 72%|███████▏  | 72/100 [03:16<01:25,  3.06s/it] 73%|███████▎  | 73/100 [03:18<01:11,  2.63s/it] 74%|███████▍  | 74/100 [03:20<01:10,  2.71s/it] 75%|███████▌  | 75/100 [03:25<01:19,  3.17s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3529 / 0.3112 / 0.8074 / 0.3491/ [0.05095541 0.90804598 0.34913793]
 76%|███████▌  | 76/100 [03:27<01:10,  2.95s/it] 77%|███████▋  | 77/100 [03:28<00:56,  2.45s/it] 78%|███████▊  | 78/100 [03:31<00:53,  2.44s/it] 79%|███████▉  | 79/100 [03:32<00:44,  2.12s/it] 80%|████████  | 80/100 [03:37<00:58,  2.91s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3613 / 0.3400 / 0.7377 / 0.3793/ [0.05732484 0.86206897 0.37931034]
 81%|████████  | 81/100 [03:38<00:46,  2.46s/it] 82%|████████▏ | 82/100 [03:41<00:44,  2.47s/it] 83%|████████▎ | 83/100 [03:42<00:36,  2.15s/it] 84%|████████▍ | 84/100 [03:45<00:35,  2.25s/it] 85%|████████▌ | 85/100 [03:49<00:42,  2.85s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3634 / 0.3346 / 0.7418 / 0.3836/ [0.05732484 0.86206897 0.38362069]
 86%|████████▌ | 86/100 [03:52<00:39,  2.85s/it] 87%|████████▋ | 87/100 [03:53<00:32,  2.47s/it] 88%|████████▊ | 88/100 [03:56<00:30,  2.51s/it] 89%|████████▉ | 89/100 [03:58<00:24,  2.24s/it] 90%|█████████ | 90/100 [04:03<00:30,  3.08s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3782 / 0.3421 / 0.7828 / 0.4052/ [0.05732484 0.88505747 0.40517241]
 91%|█████████ | 91/100 [04:04<00:23,  2.59s/it] 92%|█████████▏| 92/100 [04:07<00:21,  2.66s/it] 93%|█████████▎| 93/100 [04:08<00:16,  2.33s/it] 94%|█████████▍| 94/100 [04:11<00:14,  2.47s/it] 95%|█████████▌| 95/100 [04:15<00:14,  2.96s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3739 / 0.3372 / 0.7951 / 0.3879/ [0.05732484 0.90804598 0.38793103]
 96%|█████████▌| 96/100 [04:18<00:11,  2.92s/it] 97%|█████████▋| 97/100 [04:20<00:07,  2.53s/it] 98%|█████████▊| 98/100 [04:23<00:05,  2.59s/it] 99%|█████████▉| 99/100 [04:24<00:02,  2.32s/it]100%|██████████| 100/100 [04:30<00:00,  3.27s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
                Test acc/f1/spec/sens = 0.3319 / 0.3045 / 0.7951 / 0.3103/ [0.04458599 0.90804598 0.31034483]
Trial 2, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8500 / 0.7424 / 0.9016 / 0.9487/ [0.3125     0.95555556 0.94871795]
Test acc/f1/spec/sens = 0.3319 / 0.3045 / 0.7951 / 0.3103/ [0.04458599 0.90804598 0.31034483]
>> Finished.
Acc, agreement for latest model:  0.3319327731092437 0.38235294117647056 [0.04458599 0.90804598 0.31034483]
Load best checkpoint for thief model
Acc, agreement for best model:  0.23109243697478993 0.29831932773109243 [0.14649682 0.91954023 0.03017241]
Trial 1/1 || Cycle 1/5 || Label set size 180 || Test acc 0.2311 || Test agreement 0.2983 || Spec 0.9139 || Sens 0.0302 Class Acc: [0.14649682 0.91954023 0.03017241]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.82s/it]100%|██████████| 2/2 [00:15<00:00,  6.57s/it]100%|██████████| 2/2 [00:16<00:00,  8.15s/it]
Maximum distance from cluster centers is 0.49
labeled set:  360
unlabeled set:  1073
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:06,  1.60it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.41it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.86it/s]100%|██████████| 12/12 [00:01<00:00,  8.20it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 26, 1: 64, 2: 90}
Validation set distribution: 
Number of samples  100
{0: 16, 1: 45, 2: 39}
Labeled set distribution: 
Number of samples  360
{0: 53, 1: 138, 2: 169}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.3214, agreement = 0.3130, f1 = 0.2684, spec = 0.4344, sens = 0.3534 Class Acc: [0.43312102 0.03448276 0.35344828]
Initial model on validation dataset: acc = 0.2700, agreement = 0.2700, f1 = 0.2045, spec = 0.3607, sens = 0.5897 Class Acc: [0.1875     0.02222222 0.58974359]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:26,  2.69s/it]  2%|▏         | 2/100 [00:06<05:20,  3.28s/it]  3%|▎         | 3/100 [00:08<04:40,  2.89s/it]  4%|▍         | 4/100 [00:12<05:21,  3.35s/it]  5%|▌         | 5/100 [00:18<06:50,  4.32s/it]Epoch 5: Train acc/f1 = 0.8944 / 0.8385 / 0.8953 / 0.9704/ [0.58490566 0.92028986 0.9704142 ] 
                Val acc/f1/spec/sens = 0.8500 / 0.7262 / 0.8852 / 1.0000/ [0.25       0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4958 / 0.4074 / 0.7213 / 0.6897/ [0.06369427 0.75862069 0.68965517]
  6%|▌         | 6/100 [00:22<06:35,  4.21s/it]  7%|▋         | 7/100 [00:25<05:34,  3.60s/it]  8%|▊         | 8/100 [00:29<05:41,  3.71s/it]  9%|▉         | 9/100 [00:31<05:01,  3.31s/it] 10%|█         | 10/100 [00:38<06:40,  4.45s/it]Epoch 10: Train acc/f1 = 0.8806 / 0.8452 / 0.9005 / 0.9527/ [0.79245283 0.82608696 0.95266272] 
                Val acc/f1/spec/sens = 0.8300 / 0.7518 / 0.9016 / 0.9487/ [0.4375     0.86666667 0.94871795]
                Test acc/f1/spec/sens = 0.4265 / 0.3895 / 0.6926 / 0.5647/ [0.28025478 0.32183908 0.56465517]
 11%|█         | 11/100 [00:40<05:37,  3.79s/it] 12%|█▏        | 12/100 [00:44<05:27,  3.72s/it] 13%|█▎        | 13/100 [00:46<04:49,  3.32s/it] 14%|█▍        | 14/100 [00:50<04:46,  3.33s/it] 15%|█▌        | 15/100 [00:55<05:44,  4.05s/it]Epoch 15: Train acc/f1 = 0.9639 / 0.9523 / 0.9424 / 0.9882/ [0.8490566  0.97826087 0.98816568] 
                Val acc/f1/spec/sens = 0.8400 / 0.6972 / 0.8689 / 0.9744/ [0.1875     0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.5903 / 0.4492 / 0.6516 / 0.9052/ [0.01910828 0.7816092  0.90517241]
 16%|█▌        | 16/100 [00:59<05:24,  3.86s/it] 17%|█▋        | 17/100 [01:01<04:39,  3.36s/it] 18%|█▊        | 18/100 [01:04<04:36,  3.37s/it] 19%|█▉        | 19/100 [01:07<04:04,  3.02s/it] 20%|██        | 20/100 [01:14<05:39,  4.25s/it]Epoch 20: Train acc/f1 = 0.9083 / 0.8897 / 0.9267 / 0.9763/ [0.96226415 0.80434783 0.97633136] 
                Val acc/f1/spec/sens = 0.8100 / 0.7434 / 0.9016 / 0.9487/ [0.5        0.8        0.94871795]
                Test acc/f1/spec/sens = 0.5924 / 0.5336 / 0.5779 / 0.8147/ [0.26751592 0.5862069  0.81465517]
 21%|██        | 21/100 [01:16<04:47,  3.64s/it] 22%|██▏       | 22/100 [01:19<04:40,  3.59s/it] 23%|██▎       | 23/100 [01:22<04:06,  3.20s/it] 24%|██▍       | 24/100 [01:25<04:08,  3.27s/it] 25%|██▌       | 25/100 [01:31<05:09,  4.13s/it]Epoch 25: Train acc/f1 = 0.9944 / 0.9956 / 0.9895 / 1.0000/ [1.         0.98550725 1.        ] 
                Val acc/f1/spec/sens = 0.8700 / 0.7772 / 0.9180 / 0.9744/ [0.375      0.95555556 0.97435897]
                Test acc/f1/spec/sens = 0.4811 / 0.4200 / 0.8648 / 0.5819/ [0.08917197 0.91954023 0.58189655]
 26%|██▌       | 26/100 [01:35<05:02,  4.09s/it] 27%|██▋       | 27/100 [01:38<04:23,  3.61s/it] 28%|██▊       | 28/100 [01:42<04:25,  3.68s/it] 29%|██▉       | 29/100 [01:44<03:50,  3.24s/it] 30%|███       | 30/100 [01:51<05:07,  4.40s/it]Epoch 30: Train acc/f1 = 0.9972 / 0.9978 / 0.9948 / 1.0000/ [1.         0.99275362 1.        ] 
                Val acc/f1/spec/sens = 0.8700 / 0.7627 / 0.9016 / 1.0000/ [0.3125     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4811 / 0.4227 / 0.8730 / 0.5819/ [0.0955414  0.90804598 0.58189655]
 31%|███       | 31/100 [01:53<04:19,  3.76s/it] 32%|███▏      | 32/100 [01:57<04:16,  3.78s/it] 33%|███▎      | 33/100 [02:00<03:47,  3.40s/it] 34%|███▍      | 34/100 [02:03<03:45,  3.41s/it] 35%|███▌      | 35/100 [02:09<04:26,  4.09s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.7878 / 0.9016 / 1.0000/ [0.375      0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4496 / 0.3879 / 0.8934 / 0.5345/ [0.05732484 0.93103448 0.53448276]
 36%|███▌      | 36/100 [02:12<04:09,  3.90s/it] 37%|███▋      | 37/100 [02:15<03:38,  3.48s/it] 38%|███▊      | 38/100 [02:18<03:36,  3.49s/it] 39%|███▉      | 39/100 [02:20<03:10,  3.12s/it] 40%|████      | 40/100 [02:27<04:14,  4.24s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4937 / 0.4385 / 0.8811 / 0.5991/ [0.11464968 0.89655172 0.59913793]
 41%|████      | 41/100 [02:30<03:37,  3.69s/it] 42%|████▏     | 42/100 [02:33<03:30,  3.63s/it] 43%|████▎     | 43/100 [02:35<03:01,  3.18s/it] 44%|████▍     | 44/100 [02:39<03:04,  3.30s/it] 45%|████▌     | 45/100 [02:44<03:39,  3.98s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4601 / 0.4050 / 0.8975 / 0.5388/ [0.08280255 0.93103448 0.5387931 ]
 46%|████▌     | 46/100 [02:48<03:27,  3.84s/it] 47%|████▋     | 47/100 [02:50<03:00,  3.40s/it] 48%|████▊     | 48/100 [02:54<02:59,  3.45s/it] 49%|████▉     | 49/100 [02:56<02:39,  3.12s/it] 50%|█████     | 50/100 [03:03<03:31,  4.23s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4853 / 0.4295 / 0.8893 / 0.5733/ [0.10191083 0.94252874 0.57327586]
 51%|█████     | 51/100 [03:05<02:58,  3.65s/it] 52%|█████▏    | 52/100 [03:09<02:54,  3.63s/it] 53%|█████▎    | 53/100 [03:11<02:34,  3.28s/it] 54%|█████▍    | 54/100 [03:15<02:31,  3.30s/it] 55%|█████▌    | 55/100 [03:20<03:00,  4.01s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4517 / 0.4037 / 0.9057 / 0.5000/ [0.0955414  0.96551724 0.5       ]
 56%|█████▌    | 56/100 [03:24<02:50,  3.88s/it] 57%|█████▋    | 57/100 [03:26<02:28,  3.44s/it] 58%|█████▊    | 58/100 [03:30<02:27,  3.51s/it] 59%|█████▉    | 59/100 [03:32<02:07,  3.12s/it] 60%|██████    | 60/100 [03:40<03:00,  4.51s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4664 / 0.4269 / 0.9098 / 0.5129/ [0.13375796 0.94252874 0.51293103]
 61%|██████    | 61/100 [03:43<02:32,  3.92s/it] 62%|██████▏   | 62/100 [03:46<02:26,  3.85s/it] 63%|██████▎   | 63/100 [03:49<02:07,  3.44s/it] 64%|██████▍   | 64/100 [03:53<02:11,  3.66s/it] 65%|██████▌   | 65/100 [03:59<02:36,  4.46s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.7878 / 0.9016 / 1.0000/ [0.375      0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4601 / 0.4018 / 0.8852 / 0.5517/ [0.07643312 0.90804598 0.55172414]
 66%|██████▌   | 66/100 [04:03<02:26,  4.32s/it] 67%|██████▋   | 67/100 [04:06<02:05,  3.80s/it] 68%|██████▊   | 68/100 [04:10<02:02,  3.83s/it] 69%|██████▉   | 69/100 [04:12<01:47,  3.47s/it] 70%|███████   | 70/100 [04:20<02:21,  4.71s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4748 / 0.4194 / 0.8893 / 0.5647/ [0.0955414  0.91954023 0.56465517]
 71%|███████   | 71/100 [04:23<01:58,  4.09s/it] 72%|███████▏  | 72/100 [04:27<01:54,  4.09s/it] 73%|███████▎  | 73/100 [04:29<01:37,  3.61s/it] 74%|███████▍  | 74/100 [04:33<01:35,  3.69s/it] 75%|███████▌  | 75/100 [04:39<01:51,  4.47s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4580 / 0.4034 / 0.8975 / 0.5388/ [0.08280255 0.91954023 0.5387931 ]
 76%|███████▌  | 76/100 [04:43<01:41,  4.22s/it] 77%|███████▋  | 77/100 [04:46<01:25,  3.70s/it] 78%|███████▊  | 78/100 [04:49<01:22,  3.74s/it] 79%|███████▉  | 79/100 [04:52<01:09,  3.32s/it] 80%|████████  | 80/100 [05:00<01:34,  4.73s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4769 / 0.4218 / 0.8975 / 0.5603/ [0.0955414  0.94252874 0.56034483]
 81%|████████  | 81/100 [05:02<01:16,  4.05s/it] 82%|████████▏ | 82/100 [05:06<01:11,  3.99s/it] 83%|████████▎ | 83/100 [05:08<00:59,  3.48s/it] 84%|████████▍ | 84/100 [05:12<00:57,  3.60s/it] 85%|████████▌ | 85/100 [05:19<01:07,  4.50s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4580 / 0.4038 / 0.9016 / 0.5259/ [0.08280255 0.95402299 0.52586207]
 86%|████████▌ | 86/100 [05:23<01:00,  4.31s/it] 87%|████████▋ | 87/100 [05:25<00:48,  3.70s/it] 88%|████████▊ | 88/100 [05:29<00:44,  3.72s/it] 89%|████████▉ | 89/100 [05:31<00:37,  3.45s/it] 90%|█████████ | 90/100 [05:38<00:44,  4.42s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4706 / 0.4127 / 0.8975 / 0.5560/ [0.08280255 0.94252874 0.55603448]
 91%|█████████ | 91/100 [05:41<00:34,  3.87s/it] 92%|█████████▏| 92/100 [05:44<00:30,  3.76s/it] 93%|█████████▎| 93/100 [05:47<00:23,  3.38s/it] 94%|█████████▍| 94/100 [05:51<00:21,  3.55s/it] 95%|█████████▌| 95/100 [05:56<00:21,  4.21s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4601 / 0.4024 / 0.8934 / 0.5388/ [0.07643312 0.94252874 0.5387931 ]
 96%|█████████▌| 96/100 [06:00<00:16,  4.10s/it] 97%|█████████▋| 97/100 [06:03<00:10,  3.63s/it] 98%|█████████▊| 98/100 [06:07<00:07,  3.71s/it] 99%|█████████▉| 99/100 [06:09<00:03,  3.32s/it]100%|██████████| 100/100 [06:17<00:00,  4.69s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
                Test acc/f1/spec/sens = 0.4874 / 0.4312 / 0.8934 / 0.5776/ [0.10191083 0.94252874 0.57758621]
Trial 2, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8900 / 0.8115 / 0.9180 / 1.0000/ [0.4375     0.95555556 1.        ]
Test acc/f1/spec/sens = 0.4874 / 0.4312 / 0.8934 / 0.5776/ [0.10191083 0.94252874 0.57758621]
>> Finished.
Acc, agreement for latest model:  0.48739495798319327 0.5441176470588235 [0.10191083 0.94252874 0.57758621]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4726890756302521 0.5294117647058824 [0.13375796 0.94252874 0.52586207]
Trial 1/1 || Cycle 2/5 || Label set size 360 || Test acc 0.4727 || Test agreement 0.5294 || Spec 0.8893 || Sens 0.5259 Class Acc: [0.13375796 0.94252874 0.52586207]
**************************************************************************************************** 

  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.17s/it]100%|██████████| 2/2 [00:14<00:00,  5.90s/it]100%|██████████| 2/2 [00:14<00:00,  7.29s/it]
Maximum distance from cluster centers is 0.44
labeled set:  540
unlabeled set:  893
replacing addendum labels with victim labels
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:08,  1.30it/s] 33%|███▎      | 4/12 [00:00<00:01,  5.23it/s] 67%|██████▋   | 8/12 [00:01<00:00,  9.52it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.97it/s]100%|██████████| 12/12 [00:01<00:00,  7.79it/s]Label distribution of newly added samples after modification
Number of samples  180

{0: 42, 1: 93, 2: 45}
Validation set distribution: 
Number of samples  100
{0: 16, 1: 45, 2: 39}
Labeled set distribution: 
Number of samples  540
{0: 95, 1: 231, 2: 214}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.3067, agreement = 0.2815, f1 = 0.2568, spec = 0.7459, sens = 0.1250 Class Acc: [0.68152866 0.11494253 0.125     ]
Initial model on validation dataset: acc = 0.1800, agreement = 0.1800, f1 = 0.1278, spec = 0.9016, sens = 0.0256 Class Acc: [1.         0.02222222 0.02564103]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:26,  3.30s/it]  2%|▏         | 2/100 [00:08<06:56,  4.25s/it]  3%|▎         | 3/100 [00:11<06:08,  3.80s/it]  4%|▍         | 4/100 [00:16<06:51,  4.29s/it]  5%|▌         | 5/100 [00:24<08:46,  5.54s/it]Epoch 5: Train acc/f1 = 0.9000 / 0.8816 / 0.9939 / 0.8084/ [0.92631579 0.97402597 0.80841121] 
                Val acc/f1/spec/sens = 0.8400 / 0.7522 / 0.8033 / 0.9744/ [0.375      0.88888889 0.97435897]
                Test acc/f1/spec/sens = 0.2311 / 0.2361 / 0.9057 / 0.1078/ [0.15923567 0.68965517 0.10775862]
  6%|▌         | 6/100 [00:28<08:08,  5.20s/it]  7%|▋         | 7/100 [00:32<07:10,  4.62s/it]  8%|▊         | 8/100 [00:36<07:08,  4.65s/it]  9%|▉         | 9/100 [00:40<06:19,  4.17s/it] 10%|█         | 10/100 [00:47<07:46,  5.19s/it]Epoch 10: Train acc/f1 = 0.8037 / 0.7746 / 1.0000 / 0.5467/ [0.96842105 0.97402597 0.54672897] 
                Val acc/f1/spec/sens = 0.7400 / 0.6993 / 0.9836 / 0.5128/ [0.8125     0.91111111 0.51282051]
                Test acc/f1/spec/sens = 0.2710 / 0.2686 / 0.9057 / 0.0000/ [0.29299363 0.95402299 0.        ]
 11%|█         | 11/100 [00:50<06:27,  4.35s/it] 12%|█▏        | 12/100 [00:53<06:10,  4.21s/it] 13%|█▎        | 13/100 [00:56<05:21,  3.69s/it] 14%|█▍        | 14/100 [01:00<05:20,  3.72s/it] 15%|█▌        | 15/100 [01:06<06:14,  4.41s/it]Epoch 15: Train acc/f1 = 0.7852 / 0.7627 / 0.9969 / 0.6495/ [0.56842105 1.         0.64953271] 
                Val acc/f1/spec/sens = 0.8300 / 0.7610 / 0.9180 / 0.8718/ [0.5        0.91111111 0.87179487]
                Test acc/f1/spec/sens = 0.3025 / 0.2788 / 0.9098 / 0.1595/ [0.12738854 1.         0.15948276]
 16%|█▌        | 16/100 [01:10<05:59,  4.27s/it] 17%|█▋        | 17/100 [01:12<05:12,  3.76s/it] 18%|█▊        | 18/100 [01:16<05:16,  3.86s/it] 19%|█▉        | 19/100 [01:19<04:43,  3.50s/it] 20%|██        | 20/100 [01:26<06:02,  4.53s/it]Epoch 20: Train acc/f1 = 0.9685 / 0.9601 / 1.0000 / 0.9720/ [0.89473684 0.995671   0.97196262] 
                Val acc/f1/spec/sens = 0.8600 / 0.7817 / 0.9180 / 0.9487/ [0.4375     0.93333333 0.94871795]
                Test acc/f1/spec/sens = 0.3613 / 0.3401 / 0.8443 / 0.3491/ [0.06369427 0.93103448 0.34913793]
 21%|██        | 21/100 [01:28<05:10,  3.93s/it] 22%|██▏       | 22/100 [01:32<05:09,  3.97s/it] 23%|██▎       | 23/100 [01:35<04:35,  3.58s/it] 24%|██▍       | 24/100 [01:39<04:30,  3.56s/it] 25%|██▌       | 25/100 [01:45<05:20,  4.27s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8613 / 0.9180 / 1.0000/ [0.625      0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.3109 / 0.2950 / 0.8197 / 0.2457/ [0.06369427 0.93103448 0.24568966]
 26%|██▌       | 26/100 [01:48<05:03,  4.10s/it] 27%|██▋       | 27/100 [01:51<04:22,  3.59s/it] 28%|██▊       | 28/100 [01:54<04:23,  3.65s/it] 29%|██▉       | 29/100 [01:57<03:56,  3.33s/it] 30%|███       | 30/100 [02:04<05:15,  4.51s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8613 / 0.9180 / 1.0000/ [0.625      0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.3319 / 0.3139 / 0.8033 / 0.3017/ [0.06369427 0.89655172 0.30172414]
 31%|███       | 31/100 [02:07<04:29,  3.90s/it] 32%|███▏      | 32/100 [02:10<04:19,  3.81s/it]