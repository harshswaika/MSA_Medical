nohup: ignoring input
[24/03/07 20:23:22] [conf.py:  298]: PyTorch Version: torch=1.11.0, cuda=11.3, cudnn=8200
[24/03/07 20:23:22] [conf.py:  300]: ACTIVE:
  ADDENDUM: 900
  ALPHA: 0.2
  AUGMENT: None
  BETA: 1.0
  BUDGET: 5000
  CUTMIX_PROB: 0.0
  CYCLES: 5
  INITIAL: 900
  LA: False
  METHOD: kcenter
  PRETRAINED_PATH: /home/ankita/scratch/data_msa_medical/ckpts/resnet50-imagenet1k.pth
  TEMP: 1.0
  TRO: 1.0
  USE_PRETRAINED: True
  VAL: 500
AM:
  SGR: 1000
  THRESHOLD: 0.5
CUDNN_BENCHMARK: True
DS_SEED: 123
EDM:
  HASH: /home/harsh_s/scratch/msacopy/exp/hash/alpha.pt
  NUM_MODELS: 5
  PATH1: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T0.pt
  PATH2: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T1.pt
  PATH3: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T2.pt
  PATH4: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T3.pt
  PATH5: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T4.pt
GR:
  EPSILON: 0.1
  SUR_PATH: /home/harsh_s/scratch/msacopy/GRAD2/batch_training/outputs/trained_models/imagenet_cifar10_to_cifar10_surrogate_10epochs.pt
LOG_DEST: radformer_resnet50_gbusv_240307_202322.txt
LOG_TIME: 240307_202322
METHOD_NAME: 
OUT_DIR: /home/ankita/scratch/data_msa_medical/results_5k
PL:
  CLASS_BLNC: 10
  ITERATIONS: 20
  KAPPA_N: 0.005
  KAPPA_P: 0.05
  NO_PROGRESS: False
  NO_UNCERTAINTY: False
  TAU_N: 0.05
  TAU_P: 0.7
  TEMP_NL: 2.0
RNG_SEED: 1
SAVE_DIR: /home/ankita/scratch/data_msa_medical/results_5k/gbusg_radformer/GBUSV_resnet50/SGD/5000_val500/kcenter_
THIEF:
  ARCH: resnet50
  DATASET: GBUSV
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/GBUSV-Shared
  HARD_LABELS: True
  NUM_TRAIN: 1281167
  SUBSET: 128116
TRAIN:
  BATCH: 16
  EPOCH: 100
  GAMMA: 0.1
  LR: 0.005
  MILESTONES: [20, 40, 60, 80]
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  WDECAY: 0.0005
TRIALS: 1
VICTIM:
  ARCH: radformer
  DATASET: gbusg
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/GBCU-Shared
  HEIGHT: 224
  PATH: /home/ankita/scratch/data_msa_medical/victim_models/radformer/radformer.pkl
  PATHIN: /home/harsh_s/scratch/msacopy/ckpts/cifar10-resnet32-inaccurate/checkpoint.pth.tar
  WIDTH: 224
Loaded target dataset of size 122 with 3 classes
target model keys:  695
checkpoint keys:  695
specificity = 72/80
sensitivity = 39/42

Target model acc = 0.9016393442622951
Val-Acc: 0.9016 Val-Spec: 0.9000 Val-Sens: 0.9286
/home/ankita/scratch/data_msa_medical/GBUSV-Shared/all_names.pkl
Num of videos 64 frames 15800
/home/ankita/scratch/data_msa_medical/GBUSV-Shared/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:01<01:02,  1.12s/it]  4%|▎         | 2/57 [00:01<00:50,  1.10it/s]  5%|▌         | 3/57 [00:02<00:44,  1.22it/s]  7%|▋         | 4/57 [00:03<00:39,  1.35it/s]  9%|▉         | 5/57 [00:03<00:35,  1.48it/s] 11%|█         | 6/57 [00:04<00:35,  1.45it/s] 12%|█▏        | 7/57 [00:04<00:30,  1.62it/s] 14%|█▍        | 8/57 [00:05<00:27,  1.76it/s] 16%|█▌        | 9/57 [00:06<00:28,  1.66it/s] 18%|█▊        | 10/57 [00:06<00:28,  1.68it/s] 19%|█▉        | 11/57 [00:07<00:26,  1.73it/s] 21%|██        | 12/57 [00:07<00:26,  1.72it/s] 23%|██▎       | 13/57 [00:08<00:25,  1.73it/s] 25%|██▍       | 14/57 [00:09<00:26,  1.63it/s] 26%|██▋       | 15/57 [00:09<00:24,  1.68it/s] 28%|██▊       | 16/57 [00:10<00:26,  1.58it/s] 30%|██▉       | 17/57 [00:11<00:29,  1.35it/s] 32%|███▏      | 18/57 [00:12<00:34,  1.12it/s] 33%|███▎      | 19/57 [00:13<00:34,  1.10it/s] 35%|███▌      | 20/57 [00:14<00:33,  1.09it/s] 37%|███▋      | 21/57 [00:15<00:31,  1.16it/s] 39%|███▊      | 22/57 [00:16<00:31,  1.11it/s] 40%|████      | 23/57 [00:16<00:27,  1.22it/s] 42%|████▏     | 24/57 [00:17<00:26,  1.24it/s] 44%|████▍     | 25/57 [00:18<00:24,  1.28it/s] 46%|████▌     | 26/57 [00:19<00:23,  1.32it/s] 47%|████▋     | 27/57 [00:19<00:23,  1.29it/s] 49%|████▉     | 28/57 [00:20<00:22,  1.27it/s] 51%|█████     | 29/57 [00:21<00:22,  1.26it/s] 53%|█████▎    | 30/57 [00:22<00:22,  1.22it/s] 54%|█████▍    | 31/57 [00:23<00:21,  1.24it/s] 56%|█████▌    | 32/57 [00:23<00:19,  1.30it/s] 58%|█████▊    | 33/57 [00:24<00:19,  1.22it/s] 60%|█████▉    | 34/57 [00:25<00:18,  1.25it/s] 61%|██████▏   | 35/57 [00:26<00:18,  1.18it/s] 63%|██████▎   | 36/57 [00:27<00:17,  1.21it/s] 65%|██████▍   | 37/57 [00:28<00:16,  1.19it/s] 67%|██████▋   | 38/57 [00:28<00:16,  1.18it/s] 68%|██████▊   | 39/57 [00:29<00:15,  1.18it/s] 70%|███████   | 40/57 [00:30<00:14,  1.16it/s] 72%|███████▏  | 41/57 [00:31<00:14,  1.13it/s] 74%|███████▎  | 42/57 [00:32<00:12,  1.21it/s] 75%|███████▌  | 43/57 [00:33<00:11,  1.23it/s] 77%|███████▋  | 44/57 [00:33<00:10,  1.21it/s] 79%|███████▉  | 45/57 [00:34<00:10,  1.20it/s] 81%|████████  | 46/57 [00:35<00:08,  1.26it/s] 82%|████████▏ | 47/57 [00:36<00:08,  1.23it/s] 84%|████████▍ | 48/57 [00:37<00:07,  1.21it/s] 86%|████████▌ | 49/57 [00:38<00:06,  1.16it/s] 88%|████████▊ | 50/57 [00:39<00:06,  1.10it/s] 89%|████████▉ | 51/57 [00:40<00:05,  1.09it/s] 91%|█████████ | 52/57 [00:41<00:04,  1.09it/s] 93%|█████████▎| 53/57 [00:42<00:04,  1.05s/it] 95%|█████████▍| 54/57 [00:43<00:03,  1.04s/it] 96%|█████████▋| 55/57 [00:44<00:02,  1.06s/it] 98%|█████████▊| 56/57 [00:45<00:01,  1.10s/it]100%|██████████| 57/57 [00:46<00:00,  1.16it/s]100%|██████████| 57/57 [00:46<00:00,  1.23it/s]
replacing val labels with victim labels
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:01<00:51,  1.65s/it]  6%|▋         | 2/32 [00:02<00:43,  1.46s/it]  9%|▉         | 3/32 [00:04<00:38,  1.34s/it] 12%|█▎        | 4/32 [00:05<00:35,  1.26s/it] 16%|█▌        | 5/32 [00:06<00:34,  1.28s/it] 19%|█▉        | 6/32 [00:07<00:32,  1.25s/it] 22%|██▏       | 7/32 [00:08<00:29,  1.20s/it] 25%|██▌       | 8/32 [00:09<00:27,  1.14s/it] 28%|██▊       | 9/32 [00:10<00:23,  1.04s/it] 31%|███▏      | 10/32 [00:11<00:23,  1.06s/it] 34%|███▍      | 11/32 [00:12<00:22,  1.08s/it] 38%|███▊      | 12/32 [00:14<00:23,  1.18s/it] 41%|████      | 13/32 [00:15<00:21,  1.11s/it] 44%|████▍     | 14/32 [00:16<00:20,  1.13s/it] 47%|████▋     | 15/32 [00:17<00:19,  1.15s/it] 50%|█████     | 16/32 [00:18<00:17,  1.12s/it] 53%|█████▎    | 17/32 [00:19<00:15,  1.04s/it] 56%|█████▋    | 18/32 [00:20<00:14,  1.04s/it] 59%|█████▉    | 19/32 [00:21<00:13,  1.05s/it] 62%|██████▎   | 20/32 [00:22<00:13,  1.11s/it] 66%|██████▌   | 21/32 [00:23<00:11,  1.05s/it] 69%|██████▉   | 22/32 [00:25<00:11,  1.17s/it] 72%|███████▏  | 23/32 [00:26<00:11,  1.28s/it] 75%|███████▌  | 24/32 [00:28<00:10,  1.26s/it] 78%|███████▊  | 25/32 [00:29<00:08,  1.20s/it] 81%|████████▏ | 26/32 [00:30<00:06,  1.15s/it] 84%|████████▍ | 27/32 [00:31<00:05,  1.17s/it] 88%|████████▊ | 28/32 [00:32<00:04,  1.18s/it] 91%|█████████ | 29/32 [00:33<00:03,  1.10s/it] 94%|█████████▍| 30/32 [00:34<00:02,  1.13s/it] 97%|█████████▋| 31/32 [00:35<00:01,  1.13s/it]100%|██████████| 32/32 [00:36<00:00,  1.10it/s]100%|██████████| 32/32 [00:36<00:00,  1.14s/it]Validation set distribution: 
Number of samples  500

{0: 74, 1: 125, 2: 301}
Labeled set distribution: 
Number of samples  900
{0: 115, 1: 227, 2: 558}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked', 'fc.weight', 'fc.bias'])
thief state:  None
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
specificity = 79/80
sensitivity = 0/42
Initial model on target dataset: acc = 0.3934, agreement = 0.3689, f1 = 0.1882, spec = 0.9875, sens = 0.0000
specificity = 179/199
sensitivity = 26/301
Initial model on validation dataset: acc = 0.2740, agreement = 0.2740, f1 = 0.1778, spec = 0.8995, sens = 0.0864
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:27,  3.92s/it]  2%|▏         | 2/100 [00:10<09:10,  5.61s/it]  3%|▎         | 3/100 [00:15<08:22,  5.18s/it]  4%|▍         | 4/100 [00:21<08:40,  5.43s/it]  5%|▌         | 5/100 [00:33<12:41,  8.02s/it]Epoch 5: Train acc/f1 = 0.8978 / 0.8809 / 0.9971 / 0.8728 
                Val acc/f1/spec/sens = 0.8040 / 0.7652 / 0.8392 / 0.8638
                Test acc/f1/spec/sens = 0.7049 / 0.7065 / 0.9250 / 0.6905
  6%|▌         | 6/100 [00:40<11:58,  7.64s/it]  7%|▋         | 7/100 [00:45<10:13,  6.60s/it]  8%|▊         | 8/100 [00:51<10:06,  6.59s/it]  9%|▉         | 9/100 [00:55<08:46,  5.79s/it] 10%|█         | 10/100 [01:09<12:19,  8.22s/it]Epoch 10: Train acc/f1 = 0.9644 / 0.9594 / 0.9795 / 0.9677 
                Val acc/f1/spec/sens = 0.8620 / 0.8353 / 0.8693 / 0.9037
                Test acc/f1/spec/sens = 0.6557 / 0.6560 / 0.8875 / 0.5952
 11%|█         | 11/100 [01:14<10:39,  7.19s/it] 12%|█▏        | 12/100 [01:20<10:06,  6.89s/it] 13%|█▎        | 13/100 [01:25<09:02,  6.24s/it] 14%|█▍        | 14/100 [01:30<08:43,  6.09s/it] 15%|█▌        | 15/100 [01:44<11:37,  8.21s/it]Epoch 15: Train acc/f1 = 0.9922 / 0.9909 / 0.9854 / 0.9982 
                Val acc/f1/spec/sens = 0.8580 / 0.8244 / 0.8643 / 0.9103
                Test acc/f1/spec/sens = 0.6148 / 0.6087 / 0.6375 / 0.8571
 16%|█▌        | 16/100 [01:50<10:41,  7.64s/it] 17%|█▋        | 17/100 [01:54<09:05,  6.57s/it] 18%|█▊        | 18/100 [02:00<08:42,  6.37s/it] 19%|█▉        | 19/100 [02:05<07:55,  5.87s/it] 20%|██        | 20/100 [02:19<11:10,  8.38s/it]Epoch 20: Train acc/f1 = 0.9844 / 0.9810 / 0.9883 / 0.9892 
                Val acc/f1/spec/sens = 0.8500 / 0.8181 / 0.7990 / 0.9336
                Test acc/f1/spec/sens = 0.5000 / 0.4922 / 0.5625 / 0.7143
 21%|██        | 21/100 [02:23<09:22,  7.12s/it] 22%|██▏       | 22/100 [02:28<08:37,  6.63s/it] 23%|██▎       | 23/100 [02:33<07:38,  5.95s/it] 24%|██▍       | 24/100 [02:39<07:31,  5.93s/it] 25%|██▌       | 25/100 [02:49<09:00,  7.21s/it]Epoch 25: Train acc/f1 = 0.9978 / 0.9979 / 0.9971 / 0.9982 
                Val acc/f1/spec/sens = 0.8600 / 0.8307 / 0.8794 / 0.9037
                Test acc/f1/spec/sens = 0.5574 / 0.5621 / 0.7000 / 0.6667
 26%|██▌       | 26/100 [02:55<08:28,  6.87s/it] 27%|██▋       | 27/100 [03:00<07:34,  6.22s/it] 28%|██▊       | 28/100 [03:06<07:23,  6.16s/it] 29%|██▉       | 29/100 [03:10<06:35,  5.57s/it] 30%|███       | 30/100 [03:21<08:18,  7.13s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8480 / 0.8178 / 0.8894 / 0.8804
                Test acc/f1/spec/sens = 0.5656 / 0.5664 / 0.6750 / 0.7143
 31%|███       | 31/100 [03:25<07:08,  6.21s/it] 32%|███▏      | 32/100 [03:31<07:08,  6.31s/it] 33%|███▎      | 33/100 [03:36<06:33,  5.88s/it] 34%|███▍      | 34/100 [03:43<06:39,  6.05s/it] 35%|███▌      | 35/100 [03:52<07:43,  7.13s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8520 / 0.8200 / 0.8894 / 0.8904
                Test acc/f1/spec/sens = 0.5410 / 0.5351 / 0.6250 / 0.7381
 36%|███▌      | 36/100 [03:58<07:11,  6.74s/it] 37%|███▋      | 37/100 [04:02<06:16,  5.97s/it] 38%|███▊      | 38/100 [04:08<06:06,  5.91s/it] 39%|███▉      | 39/100 [04:13<05:35,  5.50s/it] 40%|████      | 40/100 [04:25<07:25,  7.43s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8500 / 0.8192 / 0.8643 / 0.8970
                Test acc/f1/spec/sens = 0.5492 / 0.5431 / 0.6125 / 0.7619
 41%|████      | 41/100 [04:29<06:19,  6.43s/it] 42%|████▏     | 42/100 [04:35<06:16,  6.49s/it] 43%|████▎     | 43/100 [04:39<05:28,  5.76s/it] 44%|████▍     | 44/100 [04:45<05:21,  5.74s/it] 45%|████▌     | 45/100 [04:54<06:15,  6.83s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8480 / 0.8172 / 0.8844 / 0.8837
                Test acc/f1/spec/sens = 0.5246 / 0.5204 / 0.6375 / 0.6667
 46%|████▌     | 46/100 [05:01<06:02,  6.72s/it] 47%|████▋     | 47/100 [05:05<05:23,  6.10s/it] 48%|████▊     | 48/100 [05:12<05:25,  6.26s/it] 49%|████▉     | 49/100 [05:17<04:59,  5.87s/it] 50%|█████     | 50/100 [05:29<06:17,  7.55s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8540 / 0.8246 / 0.8844 / 0.8904
                Test acc/f1/spec/sens = 0.5902 / 0.5907 / 0.6625 / 0.7619
 51%|█████     | 51/100 [05:33<05:18,  6.50s/it] 52%|█████▏    | 52/100 [05:38<04:56,  6.18s/it] 53%|█████▎    | 53/100 [05:43<04:31,  5.77s/it] 54%|█████▍    | 54/100 [05:49<04:32,  5.93s/it] 55%|█████▌    | 55/100 [05:59<05:21,  7.15s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8420 / 0.8095 / 0.8693 / 0.8870
                Test acc/f1/spec/sens = 0.5656 / 0.5671 / 0.6875 / 0.6667
 56%|█████▌    | 56/100 [06:06<05:04,  6.92s/it] 57%|█████▋    | 57/100 [06:10<04:25,  6.17s/it] 58%|█████▊    | 58/100 [06:16<04:12,  6.01s/it] 59%|█████▉    | 59/100 [06:19<03:39,  5.36s/it] 60%|██████    | 60/100 [06:31<04:46,  7.17s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8480 / 0.8128 / 0.8492 / 0.9103
                Test acc/f1/spec/sens = 0.5574 / 0.5569 / 0.5750 / 0.7857
 61%|██████    | 61/100 [06:35<04:09,  6.39s/it] 62%|██████▏   | 62/100 [06:41<03:59,  6.30s/it] 63%|██████▎   | 63/100 [06:46<03:32,  5.74s/it] 64%|██████▍   | 64/100 [06:52<03:31,  5.86s/it] 65%|██████▌   | 65/100 [07:02<04:11,  7.19s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8480 / 0.8187 / 0.8744 / 0.8870
                Test acc/f1/spec/sens = 0.5656 / 0.5668 / 0.6375 / 0.7381
 66%|██████▌   | 66/100 [07:08<03:46,  6.65s/it] 67%|██████▋   | 67/100 [07:13<03:21,  6.10s/it] 68%|██████▊   | 68/100 [07:19<03:18,  6.21s/it] 69%|██████▉   | 69/100 [07:23<02:52,  5.57s/it] 70%|███████   | 70/100 [07:34<03:33,  7.12s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8520 / 0.8247 / 0.8844 / 0.8837
                Test acc/f1/spec/sens = 0.5656 / 0.5622 / 0.6625 / 0.7381
 71%|███████   | 71/100 [07:38<03:04,  6.38s/it] 72%|███████▏  | 72/100 [07:44<02:50,  6.11s/it] 73%|███████▎  | 73/100 [07:48<02:25,  5.38s/it] 74%|███████▍  | 74/100 [07:54<02:26,  5.65s/it] 75%|███████▌  | 75/100 [08:03<02:47,  6.69s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8520 / 0.8232 / 0.8643 / 0.8970
                Test acc/f1/spec/sens = 0.5574 / 0.5556 / 0.5875 / 0.7857
 76%|███████▌  | 76/100 [08:09<02:32,  6.36s/it] 77%|███████▋  | 77/100 [08:13<02:15,  5.90s/it] 78%|███████▊  | 78/100 [08:19<02:07,  5.78s/it] 79%|███████▉  | 79/100 [08:23<01:51,  5.32s/it] 80%|████████  | 80/100 [08:34<02:20,  7.02s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8560 / 0.8280 / 0.8794 / 0.8937
                Test acc/f1/spec/sens = 0.5820 / 0.5821 / 0.6625 / 0.7619
 81%|████████  | 81/100 [08:39<02:01,  6.40s/it] 82%|████████▏ | 82/100 [08:45<01:52,  6.25s/it] 83%|████████▎ | 83/100 [08:50<01:38,  5.79s/it] 84%|████████▍ | 84/100 [08:55<01:30,  5.66s/it] 85%|████████▌ | 85/100 [09:05<01:43,  6.91s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8480 / 0.8141 / 0.8693 / 0.8970
                Test acc/f1/spec/sens = 0.5328 / 0.5320 / 0.6375 / 0.6667
 86%|████████▌ | 86/100 [09:11<01:32,  6.64s/it] 87%|████████▋ | 87/100 [09:15<01:16,  5.85s/it] 88%|████████▊ | 88/100 [09:21<01:09,  5.79s/it] 89%|████████▉ | 89/100 [09:25<00:59,  5.42s/it] 90%|█████████ | 90/100 [09:36<01:10,  7.04s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8480 / 0.8187 / 0.8744 / 0.8870
                Test acc/f1/spec/sens = 0.5574 / 0.5556 / 0.6250 / 0.7381
 91%|█████████ | 91/100 [09:41<00:57,  6.37s/it] 92%|█████████▏| 92/100 [09:47<00:50,  6.26s/it] 93%|█████████▎| 93/100 [09:51<00:40,  5.77s/it] 94%|█████████▍| 94/100 [09:57<00:34,  5.73s/it] 95%|█████████▌| 95/100 [10:07<00:35,  7.11s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8520 / 0.8201 / 0.8693 / 0.9003
                Test acc/f1/spec/sens = 0.5656 / 0.5674 / 0.6500 / 0.7143
 96%|█████████▌| 96/100 [10:13<00:26,  6.70s/it] 97%|█████████▋| 97/100 [10:18<00:18,  6.14s/it] 98%|█████████▊| 98/100 [10:24<00:12,  6.05s/it] 99%|█████████▉| 99/100 [10:28<00:05,  5.60s/it]100%|██████████| 100/100 [10:40<00:00,  7.52s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8500 / 0.8206 / 0.8945 / 0.8804
                Test acc/f1/spec/sens = 0.5574 / 0.5616 / 0.6750 / 0.6667
specificity = 342/342
sensitivity = 558/558
specificity = 178/199
sensitivity = 265/301
specificity = 54/80
sensitivity = 28/42
Trial 1, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000
Val acc/f1/spec/sens = 0.8500 / 0.8206 / 0.8945 / 0.8804
Test acc/f1/spec/sens = 0.5574 / 0.5616 / 0.6750 / 0.6667
>> Finished.
specificity = 54/80
sensitivity = 28/42
Acc, agreement for latest model:  0.5573770491803278 0.5983606557377049
Load best checkpoint for thief model
specificity = 53/80
sensitivity = 31/42
Acc, agreement for best model:  0.5737704918032787 0.6147540983606558
Trial 0/1 || Cycle 1/5 || Label set size 900 || Test acc 0.5738 || Test agreement 0.6148 || Spec 0.6625 || Sens 0.7381
**************************************************************************************************** 

  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:12<02:52, 12.34s/it] 13%|█▎        | 2/15 [00:12<01:10,  5.43s/it] 20%|██        | 3/15 [00:14<00:42,  3.58s/it] 27%|██▋       | 4/15 [00:15<00:26,  2.44s/it] 33%|███▎      | 5/15 [00:16<00:21,  2.16s/it] 40%|████      | 6/15 [00:17<00:15,  1.69s/it] 47%|████▋     | 7/15 [00:18<00:12,  1.50s/it] 53%|█████▎    | 8/15 [00:19<00:08,  1.23s/it] 60%|██████    | 9/15 [00:19<00:06,  1.07s/it] 67%|██████▋   | 10/15 [00:20<00:04,  1.08it/s] 73%|███████▎  | 11/15 [00:21<00:03,  1.15it/s] 80%|████████  | 12/15 [00:21<00:02,  1.44it/s] 87%|████████▋ | 13/15 [00:21<00:01,  1.75it/s] 93%|█████████▎| 14/15 [00:22<00:00,  2.07it/s]100%|██████████| 15/15 [00:22<00:00,  2.39it/s]100%|██████████| 15/15 [00:22<00:00,  1.51s/it]
Maximum distance from cluster centers is 0.42
labeled set:  1800
unlabeled set:  13500
replacing addendum labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:01<01:36,  1.73s/it]  4%|▎         | 2/57 [00:02<01:02,  1.13s/it]  5%|▌         | 3/57 [00:02<00:44,  1.21it/s]  7%|▋         | 4/57 [00:03<00:34,  1.52it/s]  9%|▉         | 5/57 [00:03<00:28,  1.82it/s] 11%|█         | 6/57 [00:04<00:25,  2.01it/s] 12%|█▏        | 7/57 [00:04<00:24,  2.05it/s] 14%|█▍        | 8/57 [00:04<00:22,  2.21it/s] 16%|█▌        | 9/57 [00:05<00:20,  2.36it/s] 18%|█▊        | 10/57 [00:05<00:20,  2.30it/s] 19%|█▉        | 11/57 [00:06<00:19,  2.33it/s] 21%|██        | 12/57 [00:06<00:18,  2.45it/s] 23%|██▎       | 13/57 [00:06<00:17,  2.54it/s] 25%|██▍       | 14/57 [00:07<00:17,  2.47it/s] 26%|██▋       | 15/57 [00:07<00:16,  2.55it/s] 28%|██▊       | 16/57 [00:07<00:15,  2.71it/s] 30%|██▉       | 17/57 [00:08<00:14,  2.68it/s] 32%|███▏      | 18/57 [00:08<00:13,  2.81it/s] 33%|███▎      | 19/57 [00:09<00:13,  2.82it/s] 35%|███▌      | 20/57 [00:09<00:12,  2.91it/s] 37%|███▋      | 21/57 [00:09<00:12,  2.84it/s] 39%|███▊      | 22/57 [00:10<00:12,  2.78it/s] 40%|████      | 23/57 [00:10<00:12,  2.78it/s] 42%|████▏     | 24/57 [00:10<00:12,  2.73it/s] 44%|████▍     | 25/57 [00:11<00:11,  2.67it/s] 46%|████▌     | 26/57 [00:11<00:11,  2.60it/s] 47%|████▋     | 27/57 [00:12<00:12,  2.49it/s] 49%|████▉     | 28/57 [00:12<00:11,  2.59it/s] 51%|█████     | 29/57 [00:12<00:10,  2.66it/s] 53%|█████▎    | 30/57 [00:13<00:09,  2.75it/s] 54%|█████▍    | 31/57 [00:13<00:09,  2.72it/s] 56%|█████▌    | 32/57 [00:13<00:09,  2.77it/s] 58%|█████▊    | 33/57 [00:14<00:08,  2.89it/s] 60%|█████▉    | 34/57 [00:14<00:08,  2.64it/s] 61%|██████▏   | 35/57 [00:15<00:08,  2.55it/s] 63%|██████▎   | 36/57 [00:15<00:08,  2.55it/s] 65%|██████▍   | 37/57 [00:15<00:07,  2.61it/s] 67%|██████▋   | 38/57 [00:16<00:07,  2.39it/s] 68%|██████▊   | 39/57 [00:16<00:07,  2.28it/s] 70%|███████   | 40/57 [00:17<00:07,  2.18it/s] 72%|███████▏  | 41/57 [00:17<00:07,  2.14it/s] 74%|███████▎  | 42/57 [00:18<00:06,  2.18it/s] 75%|███████▌  | 43/57 [00:18<00:06,  2.31it/s] 77%|███████▋  | 44/57 [00:18<00:05,  2.41it/s] 79%|███████▉  | 45/57 [00:19<00:04,  2.51it/s] 81%|████████  | 46/57 [00:19<00:04,  2.65it/s] 82%|████████▏ | 47/57 [00:20<00:04,  2.37it/s] 84%|████████▍ | 48/57 [00:20<00:03,  2.37it/s] 86%|████████▌ | 49/57 [00:20<00:03,  2.49it/s] 88%|████████▊ | 50/57 [00:21<00:02,  2.65it/s] 89%|████████▉ | 51/57 [00:21<00:02,  2.35it/s] 91%|█████████ | 52/57 [00:22<00:01,  2.50it/s] 93%|█████████▎| 53/57 [00:22<00:01,  2.59it/s] 95%|█████████▍| 54/57 [00:22<00:01,  2.55it/s] 96%|█████████▋| 55/57 [00:23<00:00,  2.56it/s] 98%|█████████▊| 56/57 [00:23<00:00,  2.61it/s]100%|██████████| 57/57 [00:23<00:00,  3.26it/s]100%|██████████| 57/57 [00:23<00:00,  2.38it/s]Label distribution of newly added samples after modification
Number of samples  900

{0: 137, 1: 256, 2: 507}
Validation set distribution: 
Number of samples  500
{0: 74, 1: 125, 2: 301}
Labeled set distribution: 
Number of samples  1800
{0: 252, 1: 483, 2: 1065}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked', 'fc.weight', 'fc.bias'])
thief state:  None
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
specificity = 34/80
sensitivity = 22/42
Initial model on target dataset: acc = 0.3607, agreement = 0.3525, f1 = 0.3058, spec = 0.4250, sens = 0.5238
specificity = 76/199
sensitivity = 251/301
Initial model on validation dataset: acc = 0.5520, agreement = 0.5520, f1 = 0.3261, spec = 0.3819, sens = 0.8339
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<12:36,  7.64s/it]  2%|▏         | 2/100 [00:16<13:22,  8.19s/it]  3%|▎         | 3/100 [00:25<14:01,  8.67s/it]  4%|▍         | 4/100 [00:35<14:30,  9.07s/it]  5%|▌         | 5/100 [00:50<18:11, 11.48s/it]Epoch 5: Train acc/f1 = 0.8883 / 0.8539 / 0.8558 / 0.9643 
                Val acc/f1/spec/sens = 0.8220 / 0.7721 / 0.8492 / 0.9003
                Test acc/f1/spec/sens = 0.5902 / 0.5881 / 0.5750 / 0.8810
  6%|▌         | 6/100 [01:00<17:10, 10.97s/it]  7%|▋         | 7/100 [01:10<16:19, 10.53s/it]  8%|▊         | 8/100 [01:20<15:46, 10.28s/it]  9%|▉         | 9/100 [01:28<14:47,  9.76s/it] 10%|█         | 10/100 [01:46<18:29, 12.33s/it]Epoch 10: Train acc/f1 = 0.9583 / 0.9461 / 0.9592 / 0.9822 
                Val acc/f1/spec/sens = 0.8340 / 0.7967 / 0.8744 / 0.8870
                Test acc/f1/spec/sens = 0.6721 / 0.6753 / 0.8750 / 0.5952
 11%|█         | 11/100 [01:57<17:21, 11.70s/it] 12%|█▏        | 12/100 [02:07<16:26, 11.22s/it] 13%|█▎        | 13/100 [02:16<15:26, 10.65s/it] 14%|█▍        | 14/100 [02:27<15:32, 10.84s/it] 15%|█▌        | 15/100 [02:47<19:12, 13.56s/it]Epoch 15: Train acc/f1 = 0.9822 / 0.9767 / 0.9755 / 0.9953 
                Val acc/f1/spec/sens = 0.8080 / 0.7626 / 0.9146 / 0.8405
                Test acc/f1/spec/sens = 0.6475 / 0.6406 / 0.6125 / 0.9048
 16%|█▌        | 16/100 [02:59<18:01, 12.88s/it] 17%|█▋        | 17/100 [03:07<16:06, 11.65s/it] 18%|█▊        | 18/100 [03:19<16:03, 11.75s/it] 19%|█▉        | 19/100 [03:28<14:42, 10.89s/it] 20%|██        | 20/100 [03:47<17:42, 13.28s/it]Epoch 20: Train acc/f1 = 0.9822 / 0.9796 / 0.9959 / 0.9793 
                Val acc/f1/spec/sens = 0.8280 / 0.7999 / 0.9246 / 0.8472
                Test acc/f1/spec/sens = 0.6230 / 0.6290 / 0.8000 / 0.5238
 21%|██        | 21/100 [03:57<16:15, 12.34s/it] 22%|██▏       | 22/100 [04:07<14:52, 11.44s/it] 23%|██▎       | 23/100 [04:14<13:15, 10.33s/it] 24%|██▍       | 24/100 [04:24<12:52, 10.17s/it] 25%|██▌       | 25/100 [04:46<17:14, 13.80s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8540 / 0.8255 / 0.9045 / 0.8904
                Test acc/f1/spec/sens = 0.6475 / 0.6539 / 0.7750 / 0.6190
 26%|██▌       | 26/100 [04:55<15:14, 12.36s/it] 27%|██▋       | 27/100 [05:02<13:02, 10.72s/it] 28%|██▊       | 28/100 [05:10<11:55,  9.93s/it] 29%|██▉       | 29/100 [05:18<11:00,  9.30s/it] 30%|███       | 30/100 [05:34<13:16, 11.38s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8560 / 0.8290 / 0.9095 / 0.8870
                Test acc/f1/spec/sens = 0.6393 / 0.6468 / 0.7625 / 0.6429
 31%|███       | 31/100 [05:42<11:36, 10.10s/it] 32%|███▏      | 32/100 [05:50<10:50,  9.57s/it] 33%|███▎      | 33/100 [05:57<09:47,  8.77s/it] 34%|███▍      | 34/100 [06:06<09:43,  8.84s/it] 35%|███▌      | 35/100 [06:24<12:31, 11.57s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8560 / 0.8292 / 0.9045 / 0.8904
                Test acc/f1/spec/sens = 0.6311 / 0.6410 / 0.7250 / 0.6667
 36%|███▌      | 36/100 [06:33<11:44, 11.01s/it] 37%|███▋      | 37/100 [06:43<11:05, 10.57s/it] 38%|███▊      | 38/100 [06:51<10:11,  9.87s/it] 39%|███▉      | 39/100 [06:58<09:05,  8.94s/it] 40%|████      | 40/100 [07:12<10:35, 10.60s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8480 / 0.8207 / 0.9095 / 0.8771
                Test acc/f1/spec/sens = 0.6230 / 0.6307 / 0.7500 / 0.6190
 41%|████      | 41/100 [07:21<09:52, 10.04s/it] 42%|████▏     | 42/100 [07:31<09:30,  9.83s/it] 43%|████▎     | 43/100 [07:37<08:28,  8.91s/it] 44%|████▍     | 44/100 [07:45<08:01,  8.60s/it] 45%|████▌     | 45/100 [07:59<09:15, 10.10s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8500 / 0.8238 / 0.9045 / 0.8804
                Test acc/f1/spec/sens = 0.6230 / 0.6314 / 0.7375 / 0.6190
 46%|████▌     | 46/100 [08:10<09:28, 10.53s/it] 47%|████▋     | 47/100 [08:20<08:57, 10.15s/it] 48%|████▊     | 48/100 [08:30<08:57, 10.34s/it] 49%|████▉     | 49/100 [08:39<08:21,  9.83s/it] 50%|█████     | 50/100 [08:55<09:48, 11.76s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8500 / 0.8255 / 0.8995 / 0.8771
                Test acc/f1/spec/sens = 0.6148 / 0.6192 / 0.7750 / 0.5476
 51%|█████     | 51/100 [09:05<09:05, 11.14s/it] 52%|█████▏    | 52/100 [09:14<08:21, 10.44s/it] 53%|█████▎    | 53/100 [09:22<07:43,  9.85s/it] 54%|█████▍    | 54/100 [09:31<07:20,  9.57s/it] 55%|█████▌    | 55/100 [09:47<08:34, 11.43s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8500 / 0.8208 / 0.9045 / 0.8837
                Test acc/f1/spec/sens = 0.6230 / 0.6322 / 0.7500 / 0.6190
 56%|█████▌    | 56/100 [09:57<08:00, 10.93s/it] 57%|█████▋    | 57/100 [10:06<07:22, 10.30s/it] 58%|█████▊    | 58/100 [10:15<07:03, 10.08s/it] 59%|█████▉    | 59/100 [10:24<06:39,  9.73s/it] 60%|██████    | 60/100 [10:39<07:28, 11.21s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8480 / 0.8202 / 0.9045 / 0.8804
                Test acc/f1/spec/sens = 0.6230 / 0.6322 / 0.7500 / 0.6190
 61%|██████    | 61/100 [10:47<06:48, 10.48s/it] 62%|██████▏   | 62/100 [10:57<06:23, 10.09s/it] 63%|██████▎   | 63/100 [11:05<05:49,  9.44s/it] 64%|██████▍   | 64/100 [11:15<05:48,  9.69s/it] 65%|██████▌   | 65/100 [11:31<06:50, 11.72s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8500 / 0.8234 / 0.9095 / 0.8771
                Test acc/f1/spec/sens = 0.6311 / 0.6405 / 0.7375 / 0.6190
 66%|██████▌   | 66/100 [11:42<06:25, 11.34s/it] 67%|██████▋   | 67/100 [11:50<05:43, 10.42s/it] 68%|██████▊   | 68/100 [12:00<05:32, 10.41s/it] 69%|██████▉   | 69/100 [12:08<05:00,  9.71s/it] 70%|███████   | 70/100 [12:26<06:04, 12.15s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8520 / 0.8253 / 0.9045 / 0.8837
                Test acc/f1/spec/sens = 0.6148 / 0.6231 / 0.7500 / 0.5714
 71%|███████   | 71/100 [12:34<05:11, 10.74s/it] 72%|███████▏  | 72/100 [12:44<04:57, 10.61s/it] 73%|███████▎  | 73/100 [12:53<04:36, 10.25s/it] 74%|███████▍  | 74/100 [13:04<04:31, 10.44s/it] 75%|███████▌  | 75/100 [13:20<04:59, 11.96s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8520 / 0.8251 / 0.9045 / 0.8837
                Test acc/f1/spec/sens = 0.6230 / 0.6321 / 0.7375 / 0.6190
 76%|███████▌  | 76/100 [13:30<04:36, 11.51s/it] 77%|███████▋  | 77/100 [13:39<04:02, 10.55s/it] 78%|███████▊  | 78/100 [13:49<03:52, 10.58s/it] 79%|███████▉  | 79/100 [13:57<03:25,  9.78s/it] 80%|████████  | 80/100 [14:14<03:58, 11.94s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8500 / 0.8236 / 0.9045 / 0.8804
                Test acc/f1/spec/sens = 0.6148 / 0.6237 / 0.7500 / 0.5714
 81%|████████  | 81/100 [14:23<03:29, 11.04s/it] 82%|████████▏ | 82/100 [14:34<03:16, 10.94s/it] 83%|████████▎ | 83/100 [14:41<02:49,  9.95s/it] 84%|████████▍ | 84/100 [14:51<02:36,  9.78s/it] 85%|████████▌ | 85/100 [15:05<02:48, 11.20s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8480 / 0.8205 / 0.9095 / 0.8771
                Test acc/f1/spec/sens = 0.6148 / 0.6248 / 0.7250 / 0.6190
 86%|████████▌ | 86/100 [15:16<02:33, 10.99s/it] 87%|████████▋ | 87/100 [15:25<02:15, 10.43s/it] 88%|████████▊ | 88/100 [15:34<01:59,  9.99s/it] 89%|████████▉ | 89/100 [15:43<01:46,  9.70s/it] 90%|█████████ | 90/100 [16:01<02:02, 12.27s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8500 / 0.8205 / 0.9045 / 0.8870
                Test acc/f1/spec/sens = 0.6148 / 0.6266 / 0.7000 / 0.6429
 91%|█████████ | 91/100 [16:10<01:40, 11.22s/it] 92%|█████████▏| 92/100 [16:20<01:27, 10.91s/it] 93%|█████████▎| 93/100 [16:28<01:09,  9.93s/it] 94%|█████████▍| 94/100 [16:37<00:57,  9.62s/it] 95%|█████████▌| 95/100 [16:51<00:55, 11.13s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8540 / 0.8280 / 0.9045 / 0.8837
                Test acc/f1/spec/sens = 0.6066 / 0.6168 / 0.7375 / 0.5714
 96%|█████████▌| 96/100 [17:01<00:42, 10.57s/it] 97%|█████████▋| 97/100 [17:10<00:30, 10.09s/it] 98%|█████████▊| 98/100 [17:19<00:19,  9.96s/it] 99%|█████████▉| 99/100 [17:28<00:09,  9.48s/it]100%|██████████| 100/100 [17:44<00:00, 11.66s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8560 / 0.8293 / 0.8945 / 0.8937
                Test acc/f1/spec/sens = 0.5984 / 0.6086 / 0.6750 / 0.6429
specificity = 735/735
sensitivity = 1065/1065
specificity = 178/199
sensitivity = 269/301
specificity = 54/80
sensitivity = 27/42
Trial 1, Cycle 2
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000
Val acc/f1/spec/sens = 0.8560 / 0.8293 / 0.8945 / 0.8937
Test acc/f1/spec/sens = 0.5984 / 0.6086 / 0.6750 / 0.6429
>> Finished.
specificity = 54/80
sensitivity = 27/42
Acc, agreement for latest model:  0.5983606557377049 0.6475409836065574
Load best checkpoint for thief model
specificity = 58/80
sensitivity = 27/42
Acc, agreement for best model:  0.6311475409836066 0.680327868852459
Trial 0/1 || Cycle 2/5 || Label set size 1800 || Test acc 0.6311 || Test agreement 0.6803 || Spec 0.7250 || Sens 0.6429
**************************************************************************************************** 

  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:07<01:47,  7.64s/it] 13%|█▎        | 2/15 [00:09<00:52,  4.02s/it] 20%|██        | 3/15 [00:09<00:30,  2.56s/it] 27%|██▋       | 4/15 [00:10<00:20,  1.88s/it] 33%|███▎      | 5/15 [00:11<00:16,  1.61s/it] 40%|████      | 6/15 [00:12<00:11,  1.32s/it] 47%|████▋     | 7/15 [00:13<00:09,  1.15s/it] 53%|█████▎    | 8/15 [00:14<00:07,  1.04s/it] 60%|██████    | 9/15 [00:14<00:05,  1.09it/s] 67%|██████▋   | 10/15 [00:15<00:04,  1.20it/s] 73%|███████▎  | 11/15 [00:16<00:03,  1.25it/s] 80%|████████  | 12/15 [00:16<00:02,  1.31it/s] 87%|████████▋ | 13/15 [00:17<00:01,  1.32it/s] 93%|█████████▎| 14/15 [00:18<00:00,  1.35it/s]100%|██████████| 15/15 [00:19<00:00,  1.41it/s]100%|██████████| 15/15 [00:19<00:00,  1.29s/it]
Maximum distance from cluster centers is 0.41
labeled set:  2700
unlabeled set:  12600
replacing addendum labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:43,  1.30it/s]  4%|▎         | 2/57 [00:01<00:29,  1.87it/s]  5%|▌         | 3/57 [00:01<00:23,  2.30it/s]  7%|▋         | 4/57 [00:01<00:21,  2.46it/s]  9%|▉         | 5/57 [00:02<00:19,  2.66it/s] 11%|█         | 6/57 [00:02<00:17,  2.86it/s] 12%|█▏        | 7/57 [00:02<00:16,  2.97it/s] 14%|█▍        | 8/57 [00:03<00:15,  3.10it/s] 16%|█▌        | 9/57 [00:03<00:16,  2.91it/s] 18%|█▊        | 10/57 [00:03<00:15,  2.98it/s] 19%|█▉        | 11/57 [00:04<00:15,  3.04it/s] 21%|██        | 12/57 [00:04<00:14,  3.11it/s] 23%|██▎       | 13/57 [00:04<00:14,  3.02it/s] 25%|██▍       | 14/57 [00:05<00:14,  2.94it/s] 26%|██▋       | 15/57 [00:05<00:13,  3.01it/s] 28%|██▊       | 16/57 [00:05<00:12,  3.20it/s] 30%|██▉       | 17/57 [00:05<00:12,  3.19it/s] 32%|███▏      | 18/57 [00:06<00:12,  3.15it/s] 33%|███▎      | 19/57 [00:06<00:12,  2.94it/s] 35%|███▌      | 20/57 [00:07<00:13,  2.81it/s] 37%|███▋      | 21/57 [00:07<00:12,  2.82it/s] 39%|███▊      | 22/57 [00:07<00:12,  2.86it/s] 40%|████      | 23/57 [00:08<00:11,  2.97it/s] 42%|████▏     | 24/57 [00:08<00:11,  2.97it/s] 44%|████▍     | 25/57 [00:08<00:10,  3.04it/s] 46%|████▌     | 26/57 [00:09<00:11,  2.68it/s] 47%|████▋     | 27/57 [00:09<00:10,  2.82it/s] 49%|████▉     | 28/57 [00:09<00:09,  2.95it/s] 51%|█████     | 29/57 [00:10<00:09,  3.04it/s] 53%|█████▎    | 30/57 [00:10<00:08,  3.19it/s] 54%|█████▍    | 31/57 [00:10<00:08,  3.20it/s] 56%|█████▌    | 32/57 [00:11<00:07,  3.25it/s] 58%|█████▊    | 33/57 [00:11<00:07,  3.19it/s] 60%|█████▉    | 34/57 [00:11<00:07,  3.17it/s] 61%|██████▏   | 35/57 [00:11<00:07,  3.11it/s] 63%|██████▎   | 36/57 [00:12<00:06,  3.18it/s] 65%|██████▍   | 37/57 [00:12<00:06,  3.16it/s] 67%|██████▋   | 38/57 [00:12<00:05,  3.18it/s] 68%|██████▊   | 39/57 [00:13<00:05,  3.19it/s] 70%|███████   | 40/57 [00:13<00:05,  3.13it/s] 72%|███████▏  | 41/57 [00:13<00:04,  3.29it/s] 74%|███████▎  | 42/57 [00:14<00:04,  3.32it/s] 75%|███████▌  | 43/57 [00:14<00:04,  2.82it/s] 77%|███████▋  | 44/57 [00:14<00:04,  2.86it/s] 79%|███████▉  | 45/57 [00:15<00:04,  2.92it/s] 81%|████████  | 46/57 [00:15<00:03,  3.06it/s] 82%|████████▏ | 47/57 [00:15<00:03,  2.88it/s] 84%|████████▍ | 48/57 [00:16<00:03,  2.41it/s] 86%|████████▌ | 49/57 [00:16<00:03,  2.44it/s] 88%|████████▊ | 50/57 [00:17<00:02,  2.37it/s] 89%|████████▉ | 51/57 [00:17<00:02,  2.31it/s] 91%|█████████ | 52/57 [00:18<00:02,  2.12it/s] 93%|█████████▎| 53/57 [00:19<00:02,  1.55it/s] 95%|█████████▍| 54/57 [00:20<00:01,  1.55it/s] 96%|█████████▋| 55/57 [00:20<00:01,  1.76it/s] 98%|█████████▊| 56/57 [00:20<00:00,  1.92it/s]100%|██████████| 57/57 [00:21<00:00,  2.50it/s]100%|██████████| 57/57 [00:21<00:00,  2.69it/s]Label distribution of newly added samples after modification
Number of samples  900

{0: 136, 1: 256, 2: 508}
Validation set distribution: 
Number of samples  500
{0: 74, 1: 125, 2: 301}
Labeled set distribution: 
Number of samples  2700
{0: 388, 1: 739, 2: 1573}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked', 'fc.weight', 'fc.bias'])
thief state:  None
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
specificity = 24/80
sensitivity = 27/42
Initial model on target dataset: acc = 0.3115, agreement = 0.3525, f1 = 0.2679, spec = 0.3000, sens = 0.6429
specificity = 59/199
sensitivity = 230/301
Initial model on validation dataset: acc = 0.5080, agreement = 0.5080, f1 = 0.3188, spec = 0.2965, sens = 0.7641
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:11<18:23, 11.14s/it]  2%|▏         | 2/100 [00:24<20:37, 12.63s/it]  3%|▎         | 3/100 [00:38<21:19, 13.19s/it]  4%|▍         | 4/100 [00:53<22:09, 13.85s/it]  5%|▌         | 5/100 [01:12<24:38, 15.56s/it]Epoch 5: Train acc/f1 = 0.8741 / 0.8494 / 0.9503 / 0.8849 
                Val acc/f1/spec/sens = 0.8460 / 0.8221 / 0.9095 / 0.8638
                Test acc/f1/spec/sens = 0.5820 / 0.5599 / 0.9250 / 0.2381
  6%|▌         | 6/100 [01:27<24:23, 15.57s/it]  7%|▋         | 7/100 [01:40<22:51, 14.75s/it]  8%|▊         | 8/100 [01:54<22:06, 14.42s/it]  9%|▉         | 9/100 [02:05<20:09, 13.30s/it] 10%|█         | 10/100 [02:27<24:07, 16.08s/it]Epoch 10: Train acc/f1 = 0.9296 / 0.9143 / 0.9672 / 0.9352 
                Val acc/f1/spec/sens = 0.8240 / 0.8064 / 0.9246 / 0.8140
                Test acc/f1/spec/sens = 0.6148 / 0.6078 / 0.8375 / 0.5714
 11%|█         | 11/100 [02:41<22:53, 15.44s/it] 12%|█▏        | 12/100 [02:54<21:42, 14.81s/it] 13%|█▎        | 13/100 [03:06<19:58, 13.78s/it] 14%|█▍        | 14/100 [03:19<19:33, 13.65s/it] 15%|█▌        | 15/100 [03:41<22:49, 16.11s/it]Epoch 15: Train acc/f1 = 0.9656 / 0.9562 / 0.9707 / 0.9809 
                Val acc/f1/spec/sens = 0.7960 / 0.7791 / 0.9548 / 0.7674
                Test acc/f1/spec/sens = 0.6393 / 0.6497 / 0.7750 / 0.6190
 16%|█▌        | 16/100 [03:55<21:40, 15.48s/it] 17%|█▋        | 17/100 [04:08<20:18, 14.68s/it] 18%|█▊        | 18/100 [04:23<20:06, 14.72s/it] 19%|█▉        | 19/100 [04:36<19:17, 14.29s/it] 20%|██        | 20/100 [04:58<21:58, 16.48s/it]Epoch 20: Train acc/f1 = 0.9733 / 0.9700 / 0.9894 / 0.9720 
                Val acc/f1/spec/sens = 0.8300 / 0.7984 / 0.9095 / 0.8571
                Test acc/f1/spec/sens = 0.6475 / 0.6565 / 0.7875 / 0.6429
 21%|██        | 21/100 [05:10<19:55, 15.14s/it] 22%|██▏       | 22/100 [05:24<19:20, 14.88s/it] 23%|██▎       | 23/100 [05:36<18:12, 14.19s/it] 24%|██▍       | 24/100 [05:51<17:57, 14.18s/it] 25%|██▌       | 25/100 [06:11<20:12, 16.17s/it]Epoch 25: Train acc/f1 = 0.9993 / 0.9993 / 0.9991 / 0.9994 
                Val acc/f1/spec/sens = 0.8560 / 0.8342 / 0.9246 / 0.8671
                Test acc/f1/spec/sens = 0.7131 / 0.7214 / 0.8250 / 0.7143
 26%|██▌       | 26/100 [06:25<19:07, 15.51s/it] 27%|██▋       | 27/100 [06:38<17:52, 14.69s/it] 28%|██▊       | 28/100 [06:53<17:37, 14.68s/it] 29%|██▉       | 29/100 [07:05<16:35, 14.03s/it] 30%|███       | 30/100 [07:27<19:09, 16.42s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8640 / 0.8426 / 0.9146 / 0.8837
                Test acc/f1/spec/sens = 0.7049 / 0.7182 / 0.7750 / 0.7381
 31%|███       | 31/100 [07:41<17:51, 15.53s/it] 32%|███▏      | 32/100 [07:54<16:40, 14.71s/it] 33%|███▎      | 33/100 [08:07<16:09, 14.47s/it] 34%|███▍      | 34/100 [08:22<15:54, 14.47s/it] 35%|███▌      | 35/100 [08:43<17:53, 16.51s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8540 / 0.8296 / 0.9146 / 0.8771
                Test acc/f1/spec/sens = 0.7049 / 0.7162 / 0.7875 / 0.7381
 36%|███▌      | 36/100 [08:57<16:42, 15.66s/it] 37%|███▋      | 37/100 [09:08<15:04, 14.36s/it] 38%|███▊      | 38/100 [09:20<14:00, 13.56s/it] 39%|███▉      | 39/100 [09:32<13:13, 13.01s/it] 40%|████      | 40/100 [09:54<15:50, 15.84s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8580 / 0.8382 / 0.9296 / 0.8638
                Test acc/f1/spec/sens = 0.6967 / 0.7088 / 0.8000 / 0.6905
 41%|████      | 41/100 [10:05<14:16, 14.51s/it] 42%|████▏     | 42/100 [10:20<13:59, 14.47s/it] 43%|████▎     | 43/100 [10:32<13:02, 13.74s/it] 44%|████▍     | 44/100 [10:44<12:20, 13.23s/it] 45%|████▌     | 45/100 [11:03<13:38, 14.87s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8580 / 0.8388 / 0.9246 / 0.8671
                Test acc/f1/spec/sens = 0.7213 / 0.7285 / 0.8000 / 0.7381
 46%|████▌     | 46/100 [11:17<13:12, 14.68s/it] 47%|████▋     | 47/100 [11:30<12:29, 14.15s/it] 48%|████▊     | 48/100 [11:43<12:06, 13.97s/it] 49%|████▉     | 49/100 [11:54<10:56, 12.86s/it] 50%|█████     | 50/100 [12:13<12:24, 14.89s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8640 / 0.8435 / 0.9246 / 0.8771
                Test acc/f1/spec/sens = 0.6885 / 0.7021 / 0.8000 / 0.6905
 51%|█████     | 51/100 [12:27<11:46, 14.42s/it] 52%|█████▏    | 52/100 [12:41<11:28, 14.35s/it] 53%|█████▎    | 53/100 [12:53<10:47, 13.78s/it] 54%|█████▍    | 54/100 [13:08<10:43, 13.99s/it] 55%|█████▌    | 55/100 [13:25<11:17, 15.05s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8600 / 0.8390 / 0.9095 / 0.8804
                Test acc/f1/spec/sens = 0.6885 / 0.6973 / 0.8000 / 0.7143
 56%|█████▌    | 56/100 [13:38<10:35, 14.44s/it] 57%|█████▋    | 57/100 [13:52<10:11, 14.22s/it] 58%|█████▊    | 58/100 [14:06<09:52, 14.11s/it] 59%|█████▉    | 59/100 [14:17<09:05, 13.30s/it] 60%|██████    | 60/100 [14:44<11:29, 17.23s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8600 / 0.8383 / 0.9246 / 0.8738
                Test acc/f1/spec/sens = 0.6803 / 0.6902 / 0.7875 / 0.7143
 61%|██████    | 61/100 [14:58<10:37, 16.36s/it] 62%|██████▏   | 62/100 [15:12<10:01, 15.82s/it] 63%|██████▎   | 63/100 [15:24<08:54, 14.44s/it] 64%|██████▍   | 64/100 [15:39<08:45, 14.60s/it] 65%|██████▌   | 65/100 [16:03<10:16, 17.61s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8560 / 0.8363 / 0.9146 / 0.8704
                Test acc/f1/spec/sens = 0.6803 / 0.6900 / 0.8000 / 0.6905
 66%|██████▌   | 66/100 [16:16<09:13, 16.27s/it] 67%|██████▋   | 67/100 [16:29<08:17, 15.08s/it] 68%|██████▊   | 68/100 [16:43<07:52, 14.75s/it] 69%|██████▉   | 69/100 [16:54<07:05, 13.72s/it] 70%|███████   | 70/100 [17:13<07:34, 15.15s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8640 / 0.8426 / 0.9045 / 0.8870
                Test acc/f1/spec/sens = 0.6885 / 0.6997 / 0.7750 / 0.7381
 71%|███████   | 71/100 [17:22<06:32, 13.53s/it] 72%|███████▏  | 72/100 [17:35<06:13, 13.36s/it] 73%|███████▎  | 73/100 [17:46<05:42, 12.70s/it] 74%|███████▍  | 74/100 [17:58<05:23, 12.44s/it] 75%|███████▌  | 75/100 [18:15<05:42, 13.70s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8620 / 0.8405 / 0.9095 / 0.8837
                Test acc/f1/spec/sens = 0.6885 / 0.7018 / 0.7875 / 0.6905
 76%|███████▌  | 76/100 [18:28<05:21, 13.41s/it] 77%|███████▋  | 77/100 [18:40<04:58, 12.98s/it] 78%|███████▊  | 78/100 [18:51<04:36, 12.56s/it] 79%|███████▉  | 79/100 [19:01<04:06, 11.74s/it] 80%|████████  | 80/100 [19:19<04:29, 13.47s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8620 / 0.8425 / 0.9095 / 0.8804
                Test acc/f1/spec/sens = 0.7049 / 0.7162 / 0.7875 / 0.7381
 81%|████████  | 81/100 [19:32<04:14, 13.41s/it] 82%|████████▏ | 82/100 [19:47<04:08, 13.82s/it] 83%|████████▎ | 83/100 [19:59<03:46, 13.31s/it] 84%|████████▍ | 84/100 [20:12<03:33, 13.35s/it] 85%|████████▌ | 85/100 [20:37<04:13, 16.91s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8660 / 0.8442 / 0.9045 / 0.8904
                Test acc/f1/spec/sens = 0.6967 / 0.7069 / 0.7750 / 0.7381
 86%|████████▌ | 86/100 [20:52<03:47, 16.22s/it] 87%|████████▋ | 87/100 [21:05<03:17, 15.17s/it] 88%|████████▊ | 88/100 [21:18<02:56, 14.75s/it] 89%|████████▉ | 89/100 [21:32<02:38, 14.44s/it] 90%|█████████ | 90/100 [21:55<02:49, 16.99s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8620 / 0.8405 / 0.9095 / 0.8837
                Test acc/f1/spec/sens = 0.6885 / 0.7018 / 0.7625 / 0.7381
 91%|█████████ | 91/100 [22:07<02:19, 15.46s/it] 92%|█████████▏| 92/100 [22:22<02:02, 15.36s/it] 93%|█████████▎| 93/100 [22:35<01:43, 14.72s/it] 94%|█████████▍| 94/100 [22:48<01:24, 14.14s/it] 95%|█████████▌| 95/100 [23:08<01:19, 15.93s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8600 / 0.8375 / 0.9045 / 0.8837
                Test acc/f1/spec/sens = 0.7213 / 0.7305 / 0.8000 / 0.7381
 96%|█████████▌| 96/100 [23:23<01:02, 15.70s/it] 97%|█████████▋| 97/100 [23:35<00:43, 14.47s/it] 98%|█████████▊| 98/100 [23:49<00:28, 14.29s/it] 99%|█████████▉| 99/100 [24:02<00:14, 14.04s/it]100%|██████████| 100/100 [24:25<00:00, 16.52s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8620 / 0.8405 / 0.9095 / 0.8837
                Test acc/f1/spec/sens = 0.6885 / 0.6997 / 0.7750 / 0.7381
specificity = 1127/1127
sensitivity = 1573/1573
specificity = 181/199
sensitivity = 266/301
specificity = 62/80
sensitivity = 31/42
Trial 1, Cycle 3
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000
Val acc/f1/spec/sens = 0.8620 / 0.8405 / 0.9095 / 0.8837
Test acc/f1/spec/sens = 0.6885 / 0.6997 / 0.7750 / 0.7381
>> Finished.
specificity = 62/80
sensitivity = 31/42
Acc, agreement for latest model:  0.6885245901639344 0.7131147540983607
Load best checkpoint for thief model
specificity = 60/80
sensitivity = 32/42
Acc, agreement for best model:  0.6885245901639344 0.6967213114754098
Trial 0/1 || Cycle 3/5 || Label set size 2700 || Test acc 0.6885 || Test agreement 0.6967 || Spec 0.7500 || Sens 0.7619
**************************************************************************************************** 

  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:06<01:25,  6.11s/it] 13%|█▎        | 2/15 [00:06<00:36,  2.84s/it] 20%|██        | 3/15 [00:07<00:24,  2.03s/it] 27%|██▋       | 4/15 [00:08<00:16,  1.50s/it] 33%|███▎      | 5/15 [00:09<00:12,  1.24s/it] 40%|████      | 6/15 [00:10<00:09,  1.09s/it] 47%|████▋     | 7/15 [00:10<00:08,  1.03s/it] 53%|█████▎    | 8/15 [00:11<00:06,  1.04it/s] 60%|██████    | 9/15 [00:12<00:05,  1.15it/s] 67%|██████▋   | 10/15 [00:13<00:04,  1.19it/s] 73%|███████▎  | 11/15 [00:13<00:03,  1.20it/s] 80%|████████  | 12/15 [00:14<00:02,  1.23it/s] 87%|████████▋ | 13/15 [00:15<00:01,  1.29it/s] 93%|█████████▎| 14/15 [00:16<00:00,  1.30it/s]100%|██████████| 15/15 [00:16<00:00,  1.34it/s]100%|██████████| 15/15 [00:17<00:00,  1.14s/it]
Maximum distance from cluster centers is 0.39
labeled set:  3600
unlabeled set:  11700
replacing addendum labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:54,  1.02it/s]  4%|▎         | 2/57 [00:01<00:33,  1.65it/s]  5%|▌         | 3/57 [00:01<00:27,  1.99it/s]  7%|▋         | 4/57 [00:02<00:24,  2.19it/s]  9%|▉         | 5/57 [00:02<00:21,  2.44it/s] 11%|█         | 6/57 [00:02<00:19,  2.63it/s] 12%|█▏        | 7/57 [00:03<00:18,  2.77it/s] 14%|█▍        | 8/57 [00:03<00:16,  2.92it/s] 16%|█▌        | 9/57 [00:03<00:15,  3.07it/s] 18%|█▊        | 10/57 [00:03<00:14,  3.29it/s] 19%|█▉        | 11/57 [00:04<00:13,  3.31it/s] 21%|██        | 12/57 [00:04<00:13,  3.36it/s] 23%|██▎       | 13/57 [00:04<00:12,  3.52it/s] 25%|██▍       | 14/57 [00:05<00:12,  3.52it/s] 26%|██▋       | 15/57 [00:05<00:11,  3.63it/s] 28%|██▊       | 16/57 [00:05<00:10,  3.80it/s] 30%|██▉       | 17/57 [00:05<00:10,  3.84it/s] 32%|███▏      | 18/57 [00:06<00:10,  3.75it/s] 33%|███▎      | 19/57 [00:06<00:10,  3.52it/s] 35%|███▌      | 20/57 [00:06<00:10,  3.37it/s] 37%|███▋      | 21/57 [00:06<00:10,  3.50it/s] 39%|███▊      | 22/57 [00:07<00:09,  3.59it/s] 40%|████      | 23/57 [00:07<00:09,  3.44it/s] 42%|████▏     | 24/57 [00:07<00:09,  3.35it/s] 44%|████▍     | 25/57 [00:08<00:09,  3.32it/s] 46%|████▌     | 26/57 [00:08<00:09,  3.28it/s] 47%|████▋     | 27/57 [00:08<00:09,  3.32it/s] 49%|████▉     | 28/57 [00:09<00:08,  3.23it/s] 51%|█████     | 29/57 [00:09<00:08,  3.22it/s] 53%|█████▎    | 30/57 [00:09<00:08,  3.17it/s] 54%|█████▍    | 31/57 [00:10<00:08,  3.22it/s] 56%|█████▌    | 32/57 [00:10<00:07,  3.27it/s] 58%|█████▊    | 33/57 [00:10<00:07,  3.33it/s] 60%|█████▉    | 34/57 [00:10<00:06,  3.34it/s] 61%|██████▏   | 35/57 [00:11<00:06,  3.38it/s] 63%|██████▎   | 36/57 [00:11<00:06,  3.37it/s] 65%|██████▍   | 37/57 [00:11<00:05,  3.37it/s] 67%|██████▋   | 38/57 [00:12<00:05,  3.34it/s] 68%|██████▊   | 39/57 [00:12<00:05,  3.29it/s] 70%|███████   | 40/57 [00:12<00:05,  3.26it/s] 72%|███████▏  | 41/57 [00:13<00:04,  3.27it/s] 74%|███████▎  | 42/57 [00:13<00:04,  3.21it/s] 75%|███████▌  | 43/57 [00:13<00:04,  3.18it/s] 77%|███████▋  | 44/57 [00:13<00:04,  3.23it/s] 79%|███████▉  | 45/57 [00:14<00:03,  3.34it/s] 81%|████████  | 46/57 [00:14<00:03,  3.29it/s] 82%|████████▏ | 47/57 [00:14<00:03,  3.20it/s] 84%|████████▍ | 48/57 [00:15<00:02,  3.27it/s] 86%|████████▌ | 49/57 [00:15<00:02,  3.20it/s] 88%|████████▊ | 50/57 [00:15<00:02,  3.17it/s] 89%|████████▉ | 51/57 [00:16<00:01,  3.13it/s] 91%|█████████ | 52/57 [00:16<00:01,  3.20it/s] 93%|█████████▎| 53/57 [00:16<00:01,  3.24it/s] 95%|█████████▍| 54/57 [00:17<00:00,  3.26it/s] 96%|█████████▋| 55/57 [00:17<00:00,  3.23it/s] 98%|█████████▊| 56/57 [00:17<00:00,  3.24it/s]100%|██████████| 57/57 [00:18<00:00,  3.16it/s]Label distribution of newly added samples after modification
Number of samples  900

{0: 163, 1: 264, 2: 473}
Validation set distribution: 
Number of samples  500
{0: 74, 1: 125, 2: 301}
Labeled set distribution: 
Number of samples  3600
{0: 551, 1: 1003, 2: 2046}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked', 'fc.weight', 'fc.bias'])
thief state:  None
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
specificity = 58/80
sensitivity = 12/42
Initial model on target dataset: acc = 0.3689, agreement = 0.3770, f1 = 0.2830, spec = 0.7250, sens = 0.2857
specificity = 160/199
sensitivity = 72/301
Initial model on validation dataset: acc = 0.3400, agreement = 0.3400, f1 = 0.2543, spec = 0.8040, sens = 0.2392
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:16<27:53, 16.90s/it]  2%|▏         | 2/100 [00:36<29:45, 18.22s/it]  3%|▎         | 3/100 [00:52<28:16, 17.49s/it]  4%|▍         | 4/100 [01:11<28:35, 17.87s/it]  5%|▌         | 5/100 [01:36<32:33, 20.56s/it]Epoch 5: Train acc/f1 = 0.8736 / 0.8542 / 0.9414 / 0.8827 
                Val acc/f1/spec/sens = 0.8160 / 0.7897 / 0.9397 / 0.8173
                Test acc/f1/spec/sens = 0.7131 / 0.7119 / 0.9375 / 0.5952
  6%|▌         | 6/100 [01:54<31:07, 19.87s/it]  7%|▋         | 7/100 [02:12<29:39, 19.13s/it]  8%|▊         | 8/100 [02:30<28:55, 18.86s/it]  9%|▉         | 9/100 [02:48<27:53, 18.39s/it] 10%|█         | 10/100 [03:15<31:41, 21.13s/it]Epoch 10: Train acc/f1 = 0.9294 / 0.9133 / 0.9903 / 0.9213 
                Val acc/f1/spec/sens = 0.8200 / 0.7926 / 0.9347 / 0.8239
                Test acc/f1/spec/sens = 0.6885 / 0.6977 / 0.9125 / 0.5476
 11%|█         | 11/100 [03:32<29:35, 19.95s/it] 12%|█▏        | 12/100 [03:51<28:34, 19.48s/it] 13%|█▎        | 13/100 [04:07<26:47, 18.48s/it] 14%|█▍        | 14/100 [04:25<26:22, 18.40s/it] 15%|█▌        | 15/100 [04:51<29:21, 20.73s/it]Epoch 15: Train acc/f1 = 0.9403 / 0.9346 / 0.9871 / 0.9272 
                Val acc/f1/spec/sens = 0.8200 / 0.7921 / 0.8643 / 0.8571
                Test acc/f1/spec/sens = 0.5902 / 0.5919 / 0.9125 / 0.3571
 16%|█▌        | 16/100 [05:08<27:21, 19.54s/it] 17%|█▋        | 17/100 [05:24<25:44, 18.60s/it] 18%|█▊        | 18/100 [05:43<25:28, 18.65s/it] 19%|█▉        | 19/100 [05:59<24:11, 17.92s/it] 20%|██        | 20/100 [06:28<28:14, 21.18s/it]Epoch 20: Train acc/f1 = 0.9686 / 0.9646 / 0.9955 / 0.9589 
                Val acc/f1/spec/sens = 0.8320 / 0.8165 / 0.9397 / 0.8173
                Test acc/f1/spec/sens = 0.6557 / 0.6493 / 0.9375 / 0.5000
 21%|██        | 21/100 [06:43<25:23, 19.28s/it] 22%|██▏       | 22/100 [07:03<25:09, 19.35s/it] 23%|██▎       | 23/100 [07:18<23:14, 18.11s/it] 24%|██▍       | 24/100 [07:37<23:25, 18.50s/it] 25%|██▌       | 25/100 [08:02<25:33, 20.44s/it]Epoch 25: Train acc/f1 = 0.9994 / 0.9991 / 1.0000 / 0.9995 
                Val acc/f1/spec/sens = 0.8400 / 0.8169 / 0.8844 / 0.8638
                Test acc/f1/spec/sens = 0.6885 / 0.6863 / 0.9250 / 0.5714
 26%|██▌       | 26/100 [08:21<24:31, 19.89s/it] 27%|██▋       | 27/100 [08:37<22:46, 18.72s/it] 28%|██▊       | 28/100 [08:56<22:36, 18.84s/it] 29%|██▉       | 29/100 [09:12<21:20, 18.03s/it] 30%|███       | 30/100 [09:43<25:44, 22.06s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8420 / 0.8208 / 0.8894 / 0.8605
                Test acc/f1/spec/sens = 0.7049 / 0.7094 / 0.9125 / 0.5714
 31%|███       | 31/100 [09:57<22:31, 19.58s/it] 32%|███▏      | 32/100 [10:16<22:02, 19.44s/it] 33%|███▎      | 33/100 [10:35<21:21, 19.13s/it] 34%|███▍      | 34/100 [10:54<20:59, 19.09s/it] 35%|███▌      | 35/100 [11:18<22:15, 20.55s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8380 / 0.8154 / 0.8844 / 0.8605
                Test acc/f1/spec/sens = 0.6885 / 0.6898 / 0.9125 / 0.5714
 36%|███▌      | 36/100 [11:35<20:53, 19.59s/it] 37%|███▋      | 37/100 [11:50<19:05, 18.19s/it] 38%|███▊      | 38/100 [12:08<18:42, 18.10s/it] 39%|███▉      | 39/100 [12:25<18:00, 17.72s/it] 40%|████      | 40/100 [12:53<20:55, 20.92s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8420 / 0.8193 / 0.8744 / 0.8704
                Test acc/f1/spec/sens = 0.6885 / 0.6959 / 0.8875 / 0.5714
 41%|████      | 41/100 [13:10<19:24, 19.73s/it] 42%|████▏     | 42/100 [13:27<18:20, 18.97s/it] 43%|████▎     | 43/100 [13:43<17:15, 18.16s/it] 44%|████▍     | 44/100 [14:02<17:05, 18.32s/it] 45%|████▌     | 45/100 [14:28<18:46, 20.48s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8380 / 0.8152 / 0.8844 / 0.8605
                Test acc/f1/spec/sens = 0.7049 / 0.7094 / 0.9125 / 0.5714
 46%|████▌     | 46/100 [14:45<17:41, 19.65s/it] 47%|████▋     | 47/100 [15:02<16:39, 18.86s/it] 48%|████▊     | 48/100 [15:19<15:52, 18.32s/it] 49%|████▉     | 49/100 [15:36<15:10, 17.85s/it] 50%|█████     | 50/100 [16:05<17:35, 21.11s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8400 / 0.8193 / 0.8995 / 0.8505
                Test acc/f1/spec/sens = 0.6967 / 0.6982 / 0.9250 / 0.5476
 51%|█████     | 51/100 [16:20<15:49, 19.37s/it] 52%|█████▏    | 52/100 [16:40<15:33, 19.46s/it] 53%|█████▎    | 53/100 [16:56<14:28, 18.49s/it] 54%|█████▍    | 54/100 [17:15<14:15, 18.60s/it] 55%|█████▌    | 55/100 [17:43<15:59, 21.31s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8420 / 0.8209 / 0.8995 / 0.8538
                Test acc/f1/spec/sens = 0.6967 / 0.7011 / 0.9125 / 0.5476
 56%|█████▌    | 56/100 [18:02<15:18, 20.87s/it] 57%|█████▋    | 57/100 [18:20<14:09, 19.75s/it] 58%|█████▊    | 58/100 [18:37<13:21, 19.09s/it] 59%|█████▉    | 59/100 [18:54<12:35, 18.43s/it] 60%|██████    | 60/100 [19:30<15:41, 23.54s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8440 / 0.8229 / 0.9045 / 0.8538
                Test acc/f1/spec/sens = 0.6721 / 0.6715 / 0.9125 / 0.5476
 61%|██████    | 61/100 [19:46<13:58, 21.49s/it] 62%|██████▏   | 62/100 [20:04<12:59, 20.51s/it] 63%|██████▎   | 63/100 [20:22<12:06, 19.64s/it] 64%|██████▍   | 64/100 [20:43<11:55, 19.88s/it] 65%|██████▌   | 65/100 [21:13<13:24, 22.99s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8400 / 0.8188 / 0.8945 / 0.8538
                Test acc/f1/spec/sens = 0.6885 / 0.6972 / 0.8875 / 0.5476
 66%|██████▌   | 66/100 [21:33<12:28, 22.03s/it] 67%|██████▋   | 67/100 [21:49<11:16, 20.50s/it] 68%|██████▊   | 68/100 [22:06<10:20, 19.39s/it] 69%|██████▉   | 69/100 [22:23<09:32, 18.46s/it] 70%|███████   | 70/100 [22:50<10:38, 21.29s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8420 / 0.8234 / 0.9146 / 0.8439
                Test acc/f1/spec/sens = 0.6967 / 0.6962 / 0.9500 / 0.5476
 71%|███████   | 71/100 [23:05<09:22, 19.41s/it] 72%|███████▏  | 72/100 [23:25<09:00, 19.31s/it] 73%|███████▎  | 73/100 [23:39<08:04, 17.94s/it] 74%|███████▍  | 74/100 [23:58<07:49, 18.04s/it] 75%|███████▌  | 75/100 [24:25<08:39, 20.80s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8380 / 0.8163 / 0.8844 / 0.8571
                Test acc/f1/spec/sens = 0.6885 / 0.6898 / 0.9125 / 0.5714
 76%|███████▌  | 76/100 [24:43<07:57, 19.90s/it] 77%|███████▋  | 77/100 [25:01<07:26, 19.40s/it] 78%|███████▊  | 78/100 [25:21<07:08, 19.48s/it] 79%|███████▉  | 79/100 [25:38<06:39, 19.01s/it] 80%|████████  | 80/100 [26:09<07:30, 22.52s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8460 / 0.8254 / 0.9045 / 0.8571
                Test acc/f1/spec/sens = 0.6885 / 0.6898 / 0.9125 / 0.5714
 81%|████████  | 81/100 [26:29<06:50, 21.59s/it] 82%|████████▏ | 82/100 [26:46<06:06, 20.36s/it] 83%|████████▎ | 83/100 [27:03<05:27, 19.25s/it] 84%|████████▍ | 84/100 [27:24<05:16, 19.76s/it] 85%|████████▌ | 85/100 [27:58<06:01, 24.10s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8380 / 0.8148 / 0.8945 / 0.8571
                Test acc/f1/spec/sens = 0.6803 / 0.6796 / 0.9125 / 0.5714
 86%|████████▌ | 86/100 [28:13<04:58, 21.35s/it] 87%|████████▋ | 87/100 [28:27<04:07, 19.08s/it] 88%|████████▊ | 88/100 [28:44<03:42, 18.58s/it] 89%|████████▉ | 89/100 [28:59<03:11, 17.39s/it] 90%|█████████ | 90/100 [29:23<03:13, 19.35s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8400 / 0.8188 / 0.8945 / 0.8538
                Test acc/f1/spec/sens = 0.6721 / 0.6715 / 0.9125 / 0.5476
 91%|█████████ | 91/100 [29:37<02:39, 17.74s/it] 92%|█████████▏| 92/100 [29:53<02:19, 17.41s/it] 93%|█████████▎| 93/100 [30:08<01:55, 16.54s/it] 94%|█████████▍| 94/100 [30:22<01:35, 15.90s/it] 95%|█████████▌| 95/100 [30:45<01:29, 17.96s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8340 / 0.8095 / 0.8844 / 0.8571
                Test acc/f1/spec/sens = 0.6721 / 0.6715 / 0.9125 / 0.5476
 96%|█████████▌| 96/100 [31:01<01:09, 17.37s/it] 97%|█████████▋| 97/100 [31:14<00:48, 16.02s/it] 98%|█████████▊| 98/100 [31:28<00:30, 15.41s/it] 99%|█████████▉| 99/100 [31:45<00:15, 15.85s/it]100%|██████████| 100/100 [32:10<00:00, 18.84s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8380 / 0.8137 / 0.8945 / 0.8571
                Test acc/f1/spec/sens = 0.6885 / 0.6972 / 0.8875 / 0.5476
specificity = 1554/1554
sensitivity = 2046/2046
specificity = 178/199
sensitivity = 258/301
specificity = 71/80
sensitivity = 23/42
Trial 1, Cycle 4
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000
Val acc/f1/spec/sens = 0.8380 / 0.8137 / 0.8945 / 0.8571
Test acc/f1/spec/sens = 0.6885 / 0.6972 / 0.8875 / 0.5476
>> Finished.
specificity = 71/80
sensitivity = 23/42
Acc, agreement for latest model:  0.6885245901639344 0.7131147540983607
Load best checkpoint for thief model
specificity = 73/80
sensitivity = 24/42
Acc, agreement for best model:  0.6885245901639344 0.6885245901639344
Trial 0/1 || Cycle 4/5 || Label set size 3600 || Test acc 0.6885 || Test agreement 0.6885 || Spec 0.9125 || Sens 0.5714
**************************************************************************************************** 

  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:07<01:39,  7.11s/it] 13%|█▎        | 2/15 [00:08<00:44,  3.46s/it] 20%|██        | 3/15 [00:08<00:26,  2.23s/it] 27%|██▋       | 4/15 [00:09<00:16,  1.49s/it] 33%|███▎      | 5/15 [00:09<00:10,  1.08s/it] 40%|████      | 6/15 [00:09<00:07,  1.19it/s] 47%|████▋     | 7/15 [00:10<00:05,  1.37it/s] 53%|█████▎    | 8/15 [00:11<00:05,  1.29it/s] 60%|██████    | 9/15 [00:11<00:03,  1.55it/s] 67%|██████▋   | 10/15 [00:12<00:03,  1.55it/s] 73%|███████▎  | 11/15 [00:13<00:02,  1.46it/s] 80%|████████  | 12/15 [00:13<00:02,  1.41it/s] 87%|████████▋ | 13/15 [00:14<00:01,  1.37it/s] 93%|█████████▎| 14/15 [00:15<00:00,  1.36it/s]100%|██████████| 15/15 [00:16<00:00,  1.35it/s]100%|██████████| 15/15 [00:16<00:00,  1.09s/it]
Maximum distance from cluster centers is 0.37
labeled set:  4500
unlabeled set:  10800
replacing addendum labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:55,  1.01it/s]  4%|▎         | 2/57 [00:01<00:40,  1.35it/s]  5%|▌         | 3/57 [00:01<00:32,  1.67it/s]  7%|▋         | 4/57 [00:02<00:28,  1.83it/s]  9%|▉         | 5/57 [00:02<00:25,  2.04it/s] 11%|█         | 6/57 [00:03<00:23,  2.17it/s] 12%|█▏        | 7/57 [00:03<00:22,  2.24it/s] 14%|█▍        | 8/57 [00:04<00:20,  2.37it/s] 16%|█▌        | 9/57 [00:04<00:18,  2.60it/s] 18%|█▊        | 10/57 [00:04<00:17,  2.76it/s] 19%|█▉        | 11/57 [00:05<00:17,  2.61it/s] 21%|██        | 12/57 [00:05<00:16,  2.73it/s] 23%|██▎       | 13/57 [00:05<00:18,  2.38it/s] 25%|██▍       | 14/57 [00:06<00:18,  2.36it/s] 26%|██▋       | 15/57 [00:06<00:18,  2.30it/s] 28%|██▊       | 16/57 [00:07<00:17,  2.30it/s] 30%|██▉       | 17/57 [00:07<00:18,  2.18it/s] 32%|███▏      | 18/57 [00:08<00:18,  2.15it/s] 33%|███▎      | 19/57 [00:08<00:17,  2.17it/s] 35%|███▌      | 20/57 [00:09<00:16,  2.19it/s] 37%|███▋      | 21/57 [00:09<00:15,  2.29it/s] 39%|███▊      | 22/57 [00:09<00:14,  2.35it/s] 40%|████      | 23/57 [00:10<00:14,  2.28it/s] 42%|████▏     | 24/57 [00:10<00:13,  2.38it/s] 44%|████▍     | 25/57 [00:11<00:12,  2.46it/s] 46%|████▌     | 26/57 [00:11<00:12,  2.54it/s] 47%|████▋     | 27/57 [00:11<00:11,  2.69it/s] 49%|████▉     | 28/57 [00:12<00:10,  2.81it/s] 51%|█████     | 29/57 [00:12<00:09,  2.91it/s] 53%|█████▎    | 30/57 [00:12<00:08,  3.08it/s] 54%|█████▍    | 31/57 [00:13<00:08,  2.98it/s] 56%|█████▌    | 32/57 [00:13<00:08,  2.95it/s] 58%|█████▊    | 33/57 [00:13<00:08,  2.99it/s] 60%|█████▉    | 34/57 [00:14<00:07,  2.97it/s] 61%|██████▏   | 35/57 [00:14<00:07,  3.13it/s] 63%|██████▎   | 36/57 [00:14<00:06,  3.12it/s] 65%|██████▍   | 37/57 [00:15<00:07,  2.79it/s] 67%|██████▋   | 38/57 [00:15<00:06,  2.80it/s] 68%|██████▊   | 39/57 [00:15<00:06,  2.84it/s] 70%|███████   | 40/57 [00:16<00:06,  2.65it/s] 72%|███████▏  | 41/57 [00:16<00:07,  2.19it/s] 74%|███████▎  | 42/57 [00:17<00:07,  1.97it/s] 75%|███████▌  | 43/57 [00:18<00:07,  1.88it/s] 77%|███████▋  | 44/57 [00:18<00:06,  1.94it/s] 79%|███████▉  | 45/57 [00:19<00:05,  2.05it/s] 81%|████████  | 46/57 [00:19<00:05,  2.13it/s] 82%|████████▏ | 47/57 [00:19<00:04,  2.21it/s] 84%|████████▍ | 48/57 [00:20<00:03,  2.28it/s] 86%|████████▌ | 49/57 [00:20<00:03,  2.21it/s] 88%|████████▊ | 50/57 [00:21<00:02,  2.34it/s] 89%|████████▉ | 51/57 [00:21<00:02,  2.41it/s] 91%|█████████ | 52/57 [00:21<00:01,  2.56it/s] 93%|█████████▎| 53/57 [00:22<00:01,  2.58it/s] 95%|█████████▍| 54/57 [00:22<00:01,  2.58it/s] 96%|█████████▋| 55/57 [00:23<00:00,  2.50it/s] 98%|█████████▊| 56/57 [00:23<00:00,  2.50it/s]100%|██████████| 57/57 [00:23<00:00,  3.17it/s]100%|██████████| 57/57 [00:23<00:00,  2.39it/s]Label distribution of newly added samples after modification
Number of samples  900

{0: 152, 1: 307, 2: 441}
Validation set distribution: 
Number of samples  500
{0: 74, 1: 125, 2: 301}
Labeled set distribution: 
Number of samples  4500
{0: 703, 1: 1310, 2: 2487}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked', 'fc.weight', 'fc.bias'])
thief state:  None
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
specificity = 14/80
sensitivity = 37/42
Initial model on target dataset: acc = 0.3689, agreement = 0.4262, f1 = 0.2803, spec = 0.1750, sens = 0.8810
specificity = 101/199
sensitivity = 167/301
Initial model on validation dataset: acc = 0.4220, agreement = 0.4220, f1 = 0.3276, spec = 0.5075, sens = 0.5548
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:19<32:46, 19.86s/it]  2%|▏         | 2/100 [00:40<33:32, 20.54s/it]  3%|▎         | 3/100 [01:01<33:35, 20.78s/it]  4%|▍         | 4/100 [01:23<33:56, 21.21s/it]  5%|▌         | 5/100 [01:55<39:18, 24.83s/it]Epoch 5: Train acc/f1 = 0.8167 / 0.8035 / 0.9821 / 0.7704 
                Val acc/f1/spec/sens = 0.8140 / 0.7612 / 0.9246 / 0.8505
                Test acc/f1/spec/sens = 0.6721 / 0.6493 / 0.9875 / 0.2857
  6%|▌         | 6/100 [02:16<37:08, 23.71s/it]  7%|▋         | 7/100 [02:36<34:41, 22.38s/it]  8%|▊         | 8/100 [02:57<33:43, 22.00s/it]  9%|▉         | 9/100 [03:17<32:26, 21.39s/it] 10%|█         | 10/100 [03:50<37:25, 24.95s/it]Epoch 10: Train acc/f1 = 0.9356 / 0.9216 / 0.9563 / 0.9562 
                Val acc/f1/spec/sens = 0.8280 / 0.8010 / 0.8794 / 0.8605
                Test acc/f1/spec/sens = 0.7459 / 0.7586 / 0.8375 / 0.7381
 11%|█         | 11/100 [04:11<35:18, 23.81s/it] 12%|█▏        | 12/100 [04:34<34:25, 23.47s/it] 13%|█▎        | 13/100 [04:54<32:25, 22.36s/it] 14%|█▍        | 14/100 [05:17<32:25, 22.62s/it] 15%|█▌        | 15/100 [05:46<34:54, 24.64s/it]Epoch 15: Train acc/f1 = 0.9542 / 0.9445 / 0.9622 / 0.9751 
                Val acc/f1/spec/sens = 0.8660 / 0.8331 / 0.8995 / 0.9169
                Test acc/f1/spec/sens = 0.7131 / 0.7196 / 0.9000 / 0.6667
 16%|█▌        | 16/100 [06:08<33:27, 23.89s/it] 17%|█▋        | 17/100 [06:29<31:32, 22.80s/it] 18%|█▊        | 18/100 [06:51<31:07, 22.77s/it] 19%|█▉        | 19/100 [07:12<29:55, 22.17s/it] 20%|██        | 20/100 [07:46<34:07, 25.59s/it]Epoch 20: Train acc/f1 = 0.9624 / 0.9527 / 0.9806 / 0.9727 
                Val acc/f1/spec/sens = 0.8300 / 0.7867 / 0.8894 / 0.8870
                Test acc/f1/spec/sens = 0.7377 / 0.7371 / 0.8500 / 0.8333
 21%|██        | 21/100 [08:06<31:49, 24.18s/it] 22%|██▏       | 22/100 [08:30<31:19, 24.10s/it] 23%|██▎       | 23/100 [08:52<30:05, 23.45s/it] 24%|██▍       | 24/100 [09:16<29:45, 23.49s/it] 25%|██▌       | 25/100 [09:51<33:47, 27.04s/it]Epoch 25: Train acc/f1 = 0.9998 / 0.9997 / 1.0000 / 0.9996 
                Val acc/f1/spec/sens = 0.8360 / 0.7997 / 0.9095 / 0.8704
                Test acc/f1/spec/sens = 0.7377 / 0.7429 / 0.8750 / 0.7619
 26%|██▌       | 26/100 [10:14<31:37, 25.64s/it] 27%|██▋       | 27/100 [10:35<29:37, 24.35s/it] 28%|██▊       | 28/100 [10:55<27:44, 23.12s/it] 29%|██▉       | 29/100 [11:17<26:44, 22.60s/it] 30%|███       | 30/100 [11:49<29:45, 25.51s/it]Epoch 30: Train acc/f1 = 0.9996 / 0.9993 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8400 / 0.8052 / 0.9045 / 0.8771
                Test acc/f1/spec/sens = 0.7377 / 0.7433 / 0.8750 / 0.7857
 31%|███       | 31/100 [12:07<26:40, 23.19s/it] 32%|███▏      | 32/100 [12:30<26:12, 23.13s/it] 33%|███▎      | 33/100 [12:49<24:37, 22.05s/it] 34%|███▍      | 34/100 [13:12<24:33, 22.32s/it] 35%|███▌      | 35/100 [13:42<26:39, 24.61s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8340 / 0.7975 / 0.8995 / 0.8738
                Test acc/f1/spec/sens = 0.7623 / 0.7681 / 0.8875 / 0.7857
 36%|███▌      | 36/100 [14:02<24:54, 23.34s/it] 37%|███▋      | 37/100 [14:22<23:23, 22.28s/it] 38%|███▊      | 38/100 [14:45<23:09, 22.41s/it] 39%|███▉      | 39/100 [15:04<21:39, 21.30s/it] 40%|████      | 40/100 [15:37<24:57, 24.95s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8360 / 0.8008 / 0.8995 / 0.8738
                Test acc/f1/spec/sens = 0.7459 / 0.7552 / 0.8750 / 0.7381
 41%|████      | 41/100 [15:56<22:39, 23.04s/it] 42%|████▏     | 42/100 [16:17<21:43, 22.48s/it] 43%|████▎     | 43/100 [16:38<20:56, 22.05s/it] 44%|████▍     | 44/100 [16:58<20:03, 21.49s/it] 45%|████▌     | 45/100 [17:30<22:34, 24.63s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8360 / 0.7989 / 0.9146 / 0.8704
                Test acc/f1/spec/sens = 0.7377 / 0.7466 / 0.8625 / 0.7619
 46%|████▌     | 46/100 [17:51<21:15, 23.63s/it] 47%|████▋     | 47/100 [18:12<20:00, 22.65s/it] 48%|████▊     | 48/100 [18:32<19:07, 22.06s/it] 49%|████▉     | 49/100 [18:55<18:44, 22.06s/it] 50%|█████     | 50/100 [19:26<20:47, 24.95s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8320 / 0.7943 / 0.8995 / 0.8704
                Test acc/f1/spec/sens = 0.7295 / 0.7362 / 0.8750 / 0.7381
 51%|█████     | 51/100 [19:48<19:28, 23.86s/it] 52%|█████▏    | 52/100 [20:09<18:36, 23.26s/it] 53%|█████▎    | 53/100 [20:29<17:16, 22.06s/it] 54%|█████▍    | 54/100 [20:50<16:41, 21.77s/it] 55%|█████▌    | 55/100 [21:23<18:53, 25.18s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8360 / 0.7996 / 0.9045 / 0.8738
                Test acc/f1/spec/sens = 0.7541 / 0.7573 / 0.8625 / 0.8333
 56%|█████▌    | 56/100 [21:44<17:37, 24.02s/it] 57%|█████▋    | 57/100 [22:06<16:42, 23.32s/it] 58%|█████▊    | 58/100 [22:26<15:40, 22.40s/it] 59%|█████▉    | 59/100 [22:47<15:01, 22.00s/it] 60%|██████    | 60/100 [23:21<17:06, 25.66s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8360 / 0.8006 / 0.9146 / 0.8671
                Test acc/f1/spec/sens = 0.7459 / 0.7536 / 0.8875 / 0.7381
 61%|██████    | 61/100 [23:43<15:48, 24.31s/it] 62%|██████▏   | 62/100 [24:05<15:07, 23.88s/it] 63%|██████▎   | 63/100 [24:26<14:10, 22.98s/it] 64%|██████▍   | 64/100 [24:48<13:30, 22.52s/it] 65%|██████▌   | 65/100 [25:19<14:43, 25.26s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8340 / 0.7962 / 0.8744 / 0.8837
                Test acc/f1/spec/sens = 0.7295 / 0.7373 / 0.8875 / 0.6905
 66%|██████▌   | 66/100 [25:42<13:52, 24.48s/it] 67%|██████▋   | 67/100 [26:02<12:44, 23.18s/it] 68%|██████▊   | 68/100 [26:25<12:13, 22.91s/it] 69%|██████▉   | 69/100 [26:46<11:33, 22.36s/it] 70%|███████   | 70/100 [27:19<12:54, 25.82s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8360 / 0.8008 / 0.8995 / 0.8738
                Test acc/f1/spec/sens = 0.7295 / 0.7376 / 0.8750 / 0.7381
 71%|███████   | 71/100 [27:40<11:45, 24.33s/it] 72%|███████▏  | 72/100 [28:02<10:57, 23.50s/it] 73%|███████▎  | 73/100 [28:24<10:19, 22.96s/it] 74%|███████▍  | 74/100 [28:45<09:48, 22.64s/it] 75%|███████▌  | 75/100 [29:19<10:50, 26.01s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8380 / 0.7987 / 0.8693 / 0.8937
                Test acc/f1/spec/sens = 0.7459 / 0.7520 / 0.8875 / 0.7381
 76%|███████▌  | 76/100 [29:42<10:00, 25.04s/it] 77%|███████▋  | 77/100 [30:04<09:15, 24.15s/it] 78%|███████▊  | 78/100 [30:25<08:27, 23.07s/it] 79%|███████▉  | 79/100 [30:45<07:49, 22.34s/it] 80%|████████  | 80/100 [31:22<08:49, 26.50s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8300 / 0.7932 / 0.9045 / 0.8671
                Test acc/f1/spec/sens = 0.7295 / 0.7393 / 0.8750 / 0.7143
 81%|████████  | 81/100 [31:42<07:49, 24.72s/it] 82%|████████▏ | 82/100 [32:03<07:04, 23.60s/it] 83%|████████▎ | 83/100 [32:24<06:25, 22.67s/it] 84%|████████▍ | 84/100 [32:46<06:01, 22.60s/it] 85%|████████▌ | 85/100 [33:39<07:54, 31.60s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8260 / 0.7894 / 0.9045 / 0.8605
                Test acc/f1/spec/sens = 0.7377 / 0.7436 / 0.8875 / 0.7143
 86%|████████▌ | 86/100 [34:00<06:39, 28.55s/it] 87%|████████▋ | 87/100 [34:21<05:42, 26.38s/it] 88%|████████▊ | 88/100 [34:43<04:59, 24.99s/it] 89%|████████▉ | 89/100 [35:03<04:17, 23.38s/it] 90%|█████████ | 90/100 [35:36<04:23, 26.32s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8360 / 0.7982 / 0.8995 / 0.8771
                Test acc/f1/spec/sens = 0.7295 / 0.7337 / 0.8750 / 0.7381
 91%|█████████ | 91/100 [35:56<03:39, 24.36s/it] 92%|█████████▏| 92/100 [36:16<03:05, 23.17s/it] 93%|█████████▎| 93/100 [36:37<02:37, 22.45s/it] 94%|█████████▍| 94/100 [37:05<02:24, 24.11s/it] 95%|█████████▌| 95/100 [37:40<02:17, 27.47s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8320 / 0.7960 / 0.8995 / 0.8671
                Test acc/f1/spec/sens = 0.7295 / 0.7399 / 0.8875 / 0.6667
 96%|█████████▌| 96/100 [38:01<01:41, 25.38s/it] 97%|█████████▋| 97/100 [38:20<01:10, 23.56s/it] 98%|█████████▊| 98/100 [38:42<00:46, 23.10s/it] 99%|█████████▉| 99/100 [39:02<00:22, 22.07s/it]100%|██████████| 100/100 [39:35<00:00, 25.37s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.8340 / 0.7961 / 0.8945 / 0.8771
                Test acc/f1/spec/sens = 0.7377 / 0.7434 / 0.8750 / 0.7619
specificity = 2013/2013
sensitivity = 2487/2487
specificity = 178/199
sensitivity = 264/301
specificity = 70/80
sensitivity = 32/42
Trial 1, Cycle 5
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000
Val acc/f1/spec/sens = 0.8340 / 0.7961 / 0.8945 / 0.8771
Test acc/f1/spec/sens = 0.7377 / 0.7434 / 0.8750 / 0.7619
>> Finished.
specificity = 70/80
sensitivity = 32/42
Acc, agreement for latest model:  0.7377049180327869 0.7459016393442623
Load best checkpoint for thief model
specificity = 70/80
sensitivity = 30/42
Acc, agreement for best model:  0.7131147540983607 0.6885245901639344
Trial 0/1 || Cycle 5/5 || Label set size 4500 || Test acc 0.7131 || Test agreement 0.6885 || Spec 0.8750 || Sens 0.7143
**************************************************************************************************** 

specificity = 70/80
sensitivity = 30/42
Number of samples  4500
0.6885245901639344 0.0
        acc       agr   spec      sens                  label dist
0  0.713115  0.688525  0.875  0.714286  {0: 703, 1: 1310, 2: 2487}
Results saved to  /home/ankita/scratch/data_msa_medical/results_5k/gbusg_radformer/GBUSV_resnet50/SGD/5000_val500/kcenter_
