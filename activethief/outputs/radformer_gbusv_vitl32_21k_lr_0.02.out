[24/02/22 11:43:40] [conf.py:  298]: PyTorch Version: torch=1.11.0, cuda=11.3, cudnn=8200
[24/02/22 11:43:40] [conf.py:  300]: ACTIVE:
  ADDENDUM: 0
  ALPHA: 0.2
  AUGMENT: None
  BETA: 1.0
  BUDGET: 5000
  CUTMIX_PROB: 0.0
  CYCLES: 1
  INITIAL: 4500
  LA: False
  METHOD: random
  PRETRAINED_PATH: /home/deepankar/scratch/model_stealing_encoders_copy/MSA/ckpts/ViT_Imagenet21k_Pretrained/vit_l_32-imagenet21k.pth
  TEMP: 1.0
  TRO: 1.0
  USE_PRETRAINED: True
  VAL: 500
AM:
  SGR: 1000
  THRESHOLD: 0.5
CUDNN_BENCHMARK: True
DS_SEED: 123
EDM:
  HASH: /home/harsh_s/scratch/msacopy/exp/hash/alpha.pt
  NUM_MODELS: 5
  PATH1: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T0.pt
  PATH2: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T1.pt
  PATH3: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T2.pt
  PATH4: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T3.pt
  PATH5: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T4.pt
GR:
  EPSILON: 0.1
  SUR_PATH: /home/harsh_s/scratch/msacopy/GRAD2/batch_training/outputs/trained_models/imagenet_cifar10_to_cifar10_surrogate_10epochs.pt
LOG_DEST: radformer_vitl32_21k_gbusv_240222_114340.txt
LOG_TIME: 240222_114340
METHOD_NAME: v8
OUT_DIR: /home/deepankar/scratch/MSA_Medical/results_deepankar
PL:
  CLASS_BLNC: 10
  ITERATIONS: 20
  KAPPA_N: 0.005
  KAPPA_P: 0.05
  NO_PROGRESS: False
  NO_UNCERTAINTY: False
  TAU_N: 0.05
  TAU_P: 0.7
  TEMP_NL: 2.0
RNG_SEED: 1
SAVE_DIR: /home/deepankar/scratch/MSA_Medical/results_deepankar/gbusg_radformer/GBUSV_vit_l_32_21k/SGD/5000_val500/random_v8
THIEF:
  ARCH: vit_l_32_21k
  DATASET: GBUSV
  DATA_ROOT: /home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBUSV-Shared
  HARD_LABELS: True
  NUM_TRAIN: 1281167
  SUBSET: 128116
TRAIN:
  BATCH: 256
  EPOCH: 100
  GAMMA: 0.1
  LR: 0.02
  MILESTONES: [20, 40, 60, 80]
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  WDECAY: 0.0005
VICTIM:
  ARCH: radformer
  DATASET: gbusg
  DATA_ROOT: /home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBCU-Shared
  HEIGHT: 224
  NUM_CLASSES: 10
  PATH: /home/deepankar/mnt/vision3_data_ckpts_msa_medical/victim_models/radformer/radformer.pkl
  PATHIN: /home/harsh_s/scratch/msacopy/ckpts/cifar10-resnet32-inaccurate/checkpoint.pth.tar
  WIDTH: 224
Loaded target dataset of size 122 with 3 classes
target model keys:  695
checkpoint keys:  695
specificity = 72/80
sensitivity = 39/42

Target model acc = 0.9016393442622951
Val-Acc: 0.9016 Val-Spec: 0.9000 Val-Sens: 0.9286
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:05<01:35,  5.60s/it] 11%|█         | 2/18 [00:09<01:13,  4.61s/it] 17%|█▋        | 3/18 [00:12<01:00,  4.02s/it] 22%|██▏       | 4/18 [00:16<00:52,  3.72s/it] 28%|██▊       | 5/18 [00:19<00:46,  3.59s/it] 33%|███▎      | 6/18 [00:22<00:41,  3.46s/it] 39%|███▉      | 7/18 [00:25<00:36,  3.30s/it] 44%|████▍     | 8/18 [00:28<00:32,  3.29s/it] 50%|█████     | 9/18 [00:32<00:29,  3.26s/it] 56%|█████▌    | 10/18 [00:35<00:25,  3.19s/it] 61%|██████    | 11/18 [00:38<00:22,  3.26s/it] 67%|██████▋   | 12/18 [00:41<00:19,  3.18s/it] 72%|███████▏  | 13/18 [00:44<00:16,  3.26s/it] 78%|███████▊  | 14/18 [00:47<00:12,  3.17s/it] 83%|████████▎ | 15/18 [00:51<00:09,  3.16s/it] 89%|████████▉ | 16/18 [00:54<00:06,  3.27s/it] 94%|█████████▍| 17/18 [00:58<00:03,  3.41s/it]100%|██████████| 18/18 [01:00<00:00,  2.94s/it]100%|██████████| 18/18 [01:00<00:00,  3.35s/it]
replacing val labels with victim labels
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.49s/it]100%|██████████| 2/2 [00:07<00:00,  3.51s/it]100%|██████████| 2/2 [00:07<00:00,  3.71s/it]Validation set distribution: 
Number of samples  500

{0: 74, 1: 123, 2: 303}
Labeled set distribution: 
Number of samples  4500
{0: 581, 1: 1040, 2: 2879}
odict_keys(['class_token', 'patch_embedding.weight', 'patch_embedding.bias', 'positional_embedding.pos_embedding', 'transformer.blocks.0.attn.proj_q.weight', 'transformer.blocks.0.attn.proj_q.bias', 'transformer.blocks.0.attn.proj_k.weight', 'transformer.blocks.0.attn.proj_k.bias', 'transformer.blocks.0.attn.proj_v.weight', 'transformer.blocks.0.attn.proj_v.bias', 'transformer.blocks.0.proj.weight', 'transformer.blocks.0.proj.bias', 'transformer.blocks.0.norm1.weight', 'transformer.blocks.0.norm1.bias', 'transformer.blocks.0.pwff.fc1.weight', 'transformer.blocks.0.pwff.fc1.bias', 'transformer.blocks.0.pwff.fc2.weight', 'transformer.blocks.0.pwff.fc2.bias', 'transformer.blocks.0.norm2.weight', 'transformer.blocks.0.norm2.bias', 'transformer.blocks.1.attn.proj_q.weight', 'transformer.blocks.1.attn.proj_q.bias', 'transformer.blocks.1.attn.proj_k.weight', 'transformer.blocks.1.attn.proj_k.bias', 'transformer.blocks.1.attn.proj_v.weight', 'transformer.blocks.1.attn.proj_v.bias', 'transformer.blocks.1.proj.weight', 'transformer.blocks.1.proj.bias', 'transformer.blocks.1.norm1.weight', 'transformer.blocks.1.norm1.bias', 'transformer.blocks.1.pwff.fc1.weight', 'transformer.blocks.1.pwff.fc1.bias', 'transformer.blocks.1.pwff.fc2.weight', 'transformer.blocks.1.pwff.fc2.bias', 'transformer.blocks.1.norm2.weight', 'transformer.blocks.1.norm2.bias', 'transformer.blocks.2.attn.proj_q.weight', 'transformer.blocks.2.attn.proj_q.bias', 'transformer.blocks.2.attn.proj_k.weight', 'transformer.blocks.2.attn.proj_k.bias', 'transformer.blocks.2.attn.proj_v.weight', 'transformer.blocks.2.attn.proj_v.bias', 'transformer.blocks.2.proj.weight', 'transformer.blocks.2.proj.bias', 'transformer.blocks.2.norm1.weight', 'transformer.blocks.2.norm1.bias', 'transformer.blocks.2.pwff.fc1.weight', 'transformer.blocks.2.pwff.fc1.bias', 'transformer.blocks.2.pwff.fc2.weight', 'transformer.blocks.2.pwff.fc2.bias', 'transformer.blocks.2.norm2.weight', 'transformer.blocks.2.norm2.bias', 'transformer.blocks.3.attn.proj_q.weight', 'transformer.blocks.3.attn.proj_q.bias', 'transformer.blocks.3.attn.proj_k.weight', 'transformer.blocks.3.attn.proj_k.bias', 'transformer.blocks.3.attn.proj_v.weight', 'transformer.blocks.3.attn.proj_v.bias', 'transformer.blocks.3.proj.weight', 'transformer.blocks.3.proj.bias', 'transformer.blocks.3.norm1.weight', 'transformer.blocks.3.norm1.bias', 'transformer.blocks.3.pwff.fc1.weight', 'transformer.blocks.3.pwff.fc1.bias', 'transformer.blocks.3.pwff.fc2.weight', 'transformer.blocks.3.pwff.fc2.bias', 'transformer.blocks.3.norm2.weight', 'transformer.blocks.3.norm2.bias', 'transformer.blocks.4.attn.proj_q.weight', 'transformer.blocks.4.attn.proj_q.bias', 'transformer.blocks.4.attn.proj_k.weight', 'transformer.blocks.4.attn.proj_k.bias', 'transformer.blocks.4.attn.proj_v.weight', 'transformer.blocks.4.attn.proj_v.bias', 'transformer.blocks.4.proj.weight', 'transformer.blocks.4.proj.bias', 'transformer.blocks.4.norm1.weight', 'transformer.blocks.4.norm1.bias', 'transformer.blocks.4.pwff.fc1.weight', 'transformer.blocks.4.pwff.fc1.bias', 'transformer.blocks.4.pwff.fc2.weight', 'transformer.blocks.4.pwff.fc2.bias', 'transformer.blocks.4.norm2.weight', 'transformer.blocks.4.norm2.bias', 'transformer.blocks.5.attn.proj_q.weight', 'transformer.blocks.5.attn.proj_q.bias', 'transformer.blocks.5.attn.proj_k.weight', 'transformer.blocks.5.attn.proj_k.bias', 'transformer.blocks.5.attn.proj_v.weight', 'transformer.blocks.5.attn.proj_v.bias', 'transformer.blocks.5.proj.weight', 'transformer.blocks.5.proj.bias', 'transformer.blocks.5.norm1.weight', 'transformer.blocks.5.norm1.bias', 'transformer.blocks.5.pwff.fc1.weight', 'transformer.blocks.5.pwff.fc1.bias', 'transformer.blocks.5.pwff.fc2.weight', 'transformer.blocks.5.pwff.fc2.bias', 'transformer.blocks.5.norm2.weight', 'transformer.blocks.5.norm2.bias', 'transformer.blocks.6.attn.proj_q.weight', 'transformer.blocks.6.attn.proj_q.bias', 'transformer.blocks.6.attn.proj_k.weight', 'transformer.blocks.6.attn.proj_k.bias', 'transformer.blocks.6.attn.proj_v.weight', 'transformer.blocks.6.attn.proj_v.bias', 'transformer.blocks.6.proj.weight', 'transformer.blocks.6.proj.bias', 'transformer.blocks.6.norm1.weight', 'transformer.blocks.6.norm1.bias', 'transformer.blocks.6.pwff.fc1.weight', 'transformer.blocks.6.pwff.fc1.bias', 'transformer.blocks.6.pwff.fc2.weight', 'transformer.blocks.6.pwff.fc2.bias', 'transformer.blocks.6.norm2.weight', 'transformer.blocks.6.norm2.bias', 'transformer.blocks.7.attn.proj_q.weight', 'transformer.blocks.7.attn.proj_q.bias', 'transformer.blocks.7.attn.proj_k.weight', 'transformer.blocks.7.attn.proj_k.bias', 'transformer.blocks.7.attn.proj_v.weight', 'transformer.blocks.7.attn.proj_v.bias', 'transformer.blocks.7.proj.weight', 'transformer.blocks.7.proj.bias', 'transformer.blocks.7.norm1.weight', 'transformer.blocks.7.norm1.bias', 'transformer.blocks.7.pwff.fc1.weight', 'transformer.blocks.7.pwff.fc1.bias', 'transformer.blocks.7.pwff.fc2.weight', 'transformer.blocks.7.pwff.fc2.bias', 'transformer.blocks.7.norm2.weight', 'transformer.blocks.7.norm2.bias', 'transformer.blocks.8.attn.proj_q.weight', 'transformer.blocks.8.attn.proj_q.bias', 'transformer.blocks.8.attn.proj_k.weight', 'transformer.blocks.8.attn.proj_k.bias', 'transformer.blocks.8.attn.proj_v.weight', 'transformer.blocks.8.attn.proj_v.bias', 'transformer.blocks.8.proj.weight', 'transformer.blocks.8.proj.bias', 'transformer.blocks.8.norm1.weight', 'transformer.blocks.8.norm1.bias', 'transformer.blocks.8.pwff.fc1.weight', 'transformer.blocks.8.pwff.fc1.bias', 'transformer.blocks.8.pwff.fc2.weight', 'transformer.blocks.8.pwff.fc2.bias', 'transformer.blocks.8.norm2.weight', 'transformer.blocks.8.norm2.bias', 'transformer.blocks.9.attn.proj_q.weight', 'transformer.blocks.9.attn.proj_q.bias', 'transformer.blocks.9.attn.proj_k.weight', 'transformer.blocks.9.attn.proj_k.bias', 'transformer.blocks.9.attn.proj_v.weight', 'transformer.blocks.9.attn.proj_v.bias', 'transformer.blocks.9.proj.weight', 'transformer.blocks.9.proj.bias', 'transformer.blocks.9.norm1.weight', 'transformer.blocks.9.norm1.bias', 'transformer.blocks.9.pwff.fc1.weight', 'transformer.blocks.9.pwff.fc1.bias', 'transformer.blocks.9.pwff.fc2.weight', 'transformer.blocks.9.pwff.fc2.bias', 'transformer.blocks.9.norm2.weight', 'transformer.blocks.9.norm2.bias', 'transformer.blocks.10.attn.proj_q.weight', 'transformer.blocks.10.attn.proj_q.bias', 'transformer.blocks.10.attn.proj_k.weight', 'transformer.blocks.10.attn.proj_k.bias', 'transformer.blocks.10.attn.proj_v.weight', 'transformer.blocks.10.attn.proj_v.bias', 'transformer.blocks.10.proj.weight', 'transformer.blocks.10.proj.bias', 'transformer.blocks.10.norm1.weight', 'transformer.blocks.10.norm1.bias', 'transformer.blocks.10.pwff.fc1.weight', 'transformer.blocks.10.pwff.fc1.bias', 'transformer.blocks.10.pwff.fc2.weight', 'transformer.blocks.10.pwff.fc2.bias', 'transformer.blocks.10.norm2.weight', 'transformer.blocks.10.norm2.bias', 'transformer.blocks.11.attn.proj_q.weight', 'transformer.blocks.11.attn.proj_q.bias', 'transformer.blocks.11.attn.proj_k.weight', 'transformer.blocks.11.attn.proj_k.bias', 'transformer.blocks.11.attn.proj_v.weight', 'transformer.blocks.11.attn.proj_v.bias', 'transformer.blocks.11.proj.weight', 'transformer.blocks.11.proj.bias', 'transformer.blocks.11.norm1.weight', 'transformer.blocks.11.norm1.bias', 'transformer.blocks.11.pwff.fc1.weight', 'transformer.blocks.11.pwff.fc1.bias', 'transformer.blocks.11.pwff.fc2.weight', 'transformer.blocks.11.pwff.fc2.bias', 'transformer.blocks.11.norm2.weight', 'transformer.blocks.11.norm2.bias', 'transformer.blocks.12.attn.proj_q.weight', 'transformer.blocks.12.attn.proj_q.bias', 'transformer.blocks.12.attn.proj_k.weight', 'transformer.blocks.12.attn.proj_k.bias', 'transformer.blocks.12.attn.proj_v.weight', 'transformer.blocks.12.attn.proj_v.bias', 'transformer.blocks.12.proj.weight', 'transformer.blocks.12.proj.bias', 'transformer.blocks.12.norm1.weight', 'transformer.blocks.12.norm1.bias', 'transformer.blocks.12.pwff.fc1.weight', 'transformer.blocks.12.pwff.fc1.bias', 'transformer.blocks.12.pwff.fc2.weight', 'transformer.blocks.12.pwff.fc2.bias', 'transformer.blocks.12.norm2.weight', 'transformer.blocks.12.norm2.bias', 'transformer.blocks.13.attn.proj_q.weight', 'transformer.blocks.13.attn.proj_q.bias', 'transformer.blocks.13.attn.proj_k.weight', 'transformer.blocks.13.attn.proj_k.bias', 'transformer.blocks.13.attn.proj_v.weight', 'transformer.blocks.13.attn.proj_v.bias', 'transformer.blocks.13.proj.weight', 'transformer.blocks.13.proj.bias', 'transformer.blocks.13.norm1.weight', 'transformer.blocks.13.norm1.bias', 'transformer.blocks.13.pwff.fc1.weight', 'transformer.blocks.13.pwff.fc1.bias', 'transformer.blocks.13.pwff.fc2.weight', 'transformer.blocks.13.pwff.fc2.bias', 'transformer.blocks.13.norm2.weight', 'transformer.blocks.13.norm2.bias', 'transformer.blocks.14.attn.proj_q.weight', 'transformer.blocks.14.attn.proj_q.bias', 'transformer.blocks.14.attn.proj_k.weight', 'transformer.blocks.14.attn.proj_k.bias', 'transformer.blocks.14.attn.proj_v.weight', 'transformer.blocks.14.attn.proj_v.bias', 'transformer.blocks.14.proj.weight', 'transformer.blocks.14.proj.bias', 'transformer.blocks.14.norm1.weight', 'transformer.blocks.14.norm1.bias', 'transformer.blocks.14.pwff.fc1.weight', 'transformer.blocks.14.pwff.fc1.bias', 'transformer.blocks.14.pwff.fc2.weight', 'transformer.blocks.14.pwff.fc2.bias', 'transformer.blocks.14.norm2.weight', 'transformer.blocks.14.norm2.bias', 'transformer.blocks.15.attn.proj_q.weight', 'transformer.blocks.15.attn.proj_q.bias', 'transformer.blocks.15.attn.proj_k.weight', 'transformer.blocks.15.attn.proj_k.bias', 'transformer.blocks.15.attn.proj_v.weight', 'transformer.blocks.15.attn.proj_v.bias', 'transformer.blocks.15.proj.weight', 'transformer.blocks.15.proj.bias', 'transformer.blocks.15.norm1.weight', 'transformer.blocks.15.norm1.bias', 'transformer.blocks.15.pwff.fc1.weight', 'transformer.blocks.15.pwff.fc1.bias', 'transformer.blocks.15.pwff.fc2.weight', 'transformer.blocks.15.pwff.fc2.bias', 'transformer.blocks.15.norm2.weight', 'transformer.blocks.15.norm2.bias', 'transformer.blocks.16.attn.proj_q.weight', 'transformer.blocks.16.attn.proj_q.bias', 'transformer.blocks.16.attn.proj_k.weight', 'transformer.blocks.16.attn.proj_k.bias', 'transformer.blocks.16.attn.proj_v.weight', 'transformer.blocks.16.attn.proj_v.bias', 'transformer.blocks.16.proj.weight', 'transformer.blocks.16.proj.bias', 'transformer.blocks.16.norm1.weight', 'transformer.blocks.16.norm1.bias', 'transformer.blocks.16.pwff.fc1.weight', 'transformer.blocks.16.pwff.fc1.bias', 'transformer.blocks.16.pwff.fc2.weight', 'transformer.blocks.16.pwff.fc2.bias', 'transformer.blocks.16.norm2.weight', 'transformer.blocks.16.norm2.bias', 'transformer.blocks.17.attn.proj_q.weight', 'transformer.blocks.17.attn.proj_q.bias', 'transformer.blocks.17.attn.proj_k.weight', 'transformer.blocks.17.attn.proj_k.bias', 'transformer.blocks.17.attn.proj_v.weight', 'transformer.blocks.17.attn.proj_v.bias', 'transformer.blocks.17.proj.weight', 'transformer.blocks.17.proj.bias', 'transformer.blocks.17.norm1.weight', 'transformer.blocks.17.norm1.bias', 'transformer.blocks.17.pwff.fc1.weight', 'transformer.blocks.17.pwff.fc1.bias', 'transformer.blocks.17.pwff.fc2.weight', 'transformer.blocks.17.pwff.fc2.bias', 'transformer.blocks.17.norm2.weight', 'transformer.blocks.17.norm2.bias', 'transformer.blocks.18.attn.proj_q.weight', 'transformer.blocks.18.attn.proj_q.bias', 'transformer.blocks.18.attn.proj_k.weight', 'transformer.blocks.18.attn.proj_k.bias', 'transformer.blocks.18.attn.proj_v.weight', 'transformer.blocks.18.attn.proj_v.bias', 'transformer.blocks.18.proj.weight', 'transformer.blocks.18.proj.bias', 'transformer.blocks.18.norm1.weight', 'transformer.blocks.18.norm1.bias', 'transformer.blocks.18.pwff.fc1.weight', 'transformer.blocks.18.pwff.fc1.bias', 'transformer.blocks.18.pwff.fc2.weight', 'transformer.blocks.18.pwff.fc2.bias', 'transformer.blocks.18.norm2.weight', 'transformer.blocks.18.norm2.bias', 'transformer.blocks.19.attn.proj_q.weight', 'transformer.blocks.19.attn.proj_q.bias', 'transformer.blocks.19.attn.proj_k.weight', 'transformer.blocks.19.attn.proj_k.bias', 'transformer.blocks.19.attn.proj_v.weight', 'transformer.blocks.19.attn.proj_v.bias', 'transformer.blocks.19.proj.weight', 'transformer.blocks.19.proj.bias', 'transformer.blocks.19.norm1.weight', 'transformer.blocks.19.norm1.bias', 'transformer.blocks.19.pwff.fc1.weight', 'transformer.blocks.19.pwff.fc1.bias', 'transformer.blocks.19.pwff.fc2.weight', 'transformer.blocks.19.pwff.fc2.bias', 'transformer.blocks.19.norm2.weight', 'transformer.blocks.19.norm2.bias', 'transformer.blocks.20.attn.proj_q.weight', 'transformer.blocks.20.attn.proj_q.bias', 'transformer.blocks.20.attn.proj_k.weight', 'transformer.blocks.20.attn.proj_k.bias', 'transformer.blocks.20.attn.proj_v.weight', 'transformer.blocks.20.attn.proj_v.bias', 'transformer.blocks.20.proj.weight', 'transformer.blocks.20.proj.bias', 'transformer.blocks.20.norm1.weight', 'transformer.blocks.20.norm1.bias', 'transformer.blocks.20.pwff.fc1.weight', 'transformer.blocks.20.pwff.fc1.bias', 'transformer.blocks.20.pwff.fc2.weight', 'transformer.blocks.20.pwff.fc2.bias', 'transformer.blocks.20.norm2.weight', 'transformer.blocks.20.norm2.bias', 'transformer.blocks.21.attn.proj_q.weight', 'transformer.blocks.21.attn.proj_q.bias', 'transformer.blocks.21.attn.proj_k.weight', 'transformer.blocks.21.attn.proj_k.bias', 'transformer.blocks.21.attn.proj_v.weight', 'transformer.blocks.21.attn.proj_v.bias', 'transformer.blocks.21.proj.weight', 'transformer.blocks.21.proj.bias', 'transformer.blocks.21.norm1.weight', 'transformer.blocks.21.norm1.bias', 'transformer.blocks.21.pwff.fc1.weight', 'transformer.blocks.21.pwff.fc1.bias', 'transformer.blocks.21.pwff.fc2.weight', 'transformer.blocks.21.pwff.fc2.bias', 'transformer.blocks.21.norm2.weight', 'transformer.blocks.21.norm2.bias', 'transformer.blocks.22.attn.proj_q.weight', 'transformer.blocks.22.attn.proj_q.bias', 'transformer.blocks.22.attn.proj_k.weight', 'transformer.blocks.22.attn.proj_k.bias', 'transformer.blocks.22.attn.proj_v.weight', 'transformer.blocks.22.attn.proj_v.bias', 'transformer.blocks.22.proj.weight', 'transformer.blocks.22.proj.bias', 'transformer.blocks.22.norm1.weight', 'transformer.blocks.22.norm1.bias', 'transformer.blocks.22.pwff.fc1.weight', 'transformer.blocks.22.pwff.fc1.bias', 'transformer.blocks.22.pwff.fc2.weight', 'transformer.blocks.22.pwff.fc2.bias', 'transformer.blocks.22.norm2.weight', 'transformer.blocks.22.norm2.bias', 'transformer.blocks.23.attn.proj_q.weight', 'transformer.blocks.23.attn.proj_q.bias', 'transformer.blocks.23.attn.proj_k.weight', 'transformer.blocks.23.attn.proj_k.bias', 'transformer.blocks.23.attn.proj_v.weight', 'transformer.blocks.23.attn.proj_v.bias', 'transformer.blocks.23.proj.weight', 'transformer.blocks.23.proj.bias', 'transformer.blocks.23.norm1.weight', 'transformer.blocks.23.norm1.bias', 'transformer.blocks.23.pwff.fc1.weight', 'transformer.blocks.23.pwff.fc1.bias', 'transformer.blocks.23.pwff.fc2.weight', 'transformer.blocks.23.pwff.fc2.bias', 'transformer.blocks.23.norm2.weight', 'transformer.blocks.23.norm2.bias', 'norm.weight', 'norm.bias', 'fc.weight', 'fc.bias'])
thief state:  None
Load pretrained model for initializing the thief
pretrained state:  dict_keys(['class_token', 'patch_embedding.weight', 'patch_embedding.bias', 'positional_embedding.pos_embedding', 'transformer.blocks.0.attn.proj_q.weight', 'transformer.blocks.0.attn.proj_q.bias', 'transformer.blocks.0.attn.proj_k.weight', 'transformer.blocks.0.attn.proj_k.bias', 'transformer.blocks.0.attn.proj_v.weight', 'transformer.blocks.0.attn.proj_v.bias', 'transformer.blocks.0.proj.weight', 'transformer.blocks.0.proj.bias', 'transformer.blocks.0.norm1.weight', 'transformer.blocks.0.norm1.bias', 'transformer.blocks.0.pwff.fc1.weight', 'transformer.blocks.0.pwff.fc1.bias', 'transformer.blocks.0.pwff.fc2.weight', 'transformer.blocks.0.pwff.fc2.bias', 'transformer.blocks.0.norm2.weight', 'transformer.blocks.0.norm2.bias', 'transformer.blocks.1.attn.proj_q.weight', 'transformer.blocks.1.attn.proj_q.bias', 'transformer.blocks.1.attn.proj_k.weight', 'transformer.blocks.1.attn.proj_k.bias', 'transformer.blocks.1.attn.proj_v.weight', 'transformer.blocks.1.attn.proj_v.bias', 'transformer.blocks.1.proj.weight', 'transformer.blocks.1.proj.bias', 'transformer.blocks.1.norm1.weight', 'transformer.blocks.1.norm1.bias', 'transformer.blocks.1.pwff.fc1.weight', 'transformer.blocks.1.pwff.fc1.bias', 'transformer.blocks.1.pwff.fc2.weight', 'transformer.blocks.1.pwff.fc2.bias', 'transformer.blocks.1.norm2.weight', 'transformer.blocks.1.norm2.bias', 'transformer.blocks.2.attn.proj_q.weight', 'transformer.blocks.2.attn.proj_q.bias', 'transformer.blocks.2.attn.proj_k.weight', 'transformer.blocks.2.attn.proj_k.bias', 'transformer.blocks.2.attn.proj_v.weight', 'transformer.blocks.2.attn.proj_v.bias', 'transformer.blocks.2.proj.weight', 'transformer.blocks.2.proj.bias', 'transformer.blocks.2.norm1.weight', 'transformer.blocks.2.norm1.bias', 'transformer.blocks.2.pwff.fc1.weight', 'transformer.blocks.2.pwff.fc1.bias', 'transformer.blocks.2.pwff.fc2.weight', 'transformer.blocks.2.pwff.fc2.bias', 'transformer.blocks.2.norm2.weight', 'transformer.blocks.2.norm2.bias', 'transformer.blocks.3.attn.proj_q.weight', 'transformer.blocks.3.attn.proj_q.bias', 'transformer.blocks.3.attn.proj_k.weight', 'transformer.blocks.3.attn.proj_k.bias', 'transformer.blocks.3.attn.proj_v.weight', 'transformer.blocks.3.attn.proj_v.bias', 'transformer.blocks.3.proj.weight', 'transformer.blocks.3.proj.bias', 'transformer.blocks.3.norm1.weight', 'transformer.blocks.3.norm1.bias', 'transformer.blocks.3.pwff.fc1.weight', 'transformer.blocks.3.pwff.fc1.bias', 'transformer.blocks.3.pwff.fc2.weight', 'transformer.blocks.3.pwff.fc2.bias', 'transformer.blocks.3.norm2.weight', 'transformer.blocks.3.norm2.bias', 'transformer.blocks.4.attn.proj_q.weight', 'transformer.blocks.4.attn.proj_q.bias', 'transformer.blocks.4.attn.proj_k.weight', 'transformer.blocks.4.attn.proj_k.bias', 'transformer.blocks.4.attn.proj_v.weight', 'transformer.blocks.4.attn.proj_v.bias', 'transformer.blocks.4.proj.weight', 'transformer.blocks.4.proj.bias', 'transformer.blocks.4.norm1.weight', 'transformer.blocks.4.norm1.bias', 'transformer.blocks.4.pwff.fc1.weight', 'transformer.blocks.4.pwff.fc1.bias', 'transformer.blocks.4.pwff.fc2.weight', 'transformer.blocks.4.pwff.fc2.bias', 'transformer.blocks.4.norm2.weight', 'transformer.blocks.4.norm2.bias', 'transformer.blocks.5.attn.proj_q.weight', 'transformer.blocks.5.attn.proj_q.bias', 'transformer.blocks.5.attn.proj_k.weight', 'transformer.blocks.5.attn.proj_k.bias', 'transformer.blocks.5.attn.proj_v.weight', 'transformer.blocks.5.attn.proj_v.bias', 'transformer.blocks.5.proj.weight', 'transformer.blocks.5.proj.bias', 'transformer.blocks.5.norm1.weight', 'transformer.blocks.5.norm1.bias', 'transformer.blocks.5.pwff.fc1.weight', 'transformer.blocks.5.pwff.fc1.bias', 'transformer.blocks.5.pwff.fc2.weight', 'transformer.blocks.5.pwff.fc2.bias', 'transformer.blocks.5.norm2.weight', 'transformer.blocks.5.norm2.bias', 'transformer.blocks.6.attn.proj_q.weight', 'transformer.blocks.6.attn.proj_q.bias', 'transformer.blocks.6.attn.proj_k.weight', 'transformer.blocks.6.attn.proj_k.bias', 'transformer.blocks.6.attn.proj_v.weight', 'transformer.blocks.6.attn.proj_v.bias', 'transformer.blocks.6.proj.weight', 'transformer.blocks.6.proj.bias', 'transformer.blocks.6.norm1.weight', 'transformer.blocks.6.norm1.bias', 'transformer.blocks.6.pwff.fc1.weight', 'transformer.blocks.6.pwff.fc1.bias', 'transformer.blocks.6.pwff.fc2.weight', 'transformer.blocks.6.pwff.fc2.bias', 'transformer.blocks.6.norm2.weight', 'transformer.blocks.6.norm2.bias', 'transformer.blocks.7.attn.proj_q.weight', 'transformer.blocks.7.attn.proj_q.bias', 'transformer.blocks.7.attn.proj_k.weight', 'transformer.blocks.7.attn.proj_k.bias', 'transformer.blocks.7.attn.proj_v.weight', 'transformer.blocks.7.attn.proj_v.bias', 'transformer.blocks.7.proj.weight', 'transformer.blocks.7.proj.bias', 'transformer.blocks.7.norm1.weight', 'transformer.blocks.7.norm1.bias', 'transformer.blocks.7.pwff.fc1.weight', 'transformer.blocks.7.pwff.fc1.bias', 'transformer.blocks.7.pwff.fc2.weight', 'transformer.blocks.7.pwff.fc2.bias', 'transformer.blocks.7.norm2.weight', 'transformer.blocks.7.norm2.bias', 'transformer.blocks.8.attn.proj_q.weight', 'transformer.blocks.8.attn.proj_q.bias', 'transformer.blocks.8.attn.proj_k.weight', 'transformer.blocks.8.attn.proj_k.bias', 'transformer.blocks.8.attn.proj_v.weight', 'transformer.blocks.8.attn.proj_v.bias', 'transformer.blocks.8.proj.weight', 'transformer.blocks.8.proj.bias', 'transformer.blocks.8.norm1.weight', 'transformer.blocks.8.norm1.bias', 'transformer.blocks.8.pwff.fc1.weight', 'transformer.blocks.8.pwff.fc1.bias', 'transformer.blocks.8.pwff.fc2.weight', 'transformer.blocks.8.pwff.fc2.bias', 'transformer.blocks.8.norm2.weight', 'transformer.blocks.8.norm2.bias', 'transformer.blocks.9.attn.proj_q.weight', 'transformer.blocks.9.attn.proj_q.bias', 'transformer.blocks.9.attn.proj_k.weight', 'transformer.blocks.9.attn.proj_k.bias', 'transformer.blocks.9.attn.proj_v.weight', 'transformer.blocks.9.attn.proj_v.bias', 'transformer.blocks.9.proj.weight', 'transformer.blocks.9.proj.bias', 'transformer.blocks.9.norm1.weight', 'transformer.blocks.9.norm1.bias', 'transformer.blocks.9.pwff.fc1.weight', 'transformer.blocks.9.pwff.fc1.bias', 'transformer.blocks.9.pwff.fc2.weight', 'transformer.blocks.9.pwff.fc2.bias', 'transformer.blocks.9.norm2.weight', 'transformer.blocks.9.norm2.bias', 'transformer.blocks.10.attn.proj_q.weight', 'transformer.blocks.10.attn.proj_q.bias', 'transformer.blocks.10.attn.proj_k.weight', 'transformer.blocks.10.attn.proj_k.bias', 'transformer.blocks.10.attn.proj_v.weight', 'transformer.blocks.10.attn.proj_v.bias', 'transformer.blocks.10.proj.weight', 'transformer.blocks.10.proj.bias', 'transformer.blocks.10.norm1.weight', 'transformer.blocks.10.norm1.bias', 'transformer.blocks.10.pwff.fc1.weight', 'transformer.blocks.10.pwff.fc1.bias', 'transformer.blocks.10.pwff.fc2.weight', 'transformer.blocks.10.pwff.fc2.bias', 'transformer.blocks.10.norm2.weight', 'transformer.blocks.10.norm2.bias', 'transformer.blocks.11.attn.proj_q.weight', 'transformer.blocks.11.attn.proj_q.bias', 'transformer.blocks.11.attn.proj_k.weight', 'transformer.blocks.11.attn.proj_k.bias', 'transformer.blocks.11.attn.proj_v.weight', 'transformer.blocks.11.attn.proj_v.bias', 'transformer.blocks.11.proj.weight', 'transformer.blocks.11.proj.bias', 'transformer.blocks.11.norm1.weight', 'transformer.blocks.11.norm1.bias', 'transformer.blocks.11.pwff.fc1.weight', 'transformer.blocks.11.pwff.fc1.bias', 'transformer.blocks.11.pwff.fc2.weight', 'transformer.blocks.11.pwff.fc2.bias', 'transformer.blocks.11.norm2.weight', 'transformer.blocks.11.norm2.bias', 'transformer.blocks.12.attn.proj_q.weight', 'transformer.blocks.12.attn.proj_q.bias', 'transformer.blocks.12.attn.proj_k.weight', 'transformer.blocks.12.attn.proj_k.bias', 'transformer.blocks.12.attn.proj_v.weight', 'transformer.blocks.12.attn.proj_v.bias', 'transformer.blocks.12.proj.weight', 'transformer.blocks.12.proj.bias', 'transformer.blocks.12.norm1.weight', 'transformer.blocks.12.norm1.bias', 'transformer.blocks.12.pwff.fc1.weight', 'transformer.blocks.12.pwff.fc1.bias', 'transformer.blocks.12.pwff.fc2.weight', 'transformer.blocks.12.pwff.fc2.bias', 'transformer.blocks.12.norm2.weight', 'transformer.blocks.12.norm2.bias', 'transformer.blocks.13.attn.proj_q.weight', 'transformer.blocks.13.attn.proj_q.bias', 'transformer.blocks.13.attn.proj_k.weight', 'transformer.blocks.13.attn.proj_k.bias', 'transformer.blocks.13.attn.proj_v.weight', 'transformer.blocks.13.attn.proj_v.bias', 'transformer.blocks.13.proj.weight', 'transformer.blocks.13.proj.bias', 'transformer.blocks.13.norm1.weight', 'transformer.blocks.13.norm1.bias', 'transformer.blocks.13.pwff.fc1.weight', 'transformer.blocks.13.pwff.fc1.bias', 'transformer.blocks.13.pwff.fc2.weight', 'transformer.blocks.13.pwff.fc2.bias', 'transformer.blocks.13.norm2.weight', 'transformer.blocks.13.norm2.bias', 'transformer.blocks.14.attn.proj_q.weight', 'transformer.blocks.14.attn.proj_q.bias', 'transformer.blocks.14.attn.proj_k.weight', 'transformer.blocks.14.attn.proj_k.bias', 'transformer.blocks.14.attn.proj_v.weight', 'transformer.blocks.14.attn.proj_v.bias', 'transformer.blocks.14.proj.weight', 'transformer.blocks.14.proj.bias', 'transformer.blocks.14.norm1.weight', 'transformer.blocks.14.norm1.bias', 'transformer.blocks.14.pwff.fc1.weight', 'transformer.blocks.14.pwff.fc1.bias', 'transformer.blocks.14.pwff.fc2.weight', 'transformer.blocks.14.pwff.fc2.bias', 'transformer.blocks.14.norm2.weight', 'transformer.blocks.14.norm2.bias', 'transformer.blocks.15.attn.proj_q.weight', 'transformer.blocks.15.attn.proj_q.bias', 'transformer.blocks.15.attn.proj_k.weight', 'transformer.blocks.15.attn.proj_k.bias', 'transformer.blocks.15.attn.proj_v.weight', 'transformer.blocks.15.attn.proj_v.bias', 'transformer.blocks.15.proj.weight', 'transformer.blocks.15.proj.bias', 'transformer.blocks.15.norm1.weight', 'transformer.blocks.15.norm1.bias', 'transformer.blocks.15.pwff.fc1.weight', 'transformer.blocks.15.pwff.fc1.bias', 'transformer.blocks.15.pwff.fc2.weight', 'transformer.blocks.15.pwff.fc2.bias', 'transformer.blocks.15.norm2.weight', 'transformer.blocks.15.norm2.bias', 'transformer.blocks.16.attn.proj_q.weight', 'transformer.blocks.16.attn.proj_q.bias', 'transformer.blocks.16.attn.proj_k.weight', 'transformer.blocks.16.attn.proj_k.bias', 'transformer.blocks.16.attn.proj_v.weight', 'transformer.blocks.16.attn.proj_v.bias', 'transformer.blocks.16.proj.weight', 'transformer.blocks.16.proj.bias', 'transformer.blocks.16.norm1.weight', 'transformer.blocks.16.norm1.bias', 'transformer.blocks.16.pwff.fc1.weight', 'transformer.blocks.16.pwff.fc1.bias', 'transformer.blocks.16.pwff.fc2.weight', 'transformer.blocks.16.pwff.fc2.bias', 'transformer.blocks.16.norm2.weight', 'transformer.blocks.16.norm2.bias', 'transformer.blocks.17.attn.proj_q.weight', 'transformer.blocks.17.attn.proj_q.bias', 'transformer.blocks.17.attn.proj_k.weight', 'transformer.blocks.17.attn.proj_k.bias', 'transformer.blocks.17.attn.proj_v.weight', 'transformer.blocks.17.attn.proj_v.bias', 'transformer.blocks.17.proj.weight', 'transformer.blocks.17.proj.bias', 'transformer.blocks.17.norm1.weight', 'transformer.blocks.17.norm1.bias', 'transformer.blocks.17.pwff.fc1.weight', 'transformer.blocks.17.pwff.fc1.bias', 'transformer.blocks.17.pwff.fc2.weight', 'transformer.blocks.17.pwff.fc2.bias', 'transformer.blocks.17.norm2.weight', 'transformer.blocks.17.norm2.bias', 'transformer.blocks.18.attn.proj_q.weight', 'transformer.blocks.18.attn.proj_q.bias', 'transformer.blocks.18.attn.proj_k.weight', 'transformer.blocks.18.attn.proj_k.bias', 'transformer.blocks.18.attn.proj_v.weight', 'transformer.blocks.18.attn.proj_v.bias', 'transformer.blocks.18.proj.weight', 'transformer.blocks.18.proj.bias', 'transformer.blocks.18.norm1.weight', 'transformer.blocks.18.norm1.bias', 'transformer.blocks.18.pwff.fc1.weight', 'transformer.blocks.18.pwff.fc1.bias', 'transformer.blocks.18.pwff.fc2.weight', 'transformer.blocks.18.pwff.fc2.bias', 'transformer.blocks.18.norm2.weight', 'transformer.blocks.18.norm2.bias', 'transformer.blocks.19.attn.proj_q.weight', 'transformer.blocks.19.attn.proj_q.bias', 'transformer.blocks.19.attn.proj_k.weight', 'transformer.blocks.19.attn.proj_k.bias', 'transformer.blocks.19.attn.proj_v.weight', 'transformer.blocks.19.attn.proj_v.bias', 'transformer.blocks.19.proj.weight', 'transformer.blocks.19.proj.bias', 'transformer.blocks.19.norm1.weight', 'transformer.blocks.19.norm1.bias', 'transformer.blocks.19.pwff.fc1.weight', 'transformer.blocks.19.pwff.fc1.bias', 'transformer.blocks.19.pwff.fc2.weight', 'transformer.blocks.19.pwff.fc2.bias', 'transformer.blocks.19.norm2.weight', 'transformer.blocks.19.norm2.bias', 'transformer.blocks.20.attn.proj_q.weight', 'transformer.blocks.20.attn.proj_q.bias', 'transformer.blocks.20.attn.proj_k.weight', 'transformer.blocks.20.attn.proj_k.bias', 'transformer.blocks.20.attn.proj_v.weight', 'transformer.blocks.20.attn.proj_v.bias', 'transformer.blocks.20.proj.weight', 'transformer.blocks.20.proj.bias', 'transformer.blocks.20.norm1.weight', 'transformer.blocks.20.norm1.bias', 'transformer.blocks.20.pwff.fc1.weight', 'transformer.blocks.20.pwff.fc1.bias', 'transformer.blocks.20.pwff.fc2.weight', 'transformer.blocks.20.pwff.fc2.bias', 'transformer.blocks.20.norm2.weight', 'transformer.blocks.20.norm2.bias', 'transformer.blocks.21.attn.proj_q.weight', 'transformer.blocks.21.attn.proj_q.bias', 'transformer.blocks.21.attn.proj_k.weight', 'transformer.blocks.21.attn.proj_k.bias', 'transformer.blocks.21.attn.proj_v.weight', 'transformer.blocks.21.attn.proj_v.bias', 'transformer.blocks.21.proj.weight', 'transformer.blocks.21.proj.bias', 'transformer.blocks.21.norm1.weight', 'transformer.blocks.21.norm1.bias', 'transformer.blocks.21.pwff.fc1.weight', 'transformer.blocks.21.pwff.fc1.bias', 'transformer.blocks.21.pwff.fc2.weight', 'transformer.blocks.21.pwff.fc2.bias', 'transformer.blocks.21.norm2.weight', 'transformer.blocks.21.norm2.bias', 'transformer.blocks.22.attn.proj_q.weight', 'transformer.blocks.22.attn.proj_q.bias', 'transformer.blocks.22.attn.proj_k.weight', 'transformer.blocks.22.attn.proj_k.bias', 'transformer.blocks.22.attn.proj_v.weight', 'transformer.blocks.22.attn.proj_v.bias', 'transformer.blocks.22.proj.weight', 'transformer.blocks.22.proj.bias', 'transformer.blocks.22.norm1.weight', 'transformer.blocks.22.norm1.bias', 'transformer.blocks.22.pwff.fc1.weight', 'transformer.blocks.22.pwff.fc1.bias', 'transformer.blocks.22.pwff.fc2.weight', 'transformer.blocks.22.pwff.fc2.bias', 'transformer.blocks.22.norm2.weight', 'transformer.blocks.22.norm2.bias', 'transformer.blocks.23.attn.proj_q.weight', 'transformer.blocks.23.attn.proj_q.bias', 'transformer.blocks.23.attn.proj_k.weight', 'transformer.blocks.23.attn.proj_k.bias', 'transformer.blocks.23.attn.proj_v.weight', 'transformer.blocks.23.attn.proj_v.bias', 'transformer.blocks.23.proj.weight', 'transformer.blocks.23.proj.bias', 'transformer.blocks.23.norm1.weight', 'transformer.blocks.23.norm1.bias', 'transformer.blocks.23.pwff.fc1.weight', 'transformer.blocks.23.pwff.fc1.bias', 'transformer.blocks.23.pwff.fc2.weight', 'transformer.blocks.23.pwff.fc2.bias', 'transformer.blocks.23.norm2.weight', 'transformer.blocks.23.norm2.bias', 'norm.weight', 'norm.bias'])
Thief model initialized successfully
specificity = 80/80
sensitivity = 0/42
Initial model on target dataset: acc = 0.2541, agreement = 0.2377, f1 = 0.1351, spec = 1.0000, sens = 0.0000
specificity = 197/197
sensitivity = 0/303
Initial model on validation dataset: acc = 0.1480, agreement = 0.1480, f1 = 0.0859, spec = 1.0000, sens = 0.0000
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:36<1:00:26, 36.63s/it]  2%|▏         | 2/100 [01:19<1:05:56, 40.37s/it]  3%|▎         | 3/100 [01:56<1:02:36, 38.72s/it]  4%|▍         | 4/100 [02:39<1:04:37, 40.39s/it]  5%|▌         | 5/100 [03:35<1:13:06, 46.18s/it]Epoch 5: Train acc/f1 = 0.8838 / 0.8327 / 0.8408 / 0.9677 
                Val acc/f1/spec/sens = 0.8160 / 0.7608 / 0.8426 / 0.9043
                Test acc/f1/spec/sens = 0.4836 / 0.4541 / 0.2750 / 0.9524
