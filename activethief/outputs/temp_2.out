[24/02/28 12:27:10] [conf.py:  298]: PyTorch Version: torch=2.2.1+cu121, cuda=12.1, cudnn=8902
[24/02/28 12:27:10] [conf.py:  300]: ACTIVE:
  ADDENDUM: 0
  ALPHA: 0.2
  AUGMENT: None
  BETA: 1.0
  BUDGET: 2000
  CUTMIX_PROB: 0.0
  CYCLES: 1
  INITIAL: 1800
  LA: False
  METHOD: random
  PRETRAINED_PATH: /home/deepankar/mnt/vision3_data_ckpts_msa_medical/ckpts/resnet50-imagenet1k.pth
  TEMP: 1.0
  TRO: 1.0
  USE_PRETRAINED: True
  VAL: 200
AM:
  SGR: 1000
  THRESHOLD: 0.5
CUDNN_BENCHMARK: True
DS_SEED: 123
EDM:
  HASH: /home/harsh_s/scratch/msacopy/exp/hash/alpha.pt
  NUM_MODELS: 5
  PATH1: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T0.pt
  PATH2: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T1.pt
  PATH3: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T2.pt
  PATH4: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T3.pt
  PATH5: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T4.pt
GR:
  EPSILON: 0.1
  SUR_PATH: /home/harsh_s/scratch/msacopy/GRAD2/batch_training/outputs/trained_models/imagenet_cifar10_to_cifar10_surrogate_10epochs.pt
LOG_DEST: radformer_resnet50_gbusv_240228_122710.txt
LOG_TIME: 240228_122710
METHOD_NAME: v3
OUT_DIR: /home/deepankar/scratch/MSA_Medical/results_1k
PL:
  CLASS_BLNC: 10
  ITERATIONS: 20
  KAPPA_N: 0.005
  KAPPA_P: 0.05
  NO_PROGRESS: False
  NO_UNCERTAINTY: False
  TAU_N: 0.05
  TAU_P: 0.7
  TEMP_NL: 2.0
RNG_SEED: 6
SAVE_DIR: /home/deepankar/scratch/MSA_Medical/results_1k/gbusg_radformer/GBUSV_resnet50/SGD/2000_val200/random_v3
THIEF:
  ARCH: resnet50
  DATASET: GBUSV
  DATA_ROOT: /home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBUSV-Shared
  HARD_LABELS: True
  NUM_TRAIN: 1281167
  SUBSET: 128116
TRAIN:
  BATCH: 16
  EPOCH: 100
  GAMMA: 0.1
  LR: 0.005
  MILESTONES: [20, 40, 60, 80]
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  WDECAY: 0.0005
VICTIM:
  ARCH: radformer
  DATASET: gbusg
  DATA_ROOT: /home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBCU-Shared
  HEIGHT: 224
  PATH: /home/deepankar/mnt/vision3_data_ckpts_msa_medical/victim_models/radformer/radformer.pkl
  PATHIN: /home/harsh_s/scratch/msacopy/ckpts/cifar10-resnet32-inaccurate/checkpoint.pth.tar
  WIDTH: 224
Loaded target dataset of size 122 with 3 classes
target model keys:  695
checkpoint keys:  695
specificity = 72/80
sensitivity = 39/42

Target model acc = 0.9016393442622951
Val-Acc: 0.9016 Val-Spec: 0.9000 Val-Sens: 0.9286
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:00<01:12,  1.54it/s]  2%|▏         | 2/113 [00:00<00:47,  2.34it/s]  3%|▎         | 3/113 [00:01<00:38,  2.87it/s]  4%|▎         | 4/113 [00:01<00:34,  3.14it/s]  4%|▍         | 5/113 [00:01<00:31,  3.40it/s]  5%|▌         | 6/113 [00:01<00:29,  3.59it/s]  6%|▌         | 7/113 [00:02<00:28,  3.72it/s]  7%|▋         | 8/113 [00:02<00:27,  3.78it/s]  8%|▊         | 9/113 [00:02<00:27,  3.77it/s]  9%|▉         | 10/113 [00:02<00:27,  3.80it/s] 10%|▉         | 11/113 [00:03<00:26,  3.85it/s] 11%|█         | 12/113 [00:03<00:25,  3.89it/s] 12%|█▏        | 13/113 [00:03<00:25,  3.90it/s] 12%|█▏        | 14/113 [00:03<00:25,  3.92it/s] 13%|█▎        | 15/113 [00:04<00:25,  3.88it/s] 14%|█▍        | 16/113 [00:04<00:24,  3.89it/s] 15%|█▌        | 17/113 [00:04<00:24,  3.88it/s] 16%|█▌        | 18/113 [00:05<00:24,  3.84it/s] 17%|█▋        | 19/113 [00:05<00:24,  3.88it/s] 18%|█▊        | 20/113 [00:05<00:23,  3.90it/s] 19%|█▊        | 21/113 [00:05<00:23,  3.93it/s] 19%|█▉        | 22/113 [00:06<00:23,  3.93it/s] 20%|██        | 23/113 [00:06<00:22,  3.92it/s] 21%|██        | 24/113 [00:06<00:22,  3.95it/s] 22%|██▏       | 25/113 [00:06<00:22,  3.97it/s] 23%|██▎       | 26/113 [00:07<00:22,  3.92it/s] 24%|██▍       | 27/113 [00:07<00:21,  3.93it/s] 25%|██▍       | 28/113 [00:07<00:21,  3.87it/s] 26%|██▌       | 29/113 [00:07<00:21,  3.90it/s] 27%|██▋       | 30/113 [00:08<00:21,  3.88it/s] 27%|██▋       | 31/113 [00:08<00:21,  3.89it/s] 28%|██▊       | 32/113 [00:08<00:20,  3.88it/s] 29%|██▉       | 33/113 [00:08<00:20,  3.88it/s] 30%|███       | 34/113 [00:09<00:20,  3.89it/s] 31%|███       | 35/113 [00:09<00:19,  3.91it/s] 32%|███▏      | 36/113 [00:09<00:19,  3.88it/s] 33%|███▎      | 37/113 [00:09<00:19,  3.93it/s] 34%|███▎      | 38/113 [00:10<00:18,  3.96it/s] 35%|███▍      | 39/113 [00:10<00:18,  3.97it/s] 35%|███▌      | 40/113 [00:10<00:18,  3.97it/s] 36%|███▋      | 41/113 [00:10<00:18,  3.92it/s] 37%|███▋      | 42/113 [00:11<00:18,  3.92it/s] 38%|███▊      | 43/113 [00:11<00:17,  3.94it/s] 39%|███▉      | 44/113 [00:11<00:17,  3.89it/s] 40%|███▉      | 45/113 [00:11<00:17,  3.90it/s] 41%|████      | 46/113 [00:12<00:17,  3.87it/s] 42%|████▏     | 47/113 [00:12<00:16,  3.89it/s] 42%|████▏     | 48/113 [00:12<00:16,  3.93it/s] 43%|████▎     | 49/113 [00:12<00:16,  3.97it/s] 44%|████▍     | 50/113 [00:13<00:15,  3.98it/s] 45%|████▌     | 51/113 [00:13<00:15,  3.94it/s] 46%|████▌     | 52/113 [00:13<00:15,  3.92it/s] 47%|████▋     | 53/113 [00:13<00:15,  3.94it/s] 48%|████▊     | 54/113 [00:14<00:14,  3.97it/s] 49%|████▊     | 55/113 [00:14<00:14,  3.90it/s] 50%|████▉     | 56/113 [00:14<00:14,  3.94it/s] 50%|█████     | 57/113 [00:14<00:14,  3.96it/s] 51%|█████▏    | 58/113 [00:15<00:13,  3.99it/s] 52%|█████▏    | 59/113 [00:15<00:13,  3.97it/s] 53%|█████▎    | 60/113 [00:15<00:13,  3.87it/s] 54%|█████▍    | 61/113 [00:15<00:13,  3.88it/s] 55%|█████▍    | 62/113 [00:16<00:13,  3.89it/s] 56%|█████▌    | 63/113 [00:16<00:12,  3.92it/s] 57%|█████▋    | 64/113 [00:16<00:12,  3.92it/s] 58%|█████▊    | 65/113 [00:17<00:12,  3.93it/s] 58%|█████▊    | 66/113 [00:17<00:11,  3.97it/s] 59%|█████▉    | 67/113 [00:17<00:11,  3.93it/s] 60%|██████    | 68/113 [00:17<00:11,  3.97it/s] 61%|██████    | 69/113 [00:18<00:11,  3.99it/s] 62%|██████▏   | 70/113 [00:18<00:10,  4.00it/s] 63%|██████▎   | 71/113 [00:18<00:10,  4.03it/s] 64%|██████▎   | 72/113 [00:18<00:10,  4.02it/s] 65%|██████▍   | 73/113 [00:18<00:09,  4.05it/s] 65%|██████▌   | 74/113 [00:19<00:09,  4.04it/s] 66%|██████▋   | 75/113 [00:19<00:09,  4.00it/s] 67%|██████▋   | 76/113 [00:19<00:09,  4.02it/s] 68%|██████▊   | 77/113 [00:19<00:09,  3.99it/s] 69%|██████▉   | 78/113 [00:20<00:08,  3.97it/s] 70%|██████▉   | 79/113 [00:20<00:08,  4.02it/s] 71%|███████   | 80/113 [00:20<00:08,  4.00it/s] 72%|███████▏  | 81/113 [00:20<00:08,  3.99it/s] 73%|███████▎  | 82/113 [00:21<00:07,  3.94it/s] 73%|███████▎  | 83/113 [00:21<00:07,  3.96it/s] 74%|███████▍  | 84/113 [00:21<00:07,  3.96it/s] 75%|███████▌  | 85/113 [00:22<00:07,  3.94it/s] 76%|███████▌  | 86/113 [00:22<00:06,  3.94it/s] 77%|███████▋  | 87/113 [00:22<00:06,  3.92it/s] 78%|███████▊  | 88/113 [00:22<00:06,  3.86it/s] 79%|███████▉  | 89/113 [00:23<00:06,  3.88it/s] 80%|███████▉  | 90/113 [00:23<00:05,  3.86it/s] 81%|████████  | 91/113 [00:23<00:05,  3.86it/s] 81%|████████▏ | 92/113 [00:23<00:05,  3.85it/s] 82%|████████▏ | 93/113 [00:24<00:05,  3.86it/s] 83%|████████▎ | 94/113 [00:24<00:04,  3.89it/s] 84%|████████▍ | 95/113 [00:24<00:04,  3.91it/s] 85%|████████▍ | 96/113 [00:24<00:04,  3.94it/s] 86%|████████▌ | 97/113 [00:25<00:04,  3.93it/s] 87%|████████▋ | 98/113 [00:25<00:03,  3.95it/s] 88%|████████▊ | 99/113 [00:25<00:03,  3.90it/s] 88%|████████▊ | 100/113 [00:25<00:03,  3.82it/s] 89%|████████▉ | 101/113 [00:26<00:03,  3.84it/s] 90%|█████████ | 102/113 [00:26<00:02,  3.87it/s] 91%|█████████ | 103/113 [00:26<00:02,  3.87it/s] 92%|█████████▏| 104/113 [00:26<00:02,  3.86it/s] 93%|█████████▎| 105/113 [00:27<00:02,  3.91it/s] 94%|█████████▍| 106/113 [00:27<00:01,  3.94it/s] 95%|█████████▍| 107/113 [00:27<00:01,  3.99it/s] 96%|█████████▌| 108/113 [00:27<00:01,  3.95it/s] 96%|█████████▋| 109/113 [00:28<00:01,  3.95it/s] 97%|█████████▋| 110/113 [00:28<00:00,  3.97it/s] 98%|█████████▊| 111/113 [00:28<00:00,  3.93it/s] 99%|█████████▉| 112/113 [00:28<00:00,  3.93it/s]100%|██████████| 113/113 [00:29<00:00,  3.66it/s]100%|██████████| 113/113 [00:29<00:00,  3.86it/s]
replacing val labels with victim labels
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:05,  2.10it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.93it/s] 23%|██▎       | 3/13 [00:00<00:03,  3.26it/s] 31%|███       | 4/13 [00:01<00:02,  3.45it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.64it/s] 46%|████▌     | 6/13 [00:01<00:01,  3.76it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.79it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.87it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.88it/s] 77%|███████▋  | 10/13 [00:02<00:00,  3.89it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.90it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.84it/s]100%|██████████| 13/13 [00:03<00:00,  4.45it/s]100%|██████████| 13/13 [00:03<00:00,  3.74it/s]Validation set distribution: 
Number of samples  200

{0: 28, 1: 39, 2: 133}
Labeled set distribution: 
Number of samples  1800
{0: 234, 1: 417, 2: 1149}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked', 'fc.weight', 'fc.bias'])
thief state:  None
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
specificity = 74/80
sensitivity = 7/42
Initial model on target dataset: acc = 0.3197, agreement = 0.2951, f1 = 0.3013, spec = 0.9250, sens = 0.1667
specificity = 29/67
sensitivity = 115/133
Initial model on validation dataset: acc = 0.6350, agreement = 0.6350, f1 = 0.3919, spec = 0.4328, sens = 0.8647
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<12:07,  7.35s/it]  2%|▏         | 2/100 [00:15<12:37,  7.73s/it]  3%|▎         | 3/100 [00:22<12:07,  7.50s/it]  4%|▍         | 4/100 [00:30<12:21,  7.73s/it]  5%|▌         | 5/100 [00:44<15:33,  9.83s/it]Epoch 5: Train acc/f1 = 0.8694 / 0.8291 / 0.8648 / 0.9252 
                Val acc/f1/spec/sens = 0.8100 / 0.7483 / 0.7015 / 0.9098
                Test acc/f1/spec/sens = 0.5984 / 0.6020 / 0.8625 / 0.4048
  6%|▌         | 6/100 [00:52<14:21,  9.17s/it]  7%|▋         | 7/100 [00:59<13:13,  8.53s/it]  8%|▊         | 8/100 [01:07<12:46,  8.34s/it]  9%|▉         | 9/100 [01:14<12:07,  8.00s/it] 10%|█         | 10/100 [01:28<14:34,  9.72s/it]Epoch 10: Train acc/f1 = 0.9333 / 0.9136 / 0.9324 / 0.9539 
                Val acc/f1/spec/sens = 0.8050 / 0.7424 / 0.7910 / 0.8797
                Test acc/f1/spec/sens = 0.6721 / 0.6855 / 0.8750 / 0.5238
 11%|█         | 11/100 [01:35<13:18,  8.97s/it] 12%|█▏        | 12/100 [01:43<12:46,  8.71s/it] 13%|█▎        | 13/100 [01:50<11:59,  8.27s/it] 14%|█▍        | 14/100 [01:58<11:44,  8.19s/it] 15%|█▌        | 15/100 [02:12<13:52,  9.79s/it]Epoch 15: Train acc/f1 = 0.9606 / 0.9484 / 0.9555 / 0.9782 
                Val acc/f1/spec/sens = 0.7600 / 0.6920 / 0.8657 / 0.7970
                Test acc/f1/spec/sens = 0.6721 / 0.6791 / 0.8250 / 0.6429
 16%|█▌        | 16/100 [02:20<12:55,  9.23s/it] 17%|█▋        | 17/100 [02:27<11:56,  8.63s/it] 18%|█▊        | 18/100 [02:35<11:35,  8.48s/it] 19%|█▉        | 19/100 [02:42<10:55,  8.10s/it] 20%|██        | 20/100 [02:56<13:08,  9.86s/it]Epoch 20: Train acc/f1 = 0.9761 / 0.9669 / 0.9754 / 0.9896 
                Val acc/f1/spec/sens = 0.8350 / 0.7758 / 0.8358 / 0.8872
                Test acc/f1/spec/sens = 0.6557 / 0.6604 / 0.8625 / 0.5952
 21%|██        | 21/100 [03:03<11:58,  9.09s/it] 22%|██▏       | 22/100 [03:12<11:27,  8.81s/it] 23%|██▎       | 23/100 [03:19<10:42,  8.34s/it] 24%|██▍       | 24/100 [03:27<10:24,  8.22s/it] 25%|██▌       | 25/100 [03:40<12:01,  9.63s/it]Epoch 25: Train acc/f1 = 0.9889 / 0.9853 / 0.9892 / 0.9930 
                Val acc/f1/spec/sens = 0.8300 / 0.7715 / 0.7910 / 0.8947
                Test acc/f1/spec/sens = 0.6557 / 0.6662 / 0.8000 / 0.6190
 26%|██▌       | 26/100 [03:48<11:13,  9.10s/it] 27%|██▋       | 27/100 [03:55<10:22,  8.53s/it] 28%|██▊       | 28/100 [04:03<10:02,  8.36s/it] 29%|██▉       | 29/100 [04:10<09:30,  8.03s/it] 30%|███       | 30/100 [04:23<11:15,  9.65s/it]Epoch 30: Train acc/f1 = 0.9917 / 0.9895 / 0.9908 / 0.9948 
                Val acc/f1/spec/sens = 0.8250 / 0.7678 / 0.7910 / 0.8872
                Test acc/f1/spec/sens = 0.6557 / 0.6650 / 0.8250 / 0.6190
 31%|███       | 31/100 [04:31<10:16,  8.93s/it] 32%|███▏      | 32/100 [04:39<09:47,  8.63s/it] 33%|███▎      | 33/100 [04:46<09:11,  8.23s/it] 34%|███▍      | 34/100 [04:54<08:56,  8.13s/it] 35%|███▌      | 35/100 [05:07<10:26,  9.63s/it]Epoch 35: Train acc/f1 = 0.9939 / 0.9928 / 0.9923 / 0.9956 
                Val acc/f1/spec/sens = 0.8300 / 0.7739 / 0.8358 / 0.8797
                Test acc/f1/spec/sens = 0.6803 / 0.6908 / 0.8750 / 0.5714
 36%|███▌      | 36/100 [05:15<09:44,  9.13s/it] 37%|███▋      | 37/100 [05:22<08:59,  8.57s/it] 38%|███▊      | 38/100 [05:30<08:39,  8.38s/it] 39%|███▉      | 39/100 [05:37<08:10,  8.04s/it] 40%|████      | 40/100 [05:52<09:55,  9.93s/it]Epoch 40: Train acc/f1 = 0.9978 / 0.9969 / 0.9985 / 0.9974 
                Val acc/f1/spec/sens = 0.8250 / 0.7645 / 0.8060 / 0.8872
                Test acc/f1/spec/sens = 0.6475 / 0.6575 / 0.8375 / 0.5476
 41%|████      | 41/100 [05:59<09:01,  9.18s/it] 42%|████▏     | 42/100 [06:07<08:31,  8.82s/it] 43%|████▎     | 43/100 [06:14<07:56,  8.36s/it] 44%|████▍     | 44/100 [06:22<07:40,  8.23s/it] 45%|████▌     | 45/100 [06:36<09:00,  9.82s/it]Epoch 45: Train acc/f1 = 0.9944 / 0.9931 / 0.9969 / 0.9939 
                Val acc/f1/spec/sens = 0.8250 / 0.7645 / 0.8060 / 0.8872
                Test acc/f1/spec/sens = 0.6475 / 0.6610 / 0.8000 / 0.5952
 46%|████▌     | 46/100 [06:44<08:20,  9.27s/it] 47%|████▋     | 47/100 [06:51<07:39,  8.67s/it] 48%|████▊     | 48/100 [06:59<07:19,  8.46s/it] 49%|████▉     | 49/100 [07:06<06:52,  8.09s/it] 50%|█████     | 50/100 [07:21<08:17,  9.95s/it]Epoch 50: Train acc/f1 = 0.9950 / 0.9928 / 0.9985 / 0.9948 
                Val acc/f1/spec/sens = 0.8150 / 0.7564 / 0.8060 / 0.8722
                Test acc/f1/spec/sens = 0.6721 / 0.6828 / 0.8750 / 0.5476
 51%|█████     | 51/100 [07:28<07:29,  9.17s/it] 52%|█████▏    | 52/100 [07:36<07:02,  8.80s/it] 53%|█████▎    | 53/100 [07:43<06:31,  8.34s/it] 54%|█████▍    | 54/100 [07:51<06:17,  8.22s/it] 55%|█████▌    | 55/100 [08:05<07:23,  9.86s/it]Epoch 55: Train acc/f1 = 0.9961 / 0.9939 / 0.9969 / 0.9991 
                Val acc/f1/spec/sens = 0.8200 / 0.7575 / 0.7910 / 0.8872
                Test acc/f1/spec/sens = 0.6557 / 0.6643 / 0.8500 / 0.5476
 56%|█████▌    | 56/100 [08:13<06:48,  9.29s/it] 57%|█████▋    | 57/100 [08:20<06:13,  8.68s/it] 58%|█████▊    | 58/100 [08:28<05:55,  8.46s/it] 59%|█████▉    | 59/100 [08:35<05:31,  8.09s/it] 60%|██████    | 60/100 [08:50<06:42, 10.06s/it]Epoch 60: Train acc/f1 = 0.9967 / 0.9950 / 0.9969 / 0.9983 
                Val acc/f1/spec/sens = 0.8200 / 0.7575 / 0.7910 / 0.8872
                Test acc/f1/spec/sens = 0.6639 / 0.6742 / 0.8375 / 0.5714
 61%|██████    | 61/100 [08:57<05:59,  9.23s/it] 62%|██████▏   | 62/100 [09:05<05:36,  8.85s/it] 63%|██████▎   | 63/100 [09:12<05:09,  8.36s/it] 64%|██████▍   | 64/100 [09:20<04:55,  8.22s/it] 65%|██████▌   | 65/100 [09:33<05:39,  9.70s/it]Epoch 65: Train acc/f1 = 0.9978 / 0.9978 / 1.0000 / 0.9965 
                Val acc/f1/spec/sens = 0.8250 / 0.7673 / 0.8209 / 0.8797
                Test acc/f1/spec/sens = 0.6393 / 0.6515 / 0.8125 / 0.5714
 66%|██████▌   | 66/100 [09:41<05:11,  9.16s/it] 67%|██████▋   | 67/100 [09:49<04:43,  8.60s/it] 68%|██████▊   | 68/100 [09:57<04:29,  8.42s/it] 69%|██████▉   | 69/100 [10:04<04:09,  8.06s/it] 70%|███████   | 70/100 [10:18<04:53,  9.79s/it]Epoch 70: Train acc/f1 = 0.9961 / 0.9953 / 0.9954 / 0.9974 
                Val acc/f1/spec/sens = 0.8250 / 0.7645 / 0.8060 / 0.8872
                Test acc/f1/spec/sens = 0.6557 / 0.6654 / 0.8375 / 0.5714
 71%|███████   | 71/100 [10:25<04:22,  9.04s/it] 72%|███████▏  | 72/100 [10:33<04:04,  8.72s/it] 73%|███████▎  | 73/100 [10:40<03:43,  8.27s/it] 74%|███████▍  | 74/100 [10:48<03:32,  8.18s/it] 75%|███████▌  | 75/100 [11:01<04:03,  9.74s/it]Epoch 75: Train acc/f1 = 0.9967 / 0.9958 / 0.9969 / 0.9965 
                Val acc/f1/spec/sens = 0.8250 / 0.7645 / 0.8060 / 0.8872
                Test acc/f1/spec/sens = 0.6475 / 0.6575 / 0.8250 / 0.5714
 76%|███████▌  | 76/100 [11:09<03:40,  9.20s/it] 77%|███████▋  | 77/100 [11:17<03:18,  8.62s/it] 78%|███████▊  | 78/100 [11:25<03:05,  8.43s/it] 79%|███████▉  | 79/100 [11:32<02:49,  8.08s/it] 80%|████████  | 80/100 [11:46<03:16,  9.83s/it]Epoch 80: Train acc/f1 = 0.9950 / 0.9928 / 0.9923 / 0.9991 
                Val acc/f1/spec/sens = 0.8250 / 0.7645 / 0.8060 / 0.8872
                Test acc/f1/spec/sens = 0.6475 / 0.6592 / 0.8125 / 0.5952
 81%|████████  | 81/100 [11:53<02:52,  9.06s/it] 82%|████████▏ | 82/100 [12:01<02:36,  8.72s/it] 83%|████████▎ | 83/100 [12:08<02:20,  8.29s/it] 84%|████████▍ | 84/100 [12:16<02:11,  8.19s/it] 85%|████████▌ | 85/100 [12:29<02:24,  9.63s/it]Epoch 85: Train acc/f1 = 0.9961 / 0.9950 / 0.9969 / 0.9965 
                Val acc/f1/spec/sens = 0.8150 / 0.7491 / 0.7761 / 0.8872
                Test acc/f1/spec/sens = 0.6393 / 0.6516 / 0.7875 / 0.5952
 86%|████████▌ | 86/100 [12:37<02:07,  9.12s/it] 87%|████████▋ | 87/100 [12:44<01:51,  8.58s/it] 88%|████████▊ | 88/100 [12:52<01:40,  8.40s/it] 89%|████████▉ | 89/100 [13:00<01:28,  8.06s/it] 90%|█████████ | 90/100 [13:14<01:38,  9.83s/it]Epoch 90: Train acc/f1 = 0.9956 / 0.9944 / 0.9923 / 0.9974 
                Val acc/f1/spec/sens = 0.8250 / 0.7645 / 0.8060 / 0.8872
                Test acc/f1/spec/sens = 0.6967 / 0.7075 / 0.8750 / 0.5714
 91%|█████████ | 91/100 [13:21<01:21,  9.07s/it] 92%|█████████▏| 92/100 [13:29<01:10,  8.76s/it] 93%|█████████▎| 93/100 [13:36<00:58,  8.31s/it] 94%|█████████▍| 94/100 [13:44<00:49,  8.20s/it] 95%|█████████▌| 95/100 [13:57<00:48,  9.71s/it]Epoch 95: Train acc/f1 = 0.9961 / 0.9947 / 0.9954 / 0.9983 
                Val acc/f1/spec/sens = 0.8250 / 0.7645 / 0.8060 / 0.8872
                Test acc/f1/spec/sens = 0.6311 / 0.6421 / 0.8125 / 0.5714
 96%|█████████▌| 96/100 [14:05<00:36,  9.19s/it] 97%|█████████▋| 97/100 [14:13<00:25,  8.61s/it] 98%|█████████▊| 98/100 [14:21<00:16,  8.40s/it] 99%|█████████▉| 99/100 [14:28<00:08,  8.05s/it]100%|██████████| 100/100 [14:42<00:00,  9.78s/it]                                                 Epoch 100: Train acc/f1 = 0.9956 / 0.9933 / 0.9985 / 0.9965 
                Val acc/f1/spec/sens = 0.8250 / 0.7645 / 0.8060 / 0.8872
                Test acc/f1/spec/sens = 0.6639 / 0.6718 / 0.8500 / 0.5714
specificity = 650/651
sensitivity = 1146/1149
specificity = 54/67
sensitivity = 118/133
specificity = 68/80
sensitivity = 24/42
Trial 1, Cycle 1
Train acc/f1/spec/sens = 0.9972 / 0.9958 / 0.9985 / 0.9974
Val acc/f1/spec/sens = 0.8250 / 0.7645 / 0.8060 / 0.8872
Test acc/f1/spec/sens = 0.6639 / 0.6718 / 0.8500 / 0.5714
>> Finished.
specificity = 68/80
sensitivity = 24/42
Acc, agreement for latest model:  0.6639344262295082 0.6475409836065574
Load best checkpoint for thief model
specificity = 66/80
sensitivity = 25/42
Acc, agreement for best model:  0.6721311475409836 0.6639344262295082
Trial 0/6 || Cycle 1/1 || Label set size 1800 || Test acc 0.6721 || Test agreement 0.6639 || Spec 0.8250 || Sens 0.5952
**************************************************************************************************** 

specificity = 66/80
sensitivity = 25/42
Number of samples  1800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:00<01:07,  1.65it/s]  2%|▏         | 2/113 [00:00<00:45,  2.42it/s]  3%|▎         | 3/113 [00:01<00:38,  2.88it/s]  4%|▎         | 4/113 [00:01<00:34,  3.17it/s]  4%|▍         | 5/113 [00:01<00:31,  3.39it/s]  5%|▌         | 6/113 [00:01<00:29,  3.59it/s]  6%|▌         | 7/113 [00:02<00:29,  3.63it/s]  7%|▋         | 8/113 [00:02<00:28,  3.72it/s]  8%|▊         | 9/113 [00:02<00:27,  3.75it/s]  9%|▉         | 10/113 [00:02<00:27,  3.80it/s] 10%|▉         | 11/113 [00:03<00:26,  3.81it/s] 11%|█         | 12/113 [00:03<00:26,  3.82it/s] 12%|█▏        | 13/113 [00:03<00:26,  3.83it/s] 12%|█▏        | 14/113 [00:04<00:25,  3.84it/s] 13%|█▎        | 15/113 [00:04<00:25,  3.89it/s] 14%|█▍        | 16/113 [00:04<00:25,  3.88it/s] 15%|█▌        | 17/113 [00:04<00:24,  3.90it/s] 16%|█▌        | 18/113 [00:05<00:24,  3.92it/s] 17%|█▋        | 19/113 [00:05<00:24,  3.88it/s] 18%|█▊        | 20/113 [00:05<00:23,  3.92it/s] 19%|█▊        | 21/113 [00:05<00:23,  3.90it/s] 19%|█▉        | 22/113 [00:06<00:23,  3.94it/s] 20%|██        | 23/113 [00:06<00:22,  3.94it/s] 21%|██        | 24/113 [00:06<00:22,  3.94it/s] 22%|██▏       | 25/113 [00:06<00:22,  3.90it/s] 23%|██▎       | 26/113 [00:07<00:22,  3.89it/s] 24%|██▍       | 27/113 [00:07<00:22,  3.90it/s] 25%|██▍       | 28/113 [00:07<00:22,  3.86it/s] 26%|██▌       | 29/113 [00:07<00:21,  3.90it/s] 27%|██▋       | 30/113 [00:08<00:21,  3.93it/s] 27%|██▋       | 31/113 [00:08<00:20,  3.94it/s] 28%|██▊       | 32/113 [00:08<00:20,  4.00it/s] 29%|██▉       | 33/113 [00:08<00:20,  4.00it/s] 30%|███       | 34/113 [00:09<00:19,  3.96it/s] 31%|███       | 35/113 [00:09<00:19,  3.97it/s] 32%|███▏      | 36/113 [00:09<00:19,  3.98it/s] 33%|███▎      | 37/113 [00:09<00:19,  3.95it/s] 34%|███▎      | 38/113 [00:10<00:19,  3.89it/s] 35%|███▍      | 39/113 [00:10<00:18,  3.91it/s] 35%|███▌      | 40/113 [00:10<00:18,  3.94it/s] 36%|███▋      | 41/113 [00:10<00:18,  3.83it/s] 37%|███▋      | 42/113 [00:11<00:18,  3.87it/s] 38%|███▊      | 43/113 [00:11<00:18,  3.85it/s] 39%|███▉      | 44/113 [00:11<00:18,  3.83it/s] 40%|███▉      | 45/113 [00:11<00:17,  3.84it/s] 41%|████      | 46/113 [00:12<00:17,  3.89it/s] 42%|████▏     | 47/113 [00:12<00:16,  3.90it/s] 42%|████▏     | 48/113 [00:12<00:16,  3.91it/s] 43%|████▎     | 49/113 [00:12<00:16,  3.90it/s] 44%|████▍     | 50/113 [00:13<00:16,  3.94it/s] 45%|████▌     | 51/113 [00:13<00:15,  3.94it/s] 46%|████▌     | 52/113 [00:13<00:15,  3.93it/s] 47%|████▋     | 53/113 [00:13<00:15,  3.97it/s] 48%|████▊     | 54/113 [00:14<00:14,  3.97it/s] 49%|████▊     | 55/113 [00:14<00:14,  3.94it/s] 50%|████▉     | 56/113 [00:14<00:14,  3.90it/s] 50%|█████     | 57/113 [00:14<00:14,  3.97it/s] 51%|█████▏    | 58/113 [00:15<00:13,  3.94it/s] 52%|█████▏    | 59/113 [00:15<00:13,  3.97it/s] 53%|█████▎    | 60/113 [00:15<00:13,  3.93it/s] 54%|█████▍    | 61/113 [00:15<00:13,  3.92it/s] 55%|█████▍    | 62/113 [00:16<00:13,  3.91it/s] 56%|█████▌    | 63/113 [00:16<00:12,  3.94it/s] 57%|█████▋    | 64/113 [00:16<00:12,  3.94it/s] 58%|█████▊    | 65/113 [00:17<00:12,  3.92it/s] 58%|█████▊    | 66/113 [00:17<00:11,  3.95it/s] 59%|█████▉    | 67/113 [00:17<00:11,  4.00it/s] 60%|██████    | 68/113 [00:17<00:11,  4.02it/s] 61%|██████    | 69/113 [00:17<00:10,  4.02it/s] 62%|██████▏   | 70/113 [00:18<00:10,  4.00it/s] 63%|██████▎   | 71/113 [00:18<00:10,  3.99it/s] 64%|██████▎   | 72/113 [00:18<00:10,  3.99it/s] 65%|██████▍   | 73/113 [00:19<00:10,  3.98it/s] 65%|██████▌   | 74/113 [00:19<00:09,  3.94it/s] 66%|██████▋   | 75/113 [00:19<00:09,  3.97it/s] 67%|██████▋   | 76/113 [00:19<00:09,  3.95it/s] 68%|██████▊   | 77/113 [00:20<00:09,  3.94it/s] 69%|██████▉   | 78/113 [00:20<00:08,  3.90it/s] 70%|██████▉   | 79/113 [00:20<00:08,  3.94it/s] 71%|███████   | 80/113 [00:20<00:08,  3.94it/s] 72%|███████▏  | 81/113 [00:21<00:08,  3.99it/s] 73%|███████▎  | 82/113 [00:21<00:07,  3.99it/s] 73%|███████▎  | 83/113 [00:21<00:07,  3.97it/s] 74%|███████▍  | 84/113 [00:21<00:07,  3.96it/s] 75%|███████▌  | 85/113 [00:22<00:06,  4.00it/s] 76%|███████▌  | 86/113 [00:22<00:06,  3.96it/s] 77%|███████▋  | 87/113 [00:22<00:06,  3.97it/s] 78%|███████▊  | 88/113 [00:22<00:06,  3.94it/s] 79%|███████▉  | 89/113 [00:23<00:06,  3.91it/s] 80%|███████▉  | 90/113 [00:23<00:05,  3.93it/s] 81%|████████  | 91/113 [00:23<00:05,  3.93it/s] 81%|████████▏ | 92/113 [00:23<00:05,  3.89it/s] 82%|████████▏ | 93/113 [00:24<00:05,  3.92it/s] 83%|████████▎ | 94/113 [00:24<00:04,  3.90it/s] 84%|████████▍ | 95/113 [00:24<00:04,  3.87it/s] 85%|████████▍ | 96/113 [00:24<00:04,  3.90it/s] 86%|████████▌ | 97/113 [00:25<00:04,  3.91it/s] 87%|████████▋ | 98/113 [00:25<00:03,  3.91it/s] 88%|████████▊ | 99/113 [00:25<00:03,  3.92it/s] 88%|████████▊ | 100/113 [00:25<00:03,  3.89it/s] 89%|████████▉ | 101/113 [00:26<00:03,  3.86it/s] 90%|█████████ | 102/113 [00:26<00:02,  3.86it/s] 91%|█████████ | 103/113 [00:26<00:02,  3.85it/s] 92%|█████████▏| 104/113 [00:26<00:02,  3.86it/s] 93%|█████████▎| 105/113 [00:27<00:02,  3.92it/s] 94%|█████████▍| 106/113 [00:27<00:01,  3.90it/s] 95%|█████████▍| 107/113 [00:27<00:01,  3.90it/s] 96%|█████████▌| 108/113 [00:27<00:01,  3.90it/s] 96%|█████████▋| 109/113 [00:28<00:01,  3.89it/s] 97%|█████████▋| 110/113 [00:28<00:00,  3.81it/s] 98%|█████████▊| 111/113 [00:28<00:00,  3.90it/s] 99%|█████████▉| 112/113 [00:28<00:00,  3.89it/s]100%|██████████| 113/113 [00:29<00:00,  4.55it/s]100%|██████████| 113/113 [00:29<00:00,  3.87it/s]
replacing val labels with victim labels
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:07,  1.60it/s] 15%|█▌        | 2/13 [00:00<00:04,  2.43it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.91it/s] 31%|███       | 4/13 [00:01<00:02,  3.20it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.37it/s] 46%|████▌     | 6/13 [00:01<00:02,  3.48it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.61it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.71it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.75it/s] 77%|███████▋  | 10/13 [00:02<00:00,  3.81it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.88it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.88it/s]100%|██████████| 13/13 [00:03<00:00,  4.58it/s]100%|██████████| 13/13 [00:03<00:00,  3.54it/s]Validation set distribution: 
Number of samples  200

{0: 28, 1: 50, 2: 122}
Labeled set distribution: 
Number of samples  1800
{0: 222, 1: 449, 2: 1129}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked', 'fc.weight', 'fc.bias'])
thief state:  None
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
specificity = 5/80
sensitivity = 39/42
Initial model on target dataset: acc = 0.3525, agreement = 0.3852, f1 = 0.2350, spec = 0.0625, sens = 0.9286
specificity = 16/78
sensitivity = 111/122
Initial model on validation dataset: acc = 0.6150, agreement = 0.6150, f1 = 0.3721, spec = 0.2051, sens = 0.9098
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<11:59,  7.26s/it]  2%|▏         | 2/100 [00:15<12:39,  7.75s/it]  3%|▎         | 3/100 [00:22<12:08,  7.51s/it]  4%|▍         | 4/100 [00:30<12:20,  7.72s/it]  5%|▌         | 5/100 [00:44<15:31,  9.80s/it]Epoch 5: Train acc/f1 = 0.8883 / 0.8631 / 0.8227 / 0.9557 
                Val acc/f1/spec/sens = 0.8100 / 0.7758 / 0.9744 / 0.8033
                Test acc/f1/spec/sens = 0.7213 / 0.7211 / 0.7875 / 0.8810
  6%|▌         | 6/100 [00:52<14:31,  9.28s/it]  7%|▋         | 7/100 [00:59<13:21,  8.62s/it]  8%|▊         | 8/100 [01:07<13:01,  8.49s/it]  9%|▉         | 9/100 [01:15<12:19,  8.13s/it] 10%|█         | 10/100 [01:28<14:41,  9.80s/it]Epoch 10: Train acc/f1 = 0.9328 / 0.9187 / 0.8972 / 0.9708 
                Val acc/f1/spec/sens = 0.8550 / 0.8157 / 0.8333 / 0.9262
                Test acc/f1/spec/sens = 0.7377 / 0.7448 / 0.7875 / 0.8571
 11%|█         | 11/100 [01:35<13:22,  9.02s/it] 12%|█▏        | 12/100 [01:43<12:44,  8.69s/it] 13%|█▎        | 13/100 [01:51<11:57,  8.25s/it] 14%|█▍        | 14/100 [01:59<11:44,  8.19s/it] 15%|█▌        | 15/100 [02:12<13:41,  9.66s/it]Epoch 15: Train acc/f1 = 0.9328 / 0.9280 / 0.9717 / 0.9212 
                Val acc/f1/spec/sens = 0.8400 / 0.7918 / 0.7949 / 0.9344
                Test acc/f1/spec/sens = 0.6967 / 0.6830 / 0.8750 / 0.6667
 16%|█▌        | 16/100 [02:20<12:54,  9.22s/it] 17%|█▋        | 17/100 [02:27<11:57,  8.64s/it] 18%|█▊        | 18/100 [02:35<11:32,  8.45s/it] 19%|█▉        | 19/100 [02:43<10:55,  8.09s/it] 20%|██        | 20/100 [02:57<13:11,  9.90s/it]Epoch 20: Train acc/f1 = 0.9706 / 0.9638 / 0.9866 / 0.9725 
                Val acc/f1/spec/sens = 0.8350 / 0.7916 / 0.8590 / 0.8934
                Test acc/f1/spec/sens = 0.7049 / 0.6999 / 0.8250 / 0.7857
 21%|██        | 21/100 [03:04<12:02,  9.15s/it] 22%|██▏       | 22/100 [03:12<11:28,  8.83s/it] 23%|██▎       | 23/100 [03:19<10:44,  8.37s/it] 24%|██▍       | 24/100 [03:27<10:27,  8.25s/it] 25%|██▌       | 25/100 [03:41<12:17,  9.83s/it]Epoch 25: Train acc/f1 = 0.9822 / 0.9785 / 0.9791 / 0.9885 
                Val acc/f1/spec/sens = 0.8600 / 0.8135 / 0.8846 / 0.9180
                Test acc/f1/spec/sens = 0.7295 / 0.7223 / 0.8625 / 0.7619
 26%|██▌       | 26/100 [03:49<11:26,  9.28s/it] 27%|██▋       | 27/100 [03:56<10:32,  8.67s/it] 28%|██▊       | 28/100 [04:04<10:09,  8.46s/it] 29%|██▉       | 29/100 [04:11<09:35,  8.10s/it] 30%|███       | 30/100 [04:25<11:28,  9.83s/it]Epoch 30: Train acc/f1 = 0.9806 / 0.9789 / 0.9896 / 0.9787 
                Val acc/f1/spec/sens = 0.8500 / 0.8045 / 0.8718 / 0.9098
                Test acc/f1/spec/sens = 0.7459 / 0.7453 / 0.8875 / 0.7619
 31%|███       | 31/100 [04:33<10:25,  9.07s/it] 32%|███▏      | 32/100 [04:41<09:54,  8.75s/it] 33%|███▎      | 33/100 [04:48<09:16,  8.31s/it] 34%|███▍      | 34/100 [04:56<09:01,  8.20s/it] 35%|███▌      | 35/100 [05:09<10:37,  9.80s/it]Epoch 35: Train acc/f1 = 0.9889 / 0.9887 / 0.9925 / 0.9876 
                Val acc/f1/spec/sens = 0.8550 / 0.8085 / 0.8974 / 0.9098
                Test acc/f1/spec/sens = 0.7459 / 0.7438 / 0.9000 / 0.7619
 36%|███▌      | 36/100 [05:17<09:52,  9.26s/it] 37%|███▋      | 37/100 [05:25<09:05,  8.66s/it] 38%|███▊      | 38/100 [05:33<08:49,  8.54s/it] 39%|███▉      | 39/100 [05:40<08:17,  8.15s/it] 40%|████      | 40/100 [05:54<09:50,  9.85s/it]Epoch 40: Train acc/f1 = 0.9917 / 0.9889 / 0.9955 / 0.9938 
                Val acc/f1/spec/sens = 0.8650 / 0.8215 / 0.8590 / 0.9344
                Test acc/f1/spec/sens = 0.7295 / 0.7279 / 0.8625 / 0.7857
 41%|████      | 41/100 [06:01<08:55,  9.08s/it] 42%|████▏     | 42/100 [06:09<08:26,  8.74s/it] 43%|████▎     | 43/100 [06:16<07:52,  8.29s/it] 44%|████▍     | 44/100 [06:24<07:38,  8.19s/it] 45%|████▌     | 45/100 [06:37<08:41,  9.49s/it]Epoch 45: Train acc/f1 = 0.9928 / 0.9911 / 0.9955 / 0.9938 
                Val acc/f1/spec/sens = 0.8650 / 0.8149 / 0.8590 / 0.9426
                Test acc/f1/spec/sens = 0.7213 / 0.7116 / 0.9000 / 0.7619
 46%|████▌     | 46/100 [06:45<08:05,  9.00s/it] 47%|████▋     | 47/100 [06:52<07:29,  8.49s/it] 48%|████▊     | 48/100 [07:00<07:13,  8.34s/it] 49%|████▉     | 49/100 [07:07<06:49,  8.02s/it] 50%|█████     | 50/100 [07:21<08:11,  9.83s/it]Epoch 50: Train acc/f1 = 0.9894 / 0.9875 / 0.9836 / 0.9956 
                Val acc/f1/spec/sens = 0.8650 / 0.8149 / 0.8590 / 0.9426
                Test acc/f1/spec/sens = 0.6721 / 0.6660 / 0.8000 / 0.7857
 51%|█████     | 51/100 [07:29<07:24,  9.07s/it] 52%|█████▏    | 52/100 [07:37<07:00,  8.75s/it] 53%|█████▎    | 53/100 [07:44<06:30,  8.30s/it] 54%|█████▍    | 54/100 [07:52<06:18,  8.23s/it] 55%|█████▌    | 55/100 [08:05<07:18,  9.75s/it]Epoch 55: Train acc/f1 = 0.9900 / 0.9887 / 0.9851 / 0.9947 
                Val acc/f1/spec/sens = 0.8700 / 0.8189 / 0.8590 / 0.9508
                Test acc/f1/spec/sens = 0.7049 / 0.7031 / 0.8375 / 0.7857
 56%|█████▌    | 56/100 [08:13<06:44,  9.20s/it] 57%|█████▋    | 57/100 [08:20<06:10,  8.62s/it] 58%|█████▊    | 58/100 [08:28<05:53,  8.42s/it] 59%|█████▉    | 59/100 [08:36<05:31,  8.09s/it] 60%|██████    | 60/100 [08:50<06:35,  9.89s/it]Epoch 60: Train acc/f1 = 0.9944 / 0.9945 / 0.9970 / 0.9929 
                Val acc/f1/spec/sens = 0.8450 / 0.8009 / 0.8974 / 0.8934
                Test acc/f1/spec/sens = 0.7213 / 0.7155 / 0.9000 / 0.7381
 61%|██████    | 61/100 [08:57<05:55,  9.11s/it] 62%|██████▏   | 62/100 [09:05<05:34,  8.81s/it] 63%|██████▎   | 63/100 [09:12<05:09,  8.36s/it] 64%|██████▍   | 64/100 [09:20<04:57,  8.27s/it] 65%|██████▌   | 65/100 [09:34<05:42,  9.79s/it]Epoch 65: Train acc/f1 = 0.9872 / 0.9844 / 0.9851 / 0.9938 
                Val acc/f1/spec/sens = 0.8700 / 0.8189 / 0.8590 / 0.9508
                Test acc/f1/spec/sens = 0.7131 / 0.7101 / 0.8500 / 0.7857
 66%|██████▌   | 66/100 [09:42<05:14,  9.26s/it] 67%|██████▋   | 67/100 [09:49<04:45,  8.65s/it] 68%|██████▊   | 68/100 [09:57<04:30,  8.46s/it] 69%|██████▉   | 69/100 [10:04<04:11,  8.11s/it] 70%|███████   | 70/100 [10:18<04:51,  9.71s/it]Epoch 70: Train acc/f1 = 0.9872 / 0.9846 / 0.9836 / 0.9911 
                Val acc/f1/spec/sens = 0.8750 / 0.8254 / 0.8846 / 0.9426
                Test acc/f1/spec/sens = 0.7049 / 0.6990 / 0.8625 / 0.7619
 71%|███████   | 71/100 [10:25<04:19,  8.96s/it] 72%|███████▏  | 72/100 [10:33<04:02,  8.65s/it] 73%|███████▎  | 73/100 [10:40<03:41,  8.21s/it] 74%|███████▍  | 74/100 [10:48<03:31,  8.15s/it] 75%|███████▌  | 75/100 [11:00<03:55,  9.41s/it]Epoch 75: Train acc/f1 = 0.9900 / 0.9889 / 0.9970 / 0.9885 
                Val acc/f1/spec/sens = 0.8650 / 0.8149 / 0.8590 / 0.9426
                Test acc/f1/spec/sens = 0.7049 / 0.6973 / 0.9000 / 0.7143
 76%|███████▌  | 76/100 [11:08<03:34,  8.95s/it] 77%|███████▋  | 77/100 [11:16<03:13,  8.43s/it] 78%|███████▊  | 78/100 [11:24<03:02,  8.29s/it] 79%|███████▉  | 79/100 [11:31<02:47,  7.98s/it] 80%|████████  | 80/100 [11:45<03:15,  9.77s/it]Epoch 80: Train acc/f1 = 0.9861 / 0.9849 / 0.9866 / 0.9885 
                Val acc/f1/spec/sens = 0.8600 / 0.8110 / 0.8590 / 0.9344
                Test acc/f1/spec/sens = 0.7295 / 0.7240 / 0.8750 / 0.7857
 81%|████████  | 81/100 [11:52<02:51,  9.01s/it] 82%|████████▏ | 82/100 [12:00<02:36,  8.70s/it] 83%|████████▎ | 83/100 [12:07<02:20,  8.25s/it] 84%|████████▍ | 84/100 [12:15<02:10,  8.17s/it] 85%|████████▌ | 85/100 [12:28<02:25,  9.70s/it]Epoch 85: Train acc/f1 = 0.9894 / 0.9869 / 0.9821 / 0.9973 
                Val acc/f1/spec/sens = 0.8450 / 0.7993 / 0.8590 / 0.9098
                Test acc/f1/spec/sens = 0.7049 / 0.7031 / 0.8375 / 0.7857
 86%|████████▌ | 86/100 [12:36<02:08,  9.17s/it] 87%|████████▋ | 87/100 [12:44<01:51,  8.60s/it] 88%|████████▊ | 88/100 [12:52<01:41,  8.45s/it] 89%|████████▉ | 89/100 [12:59<01:29,  8.10s/it] 90%|█████████ | 90/100 [13:13<01:38,  9.85s/it]Epoch 90: Train acc/f1 = 0.9939 / 0.9921 / 0.9925 / 0.9973 
                Val acc/f1/spec/sens = 0.8700 / 0.8189 / 0.8590 / 0.9508
                Test acc/f1/spec/sens = 0.6721 / 0.6660 / 0.8000 / 0.7857
 91%|█████████ | 91/100 [13:20<01:21,  9.09s/it] 92%|█████████▏| 92/100 [13:28<01:10,  8.76s/it] 93%|█████████▎| 93/100 [13:36<00:58,  8.32s/it] 94%|█████████▍| 94/100 [13:44<00:49,  8.22s/it] 95%|█████████▌| 95/100 [13:56<00:48,  9.63s/it]Epoch 95: Train acc/f1 = 0.9900 / 0.9877 / 0.9851 / 0.9956 
                Val acc/f1/spec/sens = 0.8500 / 0.8057 / 0.8846 / 0.9016
                Test acc/f1/spec/sens = 0.6885 / 0.6815 / 0.8250 / 0.7619
 96%|█████████▌| 96/100 [14:04<00:36,  9.13s/it] 97%|█████████▋| 97/100 [14:12<00:25,  8.59s/it] 98%|█████████▊| 98/100 [14:20<00:16,  8.42s/it] 99%|█████████▉| 99/100 [14:27<00:08,  8.07s/it]100%|██████████| 100/100 [14:41<00:00,  9.83s/it]                                                 Epoch 100: Train acc/f1 = 0.9900 / 0.9887 / 0.9851 / 0.9947 
                Val acc/f1/spec/sens = 0.8650 / 0.8174 / 0.8846 / 0.9262
                Test acc/f1/spec/sens = 0.7049 / 0.6975 / 0.8875 / 0.7381
specificity = 665/671
sensitivity = 1127/1129
specificity = 69/78
sensitivity = 113/122
specificity = 71/80
sensitivity = 31/42
Trial 2, Cycle 1
Train acc/f1/spec/sens = 0.9939 / 0.9917 / 0.9911 / 0.9982
Val acc/f1/spec/sens = 0.8650 / 0.8174 / 0.8846 / 0.9262
Test acc/f1/spec/sens = 0.7049 / 0.6975 / 0.8875 / 0.7381
>> Finished.
specificity = 71/80
sensitivity = 31/42
Acc, agreement for latest model:  0.7049180327868853 0.7049180327868853
Load best checkpoint for thief model
specificity = 70/80
sensitivity = 33/42
Acc, agreement for best model:  0.7622950819672131 0.7459016393442623
Trial 1/6 || Cycle 1/1 || Label set size 1800 || Test acc 0.7623 || Test agreement 0.7459 || Spec 0.8750 || Sens 0.7857
**************************************************************************************************** 

specificity = 70/80
sensitivity = 33/42
Number of samples  1800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:00<01:08,  1.63it/s]  2%|▏         | 2/113 [00:00<00:45,  2.43it/s]  3%|▎         | 3/113 [00:01<00:38,  2.88it/s]  4%|▎         | 4/113 [00:01<00:34,  3.12it/s]  4%|▍         | 5/113 [00:01<00:32,  3.33it/s]  5%|▌         | 6/113 [00:01<00:30,  3.45it/s]  6%|▌         | 7/113 [00:02<00:29,  3.59it/s]  7%|▋         | 8/113 [00:02<00:28,  3.64it/s]  8%|▊         | 9/113 [00:02<00:28,  3.69it/s]  9%|▉         | 10/113 [00:03<00:27,  3.75it/s] 10%|▉         | 11/113 [00:03<00:27,  3.75it/s] 11%|█         | 12/113 [00:03<00:26,  3.78it/s] 12%|█▏        | 13/113 [00:03<00:26,  3.82it/s] 12%|█▏        | 14/113 [00:04<00:26,  3.80it/s] 13%|█▎        | 15/113 [00:04<00:23,  4.13it/s] 14%|█▍        | 16/113 [00:04<00:22,  4.36it/s] 15%|█▌        | 17/113 [00:04<00:21,  4.56it/s] 16%|█▌        | 18/113 [00:04<00:20,  4.70it/s] 17%|█▋        | 19/113 [00:05<00:19,  4.86it/s] 18%|█▊        | 20/113 [00:05<00:18,  4.96it/s] 19%|█▊        | 21/113 [00:05<00:18,  5.03it/s] 19%|█▉        | 22/113 [00:05<00:17,  5.14it/s] 20%|██        | 23/113 [00:05<00:17,  5.15it/s] 21%|██        | 24/113 [00:05<00:17,  5.18it/s] 22%|██▏       | 25/113 [00:06<00:16,  5.20it/s] 23%|██▎       | 26/113 [00:06<00:16,  5.23it/s] 24%|██▍       | 27/113 [00:06<00:16,  5.25it/s] 25%|██▍       | 28/113 [00:06<00:17,  4.90it/s] 26%|██▌       | 29/113 [00:07<00:18,  4.55it/s] 27%|██▋       | 30/113 [00:07<00:19,  4.34it/s] 27%|██▋       | 31/113 [00:07<00:19,  4.31it/s] 28%|██▊       | 32/113 [00:07<00:17,  4.51it/s] 29%|██▉       | 33/113 [00:07<00:17,  4.68it/s] 30%|███       | 34/113 [00:08<00:16,  4.84it/s] 31%|███       | 35/113 [00:08<00:15,  4.91it/s] 32%|███▏      | 36/113 [00:08<00:15,  4.98it/s] 33%|███▎      | 37/113 [00:08<00:15,  5.02it/s] 34%|███▎      | 38/113 [00:08<00:14,  5.01it/s] 35%|███▍      | 39/113 [00:09<00:15,  4.69it/s] 35%|███▌      | 40/113 [00:09<00:16,  4.39it/s] 36%|███▋      | 41/113 [00:09<00:17,  4.21it/s] 37%|███▋      | 42/113 [00:09<00:16,  4.18it/s] 38%|███▊      | 43/113 [00:10<00:17,  4.11it/s] 39%|███▉      | 44/113 [00:10<00:17,  4.04it/s] 40%|███▉      | 45/113 [00:10<00:16,  4.02it/s] 41%|████      | 46/113 [00:10<00:16,  3.99it/s] 42%|████▏     | 47/113 [00:11<00:15,  4.15it/s] 42%|████▏     | 48/113 [00:11<00:14,  4.38it/s] 43%|████▎     | 49/113 [00:11<00:14,  4.40it/s] 44%|████▍     | 50/113 [00:11<00:15,  4.19it/s] 45%|████▌     | 51/113 [00:12<00:15,  4.10it/s] 46%|████▌     | 52/113 [00:12<00:15,  4.07it/s] 47%|████▋     | 53/113 [00:12<00:15,  3.99it/s] 48%|████▊     | 54/113 [00:12<00:14,  3.97it/s] 49%|████▊     | 55/113 [00:13<00:14,  3.98it/s] 50%|████▉     | 56/113 [00:13<00:14,  3.92it/s] 50%|█████     | 57/113 [00:13<00:14,  3.87it/s] 51%|█████▏    | 58/113 [00:13<00:14,  3.87it/s] 52%|█████▏    | 59/113 [00:14<00:14,  3.81it/s] 53%|█████▎    | 60/113 [00:14<00:13,  3.83it/s] 54%|█████▍    | 61/113 [00:14<00:13,  3.92it/s] 55%|█████▍    | 62/113 [00:14<00:12,  4.19it/s] 56%|█████▌    | 63/113 [00:15<00:11,  4.41it/s] 57%|█████▋    | 64/113 [00:15<00:10,  4.62it/s] 58%|█████▊    | 65/113 [00:15<00:10,  4.44it/s] 58%|█████▊    | 66/113 [00:15<00:11,  4.26it/s] 59%|█████▉    | 67/113 [00:16<00:11,  4.15it/s] 60%|██████    | 68/113 [00:16<00:11,  4.05it/s] 61%|██████    | 69/113 [00:16<00:10,  4.04it/s] 62%|██████▏   | 70/113 [00:16<00:10,  4.01it/s] 63%|██████▎   | 71/113 [00:17<00:10,  4.01it/s] 64%|██████▎   | 72/113 [00:17<00:10,  4.01it/s] 65%|██████▍   | 73/113 [00:17<00:10,  3.94it/s] 65%|██████▌   | 74/113 [00:17<00:09,  3.98it/s] 66%|██████▋   | 75/113 [00:18<00:09,  3.97it/s] 67%|██████▋   | 76/113 [00:18<00:09,  3.95it/s] 68%|██████▊   | 77/113 [00:18<00:09,  3.93it/s] 69%|██████▉   | 78/113 [00:18<00:08,  3.91it/s] 70%|██████▉   | 79/113 [00:19<00:08,  4.16it/s] 71%|███████   | 80/113 [00:19<00:07,  4.42it/s] 72%|███████▏  | 81/113 [00:19<00:06,  4.64it/s] 73%|███████▎  | 82/113 [00:19<00:06,  4.81it/s] 73%|███████▎  | 83/113 [00:19<00:06,  4.90it/s] 74%|███████▍  | 84/113 [00:19<00:05,  4.99it/s] 75%|███████▌  | 85/113 [00:20<00:05,  5.02it/s] 76%|███████▌  | 86/113 [00:20<00:05,  5.08it/s] 77%|███████▋  | 87/113 [00:20<00:05,  5.09it/s] 78%|███████▊  | 88/113 [00:20<00:04,  5.16it/s] 79%|███████▉  | 89/113 [00:20<00:04,  5.16it/s] 80%|███████▉  | 90/113 [00:21<00:04,  5.17it/s] 81%|████████  | 91/113 [00:21<00:04,  5.13it/s] 81%|████████▏ | 92/113 [00:21<00:04,  5.19it/s] 82%|████████▏ | 93/113 [00:21<00:03,  5.13it/s] 83%|████████▎ | 94/113 [00:21<00:03,  5.13it/s] 84%|████████▍ | 95/113 [00:22<00:03,  4.86it/s] 85%|████████▍ | 96/113 [00:22<00:03,  4.64it/s] 86%|████████▌ | 97/113 [00:22<00:03,  4.81it/s] 87%|████████▋ | 98/113 [00:22<00:03,  4.89it/s] 88%|████████▊ | 99/113 [00:22<00:02,  4.90it/s] 88%|████████▊ | 100/113 [00:23<00:02,  4.56it/s] 89%|████████▉ | 101/113 [00:23<00:02,  4.32it/s] 90%|█████████ | 102/113 [00:23<00:02,  4.14it/s] 91%|█████████ | 103/113 [00:24<00:02,  4.00it/s] 92%|█████████▏| 104/113 [00:24<00:02,  4.02it/s] 93%|█████████▎| 105/113 [00:24<00:02,  3.99it/s] 94%|█████████▍| 106/113 [00:24<00:01,  3.97it/s] 95%|█████████▍| 107/113 [00:25<00:01,  3.95it/s] 96%|█████████▌| 108/113 [00:25<00:01,  4.27it/s] 96%|█████████▋| 109/113 [00:25<00:00,  4.51it/s] 97%|█████████▋| 110/113 [00:25<00:00,  4.70it/s] 98%|█████████▊| 111/113 [00:25<00:00,  4.87it/s] 99%|█████████▉| 112/113 [00:26<00:00,  4.98it/s]100%|██████████| 113/113 [00:26<00:00,  5.84it/s]100%|██████████| 113/113 [00:26<00:00,  4.32it/s]
replacing val labels with victim labels
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:07,  1.62it/s] 15%|█▌        | 2/13 [00:00<00:04,  2.56it/s] 23%|██▎       | 3/13 [00:01<00:03,  3.32it/s] 31%|███       | 4/13 [00:01<00:02,  3.79it/s] 38%|███▊      | 5/13 [00:01<00:01,  4.16it/s] 46%|████▌     | 6/13 [00:01<00:01,  4.41it/s] 54%|█████▍    | 7/13 [00:01<00:01,  4.56it/s] 62%|██████▏   | 8/13 [00:02<00:01,  4.77it/s] 69%|██████▉   | 9/13 [00:02<00:00,  4.89it/s] 77%|███████▋  | 10/13 [00:02<00:00,  4.92it/s] 85%|████████▍ | 11/13 [00:02<00:00,  5.02it/s] 92%|█████████▏| 12/13 [00:02<00:00,  5.09it/s]100%|██████████| 13/13 [00:02<00:00,  4.39it/s]Validation set distribution: 
Number of samples  200

{0: 23, 1: 50, 2: 127}
Labeled set distribution: 
Number of samples  1800
{0: 223, 1: 411, 2: 1166}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked', 'fc.weight', 'fc.bias'])
thief state:  None
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
specificity = 76/80
sensitivity = 0/42
Initial model on target dataset: acc = 0.3934, agreement = 0.3689, f1 = 0.1916, spec = 0.9500, sens = 0.0000
specificity = 66/73
sensitivity = 17/127
Initial model on validation dataset: acc = 0.3050, agreement = 0.3050, f1 = 0.2054, spec = 0.9041, sens = 0.1339
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<11:51,  7.18s/it]  2%|▏         | 2/100 [00:15<12:35,  7.71s/it]  3%|▎         | 3/100 [00:22<12:08,  7.51s/it]  4%|▍         | 4/100 [00:30<12:20,  7.71s/it]  5%|▌         | 5/100 [00:44<15:39,  9.89s/it]Epoch 5: Train acc/f1 = 0.8661 / 0.8167 / 0.9132 / 0.9091 
                Val acc/f1/spec/sens = 0.7950 / 0.7513 / 0.8767 / 0.8189
                Test acc/f1/spec/sens = 0.6475 / 0.6519 / 0.7500 / 0.7619
  6%|▌         | 6/100 [00:52<14:36,  9.32s/it]  7%|▋         | 7/100 [00:59<13:25,  8.66s/it]  8%|▊         | 8/100 [01:07<12:56,  8.44s/it]  9%|▉         | 9/100 [01:15<12:16,  8.09s/it] 10%|█         | 10/100 [01:29<15:08, 10.09s/it]Epoch 10: Train acc/f1 = 0.9000 / 0.8772 / 0.9716 / 0.8919 
                Val acc/f1/spec/sens = 0.8300 / 0.8027 / 0.9315 / 0.8268
                Test acc/f1/spec/sens = 0.6967 / 0.6872 / 0.9375 / 0.5238
 11%|█         | 11/100 [01:37<13:42,  9.24s/it] 12%|█▏        | 12/100 [01:45<13:07,  8.95s/it] 13%|█▎        | 13/100 [01:52<12:14,  8.44s/it] 14%|█▍        | 14/100 [02:00<12:00,  8.37s/it] 15%|█▌        | 15/100 [02:14<14:03,  9.92s/it]Epoch 15: Train acc/f1 = 0.9400 / 0.9267 / 0.9716 / 0.9400 
                Val acc/f1/spec/sens = 0.8650 / 0.8162 / 0.7945 / 0.9528
                Test acc/f1/spec/sens = 0.6967 / 0.7049 / 0.8250 / 0.6429
 16%|█▌        | 16/100 [02:22<13:11,  9.42s/it] 17%|█▋        | 17/100 [02:29<12:09,  8.79s/it] 18%|█▊        | 18/100 [02:37<11:40,  8.55s/it] 19%|█▉        | 19/100 [02:45<11:00,  8.16s/it] 20%|██        | 20/100 [02:59<13:16,  9.96s/it]Epoch 20: Train acc/f1 = 0.9689 / 0.9611 / 0.9700 / 0.9768 
                Val acc/f1/spec/sens = 0.8700 / 0.8205 / 0.8219 / 0.9528
                Test acc/f1/spec/sens = 0.7295 / 0.7341 / 0.8250 / 0.6667
 21%|██        | 21/100 [03:06<12:04,  9.17s/it] 22%|██▏       | 22/100 [03:14<11:33,  8.90s/it] 23%|██▎       | 23/100 [03:22<10:48,  8.42s/it] 24%|██▍       | 24/100 [03:30<10:37,  8.39s/it] 25%|██▌       | 25/100 [03:43<12:19,  9.86s/it]Epoch 25: Train acc/f1 = 0.9828 / 0.9773 / 0.9921 / 0.9837 
                Val acc/f1/spec/sens = 0.9050 / 0.8652 / 0.8767 / 0.9685
                Test acc/f1/spec/sens = 0.7131 / 0.7151 / 0.9125 / 0.5238
 26%|██▌       | 26/100 [03:52<11:34,  9.38s/it] 27%|██▋       | 27/100 [03:59<10:39,  8.76s/it] 28%|██▊       | 28/100 [04:07<10:13,  8.52s/it] 29%|██▉       | 29/100 [04:14<09:39,  8.16s/it] 30%|███       | 30/100 [04:27<11:17,  9.68s/it]Epoch 30: Train acc/f1 = 0.9861 / 0.9820 / 0.9921 / 0.9871 
                Val acc/f1/spec/sens = 0.8950 / 0.8591 / 0.8767 / 0.9528
                Test acc/f1/spec/sens = 0.7049 / 0.7048 / 0.9250 / 0.5238
 31%|███       | 31/100 [04:35<10:16,  8.93s/it] 32%|███▏      | 32/100 [04:43<09:48,  8.66s/it] 33%|███▎      | 33/100 [04:50<09:11,  8.23s/it] 34%|███▍      | 34/100 [04:58<08:58,  8.16s/it] 35%|███▌      | 35/100 [05:11<10:33,  9.74s/it]Epoch 35: Train acc/f1 = 0.9944 / 0.9936 / 0.9984 / 0.9931 
                Val acc/f1/spec/sens = 0.8950 / 0.8591 / 0.8767 / 0.9528
                Test acc/f1/spec/sens = 0.7049 / 0.7043 / 0.9125 / 0.5476
 36%|███▌      | 36/100 [05:19<09:48,  9.20s/it] 37%|███▋      | 37/100 [05:26<09:02,  8.61s/it] 38%|███▊      | 38/100 [05:34<08:42,  8.43s/it] 39%|███▉      | 39/100 [05:42<08:13,  8.09s/it] 40%|████      | 40/100 [05:55<09:42,  9.71s/it]Epoch 40: Train acc/f1 = 0.9933 / 0.9916 / 0.9937 / 0.9957 
                Val acc/f1/spec/sens = 0.8900 / 0.8538 / 0.8356 / 0.9606
                Test acc/f1/spec/sens = 0.7131 / 0.7156 / 0.8875 / 0.5714
 41%|████      | 41/100 [06:02<08:49,  8.98s/it] 42%|████▏     | 42/100 [06:11<08:25,  8.71s/it] 43%|████▎     | 43/100 [06:18<07:52,  8.28s/it] 44%|████▍     | 44/100 [06:26<07:39,  8.21s/it] 45%|████▌     | 45/100 [06:39<08:57,  9.78s/it]Epoch 45: Train acc/f1 = 0.9922 / 0.9911 / 0.9953 / 0.9914 
                Val acc/f1/spec/sens = 0.9000 / 0.8608 / 0.8767 / 0.9606
                Test acc/f1/spec/sens = 0.7049 / 0.7058 / 0.9000 / 0.5476
 46%|████▌     | 46/100 [06:47<08:19,  9.26s/it] 47%|████▋     | 47/100 [06:55<07:38,  8.66s/it] 48%|████▊     | 48/100 [07:03<07:24,  8.55s/it] 49%|████▉     | 49/100 [07:10<06:56,  8.17s/it] 50%|█████     | 50/100 [07:25<08:23, 10.08s/it]Epoch 50: Train acc/f1 = 0.9950 / 0.9931 / 1.0000 / 0.9931 
                Val acc/f1/spec/sens = 0.9000 / 0.8608 / 0.8767 / 0.9606
                Test acc/f1/spec/sens = 0.6803 / 0.6799 / 0.9000 / 0.4762
 51%|█████     | 51/100 [07:32<07:33,  9.25s/it] 52%|█████▏    | 52/100 [07:40<07:07,  8.91s/it] 53%|█████▎    | 53/100 [07:47<06:35,  8.42s/it] 54%|█████▍    | 54/100 [07:56<06:22,  8.32s/it] 55%|█████▌    | 55/100 [08:09<07:25,  9.90s/it]Epoch 55: Train acc/f1 = 0.9972 / 0.9967 / 0.9968 / 0.9983 
                Val acc/f1/spec/sens = 0.8950 / 0.8552 / 0.8630 / 0.9606
                Test acc/f1/spec/sens = 0.7049 / 0.7058 / 0.9000 / 0.5476
 56%|█████▌    | 56/100 [08:17<06:51,  9.35s/it] 57%|█████▋    | 57/100 [08:24<06:14,  8.71s/it] 58%|█████▊    | 58/100 [08:32<05:57,  8.51s/it] 59%|█████▉    | 59/100 [08:40<05:33,  8.13s/it] 60%|██████    | 60/100 [08:54<06:35,  9.88s/it]Epoch 60: Train acc/f1 = 0.9961 / 0.9952 / 1.0000 / 0.9949 
                Val acc/f1/spec/sens = 0.9000 / 0.8651 / 0.8630 / 0.9606
                Test acc/f1/spec/sens = 0.7213 / 0.7223 / 0.9000 / 0.5714
 61%|██████    | 61/100 [09:01<05:54,  9.09s/it] 62%|██████▏   | 62/100 [09:09<05:36,  8.85s/it] 63%|██████▎   | 63/100 [09:16<05:10,  8.39s/it] 64%|██████▍   | 64/100 [09:25<04:58,  8.29s/it] 65%|██████▌   | 65/100 [09:38<05:43,  9.82s/it]Epoch 65: Train acc/f1 = 0.9956 / 0.9941 / 0.9953 / 0.9974 
                Val acc/f1/spec/sens = 0.8950 / 0.8538 / 0.8493 / 0.9685
                Test acc/f1/spec/sens = 0.7049 / 0.7074 / 0.8875 / 0.5714
 66%|██████▌   | 66/100 [09:46<05:15,  9.28s/it] 67%|██████▋   | 67/100 [09:53<04:46,  8.69s/it] 68%|██████▊   | 68/100 [10:01<04:31,  8.50s/it] 69%|██████▉   | 69/100 [10:09<04:12,  8.13s/it] 70%|███████   | 70/100 [10:23<04:58,  9.95s/it]Epoch 70: Train acc/f1 = 0.9906 / 0.9876 / 0.9953 / 0.9906 
                Val acc/f1/spec/sens = 0.9000 / 0.8608 / 0.8767 / 0.9606
                Test acc/f1/spec/sens = 0.6885 / 0.6887 / 0.9000 / 0.5000
 71%|███████   | 71/100 [10:30<04:26,  9.17s/it] 72%|███████▏  | 72/100 [10:38<04:06,  8.82s/it] 73%|███████▎  | 73/100 [10:45<03:45,  8.36s/it] 74%|███████▍  | 74/100 [10:53<03:34,  8.25s/it] 75%|███████▌  | 75/100 [11:07<04:06,  9.85s/it]Epoch 75: Train acc/f1 = 0.9928 / 0.9913 / 0.9905 / 0.9957 
                Val acc/f1/spec/sens = 0.9050 / 0.8751 / 0.8630 / 0.9606
                Test acc/f1/spec/sens = 0.7049 / 0.7074 / 0.8875 / 0.5714
 76%|███████▌  | 76/100 [11:15<03:43,  9.32s/it] 77%|███████▋  | 77/100 [11:22<03:20,  8.70s/it] 78%|███████▊  | 78/100 [11:30<03:06,  8.50s/it] 79%|███████▉  | 79/100 [11:38<02:51,  8.15s/it] 80%|████████  | 80/100 [11:51<03:14,  9.70s/it]Epoch 80: Train acc/f1 = 0.9956 / 0.9941 / 0.9953 / 0.9974 
                Val acc/f1/spec/sens = 0.9000 / 0.8638 / 0.8493 / 0.9685
                Test acc/f1/spec/sens = 0.7131 / 0.7168 / 0.8750 / 0.6190
 81%|████████  | 81/100 [11:58<02:50,  8.98s/it] 82%|████████▏ | 82/100 [12:06<02:36,  8.70s/it] 83%|████████▎ | 83/100 [12:14<02:20,  8.27s/it] 84%|████████▍ | 84/100 [12:22<02:10,  8.18s/it] 85%|████████▌ | 85/100 [12:34<02:23,  9.56s/it]Epoch 85: Train acc/f1 = 0.9956 / 0.9929 / 0.9968 / 0.9983 
                Val acc/f1/spec/sens = 0.9000 / 0.8608 / 0.8767 / 0.9606
                Test acc/f1/spec/sens = 0.7295 / 0.7300 / 0.9125 / 0.5714
 86%|████████▌ | 86/100 [12:42<02:07,  9.09s/it] 87%|████████▋ | 87/100 [12:50<01:50,  8.53s/it] 88%|████████▊ | 88/100 [12:58<01:40,  8.39s/it] 89%|████████▉ | 89/100 [13:05<01:28,  8.05s/it] 90%|█████████ | 90/100 [13:19<01:39,  9.94s/it]Epoch 90: Train acc/f1 = 0.9967 / 0.9943 / 0.9984 / 0.9991 
                Val acc/f1/spec/sens = 0.8950 / 0.8595 / 0.8493 / 0.9606
                Test acc/f1/spec/sens = 0.7049 / 0.7073 / 0.8875 / 0.5476
 91%|█████████ | 91/100 [13:27<01:22,  9.15s/it] 92%|█████████▏| 92/100 [13:35<01:10,  8.80s/it] 93%|█████████▎| 93/100 [13:42<00:58,  8.34s/it] 94%|█████████▍| 94/100 [13:50<00:49,  8.26s/it] 95%|█████████▌| 95/100 [14:03<00:48,  9.60s/it]Epoch 95: Train acc/f1 = 0.9906 / 0.9879 / 0.9921 / 0.9931 
                Val acc/f1/spec/sens = 0.9000 / 0.8608 / 0.8767 / 0.9606
                Test acc/f1/spec/sens = 0.7049 / 0.7103 / 0.8625 / 0.5952
 96%|█████████▌| 96/100 [14:11<00:36,  9.11s/it] 97%|█████████▋| 97/100 [14:18<00:25,  8.57s/it] 98%|█████████▊| 98/100 [14:26<00:16,  8.42s/it] 99%|█████████▉| 99/100 [14:33<00:08,  8.08s/it]100%|██████████| 100/100 [14:47<00:00,  9.89s/it]                                                 Epoch 100: Train acc/f1 = 0.9961 / 0.9956 / 0.9953 / 0.9974 
                Val acc/f1/spec/sens = 0.9050 / 0.8761 / 0.8493 / 0.9606
                Test acc/f1/spec/sens = 0.7213 / 0.7239 / 0.8875 / 0.5714
specificity = 630/634
sensitivity = 1161/1166
specificity = 62/73
sensitivity = 122/127
specificity = 71/80
sensitivity = 24/42
Trial 3, Cycle 1
Train acc/f1/spec/sens = 0.9950 / 0.9947 / 0.9937 / 0.9957
Val acc/f1/spec/sens = 0.9050 / 0.8761 / 0.8493 / 0.9606
Test acc/f1/spec/sens = 0.7213 / 0.7239 / 0.8875 / 0.5714
>> Finished.
specificity = 71/80
sensitivity = 24/42
Acc, agreement for latest model:  0.7213114754098361 0.7049180327868853
Load best checkpoint for thief model
specificity = 72/80
sensitivity = 23/42
Acc, agreement for best model:  0.7131147540983607 0.6885245901639344
Trial 2/6 || Cycle 1/1 || Label set size 1800 || Test acc 0.7131 || Test agreement 0.6885 || Spec 0.9000 || Sens 0.5476
**************************************************************************************************** 

specificity = 72/80
sensitivity = 23/42
Number of samples  1800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:00<01:08,  1.64it/s]  2%|▏         | 2/113 [00:00<00:41,  2.71it/s]  3%|▎         | 3/113 [00:01<00:32,  3.44it/s]  4%|▎         | 4/113 [00:01<00:27,  3.93it/s]  4%|▍         | 5/113 [00:01<00:27,  3.93it/s]  5%|▌         | 6/113 [00:01<00:27,  3.95it/s]  6%|▌         | 7/113 [00:01<00:26,  3.95it/s]  7%|▋         | 8/113 [00:02<00:26,  3.94it/s]  8%|▊         | 9/113 [00:02<00:26,  3.91it/s]  9%|▉         | 10/113 [00:02<00:26,  3.87it/s] 10%|▉         | 11/113 [00:03<00:26,  3.88it/s] 11%|█         | 12/113 [00:03<00:26,  3.85it/s] 12%|█▏        | 13/113 [00:03<00:25,  3.86it/s] 12%|█▏        | 14/113 [00:03<00:25,  3.85it/s] 13%|█▎        | 15/113 [00:04<00:25,  3.90it/s] 14%|█▍        | 16/113 [00:04<00:24,  3.90it/s] 15%|█▌        | 17/113 [00:04<00:24,  3.94it/s] 16%|█▌        | 18/113 [00:04<00:23,  3.99it/s] 17%|█▋        | 19/113 [00:05<00:23,  3.99it/s] 18%|█▊        | 20/113 [00:05<00:23,  3.96it/s] 19%|█▊        | 21/113 [00:05<00:23,  3.94it/s] 19%|█▉        | 22/113 [00:05<00:22,  3.96it/s] 20%|██        | 23/113 [00:06<00:22,  3.98it/s] 21%|██        | 24/113 [00:06<00:22,  3.94it/s] 22%|██▏       | 25/113 [00:06<00:22,  3.92it/s] 23%|██▎       | 26/113 [00:06<00:22,  3.92it/s] 24%|██▍       | 27/113 [00:07<00:22,  3.91it/s] 25%|██▍       | 28/113 [00:07<00:21,  3.89it/s] 26%|██▌       | 29/113 [00:07<00:21,  3.91it/s] 27%|██▋       | 30/113 [00:07<00:21,  3.89it/s] 27%|██▋       | 31/113 [00:08<00:21,  3.84it/s] 28%|██▊       | 32/113 [00:08<00:20,  3.90it/s] 29%|██▉       | 33/113 [00:08<00:20,  3.95it/s] 30%|███       | 34/113 [00:08<00:19,  4.04it/s] 31%|███       | 35/113 [00:09<00:18,  4.21it/s] 32%|███▏      | 36/113 [00:09<00:17,  4.45it/s] 33%|███▎      | 37/113 [00:09<00:16,  4.58it/s] 34%|███▎      | 38/113 [00:09<00:15,  4.74it/s] 35%|███▍      | 39/113 [00:09<00:16,  4.56it/s] 35%|███▌      | 40/113 [00:10<00:16,  4.30it/s] 36%|███▋      | 41/113 [00:10<00:17,  4.18it/s] 37%|███▋      | 42/113 [00:10<00:17,  4.10it/s] 38%|███▊      | 43/113 [00:10<00:17,  4.00it/s] 39%|███▉      | 44/113 [00:11<00:17,  3.97it/s] 40%|███▉      | 45/113 [00:11<00:17,  3.98it/s] 41%|████      | 46/113 [00:11<00:16,  3.95it/s] 42%|████▏     | 47/113 [00:11<00:16,  3.94it/s] 42%|████▏     | 48/113 [00:12<00:16,  3.93it/s] 43%|████▎     | 49/113 [00:12<00:16,  3.94it/s] 44%|████▍     | 50/113 [00:12<00:16,  3.92it/s] 45%|████▌     | 51/113 [00:12<00:15,  3.91it/s] 46%|████▌     | 52/113 [00:13<00:15,  3.91it/s] 47%|████▋     | 53/113 [00:13<00:15,  3.87it/s] 48%|████▊     | 54/113 [00:13<00:15,  3.85it/s] 49%|████▊     | 55/113 [00:14<00:15,  3.83it/s] 50%|████▉     | 56/113 [00:14<00:13,  4.17it/s] 50%|█████     | 57/113 [00:14<00:12,  4.42it/s] 51%|█████▏    | 58/113 [00:14<00:12,  4.58it/s] 52%|█████▏    | 59/113 [00:14<00:11,  4.54it/s] 53%|█████▎    | 60/113 [00:15<00:12,  4.33it/s] 54%|█████▍    | 61/113 [00:15<00:12,  4.22it/s] 55%|█████▍    | 62/113 [00:15<00:12,  4.11it/s] 56%|█████▌    | 63/113 [00:15<00:12,  3.98it/s] 57%|█████▋    | 64/113 [00:16<00:12,  3.94it/s] 58%|█████▊    | 65/113 [00:16<00:12,  3.92it/s] 58%|█████▊    | 66/113 [00:16<00:11,  3.95it/s] 59%|█████▉    | 67/113 [00:16<00:11,  3.96it/s] 60%|██████    | 68/113 [00:17<00:11,  3.95it/s] 61%|██████    | 69/113 [00:17<00:11,  3.89it/s] 62%|██████▏   | 70/113 [00:17<00:11,  3.91it/s] 63%|██████▎   | 71/113 [00:17<00:10,  3.92it/s] 64%|██████▎   | 72/113 [00:18<00:10,  3.90it/s] 65%|██████▍   | 73/113 [00:18<00:10,  3.90it/s] 65%|██████▌   | 74/113 [00:18<00:09,  3.91it/s] 66%|██████▋   | 75/113 [00:18<00:09,  3.89it/s] 67%|██████▋   | 76/113 [00:19<00:09,  3.93it/s] 68%|██████▊   | 77/113 [00:19<00:09,  3.94it/s] 69%|██████▉   | 78/113 [00:19<00:08,  3.94it/s] 70%|██████▉   | 79/113 [00:19<00:08,  3.88it/s] 71%|███████   | 80/113 [00:20<00:08,  3.89it/s] 72%|███████▏  | 81/113 [00:20<00:08,  3.94it/s] 73%|███████▎  | 82/113 [00:20<00:07,  3.89it/s] 73%|███████▎  | 83/113 [00:20<00:07,  3.90it/s] 74%|███████▍  | 84/113 [00:21<00:07,  3.93it/s] 75%|███████▌  | 85/113 [00:21<00:07,  3.89it/s] 76%|███████▌  | 86/113 [00:21<00:06,  3.88it/s] 77%|███████▋  | 87/113 [00:21<00:06,  3.92it/s] 78%|███████▊  | 88/113 [00:22<00:05,  4.26it/s] 79%|███████▉  | 89/113 [00:22<00:05,  4.53it/s] 80%|███████▉  | 90/113 [00:22<00:04,  4.70it/s] 81%|████████  | 91/113 [00:22<00:04,  4.86it/s] 81%|████████▏ | 92/113 [00:22<00:04,  4.95it/s] 82%|████████▏ | 93/113 [00:23<00:04,  5.00it/s] 83%|████████▎ | 94/113 [00:23<00:03,  5.09it/s] 84%|████████▍ | 95/113 [00:23<00:03,  5.08it/s] 85%|████████▍ | 96/113 [00:23<00:03,  4.63it/s] 86%|████████▌ | 97/113 [00:24<00:03,  4.23it/s] 87%|████████▋ | 98/113 [00:24<00:03,  4.03it/s] 88%|████████▊ | 99/113 [00:24<00:03,  3.89it/s] 88%|████████▊ | 100/113 [00:24<00:03,  4.09it/s] 89%|████████▉ | 101/113 [00:25<00:02,  4.00it/s] 90%|█████████ | 102/113 [00:25<00:02,  3.95it/s] 91%|█████████ | 103/113 [00:25<00:02,  3.94it/s] 92%|█████████▏| 104/113 [00:25<00:02,  3.93it/s] 93%|█████████▎| 105/113 [00:26<00:02,  3.95it/s] 94%|█████████▍| 106/113 [00:26<00:01,  3.99it/s] 95%|█████████▍| 107/113 [00:26<00:01,  3.95it/s] 96%|█████████▌| 108/113 [00:26<00:01,  3.96it/s] 96%|█████████▋| 109/113 [00:27<00:01,  3.97it/s] 97%|█████████▋| 110/113 [00:27<00:00,  3.98it/s] 98%|█████████▊| 111/113 [00:27<00:00,  3.93it/s] 99%|█████████▉| 112/113 [00:27<00:00,  3.88it/s]100%|██████████| 113/113 [00:28<00:00,  4.58it/s]100%|██████████| 113/113 [00:28<00:00,  4.02it/s]
replacing val labels with victim labels
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:07,  1.63it/s] 15%|█▌        | 2/13 [00:00<00:04,  2.69it/s] 23%|██▎       | 3/13 [00:01<00:02,  3.43it/s] 31%|███       | 4/13 [00:01<00:02,  3.92it/s] 38%|███▊      | 5/13 [00:01<00:01,  4.29it/s] 46%|████▌     | 6/13 [00:01<00:01,  4.57it/s] 54%|█████▍    | 7/13 [00:01<00:01,  4.77it/s] 62%|██████▏   | 8/13 [00:01<00:01,  4.88it/s] 69%|██████▉   | 9/13 [00:02<00:00,  5.00it/s] 77%|███████▋  | 10/13 [00:02<00:00,  4.98it/s] 85%|████████▍ | 11/13 [00:02<00:00,  5.05it/s] 92%|█████████▏| 12/13 [00:02<00:00,  4.86it/s]100%|██████████| 13/13 [00:02<00:00,  5.51it/s]100%|██████████| 13/13 [00:02<00:00,  4.35it/s]Validation set distribution: 
Number of samples  200

{0: 27, 1: 39, 2: 134}
Labeled set distribution: 
Number of samples  1800
{0: 246, 1: 414, 2: 1140}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked', 'fc.weight', 'fc.bias'])
thief state:  None
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
specificity = 79/80
sensitivity = 0/42
Initial model on target dataset: acc = 0.2951, agreement = 0.2541, f1 = 0.2289, spec = 0.9875, sens = 0.0000
specificity = 66/66
sensitivity = 0/134
Initial model on validation dataset: acc = 0.1100, agreement = 0.1100, f1 = 0.0940, spec = 1.0000, sens = 0.0000
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<11:48,  7.16s/it]  2%|▏         | 2/100 [00:15<12:31,  7.67s/it]  3%|▎         | 3/100 [00:22<12:04,  7.47s/it]  4%|▍         | 4/100 [00:30<12:23,  7.74s/it]  5%|▌         | 5/100 [00:43<15:19,  9.68s/it]Epoch 5: Train acc/f1 = 0.8250 / 0.7893 / 0.9742 / 0.8123 
                Val acc/f1/spec/sens = 0.8350 / 0.7643 / 0.7424 / 0.9328
                Test acc/f1/spec/sens = 0.6066 / 0.5898 / 0.9375 / 0.2857
  6%|▌         | 6/100 [00:51<14:21,  9.16s/it]  7%|▋         | 7/100 [00:59<13:13,  8.53s/it]  8%|▊         | 8/100 [01:07<12:47,  8.34s/it]  9%|▉         | 9/100 [01:14<12:07,  8.00s/it] 10%|█         | 10/100 [01:27<14:32,  9.69s/it]Epoch 10: Train acc/f1 = 0.9028 / 0.8590 / 0.8879 / 0.9605 
                Val acc/f1/spec/sens = 0.8550 / 0.7652 / 0.7879 / 0.9701
                Test acc/f1/spec/sens = 0.6148 / 0.6022 / 0.6250 / 0.7619
 11%|█         | 11/100 [01:34<13:16,  8.95s/it] 12%|█▏        | 12/100 [01:42<12:40,  8.65s/it] 13%|█▎        | 13/100 [01:50<11:55,  8.23s/it] 14%|█▍        | 14/100 [01:58<11:42,  8.17s/it] 15%|█▌        | 15/100 [02:11<13:44,  9.71s/it]Epoch 15: Train acc/f1 = 0.9561 / 0.9468 / 0.9379 / 0.9763 
                Val acc/f1/spec/sens = 0.8300 / 0.7285 / 0.8182 / 0.9403
                Test acc/f1/spec/sens = 0.7295 / 0.7330 / 0.7000 / 0.9524
 16%|█▌        | 16/100 [02:19<12:53,  9.20s/it] 17%|█▋        | 17/100 [02:26<11:57,  8.64s/it] 18%|█▊        | 18/100 [02:34<11:31,  8.44s/it] 19%|█▉        | 19/100 [02:42<10:54,  8.08s/it] 20%|██        | 20/100 [02:56<13:07,  9.84s/it]Epoch 20: Train acc/f1 = 0.9667 / 0.9583 / 0.9879 / 0.9667 
                Val acc/f1/spec/sens = 0.8650 / 0.8075 / 0.8939 / 0.9179
                Test acc/f1/spec/sens = 0.7705 / 0.7716 / 0.8875 / 0.7143
 21%|██        | 21/100 [03:03<11:57,  9.08s/it] 22%|██▏       | 22/100 [03:11<11:22,  8.75s/it] 23%|██▎       | 23/100 [03:18<10:40,  8.32s/it] 24%|██▍       | 24/100 [03:26<10:25,  8.23s/it] 25%|██▌       | 25/100 [03:40<12:15,  9.81s/it]Epoch 25: Train acc/f1 = 0.9806 / 0.9770 / 0.9894 / 0.9807 
                Val acc/f1/spec/sens = 0.8550 / 0.7842 / 0.8485 / 0.9328
                Test acc/f1/spec/sens = 0.7787 / 0.7814 / 0.8750 / 0.7857
 26%|██▌       | 26/100 [03:48<11:24,  9.25s/it] 27%|██▋       | 27/100 [03:55<10:32,  8.67s/it] 28%|██▊       | 28/100 [04:03<10:10,  8.48s/it] 29%|██▉       | 29/100 [04:10<09:37,  8.13s/it] 30%|███       | 30/100 [04:24<11:34,  9.93s/it]Epoch 30: Train acc/f1 = 0.9861 / 0.9815 / 0.9939 / 0.9868 
                Val acc/f1/spec/sens = 0.8500 / 0.7760 / 0.8333 / 0.9328
                Test acc/f1/spec/sens = 0.7623 / 0.7664 / 0.8500 / 0.7857
 31%|███       | 31/100 [04:32<10:30,  9.14s/it] 32%|███▏      | 32/100 [04:40<09:58,  8.79s/it] 33%|███▎      | 33/100 [04:47<09:18,  8.33s/it] 34%|███▍      | 34/100 [04:55<09:03,  8.24s/it] 35%|███▌      | 35/100 [05:08<10:34,  9.76s/it]Epoch 35: Train acc/f1 = 0.9900 / 0.9879 / 0.9864 / 0.9939 
                Val acc/f1/spec/sens = 0.8500 / 0.7727 / 0.8485 / 0.9328
                Test acc/f1/spec/sens = 0.7705 / 0.7734 / 0.8250 / 0.8333
 36%|███▌      | 36/100 [05:16<09:51,  9.24s/it] 37%|███▋      | 37/100 [05:24<09:04,  8.65s/it] 38%|███▊      | 38/100 [05:32<08:44,  8.46s/it] 39%|███▉      | 39/100 [05:39<08:15,  8.12s/it] 40%|████      | 40/100 [05:53<09:49,  9.82s/it]Epoch 40: Train acc/f1 = 0.9911 / 0.9897 / 0.9970 / 0.9895 
                Val acc/f1/spec/sens = 0.8600 / 0.7876 / 0.8485 / 0.9403
                Test acc/f1/spec/sens = 0.7541 / 0.7587 / 0.8375 / 0.7619
 41%|████      | 41/100 [06:00<08:54,  9.06s/it] 42%|████▏     | 42/100 [06:08<08:27,  8.75s/it] 43%|████▎     | 43/100 [06:15<07:54,  8.32s/it] 44%|████▍     | 44/100 [06:23<07:41,  8.23s/it] 45%|████▌     | 45/100 [06:37<08:57,  9.78s/it]Epoch 45: Train acc/f1 = 0.9950 / 0.9937 / 1.0000 / 0.9939 
                Val acc/f1/spec/sens = 0.8500 / 0.7713 / 0.8485 / 0.9328
                Test acc/f1/spec/sens = 0.7623 / 0.7677 / 0.8625 / 0.7857
 46%|████▌     | 46/100 [06:45<08:20,  9.27s/it] 47%|████▋     | 47/100 [06:52<07:38,  8.65s/it] 48%|████▊     | 48/100 [07:00<07:20,  8.46s/it] 49%|████▉     | 49/100 [07:07<06:53,  8.11s/it] 50%|█████     | 50/100 [07:22<08:16,  9.94s/it]Epoch 50: Train acc/f1 = 0.9956 / 0.9943 / 0.9985 / 0.9956 
                Val acc/f1/spec/sens = 0.8550 / 0.7802 / 0.8333 / 0.9403
                Test acc/f1/spec/sens = 0.7623 / 0.7661 / 0.8375 / 0.7857
 51%|█████     | 51/100 [07:29<07:28,  9.16s/it] 52%|█████▏    | 52/100 [07:37<07:04,  8.84s/it] 53%|█████▎    | 53/100 [07:44<06:33,  8.37s/it] 54%|█████▍    | 54/100 [07:52<06:19,  8.25s/it] 55%|█████▌    | 55/100 [08:06<07:19,  9.77s/it]Epoch 55: Train acc/f1 = 0.9933 / 0.9910 / 0.9939 / 0.9956 
                Val acc/f1/spec/sens = 0.8550 / 0.7802 / 0.8333 / 0.9403
                Test acc/f1/spec/sens = 0.7541 / 0.7572 / 0.8125 / 0.8333
 56%|█████▌    | 56/100 [08:14<06:46,  9.24s/it] 57%|█████▋    | 57/100 [08:21<06:12,  8.66s/it] 58%|█████▊    | 58/100 [08:29<05:56,  8.49s/it] 59%|█████▉    | 59/100 [08:36<05:32,  8.12s/it] 60%|██████    | 60/100 [08:50<06:38,  9.96s/it]Epoch 60: Train acc/f1 = 0.9944 / 0.9929 / 0.9924 / 0.9974 
                Val acc/f1/spec/sens = 0.8500 / 0.7727 / 0.8182 / 0.9403
                Test acc/f1/spec/sens = 0.7459 / 0.7499 / 0.8000 / 0.8333
 61%|██████    | 61/100 [08:58<05:58,  9.19s/it] 62%|██████▏   | 62/100 [09:06<05:35,  8.84s/it] 63%|██████▎   | 63/100 [09:13<05:09,  8.38s/it] 64%|██████▍   | 64/100 [09:21<04:58,  8.29s/it] 65%|██████▌   | 65/100 [09:35<05:45,  9.87s/it]Epoch 65: Train acc/f1 = 0.9944 / 0.9929 / 0.9970 / 0.9947 
                Val acc/f1/spec/sens = 0.8600 / 0.7910 / 0.8333 / 0.9403
                Test acc/f1/spec/sens = 0.7541 / 0.7573 / 0.8375 / 0.7857
 66%|██████▌   | 66/100 [09:43<05:16,  9.32s/it] 67%|██████▋   | 67/100 [09:50<04:47,  8.71s/it] 68%|██████▊   | 68/100 [09:58<04:32,  8.51s/it] 69%|██████▉   | 69/100 [10:05<04:12,  8.16s/it] 70%|███████   | 70/100 [10:20<04:59,  9.98s/it]Epoch 70: Train acc/f1 = 0.9944 / 0.9929 / 0.9939 / 0.9965 
                Val acc/f1/spec/sens = 0.8550 / 0.7802 / 0.8333 / 0.9403
                Test acc/f1/spec/sens = 0.7705 / 0.7734 / 0.8250 / 0.8333
 71%|███████   | 71/100 [10:27<04:25,  9.17s/it] 72%|███████▏  | 72/100 [10:35<04:06,  8.80s/it] 73%|███████▎  | 73/100 [10:42<03:44,  8.33s/it] 74%|███████▍  | 74/100 [10:50<03:34,  8.24s/it] 75%|███████▌  | 75/100 [11:04<04:05,  9.83s/it]Epoch 75: Train acc/f1 = 0.9956 / 0.9943 / 0.9955 / 0.9974 
                Val acc/f1/spec/sens = 0.8550 / 0.7802 / 0.8333 / 0.9403
                Test acc/f1/spec/sens = 0.7623 / 0.7662 / 0.8250 / 0.8095
 76%|███████▌  | 76/100 [11:12<03:42,  9.28s/it] 77%|███████▋  | 77/100 [11:19<03:19,  8.69s/it] 78%|███████▊  | 78/100 [11:27<03:06,  8.48s/it] 79%|███████▉  | 79/100 [11:34<02:50,  8.14s/it] 80%|████████  | 80/100 [11:48<03:17,  9.88s/it]Epoch 80: Train acc/f1 = 0.9922 / 0.9907 / 0.9970 / 0.9912 
                Val acc/f1/spec/sens = 0.8500 / 0.7684 / 0.8636 / 0.9328
                Test acc/f1/spec/sens = 0.7623 / 0.7691 / 0.8625 / 0.7619
 81%|████████  | 81/100 [11:56<02:53,  9.12s/it] 82%|████████▏ | 82/100 [12:04<02:38,  8.82s/it] 83%|████████▎ | 83/100 [12:11<02:22,  8.36s/it] 84%|████████▍ | 84/100 [12:19<02:12,  8.28s/it] 85%|████████▌ | 85/100 [12:33<02:27,  9.84s/it]Epoch 85: Train acc/f1 = 0.9972 / 0.9970 / 0.9970 / 0.9974 
                Val acc/f1/spec/sens = 0.8550 / 0.7769 / 0.8485 / 0.9403
                Test acc/f1/spec/sens = 0.7459 / 0.7487 / 0.8125 / 0.8333
 86%|████████▌ | 86/100 [12:41<02:10,  9.31s/it] 87%|████████▋ | 87/100 [12:48<01:52,  8.69s/it] 88%|████████▊ | 88/100 [12:56<01:42,  8.51s/it] 89%|████████▉ | 89/100 [13:03<01:29,  8.15s/it] 90%|█████████ | 90/100 [13:17<01:39,  9.92s/it]Epoch 90: Train acc/f1 = 0.9944 / 0.9929 / 0.9970 / 0.9947 
                Val acc/f1/spec/sens = 0.8550 / 0.7802 / 0.8333 / 0.9403
                Test acc/f1/spec/sens = 0.7705 / 0.7733 / 0.8375 / 0.8095
 91%|█████████ | 91/100 [13:25<01:22,  9.15s/it] 92%|█████████▏| 92/100 [13:33<01:10,  8.81s/it] 93%|█████████▎| 93/100 [13:40<00:58,  8.36s/it] 94%|█████████▍| 94/100 [13:48<00:49,  8.28s/it] 95%|█████████▌| 95/100 [14:02<00:49,  9.82s/it]Epoch 95: Train acc/f1 = 0.9933 / 0.9902 / 0.9985 / 0.9956 
                Val acc/f1/spec/sens = 0.8550 / 0.7802 / 0.8333 / 0.9403
                Test acc/f1/spec/sens = 0.7377 / 0.7412 / 0.8125 / 0.8095
 96%|█████████▌| 96/100 [14:10<00:37,  9.32s/it] 97%|█████████▋| 97/100 [14:17<00:26,  8.73s/it] 98%|█████████▊| 98/100 [14:25<00:17,  8.57s/it] 99%|█████████▉| 99/100 [14:33<00:08,  8.20s/it]100%|██████████| 100/100 [14:47<00:00,  9.90s/it]                                                 Epoch 100: Train acc/f1 = 0.9961 / 0.9948 / 1.0000 / 0.9956 
                Val acc/f1/spec/sens = 0.8550 / 0.7802 / 0.8333 / 0.9403
                Test acc/f1/spec/sens = 0.7541 / 0.7577 / 0.8125 / 0.8333
specificity = 657/660
sensitivity = 1134/1140
specificity = 55/66
sensitivity = 126/134
specificity = 65/80
sensitivity = 35/42
Trial 4, Cycle 1
Train acc/f1/spec/sens = 0.9944 / 0.9932 / 0.9955 / 0.9947
Val acc/f1/spec/sens = 0.8550 / 0.7802 / 0.8333 / 0.9403
Test acc/f1/spec/sens = 0.7541 / 0.7577 / 0.8125 / 0.8333
>> Finished.
specificity = 65/80
sensitivity = 35/42
Acc, agreement for latest model:  0.7540983606557377 0.7295081967213115
Load best checkpoint for thief model
specificity = 72/80
sensitivity = 30/42
Acc, agreement for best model:  0.7540983606557377 0.7295081967213115
Trial 3/6 || Cycle 1/1 || Label set size 1800 || Test acc 0.7541 || Test agreement 0.7295 || Spec 0.9000 || Sens 0.7143
**************************************************************************************************** 

specificity = 72/80
sensitivity = 30/42
Number of samples  1800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:00<01:09,  1.60it/s]  2%|▏         | 2/113 [00:00<00:46,  2.41it/s]  3%|▎         | 3/113 [00:01<00:38,  2.89it/s]  4%|▎         | 4/113 [00:01<00:33,  3.22it/s]  4%|▍         | 5/113 [00:01<00:31,  3.45it/s]  5%|▌         | 6/113 [00:01<00:30,  3.56it/s]  6%|▌         | 7/113 [00:02<00:29,  3.64it/s]  7%|▋         | 8/113 [00:02<00:28,  3.73it/s]  8%|▊         | 9/113 [00:02<00:27,  3.82it/s]  9%|▉         | 10/113 [00:02<00:26,  3.85it/s] 10%|▉         | 11/113 [00:03<00:26,  3.84it/s] 11%|█         | 12/113 [00:03<00:26,  3.87it/s] 12%|█▏        | 13/113 [00:03<00:25,  3.88it/s] 12%|█▏        | 14/113 [00:03<00:25,  3.89it/s] 13%|█▎        | 15/113 [00:04<00:25,  3.90it/s] 14%|█▍        | 16/113 [00:04<00:24,  3.88it/s] 15%|█▌        | 17/113 [00:04<00:24,  3.88it/s] 16%|█▌        | 18/113 [00:05<00:24,  3.91it/s] 17%|█▋        | 19/113 [00:05<00:24,  3.92it/s] 18%|█▊        | 20/113 [00:05<00:23,  3.88it/s] 19%|█▊        | 21/113 [00:05<00:23,  3.89it/s] 19%|█▉        | 22/113 [00:06<00:23,  3.88it/s] 20%|██        | 23/113 [00:06<00:23,  3.86it/s] 21%|██        | 24/113 [00:06<00:22,  3.92it/s] 22%|██▏       | 25/113 [00:06<00:22,  3.95it/s] 23%|██▎       | 26/113 [00:07<00:22,  3.95it/s] 24%|██▍       | 27/113 [00:07<00:21,  3.95it/s] 25%|██▍       | 28/113 [00:07<00:21,  3.96it/s] 26%|██▌       | 29/113 [00:07<00:21,  3.99it/s] 27%|██▋       | 30/113 [00:08<00:21,  3.92it/s] 27%|██▋       | 31/113 [00:08<00:20,  3.98it/s] 28%|██▊       | 32/113 [00:08<00:18,  4.30it/s] 29%|██▉       | 33/113 [00:08<00:17,  4.55it/s] 30%|███       | 34/113 [00:08<00:16,  4.75it/s] 31%|███       | 35/113 [00:09<00:15,  4.90it/s] 32%|███▏      | 36/113 [00:09<00:15,  5.03it/s] 33%|███▎      | 37/113 [00:09<00:14,  5.07it/s] 34%|███▎      | 38/113 [00:09<00:14,  5.09it/s] 35%|███▍      | 39/113 [00:09<00:14,  5.17it/s] 35%|███▌      | 40/113 [00:10<00:14,  5.21it/s] 36%|███▋      | 41/113 [00:10<00:13,  5.22it/s] 37%|███▋      | 42/113 [00:10<00:13,  5.26it/s] 38%|███▊      | 43/113 [00:10<00:13,  5.24it/s] 39%|███▉      | 44/113 [00:10<00:13,  5.20it/s] 40%|███▉      | 45/113 [00:10<00:12,  5.25it/s] 41%|████      | 46/113 [00:11<00:12,  5.25it/s] 42%|████▏     | 47/113 [00:11<00:12,  5.24it/s] 42%|████▏     | 48/113 [00:11<00:12,  5.25it/s] 43%|████▎     | 49/113 [00:11<00:12,  5.23it/s] 44%|████▍     | 50/113 [00:11<00:12,  5.19it/s] 45%|████▌     | 51/113 [00:12<00:11,  5.20it/s] 46%|████▌     | 52/113 [00:12<00:11,  5.24it/s] 47%|████▋     | 53/113 [00:12<00:11,  5.23it/s] 48%|████▊     | 54/113 [00:12<00:11,  5.22it/s] 49%|████▊     | 55/113 [00:12<00:11,  5.24it/s] 50%|████▉     | 56/113 [00:13<00:10,  5.22it/s] 50%|█████     | 57/113 [00:13<00:10,  5.22it/s] 51%|█████▏    | 58/113 [00:13<00:10,  5.22it/s] 52%|█████▏    | 59/113 [00:13<00:10,  5.18it/s] 53%|█████▎    | 60/113 [00:13<00:10,  5.17it/s] 54%|█████▍    | 61/113 [00:14<00:10,  5.17it/s] 55%|█████▍    | 62/113 [00:14<00:09,  5.20it/s] 56%|█████▌    | 63/113 [00:14<00:09,  5.21it/s] 57%|█████▋    | 64/113 [00:14<00:09,  5.23it/s] 58%|█████▊    | 65/113 [00:14<00:09,  5.25it/s] 58%|█████▊    | 66/113 [00:14<00:09,  5.19it/s] 59%|█████▉    | 67/113 [00:15<00:08,  5.19it/s] 60%|██████    | 68/113 [00:15<00:08,  5.19it/s] 61%|██████    | 69/113 [00:15<00:08,  5.18it/s] 62%|██████▏   | 70/113 [00:15<00:08,  5.20it/s] 63%|██████▎   | 71/113 [00:15<00:08,  5.23it/s] 64%|██████▎   | 72/113 [00:16<00:07,  5.25it/s] 65%|██████▍   | 73/113 [00:16<00:07,  5.26it/s] 65%|██████▌   | 74/113 [00:16<00:08,  4.77it/s] 66%|██████▋   | 75/113 [00:16<00:08,  4.53it/s] 67%|██████▋   | 76/113 [00:17<00:08,  4.39it/s] 68%|██████▊   | 77/113 [00:17<00:08,  4.24it/s] 69%|██████▉   | 78/113 [00:17<00:08,  4.13it/s] 70%|██████▉   | 79/113 [00:17<00:08,  4.07it/s] 71%|███████   | 80/113 [00:18<00:08,  4.05it/s] 72%|███████▏  | 81/113 [00:18<00:07,  4.03it/s] 73%|███████▎  | 82/113 [00:18<00:07,  4.02it/s] 73%|███████▎  | 83/113 [00:18<00:07,  3.99it/s] 74%|███████▍  | 84/113 [00:19<00:07,  3.93it/s] 75%|███████▌  | 85/113 [00:19<00:07,  3.98it/s] 76%|███████▌  | 86/113 [00:19<00:06,  3.93it/s] 77%|███████▋  | 87/113 [00:19<00:06,  3.90it/s] 78%|███████▊  | 88/113 [00:20<00:06,  3.95it/s] 79%|███████▉  | 89/113 [00:20<00:06,  3.97it/s] 80%|███████▉  | 90/113 [00:20<00:05,  3.94it/s] 81%|████████  | 91/113 [00:20<00:05,  3.90it/s] 81%|████████▏ | 92/113 [00:21<00:05,  3.88it/s] 82%|████████▏ | 93/113 [00:21<00:05,  3.90it/s] 83%|████████▎ | 94/113 [00:21<00:04,  3.97it/s] 84%|████████▍ | 95/113 [00:21<00:04,  3.95it/s] 85%|████████▍ | 96/113 [00:22<00:04,  3.93it/s] 86%|████████▌ | 97/113 [00:22<00:04,  3.91it/s] 87%|████████▋ | 98/113 [00:22<00:03,  4.09it/s] 88%|████████▊ | 99/113 [00:22<00:03,  4.37it/s] 88%|████████▊ | 100/113 [00:23<00:02,  4.61it/s] 89%|████████▉ | 101/113 [00:23<00:02,  4.81it/s] 90%|█████████ | 102/113 [00:23<00:02,  4.89it/s] 91%|█████████ | 103/113 [00:23<00:02,  4.99it/s] 92%|█████████▏| 104/113 [00:23<00:01,  5.07it/s] 93%|█████████▎| 105/113 [00:23<00:01,  5.10it/s] 94%|█████████▍| 106/113 [00:24<00:01,  5.09it/s] 95%|█████████▍| 107/113 [00:24<00:01,  5.10it/s] 96%|█████████▌| 108/113 [00:24<00:01,  4.64it/s] 96%|█████████▋| 109/113 [00:24<00:00,  4.40it/s] 97%|█████████▋| 110/113 [00:25<00:00,  4.30it/s] 98%|█████████▊| 111/113 [00:25<00:00,  4.22it/s] 99%|█████████▉| 112/113 [00:25<00:00,  4.13it/s]100%|██████████| 113/113 [00:25<00:00,  4.76it/s]100%|██████████| 113/113 [00:25<00:00,  4.37it/s]
replacing val labels with victim labels
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:06,  1.83it/s] 15%|█▌        | 2/13 [00:00<00:03,  2.87it/s] 23%|██▎       | 3/13 [00:00<00:02,  3.50it/s] 31%|███       | 4/13 [00:01<00:02,  3.99it/s] 38%|███▊      | 5/13 [00:01<00:01,  4.29it/s] 46%|████▌     | 6/13 [00:01<00:01,  4.50it/s] 54%|█████▍    | 7/13 [00:01<00:01,  4.72it/s] 62%|██████▏   | 8/13 [00:01<00:01,  4.80it/s] 69%|██████▉   | 9/13 [00:02<00:00,  4.89it/s] 77%|███████▋  | 10/13 [00:02<00:00,  4.94it/s] 85%|████████▍ | 11/13 [00:02<00:00,  5.01it/s] 92%|█████████▏| 12/13 [00:02<00:00,  5.04it/s]100%|██████████| 13/13 [00:02<00:00,  5.86it/s]100%|██████████| 13/13 [00:02<00:00,  4.50it/s]Validation set distribution: 
Number of samples  200

{0: 25, 1: 35, 2: 140}
Labeled set distribution: 
Number of samples  1800
{0: 186, 1: 446, 2: 1168}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked', 'fc.weight', 'fc.bias'])
thief state:  None
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
specificity = 36/80
sensitivity = 30/42
Initial model on target dataset: acc = 0.3689, agreement = 0.4016, f1 = 0.3154, spec = 0.4500, sens = 0.7143
specificity = 36/60
sensitivity = 91/140
Initial model on validation dataset: acc = 0.5250, agreement = 0.5250, f1 = 0.3177, spec = 0.6000, sens = 0.6500
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<12:00,  7.28s/it]  2%|▏         | 2/100 [00:15<12:42,  7.78s/it]  3%|▎         | 3/100 [00:22<12:09,  7.52s/it]  4%|▍         | 4/100 [00:30<12:26,  7.77s/it]  5%|▌         | 5/100 [00:43<15:15,  9.63s/it]Epoch 5: Train acc/f1 = 0.8939 / 0.8666 / 0.9620 / 0.8887 
                Val acc/f1/spec/sens = 0.8950 / 0.8229 / 0.7500 / 0.9929
                Test acc/f1/spec/sens = 0.5738 / 0.5587 / 0.9375 / 0.2857
  6%|▌         | 6/100 [00:51<14:12,  9.07s/it]  7%|▋         | 7/100 [00:59<13:10,  8.50s/it]  8%|▊         | 8/100 [01:07<12:53,  8.40s/it]  9%|▉         | 9/100 [01:14<12:13,  8.07s/it] 10%|█         | 10/100 [01:28<15:00, 10.00s/it]Epoch 10: Train acc/f1 = 0.9411 / 0.9162 / 0.9272 / 0.9709 
                Val acc/f1/spec/sens = 0.8950 / 0.8426 / 0.8667 / 0.9357
                Test acc/f1/spec/sens = 0.6230 / 0.6266 / 0.8625 / 0.3810
 11%|█         | 11/100 [01:36<13:38,  9.20s/it] 12%|█▏        | 12/100 [01:44<12:58,  8.84s/it] 13%|█▎        | 13/100 [01:51<12:07,  8.36s/it] 14%|█▍        | 14/100 [01:59<11:48,  8.23s/it] 15%|█▌        | 15/100 [02:12<13:52,  9.80s/it]Epoch 15: Train acc/f1 = 0.9361 / 0.9156 / 0.9858 / 0.9238 
                Val acc/f1/spec/sens = 0.8800 / 0.8233 / 0.9000 / 0.9143
                Test acc/f1/spec/sens = 0.5738 / 0.5430 / 0.9500 / 0.2143
 16%|█▌        | 16/100 [02:21<13:01,  9.30s/it] 17%|█▋        | 17/100 [02:28<12:01,  8.70s/it] 18%|█▊        | 18/100 [02:36<11:42,  8.57s/it] 19%|█▉        | 19/100 [02:43<11:02,  8.17s/it] 20%|██        | 20/100 [02:58<13:17,  9.97s/it]Epoch 20: Train acc/f1 = 0.9772 / 0.9687 / 0.9810 / 0.9829 
                Val acc/f1/spec/sens = 0.8900 / 0.8501 / 0.8833 / 0.9143
                Test acc/f1/spec/sens = 0.6557 / 0.6664 / 0.8000 / 0.5714
 21%|██        | 21/100 [03:05<12:05,  9.18s/it] 22%|██▏       | 22/100 [03:13<11:32,  8.88s/it] 23%|██▎       | 23/100 [03:20<10:46,  8.39s/it] 24%|██▍       | 24/100 [03:28<10:28,  8.28s/it] 25%|██▌       | 25/100 [03:42<12:17,  9.83s/it]Epoch 25: Train acc/f1 = 0.9889 / 0.9839 / 0.9968 / 0.9889 
                Val acc/f1/spec/sens = 0.9150 / 0.8824 / 0.9167 / 0.9357
                Test acc/f1/spec/sens = 0.6066 / 0.6103 / 0.8250 / 0.4048
 26%|██▌       | 26/100 [03:50<11:28,  9.30s/it] 27%|██▋       | 27/100 [03:57<10:35,  8.71s/it] 28%|██▊       | 28/100 [04:05<10:17,  8.57s/it] 29%|██▉       | 29/100 [04:13<09:41,  8.19s/it] 30%|███       | 30/100 [04:27<11:42, 10.04s/it]Epoch 30: Train acc/f1 = 0.9911 / 0.9880 / 0.9937 / 0.9923 
                Val acc/f1/spec/sens = 0.9250 / 0.8949 / 0.9000 / 0.9500
                Test acc/f1/spec/sens = 0.6557 / 0.6675 / 0.8000 / 0.5238
 31%|███       | 31/100 [04:34<10:35,  9.22s/it] 32%|███▏      | 32/100 [04:42<10:00,  8.83s/it] 33%|███▎      | 33/100 [04:50<09:20,  8.36s/it] 34%|███▍      | 34/100 [04:58<09:04,  8.25s/it] 35%|███▌      | 35/100 [05:11<10:36,  9.79s/it]Epoch 35: Train acc/f1 = 0.9944 / 0.9925 / 0.9937 / 0.9957 
                Val acc/f1/spec/sens = 0.9100 / 0.8776 / 0.9000 / 0.9286
                Test acc/f1/spec/sens = 0.6311 / 0.6466 / 0.7750 / 0.5000
 36%|███▌      | 36/100 [05:19<09:57,  9.33s/it] 37%|███▋      | 37/100 [05:26<09:07,  8.70s/it] 38%|███▊      | 38/100 [05:34<08:45,  8.48s/it] 39%|███▉      | 39/100 [05:42<08:16,  8.13s/it] 40%|████      | 40/100 [05:56<09:50,  9.84s/it]Epoch 40: Train acc/f1 = 0.9939 / 0.9916 / 0.9968 / 0.9949 
                Val acc/f1/spec/sens = 0.9150 / 0.8884 / 0.8667 / 0.9429
                Test acc/f1/spec/sens = 0.6393 / 0.6446 / 0.8250 / 0.4524
 41%|████      | 41/100 [06:03<08:55,  9.07s/it] 42%|████▏     | 42/100 [06:11<08:27,  8.76s/it] 43%|████▎     | 43/100 [06:18<07:54,  8.32s/it] 44%|████▍     | 44/100 [06:26<07:41,  8.24s/it] 45%|████▌     | 45/100 [06:40<09:00,  9.83s/it]Epoch 45: Train acc/f1 = 0.9917 / 0.9885 / 0.9953 / 0.9923 
                Val acc/f1/spec/sens = 0.9100 / 0.8816 / 0.8500 / 0.9429
                Test acc/f1/spec/sens = 0.6557 / 0.6669 / 0.7875 / 0.5476
 46%|████▌     | 46/100 [06:48<08:20,  9.27s/it] 47%|████▋     | 47/100 [06:55<07:40,  8.69s/it] 48%|████▊     | 48/100 [07:03<07:20,  8.48s/it] 49%|████▉     | 49/100 [07:10<06:53,  8.11s/it] 50%|█████     | 50/100 [07:25<08:19, 10.00s/it]Epoch 50: Train acc/f1 = 0.9944 / 0.9895 / 0.9984 / 0.9966 
                Val acc/f1/spec/sens = 0.9200 / 0.8949 / 0.8833 / 0.9429
                Test acc/f1/spec/sens = 0.6475 / 0.6563 / 0.8000 / 0.5238
 51%|█████     | 51/100 [07:32<07:30,  9.20s/it] 52%|█████▏    | 52/100 [07:40<07:04,  8.84s/it] 53%|█████▎    | 53/100 [07:47<06:33,  8.38s/it] 54%|█████▍    | 54/100 [07:55<06:20,  8.28s/it] 55%|█████▌    | 55/100 [08:09<07:29,  9.99s/it]Epoch 55: Train acc/f1 = 0.9928 / 0.9905 / 0.9953 / 0.9940 
                Val acc/f1/spec/sens = 0.9100 / 0.8816 / 0.8500 / 0.9429
                Test acc/f1/spec/sens = 0.6557 / 0.6652 / 0.8125 / 0.5238
 56%|█████▌    | 56/100 [08:17<06:54,  9.41s/it] 57%|█████▋    | 57/100 [08:25<06:17,  8.77s/it] 58%|█████▊    | 58/100 [08:33<05:59,  8.55s/it] 59%|█████▉    | 59/100 [08:40<05:34,  8.17s/it] 60%|██████    | 60/100 [08:54<06:42, 10.06s/it]Epoch 60: Train acc/f1 = 0.9939 / 0.9910 / 0.9968 / 0.9949 
                Val acc/f1/spec/sens = 0.9200 / 0.8949 / 0.8833 / 0.9429
                Test acc/f1/spec/sens = 0.6557 / 0.6637 / 0.8125 / 0.5000
 61%|██████    | 61/100 [09:02<06:00,  9.24s/it] 62%|██████▏   | 62/100 [09:10<05:39,  8.94s/it] 63%|██████▎   | 63/100 [09:17<05:12,  8.43s/it] 64%|██████▍   | 64/100 [09:25<04:58,  8.30s/it] 65%|██████▌   | 65/100 [09:39<05:52, 10.06s/it]Epoch 65: Train acc/f1 = 0.9967 / 0.9949 / 0.9984 / 0.9974 
                Val acc/f1/spec/sens = 0.9150 / 0.8884 / 0.8667 / 0.9429
                Test acc/f1/spec/sens = 0.6393 / 0.6504 / 0.7875 / 0.5000
 66%|██████▌   | 66/100 [09:48<05:21,  9.47s/it] 67%|██████▋   | 67/100 [09:55<04:51,  8.82s/it] 68%|██████▊   | 68/100 [10:03<04:35,  8.60s/it] 69%|██████▉   | 69/100 [10:10<04:14,  8.22s/it] 70%|███████   | 70/100 [10:25<05:03, 10.13s/it]Epoch 70: Train acc/f1 = 0.9944 / 0.9936 / 0.9921 / 0.9966 
                Val acc/f1/spec/sens = 0.9150 / 0.8884 / 0.8667 / 0.9429
                Test acc/f1/spec/sens = 0.6557 / 0.6654 / 0.8000 / 0.5238
 71%|███████   | 71/100 [10:32<04:29,  9.28s/it] 72%|███████▏  | 72/100 [10:40<04:08,  8.89s/it] 73%|███████▎  | 73/100 [10:47<03:46,  8.40s/it] 74%|███████▍  | 74/100 [10:55<03:35,  8.28s/it] 75%|███████▌  | 75/100 [11:10<04:14, 10.17s/it]Epoch 75: Train acc/f1 = 0.9939 / 0.9923 / 0.9953 / 0.9949 
                Val acc/f1/spec/sens = 0.9200 / 0.8949 / 0.8833 / 0.9429
                Test acc/f1/spec/sens = 0.6475 / 0.6603 / 0.7750 / 0.5476
 76%|███████▌  | 76/100 [11:18<03:49,  9.58s/it] 77%|███████▋  | 77/100 [11:25<03:25,  8.91s/it] 78%|███████▊  | 78/100 [11:34<03:10,  8.67s/it] 79%|███████▉  | 79/100 [11:41<02:53,  8.26s/it] 80%|████████  | 80/100 [11:55<03:23, 10.16s/it]Epoch 80: Train acc/f1 = 0.9956 / 0.9941 / 0.9984 / 0.9949 
                Val acc/f1/spec/sens = 0.9100 / 0.8816 / 0.8500 / 0.9429
                Test acc/f1/spec/sens = 0.6475 / 0.6578 / 0.7875 / 0.5476
 81%|████████  | 81/100 [12:03<02:56,  9.31s/it] 82%|████████▏ | 82/100 [12:11<02:40,  8.94s/it] 83%|████████▎ | 83/100 [12:18<02:23,  8.46s/it] 84%|████████▍ | 84/100 [12:26<02:13,  8.34s/it] 85%|████████▌ | 85/100 [12:40<02:31, 10.10s/it]Epoch 85: Train acc/f1 = 0.9939 / 0.9915 / 0.9984 / 0.9923 
                Val acc/f1/spec/sens = 0.9200 / 0.8949 / 0.8833 / 0.9429
                Test acc/f1/spec/sens = 0.6148 / 0.6199 / 0.8125 / 0.4286
 86%|████████▌ | 86/100 [12:49<02:12,  9.49s/it] 87%|████████▋ | 87/100 [12:56<01:54,  8.84s/it] 88%|████████▊ | 88/100 [13:04<01:43,  8.61s/it] 89%|████████▉ | 89/100 [13:11<01:30,  8.23s/it] 90%|█████████ | 90/100 [13:26<01:40, 10.08s/it]Epoch 90: Train acc/f1 = 0.9961 / 0.9946 / 0.9953 / 0.9974 
                Val acc/f1/spec/sens = 0.9100 / 0.8816 / 0.8500 / 0.9429
                Test acc/f1/spec/sens = 0.6311 / 0.6466 / 0.7625 / 0.5476
 91%|█████████ | 91/100 [13:33<01:23,  9.27s/it] 92%|█████████▏| 92/100 [13:41<01:11,  8.91s/it] 93%|█████████▎| 93/100 [13:48<00:58,  8.43s/it] 94%|█████████▍| 94/100 [13:57<00:49,  8.32s/it] 95%|█████████▌| 95/100 [14:10<00:49,  9.88s/it]Epoch 95: Train acc/f1 = 0.9956 / 0.9948 / 0.9953 / 0.9957 
                Val acc/f1/spec/sens = 0.9150 / 0.8884 / 0.8667 / 0.9429
                Test acc/f1/spec/sens = 0.6393 / 0.6489 / 0.8000 / 0.4762
 96%|█████████▌| 96/100 [14:18<00:37,  9.33s/it] 97%|█████████▋| 97/100 [14:25<00:26,  8.74s/it] 98%|█████████▊| 98/100 [14:34<00:17,  8.54s/it] 99%|█████████▉| 99/100 [14:41<00:08,  8.19s/it]100%|██████████| 100/100 [14:55<00:00,  9.93s/it]                                                 Epoch 100: Train acc/f1 = 0.9967 / 0.9951 / 0.9968 / 0.9974 
                Val acc/f1/spec/sens = 0.9100 / 0.8816 / 0.8500 / 0.9429
                Test acc/f1/spec/sens = 0.6557 / 0.6665 / 0.7875 / 0.5476
specificity = 631/632
sensitivity = 1165/1168
specificity = 51/60
sensitivity = 132/140
specificity = 63/80
sensitivity = 23/42
Trial 5, Cycle 1
Train acc/f1/spec/sens = 0.9961 / 0.9931 / 0.9984 / 0.9974
Val acc/f1/spec/sens = 0.9100 / 0.8816 / 0.8500 / 0.9429
Test acc/f1/spec/sens = 0.6557 / 0.6665 / 0.7875 / 0.5476
>> Finished.
specificity = 63/80
sensitivity = 23/42
Acc, agreement for latest model:  0.6557377049180327 0.7049180327868853
Load best checkpoint for thief model
specificity = 64/80
sensitivity = 17/42
Acc, agreement for best model:  0.6311475409836066 0.6639344262295082
Trial 4/6 || Cycle 1/1 || Label set size 1800 || Test acc 0.6311 || Test agreement 0.6639 || Spec 0.8000 || Sens 0.4048
**************************************************************************************************** 

specificity = 64/80
sensitivity = 17/42
Number of samples  1800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/113 [00:00<?, ?it/s]  1%|          | 1/113 [00:00<01:07,  1.66it/s]  2%|▏         | 2/113 [00:00<00:44,  2.48it/s]  3%|▎         | 3/113 [00:01<00:37,  2.96it/s]  4%|▎         | 4/113 [00:01<00:33,  3.23it/s]  4%|▍         | 5/113 [00:01<00:31,  3.38it/s]  5%|▌         | 6/113 [00:01<00:30,  3.53it/s]  6%|▌         | 7/113 [00:02<00:29,  3.63it/s]  7%|▋         | 8/113 [00:02<00:27,  3.81it/s]  8%|▊         | 9/113 [00:02<00:25,  4.09it/s]  9%|▉         | 10/113 [00:02<00:24,  4.16it/s] 10%|▉         | 11/113 [00:03<00:24,  4.19it/s] 11%|█         | 12/113 [00:03<00:22,  4.43it/s] 12%|█▏        | 13/113 [00:03<00:21,  4.61it/s] 12%|█▏        | 14/113 [00:03<00:21,  4.52it/s] 13%|█▎        | 15/113 [00:03<00:21,  4.46it/s] 14%|█▍        | 16/113 [00:04<00:20,  4.62it/s] 15%|█▌        | 17/113 [00:04<00:20,  4.70it/s] 16%|█▌        | 18/113 [00:04<00:19,  4.79it/s] 17%|█▋        | 19/113 [00:04<00:19,  4.80it/s] 18%|█▊        | 20/113 [00:04<00:18,  4.90it/s] 19%|█▊        | 21/113 [00:05<00:18,  4.97it/s] 19%|█▉        | 22/113 [00:05<00:18,  4.99it/s] 20%|██        | 23/113 [00:05<00:17,  5.05it/s] 21%|██        | 24/113 [00:05<00:17,  5.08it/s] 22%|██▏       | 25/113 [00:05<00:17,  5.07it/s] 23%|██▎       | 26/113 [00:06<00:18,  4.68it/s] 24%|██▍       | 27/113 [00:06<00:18,  4.73it/s] 25%|██▍       | 28/113 [00:06<00:17,  4.83it/s] 26%|██▌       | 29/113 [00:06<00:17,  4.91it/s] 27%|██▋       | 30/113 [00:06<00:16,  4.94it/s] 27%|██▋       | 31/113 [00:07<00:16,  4.97it/s] 28%|██▊       | 32/113 [00:07<00:16,  5.03it/s] 29%|██▉       | 33/113 [00:07<00:15,  5.08it/s] 30%|███       | 34/113 [00:07<00:15,  5.13it/s] 31%|███       | 35/113 [00:07<00:15,  5.06it/s] 32%|███▏      | 36/113 [00:08<00:15,  5.07it/s] 33%|███▎      | 37/113 [00:08<00:15,  4.98it/s] 34%|███▎      | 38/113 [00:08<00:15,  4.99it/s] 35%|███▍      | 39/113 [00:08<00:14,  5.03it/s] 35%|███▌      | 40/113 [00:08<00:14,  5.11it/s] 36%|███▋      | 41/113 [00:09<00:14,  5.13it/s] 37%|███▋      | 42/113 [00:09<00:13,  5.09it/s] 38%|███▊      | 43/113 [00:09<00:13,  5.12it/s] 39%|███▉      | 44/113 [00:09<00:13,  5.16it/s] 40%|███▉      | 45/113 [00:09<00:13,  5.10it/s] 41%|████      | 46/113 [00:10<00:13,  5.11it/s] 42%|████▏     | 47/113 [00:10<00:12,  5.09it/s] 42%|████▏     | 48/113 [00:10<00:12,  5.02it/s] 43%|████▎     | 49/113 [00:10<00:12,  5.08it/s] 44%|████▍     | 50/113 [00:10<00:12,  5.07it/s] 45%|████▌     | 51/113 [00:11<00:12,  5.07it/s] 46%|████▌     | 52/113 [00:11<00:11,  5.09it/s] 47%|████▋     | 53/113 [00:11<00:11,  5.09it/s] 48%|████▊     | 54/113 [00:11<00:11,  5.07it/s] 49%|████▊     | 55/113 [00:11<00:11,  5.05it/s] 50%|████▉     | 56/113 [00:12<00:11,  5.10it/s] 50%|█████     | 57/113 [00:12<00:10,  5.10it/s] 51%|█████▏    | 58/113 [00:12<00:10,  5.08it/s] 52%|█████▏    | 59/113 [00:12<00:10,  5.07it/s] 53%|█████▎    | 60/113 [00:12<00:10,  5.09it/s] 54%|█████▍    | 61/113 [00:13<00:10,  5.10it/s] 55%|█████▍    | 62/113 [00:13<00:10,  5.10it/s] 56%|█████▌    | 63/113 [00:13<00:09,  5.08it/s] 57%|█████▋    | 64/113 [00:13<00:09,  5.11it/s] 58%|█████▊    | 65/113 [00:13<00:09,  5.05it/s] 58%|█████▊    | 66/113 [00:14<00:09,  5.05it/s] 59%|█████▉    | 67/113 [00:14<00:09,  4.99it/s] 60%|██████    | 68/113 [00:14<00:09,  4.90it/s] 61%|██████    | 69/113 [00:14<00:09,  4.55it/s] 62%|██████▏   | 70/113 [00:14<00:09,  4.43it/s] 63%|██████▎   | 71/113 [00:15<00:09,  4.56it/s] 64%|██████▎   | 72/113 [00:15<00:08,  4.56it/s] 65%|██████▍   | 73/113 [00:15<00:08,  4.68it/s] 65%|██████▌   | 74/113 [00:15<00:08,  4.81it/s] 66%|██████▋   | 75/113 [00:15<00:07,  4.92it/s] 67%|██████▋   | 76/113 [00:16<00:07,  4.95it/s] 68%|██████▊   | 77/113 [00:16<00:07,  4.99it/s] 69%|██████▉   | 78/113 [00:16<00:06,  5.06it/s] 70%|██████▉   | 79/113 [00:16<00:06,  5.10it/s] 71%|███████   | 80/113 [00:16<00:06,  5.12it/s] 72%|███████▏  | 81/113 [00:17<00:06,  5.13it/s] 73%|███████▎  | 82/113 [00:17<00:06,  5.12it/s] 73%|███████▎  | 83/113 [00:17<00:05,  5.14it/s] 74%|███████▍  | 84/113 [00:17<00:05,  5.17it/s] 75%|███████▌  | 85/113 [00:17<00:05,  5.02it/s] 76%|███████▌  | 86/113 [00:18<00:05,  4.62it/s] 77%|███████▋  | 87/113 [00:18<00:05,  4.40it/s] 78%|███████▊  | 88/113 [00:18<00:05,  4.29it/s] 79%|███████▉  | 89/113 [00:18<00:05,  4.11it/s] 80%|███████▉  | 90/113 [00:19<00:05,  4.05it/s] 81%|████████  | 91/113 [00:19<00:05,  3.99it/s] 81%|████████▏ | 92/113 [00:19<00:05,  3.98it/s] 82%|████████▏ | 93/113 [00:19<00:05,  3.96it/s] 83%|████████▎ | 94/113 [00:20<00:04,  3.98it/s] 84%|████████▍ | 95/113 [00:20<00:04,  3.93it/s] 85%|████████▍ | 96/113 [00:20<00:04,  3.96it/s] 86%|████████▌ | 97/113 [00:20<00:04,  3.98it/s] 87%|████████▋ | 98/113 [00:21<00:03,  3.95it/s] 88%|████████▊ | 99/113 [00:21<00:03,  4.19it/s] 88%|████████▊ | 100/113 [00:21<00:03,  4.32it/s] 89%|████████▉ | 101/113 [00:21<00:02,  4.54it/s] 90%|█████████ | 102/113 [00:22<00:02,  4.60it/s] 91%|█████████ | 103/113 [00:22<00:02,  4.74it/s] 92%|█████████▏| 104/113 [00:22<00:01,  4.71it/s] 93%|█████████▎| 105/113 [00:22<00:01,  4.79it/s] 94%|█████████▍| 106/113 [00:22<00:01,  4.91it/s] 95%|█████████▍| 107/113 [00:23<00:01,  4.98it/s] 96%|█████████▌| 108/113 [00:23<00:01,  5.00it/s] 96%|█████████▋| 109/113 [00:23<00:00,  5.04it/s] 97%|█████████▋| 110/113 [00:23<00:00,  5.09it/s] 98%|█████████▊| 111/113 [00:23<00:00,  5.07it/s] 99%|█████████▉| 112/113 [00:24<00:00,  4.93it/s]100%|██████████| 113/113 [00:24<00:00,  5.46it/s]100%|██████████| 113/113 [00:24<00:00,  4.65it/s]
replacing val labels with victim labels
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:07,  1.69it/s] 15%|█▌        | 2/13 [00:00<00:04,  2.45it/s] 23%|██▎       | 3/13 [00:01<00:03,  2.95it/s] 31%|███       | 4/13 [00:01<00:02,  3.22it/s] 38%|███▊      | 5/13 [00:01<00:02,  3.39it/s] 46%|████▌     | 6/13 [00:01<00:01,  3.52it/s] 54%|█████▍    | 7/13 [00:02<00:01,  3.56it/s] 62%|██████▏   | 8/13 [00:02<00:01,  3.60it/s] 69%|██████▉   | 9/13 [00:02<00:01,  3.67it/s] 77%|███████▋  | 10/13 [00:02<00:00,  3.74it/s] 85%|████████▍ | 11/13 [00:03<00:00,  3.74it/s] 92%|█████████▏| 12/13 [00:03<00:00,  3.70it/s]100%|██████████| 13/13 [00:03<00:00,  4.36it/s]100%|██████████| 13/13 [00:03<00:00,  3.48it/s]Validation set distribution: 
Number of samples  200

{0: 20, 1: 45, 2: 135}
Labeled set distribution: 
Number of samples  1800
{0: 237, 1: 404, 2: 1159}
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked', 'fc.weight', 'fc.bias'])
thief state:  None
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
specificity = 80/80
sensitivity = 0/42
Initial model on target dataset: acc = 0.4016, agreement = 0.3770, f1 = 0.1910, spec = 1.0000, sens = 0.0000
specificity = 65/65
sensitivity = 0/135
Initial model on validation dataset: acc = 0.2250, agreement = 0.2250, f1 = 0.1224, spec = 1.0000, sens = 0.0000
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<11:57,  7.25s/it]  2%|▏         | 2/100 [00:15<12:38,  7.74s/it]  3%|▎         | 3/100 [00:22<12:10,  7.53s/it]  4%|▍         | 4/100 [00:30<12:26,  7.78s/it]  5%|▌         | 5/100 [00:44<15:28,  9.77s/it]Epoch 5: Train acc/f1 = 0.8678 / 0.8311 / 0.9002 / 0.8982 
                Val acc/f1/spec/sens = 0.8500 / 0.8045 / 0.8769 / 0.8741
                Test acc/f1/spec/sens = 0.7459 / 0.7535 / 0.9000 / 0.7619
  6%|▌         | 6/100 [00:52<14:24,  9.20s/it]  7%|▋         | 7/100 [00:59<13:18,  8.58s/it]  8%|▊         | 8/100 [01:07<12:52,  8.40s/it]  9%|▉         | 9/100 [01:14<12:13,  8.06s/it] 10%|█         | 10/100 [01:29<14:56,  9.96s/it]Epoch 10: Train acc/f1 = 0.8983 / 0.8758 / 0.9735 / 0.8870 
                Val acc/f1/spec/sens = 0.8200 / 0.7680 / 0.9692 / 0.8074
                Test acc/f1/spec/sens = 0.6885 / 0.6815 / 0.9125 / 0.4524
 11%|█         | 11/100 [01:36<13:34,  9.16s/it] 12%|█▏        | 12/100 [01:44<12:56,  8.82s/it] 13%|█▎        | 13/100 [01:51<12:08,  8.37s/it] 14%|█▍        | 14/100 [01:59<11:50,  8.26s/it] 15%|█▌        | 15/100 [02:13<14:00,  9.88s/it]Epoch 15: Train acc/f1 = 0.9478 / 0.9316 / 0.9563 / 0.9620 
                Val acc/f1/spec/sens = 0.8350 / 0.7785 / 0.8769 / 0.8667
                Test acc/f1/spec/sens = 0.7377 / 0.7517 / 0.8625 / 0.6190
 16%|█▌        | 16/100 [02:21<13:08,  9.39s/it] 17%|█▋        | 17/100 [02:28<12:06,  8.76s/it] 18%|█▊        | 18/100 [02:36<11:40,  8.55s/it] 19%|█▉        | 19/100 [02:44<11:01,  8.17s/it] 20%|██        | 20/100 [02:58<13:24, 10.05s/it]Epoch 20: Train acc/f1 = 0.9633 / 0.9510 / 0.9860 / 0.9672 
                Val acc/f1/spec/sens = 0.8500 / 0.7805 / 0.8615 / 0.9037
                Test acc/f1/spec/sens = 0.7213 / 0.7307 / 0.8875 / 0.5952
 21%|██        | 21/100 [03:06<12:09,  9.24s/it] 22%|██▏       | 22/100 [03:14<11:31,  8.87s/it] 23%|██▎       | 23/100 [03:21<10:46,  8.39s/it] 24%|██▍       | 24/100 [03:29<10:30,  8.29s/it] 25%|██▌       | 25/100 [03:42<12:17,  9.83s/it]Epoch 25: Train acc/f1 = 0.9878 / 0.9844 / 0.9891 / 0.9905 
                Val acc/f1/spec/sens = 0.8700 / 0.7994 / 0.8923 / 0.9185
                Test acc/f1/spec/sens = 0.7213 / 0.7349 / 0.7750 / 0.7857
 26%|██▌       | 26/100 [03:50<11:27,  9.30s/it] 27%|██▋       | 27/100 [03:58<10:35,  8.70s/it] 28%|██▊       | 28/100 [04:06<10:12,  8.50s/it] 29%|██▉       | 29/100 [04:13<09:37,  8.14s/it] 30%|███       | 30/100 [04:27<11:36,  9.95s/it]Epoch 30: Train acc/f1 = 0.9883 / 0.9848 / 0.9969 / 0.9888 
                Val acc/f1/spec/sens = 0.8750 / 0.8020 / 0.9077 / 0.9185
                Test acc/f1/spec/sens = 0.7131 / 0.7229 / 0.7875 / 0.7857
 31%|███       | 31/100 [04:35<10:33,  9.18s/it] 32%|███▏      | 32/100 [04:43<10:06,  8.91s/it] 33%|███▎      | 33/100 [04:50<09:25,  8.44s/it] 34%|███▍      | 34/100 [04:58<09:09,  8.32s/it] 35%|███▌      | 35/100 [05:12<10:44,  9.92s/it]Epoch 35: Train acc/f1 = 0.9889 / 0.9845 / 0.9969 / 0.9905 
                Val acc/f1/spec/sens = 0.8800 / 0.8062 / 0.9077 / 0.9259
                Test acc/f1/spec/sens = 0.7131 / 0.7254 / 0.7750 / 0.7857
 36%|███▌      | 36/100 [05:20<09:58,  9.35s/it] 37%|███▋      | 37/100 [05:27<09:09,  8.73s/it] 38%|███▊      | 38/100 [05:35<08:48,  8.53s/it] 39%|███▉      | 39/100 [05:43<08:18,  8.16s/it] 40%|████      | 40/100 [05:57<09:55,  9.93s/it]Epoch 40: Train acc/f1 = 0.9928 / 0.9911 / 0.9984 / 0.9914 
                Val acc/f1/spec/sens = 0.8850 / 0.8104 / 0.9077 / 0.9333
                Test acc/f1/spec/sens = 0.7459 / 0.7567 / 0.8250 / 0.7857
 41%|████      | 41/100 [06:04<08:59,  9.15s/it] 42%|████▏     | 42/100 [06:12<08:33,  8.85s/it] 43%|████▎     | 43/100 [06:19<07:58,  8.39s/it] 44%|████▍     | 44/100 [06:27<07:44,  8.29s/it] 45%|████▌     | 45/100 [06:41<08:59,  9.82s/it]Epoch 45: Train acc/f1 = 0.9944 / 0.9934 / 1.0000 / 0.9931 
                Val acc/f1/spec/sens = 0.8850 / 0.8132 / 0.9077 / 0.9333
                Test acc/f1/spec/sens = 0.7049 / 0.7185 / 0.8250 / 0.6905
 46%|████▌     | 46/100 [06:49<08:21,  9.28s/it] 47%|████▋     | 47/100 [06:56<07:40,  8.69s/it] 48%|████▊     | 48/100 [07:04<07:22,  8.51s/it] 49%|████▉     | 49/100 [07:12<06:55,  8.14s/it] 50%|█████     | 50/100 [07:26<08:20, 10.00s/it]Epoch 50: Train acc/f1 = 0.9939 / 0.9919 / 0.9906 / 0.9983 
                Val acc/f1/spec/sens = 0.8850 / 0.8118 / 0.8923 / 0.9407
                Test acc/f1/spec/sens = 0.7213 / 0.7298 / 0.7875 / 0.8095
 51%|█████     | 51/100 [07:33<07:31,  9.21s/it] 52%|█████▏    | 52/100 [07:41<07:05,  8.86s/it] 53%|█████▎    | 53/100 [07:49<06:34,  8.40s/it] 54%|█████▍    | 54/100 [07:57<06:20,  8.28s/it] 55%|█████▌    | 55/100 [08:10<07:23,  9.86s/it]Epoch 55: Train acc/f1 = 0.9939 / 0.9914 / 0.9969 / 0.9957 
                Val acc/f1/spec/sens = 0.8800 / 0.8090 / 0.9077 / 0.9259
                Test acc/f1/spec/sens = 0.7131 / 0.7251 / 0.8000 / 0.7381
 56%|█████▌    | 56/100 [08:18<06:50,  9.32s/it] 57%|█████▋    | 57/100 [08:26<06:14,  8.72s/it] 58%|█████▊    | 58/100 [08:34<05:58,  8.53s/it] 59%|█████▉    | 59/100 [08:41<05:34,  8.15s/it] 60%|██████    | 60/100 [08:55<06:36,  9.92s/it]Epoch 60: Train acc/f1 = 0.9917 / 0.9886 / 0.9953 / 0.9931 
                Val acc/f1/spec/sens = 0.8800 / 0.8125 / 0.8769 / 0.9333
                Test acc/f1/spec/sens = 0.7131 / 0.7220 / 0.8125 / 0.7381
 61%|██████    | 61/100 [09:02<05:56,  9.15s/it] 62%|██████▏   | 62/100 [09:10<05:34,  8.81s/it] 63%|██████▎   | 63/100 [09:18<05:09,  8.36s/it] 64%|██████▍   | 64/100 [09:26<04:57,  8.27s/it] 65%|██████▌   | 65/100 [09:39<05:47,  9.92s/it]Epoch 65: Train acc/f1 = 0.9939 / 0.9902 / 0.9969 / 0.9974 
                Val acc/f1/spec/sens = 0.8800 / 0.8090 / 0.9077 / 0.9259
                Test acc/f1/spec/sens = 0.7213 / 0.7253 / 0.7750 / 0.8333
 66%|██████▌   | 66/100 [09:47<05:17,  9.34s/it] 67%|██████▋   | 67/100 [09:55<04:48,  8.75s/it] 68%|██████▊   | 68/100 [10:03<04:33,  8.53s/it] 69%|██████▉   | 69/100 [10:10<04:13,  8.16s/it] 70%|███████   | 70/100 [10:25<05:01, 10.04s/it]Epoch 70: Train acc/f1 = 0.9922 / 0.9894 / 0.9984 / 0.9914 
                Val acc/f1/spec/sens = 0.8850 / 0.8104 / 0.9077 / 0.9333
                Test acc/f1/spec/sens = 0.7377 / 0.7467 / 0.8000 / 0.8095
 71%|███████   | 71/100 [10:32<04:27,  9.23s/it] 72%|███████▏  | 72/100 [10:40<04:08,  8.88s/it] 73%|███████▎  | 73/100 [10:47<03:47,  8.42s/it] 74%|███████▍  | 74/100 [10:55<03:36,  8.31s/it] 75%|███████▌  | 75/100 [11:09<04:08,  9.93s/it]Epoch 75: Train acc/f1 = 0.9944 / 0.9930 / 0.9953 / 0.9940 
                Val acc/f1/spec/sens = 0.8900 / 0.8174 / 0.9077 / 0.9407
                Test acc/f1/spec/sens = 0.7295 / 0.7422 / 0.8250 / 0.7381
 76%|███████▌  | 76/100 [11:17<03:44,  9.36s/it] 77%|███████▋  | 77/100 [11:24<03:21,  8.75s/it] 78%|███████▊  | 78/100 [11:33<03:09,  8.63s/it] 79%|███████▉  | 79/100 [11:40<02:53,  8.25s/it] 80%|████████  | 80/100 [11:54<03:19,  9.97s/it]Epoch 80: Train acc/f1 = 0.9956 / 0.9950 / 0.9938 / 0.9965 
                Val acc/f1/spec/sens = 0.8850 / 0.8132 / 0.9077 / 0.9333
                Test acc/f1/spec/sens = 0.7377 / 0.7494 / 0.8000 / 0.8095
 81%|████████  | 81/100 [12:01<02:54,  9.19s/it] 82%|████████▏ | 82/100 [12:10<02:39,  8.84s/it] 83%|████████▎ | 83/100 [12:17<02:22,  8.38s/it] 84%|████████▍ | 84/100 [12:25<02:12,  8.27s/it] 85%|████████▌ | 85/100 [12:38<02:26,  9.79s/it]Epoch 85: Train acc/f1 = 0.9950 / 0.9936 / 0.9984 / 0.9948 
                Val acc/f1/spec/sens = 0.8800 / 0.8062 / 0.9077 / 0.9259
                Test acc/f1/spec/sens = 0.7295 / 0.7401 / 0.8125 / 0.7857
 86%|████████▌ | 86/100 [12:46<02:09,  9.26s/it] 87%|████████▋ | 87/100 [12:54<01:52,  8.68s/it] 88%|████████▊ | 88/100 [13:02<01:41,  8.48s/it] 89%|████████▉ | 89/100 [13:09<01:29,  8.12s/it] 90%|█████████ | 90/100 [13:23<01:39,  9.90s/it]Epoch 90: Train acc/f1 = 0.9939 / 0.9919 / 0.9953 / 0.9948 
                Val acc/f1/spec/sens = 0.8800 / 0.8090 / 0.9077 / 0.9259
                Test acc/f1/spec/sens = 0.7295 / 0.7401 / 0.8250 / 0.7619
 91%|█████████ | 91/100 [13:30<01:22,  9.15s/it] 92%|█████████▏| 92/100 [13:39<01:11,  8.92s/it] 93%|█████████▎| 93/100 [13:46<00:59,  8.46s/it] 94%|█████████▍| 94/100 [13:54<00:50,  8.36s/it] 95%|█████████▌| 95/100 [14:08<00:49,  9.98s/it]Epoch 95: Train acc/f1 = 0.9933 / 0.9911 / 0.9984 / 0.9922 
                Val acc/f1/spec/sens = 0.8850 / 0.8132 / 0.9077 / 0.9333
                Test acc/f1/spec/sens = 0.7295 / 0.7425 / 0.8125 / 0.7619
 96%|█████████▌| 96/100 [14:16<00:37,  9.41s/it] 97%|█████████▋| 97/100 [14:23<00:26,  8.79s/it] 98%|█████████▊| 98/100 [14:31<00:17,  8.57s/it] 99%|█████████▉| 99/100 [14:39<00:08,  8.20s/it]100%|██████████| 100/100 [14:53<00:00, 10.01s/it]                                                 Epoch 100: Train acc/f1 = 0.9933 / 0.9905 / 0.9969 / 0.9948 
                Val acc/f1/spec/sens = 0.8850 / 0.8166 / 0.8769 / 0.9407
                Test acc/f1/spec/sens = 0.7295 / 0.7367 / 0.7875 / 0.8333
specificity = 639/641
sensitivity = 1154/1159
specificity = 57/65
sensitivity = 127/135
specificity = 63/80
sensitivity = 35/42
Trial 6, Cycle 1
Train acc/f1/spec/sens = 0.9961 / 0.9958 / 0.9969 / 0.9957
Val acc/f1/spec/sens = 0.8850 / 0.8166 / 0.8769 / 0.9407
Test acc/f1/spec/sens = 0.7295 / 0.7367 / 0.7875 / 0.8333
>> Finished.
specificity = 63/80
sensitivity = 35/42
Acc, agreement for latest model:  0.7295081967213115 0.7377049180327869
Load best checkpoint for thief model
specificity = 61/80
sensitivity = 36/42
Acc, agreement for best model:  0.7295081967213115 0.7377049180327869
Trial 5/6 || Cycle 1/1 || Label set size 1800 || Test acc 0.7295 || Test agreement 0.7377 || Spec 0.7625 || Sens 0.8571
**************************************************************************************************** 

specificity = 61/80
sensitivity = 36/42
Number of samples  1800
0.7049180327868853 0.03412567212239566
        acc       agr    spec      sens                 label dist
0  0.672131  0.663934  0.8250  0.595238  {0: 234, 1: 417, 2: 1149}
1  0.762295  0.745902  0.8750  0.785714  {0: 222, 1: 449, 2: 1129}
2  0.713115  0.688525  0.9000  0.547619  {0: 223, 1: 411, 2: 1166}
3  0.754098  0.729508  0.9000  0.714286  {0: 246, 1: 414, 2: 1140}
4  0.631148  0.663934  0.8000  0.404762  {0: 186, 1: 446, 2: 1168}
5  0.729508  0.737705  0.7625  0.857143  {0: 237, 1: 404, 2: 1159}
Results saved to  /home/deepankar/scratch/MSA_Medical/results_1k/gbusg_radformer/GBUSV_resnet50/SGD/2000_val200/random_v3
