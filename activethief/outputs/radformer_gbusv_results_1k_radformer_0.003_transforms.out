[24/02/29 15:34:25] [conf.py:  298]: PyTorch Version: torch=1.11.0, cuda=11.3, cudnn=8200
[24/02/29 15:34:25] [conf.py:  300]: ACTIVE:
  ADDENDUM: 0
  ALPHA: 0.0
  AUGMENT: None
  BETA: 1.0
  BUDGET: 1000
  CUTMIX_PROB: 0.0
  CYCLES: 1
  INITIAL: 900
  LA: False
  METHOD: random
  PRETRAINED_PATH: /home/deepankar/mnt/vision3_data_ckpts_msa_medical/ckpts/resnet50-imagenet1k.pth
  TEMP: 1.0
  TRO: 1.0
  USE_PRETRAINED: False
  VAL: 100
AM:
  SGR: 1000
  THRESHOLD: 0.5
CUDNN_BENCHMARK: True
DS_SEED: 123
EDM:
  HASH: /home/harsh_s/scratch/msacopy/exp/hash/alpha.pt
  NUM_MODELS: 5
  PATH1: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T0.pt
  PATH2: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T1.pt
  PATH3: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T2.pt
  PATH4: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T3.pt
  PATH5: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T4.pt
GR:
  EPSILON: 0.1
  SUR_PATH: /home/harsh_s/scratch/msacopy/GRAD2/batch_training/outputs/trained_models/imagenet_cifar10_to_cifar10_surrogate_10epochs.pt
LOG_DEST: radformer_radformer_gbusv_240229_153425.txt
LOG_TIME: 240229_153425
METHOD_NAME: v1_transforms
OUT_DIR: /home/deepankar/scratch/MSA_Medical/results_1k
PL:
  CLASS_BLNC: 10
  ITERATIONS: 20
  KAPPA_N: 0.005
  KAPPA_P: 0.05
  NO_PROGRESS: False
  NO_UNCERTAINTY: False
  TAU_N: 0.05
  TAU_P: 0.7
  TEMP_NL: 2.0
RNG_SEED: 5
SAVE_DIR: /home/deepankar/scratch/MSA_Medical/results_1k/gbusg_radformer/GBUSV_radformer/SGD/1000_val100/random_v1_transforms
THIEF:
  ARCH: radformer
  DATASET: GBUSV
  DATA_ROOT: /home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBUSV-Shared
  HARD_LABELS: True
  NUM_TRAIN: 1281167
  SUBSET: 128116
TRAIN:
  BATCH: 32
  EPOCH: 50
  GAMMA: 0.1
  LR: 0.0003
  MILESTONES: [10, 20, 30, 40]
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  WDECAY: 0.0005
VICTIM:
  ARCH: radformer
  DATASET: gbusg
  DATA_ROOT: /home/deepankar/mnt/vision3_data_ckpts_msa_medical/GBCU-Shared
  HEIGHT: 224
  PATH: /home/deepankar/mnt/vision3_data_ckpts_msa_medical/victim_models/radformer/radformer.pkl
  PATHIN: /home/harsh_s/scratch/msacopy/ckpts/cifar10-resnet32-inaccurate/checkpoint.pth.tar
  WIDTH: 224
Loaded target dataset of size 122 with 3 classes
target model keys:  695
checkpoint keys:  695
specificity = 72/80
sensitivity = 39/42

Target model acc = 0.9016393442622951
Val-Acc: 0.9016 Val-Spec: 0.9000 Val-Sens: 0.9286
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:27,  1.00it/s]  7%|▋         | 2/29 [00:01<00:19,  1.38it/s] 10%|█         | 3/29 [00:02<00:16,  1.57it/s] 14%|█▍        | 4/29 [00:02<00:15,  1.66it/s] 17%|█▋        | 5/29 [00:03<00:13,  1.77it/s] 21%|██        | 6/29 [00:03<00:13,  1.67it/s] 24%|██▍       | 7/29 [00:04<00:13,  1.68it/s] 28%|██▊       | 8/29 [00:04<00:12,  1.66it/s] 31%|███       | 9/29 [00:05<00:12,  1.62it/s] 34%|███▍      | 10/29 [00:06<00:11,  1.67it/s] 38%|███▊      | 11/29 [00:06<00:10,  1.72it/s] 41%|████▏     | 12/29 [00:07<00:11,  1.51it/s] 45%|████▍     | 13/29 [00:08<00:10,  1.52it/s] 48%|████▊     | 14/29 [00:09<00:10,  1.39it/s] 52%|█████▏    | 15/29 [00:09<00:10,  1.37it/s] 55%|█████▌    | 16/29 [00:10<00:09,  1.36it/s] 59%|█████▊    | 17/29 [00:11<00:09,  1.26it/s] 62%|██████▏   | 18/29 [00:12<00:08,  1.36it/s] 66%|██████▌   | 19/29 [00:12<00:07,  1.40it/s] 69%|██████▉   | 20/29 [00:13<00:06,  1.40it/s] 72%|███████▏  | 21/29 [00:14<00:05,  1.41it/s] 76%|███████▌  | 22/29 [00:14<00:04,  1.44it/s] 79%|███████▉  | 23/29 [00:15<00:03,  1.51it/s] 83%|████████▎ | 24/29 [00:15<00:03,  1.58it/s] 86%|████████▌ | 25/29 [00:16<00:02,  1.61it/s] 90%|████████▉ | 26/29 [00:17<00:01,  1.59it/s] 93%|█████████▎| 27/29 [00:17<00:01,  1.66it/s] 97%|█████████▋| 28/29 [00:18<00:00,  1.53it/s]100%|██████████| 29/29 [00:18<00:00,  1.54it/s]
replacing val labels with victim labels
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.35s/it] 50%|█████     | 2/4 [00:02<00:01,  1.01it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.09it/s]100%|██████████| 4/4 [00:03<00:00,  1.65it/s]100%|██████████| 4/4 [00:03<00:00,  1.26it/s]Validation set distribution: 
Number of samples  100

{0: 9, 1: 18, 2: 73}
Labeled set distribution: 
Number of samples  900
{0: 111, 1: 200, 2: 589}
odict_keys(['global_branch.net.conv1.weight', 'global_branch.net.bn1.weight', 'global_branch.net.bn1.bias', 'global_branch.net.bn1.running_mean', 'global_branch.net.bn1.running_var', 'global_branch.net.bn1.num_batches_tracked', 'global_branch.net.layer1.0.conv1.weight', 'global_branch.net.layer1.0.bn1.weight', 'global_branch.net.layer1.0.bn1.bias', 'global_branch.net.layer1.0.bn1.running_mean', 'global_branch.net.layer1.0.bn1.running_var', 'global_branch.net.layer1.0.bn1.num_batches_tracked', 'global_branch.net.layer1.0.conv2.weight', 'global_branch.net.layer1.0.bn2.weight', 'global_branch.net.layer1.0.bn2.bias', 'global_branch.net.layer1.0.bn2.running_mean', 'global_branch.net.layer1.0.bn2.running_var', 'global_branch.net.layer1.0.bn2.num_batches_tracked', 'global_branch.net.layer1.0.conv3.weight', 'global_branch.net.layer1.0.bn3.weight', 'global_branch.net.layer1.0.bn3.bias', 'global_branch.net.layer1.0.bn3.running_mean', 'global_branch.net.layer1.0.bn3.running_var', 'global_branch.net.layer1.0.bn3.num_batches_tracked', 'global_branch.net.layer1.0.downsample.0.weight', 'global_branch.net.layer1.0.downsample.1.weight', 'global_branch.net.layer1.0.downsample.1.bias', 'global_branch.net.layer1.0.downsample.1.running_mean', 'global_branch.net.layer1.0.downsample.1.running_var', 'global_branch.net.layer1.0.downsample.1.num_batches_tracked', 'global_branch.net.layer1.1.conv1.weight', 'global_branch.net.layer1.1.bn1.weight', 'global_branch.net.layer1.1.bn1.bias', 'global_branch.net.layer1.1.bn1.running_mean', 'global_branch.net.layer1.1.bn1.running_var', 'global_branch.net.layer1.1.bn1.num_batches_tracked', 'global_branch.net.layer1.1.conv2.weight', 'global_branch.net.layer1.1.bn2.weight', 'global_branch.net.layer1.1.bn2.bias', 'global_branch.net.layer1.1.bn2.running_mean', 'global_branch.net.layer1.1.bn2.running_var', 'global_branch.net.layer1.1.bn2.num_batches_tracked', 'global_branch.net.layer1.1.conv3.weight', 'global_branch.net.layer1.1.bn3.weight', 'global_branch.net.layer1.1.bn3.bias', 'global_branch.net.layer1.1.bn3.running_mean', 'global_branch.net.layer1.1.bn3.running_var', 'global_branch.net.layer1.1.bn3.num_batches_tracked', 'global_branch.net.layer1.2.conv1.weight', 'global_branch.net.layer1.2.bn1.weight', 'global_branch.net.layer1.2.bn1.bias', 'global_branch.net.layer1.2.bn1.running_mean', 'global_branch.net.layer1.2.bn1.running_var', 'global_branch.net.layer1.2.bn1.num_batches_tracked', 'global_branch.net.layer1.2.conv2.weight', 'global_branch.net.layer1.2.bn2.weight', 'global_branch.net.layer1.2.bn2.bias', 'global_branch.net.layer1.2.bn2.running_mean', 'global_branch.net.layer1.2.bn2.running_var', 'global_branch.net.layer1.2.bn2.num_batches_tracked', 'global_branch.net.layer1.2.conv3.weight', 'global_branch.net.layer1.2.bn3.weight', 'global_branch.net.layer1.2.bn3.bias', 'global_branch.net.layer1.2.bn3.running_mean', 'global_branch.net.layer1.2.bn3.running_var', 'global_branch.net.layer1.2.bn3.num_batches_tracked', 'global_branch.net.layer2.0.conv1.weight', 'global_branch.net.layer2.0.bn1.weight', 'global_branch.net.layer2.0.bn1.bias', 'global_branch.net.layer2.0.bn1.running_mean', 'global_branch.net.layer2.0.bn1.running_var', 'global_branch.net.layer2.0.bn1.num_batches_tracked', 'global_branch.net.layer2.0.conv2.weight', 'global_branch.net.layer2.0.bn2.weight', 'global_branch.net.layer2.0.bn2.bias', 'global_branch.net.layer2.0.bn2.running_mean', 'global_branch.net.layer2.0.bn2.running_var', 'global_branch.net.layer2.0.bn2.num_batches_tracked', 'global_branch.net.layer2.0.conv3.weight', 'global_branch.net.layer2.0.bn3.weight', 'global_branch.net.layer2.0.bn3.bias', 'global_branch.net.layer2.0.bn3.running_mean', 'global_branch.net.layer2.0.bn3.running_var', 'global_branch.net.layer2.0.bn3.num_batches_tracked', 'global_branch.net.layer2.0.downsample.0.weight', 'global_branch.net.layer2.0.downsample.1.weight', 'global_branch.net.layer2.0.downsample.1.bias', 'global_branch.net.layer2.0.downsample.1.running_mean', 'global_branch.net.layer2.0.downsample.1.running_var', 'global_branch.net.layer2.0.downsample.1.num_batches_tracked', 'global_branch.net.layer2.1.conv1.weight', 'global_branch.net.layer2.1.bn1.weight', 'global_branch.net.layer2.1.bn1.bias', 'global_branch.net.layer2.1.bn1.running_mean', 'global_branch.net.layer2.1.bn1.running_var', 'global_branch.net.layer2.1.bn1.num_batches_tracked', 'global_branch.net.layer2.1.conv2.weight', 'global_branch.net.layer2.1.bn2.weight', 'global_branch.net.layer2.1.bn2.bias', 'global_branch.net.layer2.1.bn2.running_mean', 'global_branch.net.layer2.1.bn2.running_var', 'global_branch.net.layer2.1.bn2.num_batches_tracked', 'global_branch.net.layer2.1.conv3.weight', 'global_branch.net.layer2.1.bn3.weight', 'global_branch.net.layer2.1.bn3.bias', 'global_branch.net.layer2.1.bn3.running_mean', 'global_branch.net.layer2.1.bn3.running_var', 'global_branch.net.layer2.1.bn3.num_batches_tracked', 'global_branch.net.layer2.2.conv1.weight', 'global_branch.net.layer2.2.bn1.weight', 'global_branch.net.layer2.2.bn1.bias', 'global_branch.net.layer2.2.bn1.running_mean', 'global_branch.net.layer2.2.bn1.running_var', 'global_branch.net.layer2.2.bn1.num_batches_tracked', 'global_branch.net.layer2.2.conv2.weight', 'global_branch.net.layer2.2.bn2.weight', 'global_branch.net.layer2.2.bn2.bias', 'global_branch.net.layer2.2.bn2.running_mean', 'global_branch.net.layer2.2.bn2.running_var', 'global_branch.net.layer2.2.bn2.num_batches_tracked', 'global_branch.net.layer2.2.conv3.weight', 'global_branch.net.layer2.2.bn3.weight', 'global_branch.net.layer2.2.bn3.bias', 'global_branch.net.layer2.2.bn3.running_mean', 'global_branch.net.layer2.2.bn3.running_var', 'global_branch.net.layer2.2.bn3.num_batches_tracked', 'global_branch.net.layer2.3.conv1.weight', 'global_branch.net.layer2.3.bn1.weight', 'global_branch.net.layer2.3.bn1.bias', 'global_branch.net.layer2.3.bn1.running_mean', 'global_branch.net.layer2.3.bn1.running_var', 'global_branch.net.layer2.3.bn1.num_batches_tracked', 'global_branch.net.layer2.3.conv2.weight', 'global_branch.net.layer2.3.bn2.weight', 'global_branch.net.layer2.3.bn2.bias', 'global_branch.net.layer2.3.bn2.running_mean', 'global_branch.net.layer2.3.bn2.running_var', 'global_branch.net.layer2.3.bn2.num_batches_tracked', 'global_branch.net.layer2.3.conv3.weight', 'global_branch.net.layer2.3.bn3.weight', 'global_branch.net.layer2.3.bn3.bias', 'global_branch.net.layer2.3.bn3.running_mean', 'global_branch.net.layer2.3.bn3.running_var', 'global_branch.net.layer2.3.bn3.num_batches_tracked', 'global_branch.net.layer3.0.conv1.weight', 'global_branch.net.layer3.0.bn1.weight', 'global_branch.net.layer3.0.bn1.bias', 'global_branch.net.layer3.0.bn1.running_mean', 'global_branch.net.layer3.0.bn1.running_var', 'global_branch.net.layer3.0.bn1.num_batches_tracked', 'global_branch.net.layer3.0.conv2.weight', 'global_branch.net.layer3.0.bn2.weight', 'global_branch.net.layer3.0.bn2.bias', 'global_branch.net.layer3.0.bn2.running_mean', 'global_branch.net.layer3.0.bn2.running_var', 'global_branch.net.layer3.0.bn2.num_batches_tracked', 'global_branch.net.layer3.0.conv3.weight', 'global_branch.net.layer3.0.bn3.weight', 'global_branch.net.layer3.0.bn3.bias', 'global_branch.net.layer3.0.bn3.running_mean', 'global_branch.net.layer3.0.bn3.running_var', 'global_branch.net.layer3.0.bn3.num_batches_tracked', 'global_branch.net.layer3.0.downsample.0.weight', 'global_branch.net.layer3.0.downsample.1.weight', 'global_branch.net.layer3.0.downsample.1.bias', 'global_branch.net.layer3.0.downsample.1.running_mean', 'global_branch.net.layer3.0.downsample.1.running_var', 'global_branch.net.layer3.0.downsample.1.num_batches_tracked', 'global_branch.net.layer3.1.conv1.weight', 'global_branch.net.layer3.1.bn1.weight', 'global_branch.net.layer3.1.bn1.bias', 'global_branch.net.layer3.1.bn1.running_mean', 'global_branch.net.layer3.1.bn1.running_var', 'global_branch.net.layer3.1.bn1.num_batches_tracked', 'global_branch.net.layer3.1.conv2.weight', 'global_branch.net.layer3.1.bn2.weight', 'global_branch.net.layer3.1.bn2.bias', 'global_branch.net.layer3.1.bn2.running_mean', 'global_branch.net.layer3.1.bn2.running_var', 'global_branch.net.layer3.1.bn2.num_batches_tracked', 'global_branch.net.layer3.1.conv3.weight', 'global_branch.net.layer3.1.bn3.weight', 'global_branch.net.layer3.1.bn3.bias', 'global_branch.net.layer3.1.bn3.running_mean', 'global_branch.net.layer3.1.bn3.running_var', 'global_branch.net.layer3.1.bn3.num_batches_tracked', 'global_branch.net.layer3.2.conv1.weight', 'global_branch.net.layer3.2.bn1.weight', 'global_branch.net.layer3.2.bn1.bias', 'global_branch.net.layer3.2.bn1.running_mean', 'global_branch.net.layer3.2.bn1.running_var', 'global_branch.net.layer3.2.bn1.num_batches_tracked', 'global_branch.net.layer3.2.conv2.weight', 'global_branch.net.layer3.2.bn2.weight', 'global_branch.net.layer3.2.bn2.bias', 'global_branch.net.layer3.2.bn2.running_mean', 'global_branch.net.layer3.2.bn2.running_var', 'global_branch.net.layer3.2.bn2.num_batches_tracked', 'global_branch.net.layer3.2.conv3.weight', 'global_branch.net.layer3.2.bn3.weight', 'global_branch.net.layer3.2.bn3.bias', 'global_branch.net.layer3.2.bn3.running_mean', 'global_branch.net.layer3.2.bn3.running_var', 'global_branch.net.layer3.2.bn3.num_batches_tracked', 'global_branch.net.layer3.3.conv1.weight', 'global_branch.net.layer3.3.bn1.weight', 'global_branch.net.layer3.3.bn1.bias', 'global_branch.net.layer3.3.bn1.running_mean', 'global_branch.net.layer3.3.bn1.running_var', 'global_branch.net.layer3.3.bn1.num_batches_tracked', 'global_branch.net.layer3.3.conv2.weight', 'global_branch.net.layer3.3.bn2.weight', 'global_branch.net.layer3.3.bn2.bias', 'global_branch.net.layer3.3.bn2.running_mean', 'global_branch.net.layer3.3.bn2.running_var', 'global_branch.net.layer3.3.bn2.num_batches_tracked', 'global_branch.net.layer3.3.conv3.weight', 'global_branch.net.layer3.3.bn3.weight', 'global_branch.net.layer3.3.bn3.bias', 'global_branch.net.layer3.3.bn3.running_mean', 'global_branch.net.layer3.3.bn3.running_var', 'global_branch.net.layer3.3.bn3.num_batches_tracked', 'global_branch.net.layer3.4.conv1.weight', 'global_branch.net.layer3.4.bn1.weight', 'global_branch.net.layer3.4.bn1.bias', 'global_branch.net.layer3.4.bn1.running_mean', 'global_branch.net.layer3.4.bn1.running_var', 'global_branch.net.layer3.4.bn1.num_batches_tracked', 'global_branch.net.layer3.4.conv2.weight', 'global_branch.net.layer3.4.bn2.weight', 'global_branch.net.layer3.4.bn2.bias', 'global_branch.net.layer3.4.bn2.running_mean', 'global_branch.net.layer3.4.bn2.running_var', 'global_branch.net.layer3.4.bn2.num_batches_tracked', 'global_branch.net.layer3.4.conv3.weight', 'global_branch.net.layer3.4.bn3.weight', 'global_branch.net.layer3.4.bn3.bias', 'global_branch.net.layer3.4.bn3.running_mean', 'global_branch.net.layer3.4.bn3.running_var', 'global_branch.net.layer3.4.bn3.num_batches_tracked', 'global_branch.net.layer3.5.conv1.weight', 'global_branch.net.layer3.5.bn1.weight', 'global_branch.net.layer3.5.bn1.bias', 'global_branch.net.layer3.5.bn1.running_mean', 'global_branch.net.layer3.5.bn1.running_var', 'global_branch.net.layer3.5.bn1.num_batches_tracked', 'global_branch.net.layer3.5.conv2.weight', 'global_branch.net.layer3.5.bn2.weight', 'global_branch.net.layer3.5.bn2.bias', 'global_branch.net.layer3.5.bn2.running_mean', 'global_branch.net.layer3.5.bn2.running_var', 'global_branch.net.layer3.5.bn2.num_batches_tracked', 'global_branch.net.layer3.5.conv3.weight', 'global_branch.net.layer3.5.bn3.weight', 'global_branch.net.layer3.5.bn3.bias', 'global_branch.net.layer3.5.bn3.running_mean', 'global_branch.net.layer3.5.bn3.running_var', 'global_branch.net.layer3.5.bn3.num_batches_tracked', 'global_branch.net.layer4.0.conv1.weight', 'global_branch.net.layer4.0.bn1.weight', 'global_branch.net.layer4.0.bn1.bias', 'global_branch.net.layer4.0.bn1.running_mean', 'global_branch.net.layer4.0.bn1.running_var', 'global_branch.net.layer4.0.bn1.num_batches_tracked', 'global_branch.net.layer4.0.conv2.weight', 'global_branch.net.layer4.0.bn2.weight', 'global_branch.net.layer4.0.bn2.bias', 'global_branch.net.layer4.0.bn2.running_mean', 'global_branch.net.layer4.0.bn2.running_var', 'global_branch.net.layer4.0.bn2.num_batches_tracked', 'global_branch.net.layer4.0.conv3.weight', 'global_branch.net.layer4.0.bn3.weight', 'global_branch.net.layer4.0.bn3.bias', 'global_branch.net.layer4.0.bn3.running_mean', 'global_branch.net.layer4.0.bn3.running_var', 'global_branch.net.layer4.0.bn3.num_batches_tracked', 'global_branch.net.layer4.0.downsample.0.weight', 'global_branch.net.layer4.0.downsample.1.weight', 'global_branch.net.layer4.0.downsample.1.bias', 'global_branch.net.layer4.0.downsample.1.running_mean', 'global_branch.net.layer4.0.downsample.1.running_var', 'global_branch.net.layer4.0.downsample.1.num_batches_tracked', 'global_branch.net.layer4.1.conv1.weight', 'global_branch.net.layer4.1.bn1.weight', 'global_branch.net.layer4.1.bn1.bias', 'global_branch.net.layer4.1.bn1.running_mean', 'global_branch.net.layer4.1.bn1.running_var', 'global_branch.net.layer4.1.bn1.num_batches_tracked', 'global_branch.net.layer4.1.conv2.weight', 'global_branch.net.layer4.1.bn2.weight', 'global_branch.net.layer4.1.bn2.bias', 'global_branch.net.layer4.1.bn2.running_mean', 'global_branch.net.layer4.1.bn2.running_var', 'global_branch.net.layer4.1.bn2.num_batches_tracked', 'global_branch.net.layer4.1.conv3.weight', 'global_branch.net.layer4.1.bn3.weight', 'global_branch.net.layer4.1.bn3.bias', 'global_branch.net.layer4.1.bn3.running_mean', 'global_branch.net.layer4.1.bn3.running_var', 'global_branch.net.layer4.1.bn3.num_batches_tracked', 'global_branch.net.layer4.2.conv1.weight', 'global_branch.net.layer4.2.bn1.weight', 'global_branch.net.layer4.2.bn1.bias', 'global_branch.net.layer4.2.bn1.running_mean', 'global_branch.net.layer4.2.bn1.running_var', 'global_branch.net.layer4.2.bn1.num_batches_tracked', 'global_branch.net.layer4.2.conv2.weight', 'global_branch.net.layer4.2.bn2.weight', 'global_branch.net.layer4.2.bn2.bias', 'global_branch.net.layer4.2.bn2.running_mean', 'global_branch.net.layer4.2.bn2.running_var', 'global_branch.net.layer4.2.bn2.num_batches_tracked', 'global_branch.net.layer4.2.conv3.weight', 'global_branch.net.layer4.2.bn3.weight', 'global_branch.net.layer4.2.bn3.bias', 'global_branch.net.layer4.2.bn3.running_mean', 'global_branch.net.layer4.2.bn3.running_var', 'global_branch.net.layer4.2.bn3.num_batches_tracked', 'global_branch.net.fc.weight', 'global_branch.net.fc.bias', 'local_branch.conv1.weight', 'local_branch.conv2.weight', 'local_branch.bn1.weight', 'local_branch.bn1.bias', 'local_branch.bn1.running_mean', 'local_branch.bn1.running_var', 'local_branch.bn1.num_batches_tracked', 'local_branch.layer1.0.conv1.weight', 'local_branch.layer1.0.bn1.weight', 'local_branch.layer1.0.bn1.bias', 'local_branch.layer1.0.bn1.running_mean', 'local_branch.layer1.0.bn1.running_var', 'local_branch.layer1.0.bn1.num_batches_tracked', 'local_branch.layer1.0.conv2.weight', 'local_branch.layer1.0.bn2.weight', 'local_branch.layer1.0.bn2.bias', 'local_branch.layer1.0.bn2.running_mean', 'local_branch.layer1.0.bn2.running_var', 'local_branch.layer1.0.bn2.num_batches_tracked', 'local_branch.layer1.0.conv3.weight', 'local_branch.layer1.0.bn3.weight', 'local_branch.layer1.0.bn3.bias', 'local_branch.layer1.0.bn3.running_mean', 'local_branch.layer1.0.bn3.running_var', 'local_branch.layer1.0.bn3.num_batches_tracked', 'local_branch.layer1.0.downsample.0.weight', 'local_branch.layer1.0.downsample.1.weight', 'local_branch.layer1.0.downsample.1.bias', 'local_branch.layer1.0.downsample.1.running_mean', 'local_branch.layer1.0.downsample.1.running_var', 'local_branch.layer1.0.downsample.1.num_batches_tracked', 'local_branch.layer1.1.conv1.weight', 'local_branch.layer1.1.bn1.weight', 'local_branch.layer1.1.bn1.bias', 'local_branch.layer1.1.bn1.running_mean', 'local_branch.layer1.1.bn1.running_var', 'local_branch.layer1.1.bn1.num_batches_tracked', 'local_branch.layer1.1.conv2.weight', 'local_branch.layer1.1.bn2.weight', 'local_branch.layer1.1.bn2.bias', 'local_branch.layer1.1.bn2.running_mean', 'local_branch.layer1.1.bn2.running_var', 'local_branch.layer1.1.bn2.num_batches_tracked', 'local_branch.layer1.1.conv3.weight', 'local_branch.layer1.1.bn3.weight', 'local_branch.layer1.1.bn3.bias', 'local_branch.layer1.1.bn3.running_mean', 'local_branch.layer1.1.bn3.running_var', 'local_branch.layer1.1.bn3.num_batches_tracked', 'local_branch.layer1.2.conv1.weight', 'local_branch.layer1.2.bn1.weight', 'local_branch.layer1.2.bn1.bias', 'local_branch.layer1.2.bn1.running_mean', 'local_branch.layer1.2.bn1.running_var', 'local_branch.layer1.2.bn1.num_batches_tracked', 'local_branch.layer1.2.conv2.weight', 'local_branch.layer1.2.bn2.weight', 'local_branch.layer1.2.bn2.bias', 'local_branch.layer1.2.bn2.running_mean', 'local_branch.layer1.2.bn2.running_var', 'local_branch.layer1.2.bn2.num_batches_tracked', 'local_branch.layer1.2.conv3.weight', 'local_branch.layer1.2.bn3.weight', 'local_branch.layer1.2.bn3.bias', 'local_branch.layer1.2.bn3.running_mean', 'local_branch.layer1.2.bn3.running_var', 'local_branch.layer1.2.bn3.num_batches_tracked', 'local_branch.layer2.0.conv1.weight', 'local_branch.layer2.0.bn1.weight', 'local_branch.layer2.0.bn1.bias', 'local_branch.layer2.0.bn1.running_mean', 'local_branch.layer2.0.bn1.running_var', 'local_branch.layer2.0.bn1.num_batches_tracked', 'local_branch.layer2.0.conv2.weight', 'local_branch.layer2.0.bn2.weight', 'local_branch.layer2.0.bn2.bias', 'local_branch.layer2.0.bn2.running_mean', 'local_branch.layer2.0.bn2.running_var', 'local_branch.layer2.0.bn2.num_batches_tracked', 'local_branch.layer2.0.conv3.weight', 'local_branch.layer2.0.bn3.weight', 'local_branch.layer2.0.bn3.bias', 'local_branch.layer2.0.bn3.running_mean', 'local_branch.layer2.0.bn3.running_var', 'local_branch.layer2.0.bn3.num_batches_tracked', 'local_branch.layer2.0.downsample.0.weight', 'local_branch.layer2.0.downsample.1.weight', 'local_branch.layer2.0.downsample.1.bias', 'local_branch.layer2.0.downsample.1.running_mean', 'local_branch.layer2.0.downsample.1.running_var', 'local_branch.layer2.0.downsample.1.num_batches_tracked', 'local_branch.layer2.1.conv1.weight', 'local_branch.layer2.1.bn1.weight', 'local_branch.layer2.1.bn1.bias', 'local_branch.layer2.1.bn1.running_mean', 'local_branch.layer2.1.bn1.running_var', 'local_branch.layer2.1.bn1.num_batches_tracked', 'local_branch.layer2.1.conv2.weight', 'local_branch.layer2.1.bn2.weight', 'local_branch.layer2.1.bn2.bias', 'local_branch.layer2.1.bn2.running_mean', 'local_branch.layer2.1.bn2.running_var', 'local_branch.layer2.1.bn2.num_batches_tracked', 'local_branch.layer2.1.conv3.weight', 'local_branch.layer2.1.bn3.weight', 'local_branch.layer2.1.bn3.bias', 'local_branch.layer2.1.bn3.running_mean', 'local_branch.layer2.1.bn3.running_var', 'local_branch.layer2.1.bn3.num_batches_tracked', 'local_branch.layer2.2.conv1.weight', 'local_branch.layer2.2.bn1.weight', 'local_branch.layer2.2.bn1.bias', 'local_branch.layer2.2.bn1.running_mean', 'local_branch.layer2.2.bn1.running_var', 'local_branch.layer2.2.bn1.num_batches_tracked', 'local_branch.layer2.2.conv2.weight', 'local_branch.layer2.2.bn2.weight', 'local_branch.layer2.2.bn2.bias', 'local_branch.layer2.2.bn2.running_mean', 'local_branch.layer2.2.bn2.running_var', 'local_branch.layer2.2.bn2.num_batches_tracked', 'local_branch.layer2.2.conv3.weight', 'local_branch.layer2.2.bn3.weight', 'local_branch.layer2.2.bn3.bias', 'local_branch.layer2.2.bn3.running_mean', 'local_branch.layer2.2.bn3.running_var', 'local_branch.layer2.2.bn3.num_batches_tracked', 'local_branch.layer2.3.conv1.weight', 'local_branch.layer2.3.bn1.weight', 'local_branch.layer2.3.bn1.bias', 'local_branch.layer2.3.bn1.running_mean', 'local_branch.layer2.3.bn1.running_var', 'local_branch.layer2.3.bn1.num_batches_tracked', 'local_branch.layer2.3.conv2.weight', 'local_branch.layer2.3.bn2.weight', 'local_branch.layer2.3.bn2.bias', 'local_branch.layer2.3.bn2.running_mean', 'local_branch.layer2.3.bn2.running_var', 'local_branch.layer2.3.bn2.num_batches_tracked', 'local_branch.layer2.3.conv3.weight', 'local_branch.layer2.3.bn3.weight', 'local_branch.layer2.3.bn3.bias', 'local_branch.layer2.3.bn3.running_mean', 'local_branch.layer2.3.bn3.running_var', 'local_branch.layer2.3.bn3.num_batches_tracked', 'local_branch.layer3.0.conv1.weight', 'local_branch.layer3.0.bn1.weight', 'local_branch.layer3.0.bn1.bias', 'local_branch.layer3.0.bn1.running_mean', 'local_branch.layer3.0.bn1.running_var', 'local_branch.layer3.0.bn1.num_batches_tracked', 'local_branch.layer3.0.conv2.weight', 'local_branch.layer3.0.bn2.weight', 'local_branch.layer3.0.bn2.bias', 'local_branch.layer3.0.bn2.running_mean', 'local_branch.layer3.0.bn2.running_var', 'local_branch.layer3.0.bn2.num_batches_tracked', 'local_branch.layer3.0.conv3.weight', 'local_branch.layer3.0.bn3.weight', 'local_branch.layer3.0.bn3.bias', 'local_branch.layer3.0.bn3.running_mean', 'local_branch.layer3.0.bn3.running_var', 'local_branch.layer3.0.bn3.num_batches_tracked', 'local_branch.layer3.0.downsample.0.weight', 'local_branch.layer3.0.downsample.1.weight', 'local_branch.layer3.0.downsample.1.bias', 'local_branch.layer3.0.downsample.1.running_mean', 'local_branch.layer3.0.downsample.1.running_var', 'local_branch.layer3.0.downsample.1.num_batches_tracked', 'local_branch.layer3.1.conv1.weight', 'local_branch.layer3.1.bn1.weight', 'local_branch.layer3.1.bn1.bias', 'local_branch.layer3.1.bn1.running_mean', 'local_branch.layer3.1.bn1.running_var', 'local_branch.layer3.1.bn1.num_batches_tracked', 'local_branch.layer3.1.conv2.weight', 'local_branch.layer3.1.bn2.weight', 'local_branch.layer3.1.bn2.bias', 'local_branch.layer3.1.bn2.running_mean', 'local_branch.layer3.1.bn2.running_var', 'local_branch.layer3.1.bn2.num_batches_tracked', 'local_branch.layer3.1.conv3.weight', 'local_branch.layer3.1.bn3.weight', 'local_branch.layer3.1.bn3.bias', 'local_branch.layer3.1.bn3.running_mean', 'local_branch.layer3.1.bn3.running_var', 'local_branch.layer3.1.bn3.num_batches_tracked', 'local_branch.layer3.2.conv1.weight', 'local_branch.layer3.2.bn1.weight', 'local_branch.layer3.2.bn1.bias', 'local_branch.layer3.2.bn1.running_mean', 'local_branch.layer3.2.bn1.running_var', 'local_branch.layer3.2.bn1.num_batches_tracked', 'local_branch.layer3.2.conv2.weight', 'local_branch.layer3.2.bn2.weight', 'local_branch.layer3.2.bn2.bias', 'local_branch.layer3.2.bn2.running_mean', 'local_branch.layer3.2.bn2.running_var', 'local_branch.layer3.2.bn2.num_batches_tracked', 'local_branch.layer3.2.conv3.weight', 'local_branch.layer3.2.bn3.weight', 'local_branch.layer3.2.bn3.bias', 'local_branch.layer3.2.bn3.running_mean', 'local_branch.layer3.2.bn3.running_var', 'local_branch.layer3.2.bn3.num_batches_tracked', 'local_branch.layer3.3.conv1.weight', 'local_branch.layer3.3.bn1.weight', 'local_branch.layer3.3.bn1.bias', 'local_branch.layer3.3.bn1.running_mean', 'local_branch.layer3.3.bn1.running_var', 'local_branch.layer3.3.bn1.num_batches_tracked', 'local_branch.layer3.3.conv2.weight', 'local_branch.layer3.3.bn2.weight', 'local_branch.layer3.3.bn2.bias', 'local_branch.layer3.3.bn2.running_mean', 'local_branch.layer3.3.bn2.running_var', 'local_branch.layer3.3.bn2.num_batches_tracked', 'local_branch.layer3.3.conv3.weight', 'local_branch.layer3.3.bn3.weight', 'local_branch.layer3.3.bn3.bias', 'local_branch.layer3.3.bn3.running_mean', 'local_branch.layer3.3.bn3.running_var', 'local_branch.layer3.3.bn3.num_batches_tracked', 'local_branch.layer3.4.conv1.weight', 'local_branch.layer3.4.bn1.weight', 'local_branch.layer3.4.bn1.bias', 'local_branch.layer3.4.bn1.running_mean', 'local_branch.layer3.4.bn1.running_var', 'local_branch.layer3.4.bn1.num_batches_tracked', 'local_branch.layer3.4.conv2.weight', 'local_branch.layer3.4.bn2.weight', 'local_branch.layer3.4.bn2.bias', 'local_branch.layer3.4.bn2.running_mean', 'local_branch.layer3.4.bn2.running_var', 'local_branch.layer3.4.bn2.num_batches_tracked', 'local_branch.layer3.4.conv3.weight', 'local_branch.layer3.4.bn3.weight', 'local_branch.layer3.4.bn3.bias', 'local_branch.layer3.4.bn3.running_mean', 'local_branch.layer3.4.bn3.running_var', 'local_branch.layer3.4.bn3.num_batches_tracked', 'local_branch.layer3.5.conv1.weight', 'local_branch.layer3.5.bn1.weight', 'local_branch.layer3.5.bn1.bias', 'local_branch.layer3.5.bn1.running_mean', 'local_branch.layer3.5.bn1.running_var', 'local_branch.layer3.5.bn1.num_batches_tracked', 'local_branch.layer3.5.conv2.weight', 'local_branch.layer3.5.bn2.weight', 'local_branch.layer3.5.bn2.bias', 'local_branch.layer3.5.bn2.running_mean', 'local_branch.layer3.5.bn2.running_var', 'local_branch.layer3.5.bn2.num_batches_tracked', 'local_branch.layer3.5.conv3.weight', 'local_branch.layer3.5.bn3.weight', 'local_branch.layer3.5.bn3.bias', 'local_branch.layer3.5.bn3.running_mean', 'local_branch.layer3.5.bn3.running_var', 'local_branch.layer3.5.bn3.num_batches_tracked', 'local_branch.layer4.0.conv1.weight', 'local_branch.layer4.0.bn1.weight', 'local_branch.layer4.0.bn1.bias', 'local_branch.layer4.0.bn1.running_mean', 'local_branch.layer4.0.bn1.running_var', 'local_branch.layer4.0.bn1.num_batches_tracked', 'local_branch.layer4.0.conv2.weight', 'local_branch.layer4.0.bn2.weight', 'local_branch.layer4.0.bn2.bias', 'local_branch.layer4.0.bn2.running_mean', 'local_branch.layer4.0.bn2.running_var', 'local_branch.layer4.0.bn2.num_batches_tracked', 'local_branch.layer4.0.conv3.weight', 'local_branch.layer4.0.bn3.weight', 'local_branch.layer4.0.bn3.bias', 'local_branch.layer4.0.bn3.running_mean', 'local_branch.layer4.0.bn3.running_var', 'local_branch.layer4.0.bn3.num_batches_tracked', 'local_branch.layer4.0.downsample.0.weight', 'local_branch.layer4.0.downsample.1.weight', 'local_branch.layer4.0.downsample.1.bias', 'local_branch.layer4.0.downsample.1.running_mean', 'local_branch.layer4.0.downsample.1.running_var', 'local_branch.layer4.0.downsample.1.num_batches_tracked', 'local_branch.layer4.1.conv1.weight', 'local_branch.layer4.1.bn1.weight', 'local_branch.layer4.1.bn1.bias', 'local_branch.layer4.1.bn1.running_mean', 'local_branch.layer4.1.bn1.running_var', 'local_branch.layer4.1.bn1.num_batches_tracked', 'local_branch.layer4.1.conv2.weight', 'local_branch.layer4.1.bn2.weight', 'local_branch.layer4.1.bn2.bias', 'local_branch.layer4.1.bn2.running_mean', 'local_branch.layer4.1.bn2.running_var', 'local_branch.layer4.1.bn2.num_batches_tracked', 'local_branch.layer4.1.conv3.weight', 'local_branch.layer4.1.bn3.weight', 'local_branch.layer4.1.bn3.bias', 'local_branch.layer4.1.bn3.running_mean', 'local_branch.layer4.1.bn3.running_var', 'local_branch.layer4.1.bn3.num_batches_tracked', 'local_branch.layer4.2.conv1.weight', 'local_branch.layer4.2.bn1.weight', 'local_branch.layer4.2.bn1.bias', 'local_branch.layer4.2.bn1.running_mean', 'local_branch.layer4.2.bn1.running_var', 'local_branch.layer4.2.bn1.num_batches_tracked', 'local_branch.layer4.2.conv2.weight', 'local_branch.layer4.2.bn2.weight', 'local_branch.layer4.2.bn2.bias', 'local_branch.layer4.2.bn2.running_mean', 'local_branch.layer4.2.bn2.running_var', 'local_branch.layer4.2.bn2.num_batches_tracked', 'local_branch.layer4.2.conv3.weight', 'local_branch.layer4.2.bn3.weight', 'local_branch.layer4.2.bn3.bias', 'local_branch.layer4.2.bn3.running_mean', 'local_branch.layer4.2.bn3.running_var', 'local_branch.layer4.2.bn3.num_batches_tracked', 'local_branch.fc.weight', 'local_branch.fc.bias', 'fusion_branch.encoder.enc_layers.0.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.0.layernorm1.weight', 'fusion_branch.encoder.enc_layers.0.layernorm1.bias', 'fusion_branch.encoder.enc_layers.0.layernorm2.weight', 'fusion_branch.encoder.enc_layers.0.layernorm2.bias', 'fusion_branch.encoder.enc_layers.1.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.1.layernorm1.weight', 'fusion_branch.encoder.enc_layers.1.layernorm1.bias', 'fusion_branch.encoder.enc_layers.1.layernorm2.weight', 'fusion_branch.encoder.enc_layers.1.layernorm2.bias', 'fusion_branch.encoder.enc_layers.2.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.2.layernorm1.weight', 'fusion_branch.encoder.enc_layers.2.layernorm1.bias', 'fusion_branch.encoder.enc_layers.2.layernorm2.weight', 'fusion_branch.encoder.enc_layers.2.layernorm2.bias', 'fusion_branch.encoder.enc_layers.3.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.3.layernorm1.weight', 'fusion_branch.encoder.enc_layers.3.layernorm1.bias', 'fusion_branch.encoder.enc_layers.3.layernorm2.weight', 'fusion_branch.encoder.enc_layers.3.layernorm2.bias', 'fusion_branch.dense.weight', 'fusion_branch.dense.bias'])
thief state:  None
pretrained state:  dict_keys([])
Thief model initialized successfully
specificity = 9/80
sensitivity = 36/42
Initial model on target dataset: acc = 0.3197, agreement = 0.3525, f1 = 0.2046, spec = 0.1125, sens = 0.8571
specificity = 4/27
sensitivity = 59/73
Initial model on validation dataset: acc = 0.6000, agreement = 0.6000, f1 = 0.2785, spec = 0.1481, sens = 0.8082
la:  None
>> Train a Model.
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:29<24:17, 29.75s/it]  4%|▍         | 2/50 [01:05<26:36, 33.27s/it]  6%|▌         | 3/50 [01:35<24:47, 31.64s/it]  8%|▊         | 4/50 [02:09<25:11, 32.85s/it] 10%|█         | 5/50 [03:16<33:39, 44.88s/it]Epoch 5: Train acc/f1 = 0.6544 / 0.2637 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.7300 / 0.2813 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
 12%|█▏        | 6/50 [03:50<30:14, 41.25s/it] 14%|█▍        | 7/50 [04:21<27:13, 37.99s/it] 16%|█▌        | 8/50 [04:56<25:50, 36.91s/it] 18%|█▊        | 9/50 [05:26<23:47, 34.81s/it] 20%|██        | 10/50 [06:30<29:12, 43.82s/it]Epoch 10: Train acc/f1 = 0.7700 / 0.6565 / 0.5884 / 0.9321 
                Val acc/f1/spec/sens = 0.8300 / 0.6430 / 0.6296 / 0.9863
                Test acc/f1/spec/sens = 0.6311 / 0.6228 / 0.4750 / 0.9524
 22%|██▏       | 11/50 [06:58<25:24, 39.09s/it] 24%|██▍       | 12/50 [07:32<23:45, 37.52s/it] 26%|██▌       | 13/50 [08:01<21:29, 34.84s/it] 28%|██▊       | 14/50 [08:33<20:22, 33.95s/it] 30%|███       | 15/50 [09:34<24:33, 42.09s/it]Epoch 15: Train acc/f1 = 0.7744 / 0.6728 / 0.5723 / 0.9338 
                Val acc/f1/spec/sens = 0.8300 / 0.6516 / 0.5926 / 0.9863
                Test acc/f1/spec/sens = 0.6393 / 0.6402 / 0.4875 / 0.9524
 32%|███▏      | 16/50 [10:07<22:17, 39.34s/it] 34%|███▍      | 17/50 [10:35<19:53, 36.17s/it] 36%|███▌      | 18/50 [11:08<18:46, 35.21s/it] 38%|███▊      | 19/50 [11:37<17:10, 33.24s/it] 40%|████      | 20/50 [12:39<20:56, 41.90s/it]Epoch 20: Train acc/f1 = 0.7900 / 0.6840 / 0.5916 / 0.9508 
                Val acc/f1/spec/sens = 0.8500 / 0.7016 / 0.5926 / 0.9863
                Test acc/f1/spec/sens = 0.6148 / 0.5995 / 0.4500 / 0.9524
 42%|████▏     | 21/50 [13:09<18:27, 38.18s/it] 44%|████▍     | 22/50 [13:41<16:57, 36.35s/it] 46%|████▌     | 23/50 [14:11<15:29, 34.44s/it] 48%|████▊     | 24/50 [14:42<14:32, 33.57s/it] 50%|█████     | 25/50 [15:41<17:04, 40.98s/it]Epoch 25: Train acc/f1 = 0.7933 / 0.7001 / 0.6399 / 0.9338 
                Val acc/f1/spec/sens = 0.8600 / 0.7161 / 0.7037 / 0.9863
                Test acc/f1/spec/sens = 0.6230 / 0.6113 / 0.4625 / 0.9524
 52%|█████▏    | 26/50 [16:13<15:25, 38.56s/it] 54%|█████▍    | 27/50 [16:42<13:38, 35.60s/it] 56%|█████▌    | 28/50 [17:14<12:41, 34.60s/it] 58%|█████▊    | 29/50 [17:43<11:27, 32.76s/it] 60%|██████    | 30/50 [18:46<13:59, 41.98s/it]Epoch 30: Train acc/f1 = 0.7933 / 0.7042 / 0.6109 / 0.9406 
                Val acc/f1/spec/sens = 0.8500 / 0.6989 / 0.6667 / 0.9863
                Test acc/f1/spec/sens = 0.6148 / 0.6032 / 0.4500 / 0.9524
 62%|██████▏   | 31/50 [19:16<12:04, 38.13s/it] 64%|██████▍   | 32/50 [19:48<10:56, 36.49s/it] 66%|██████▌   | 33/50 [20:17<09:42, 34.25s/it] 68%|██████▊   | 34/50 [20:50<08:59, 33.70s/it] 70%|███████   | 35/50 [21:51<10:28, 41.90s/it]Epoch 35: Train acc/f1 = 0.7944 / 0.6932 / 0.5949 / 0.9559 
                Val acc/f1/spec/sens = 0.8400 / 0.6799 / 0.5926 / 0.9863
                Test acc/f1/spec/sens = 0.6148 / 0.6071 / 0.4500 / 0.9524
 72%|███████▏  | 36/50 [22:22<09:01, 38.70s/it] 74%|███████▍  | 37/50 [22:52<07:47, 36.00s/it] 76%|███████▌  | 38/50 [23:23<06:54, 34.56s/it] 78%|███████▊  | 39/50 [23:52<06:03, 33.03s/it] 80%|████████  | 40/50 [24:55<06:58, 41.89s/it]Epoch 40: Train acc/f1 = 0.7867 / 0.6791 / 0.5563 / 0.9593 
                Val acc/f1/spec/sens = 0.8100 / 0.6013 / 0.5185 / 0.9863
                Test acc/f1/spec/sens = 0.6066 / 0.5918 / 0.4375 / 0.9524
 82%|████████▏ | 41/50 [25:24<05:42, 38.09s/it] 84%|████████▍ | 42/50 [25:57<04:53, 36.63s/it] 86%|████████▌ | 43/50 [26:27<04:02, 34.58s/it] 88%|████████▊ | 44/50 [26:59<03:22, 33.83s/it] 90%|█████████ | 45/50 [28:00<03:29, 41.96s/it]Epoch 45: Train acc/f1 = 0.7878 / 0.6983 / 0.6367 / 0.9219 
                Val acc/f1/spec/sens = 0.8500 / 0.6898 / 0.7037 / 0.9863
                Test acc/f1/spec/sens = 0.6557 / 0.6524 / 0.5125 / 0.9524
 92%|█████████▏| 46/50 [28:33<02:37, 39.25s/it] 94%|█████████▍| 47/50 [29:02<01:48, 36.08s/it] 96%|█████████▌| 48/50 [29:32<01:08, 34.38s/it] 98%|█████████▊| 49/50 [29:59<00:32, 32.06s/it]100%|██████████| 50/50 [30:55<00:00, 39.42s/it]                                               Epoch 50: Train acc/f1 = 0.7933 / 0.6990 / 0.6238 / 0.9406 
                Val acc/f1/spec/sens = 0.8500 / 0.6989 / 0.6667 / 0.9863
                Test acc/f1/spec/sens = 0.6475 / 0.6476 / 0.5000 / 0.9524
specificity = 192/311
sensitivity = 554/589
specificity = 18/27
sensitivity = 72/73
specificity = 40/80
sensitivity = 40/42
Trial 1, Cycle 1
Train acc/f1/spec/sens = 0.7967 / 0.7087 / 0.6174 / 0.9406
Val acc/f1/spec/sens = 0.8500 / 0.6989 / 0.6667 / 0.9863
Test acc/f1/spec/sens = 0.6475 / 0.6476 / 0.5000 / 0.9524
>> Finished.
specificity = 40/80
sensitivity = 40/42
Acc, agreement for latest model:  0.6475409836065574 0.6639344262295082
Load best checkpoint for thief model
specificity = 38/80
sensitivity = 40/42
Acc, agreement for best model:  0.6311475409836066 0.6475409836065574
Trial 0/5 || Cycle 1/1 || Label set size 900 || Test acc 0.6311 || Test agreement 0.6475 || Spec 0.4750 || Sens 0.9524
**************************************************************************************************** 

specificity = 38/80
sensitivity = 40/42
Number of samples  900
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:01<00:35,  1.28s/it]  7%|▋         | 2/29 [00:01<00:23,  1.14it/s] 10%|█         | 3/29 [00:02<00:18,  1.39it/s] 14%|█▍        | 4/29 [00:03<00:17,  1.44it/s] 17%|█▋        | 5/29 [00:03<00:16,  1.45it/s] 21%|██        | 6/29 [00:04<00:15,  1.45it/s] 24%|██▍       | 7/29 [00:05<00:14,  1.52it/s] 28%|██▊       | 8/29 [00:05<00:14,  1.46it/s] 31%|███       | 9/29 [00:06<00:13,  1.51it/s] 34%|███▍      | 10/29 [00:06<00:11,  1.59it/s] 38%|███▊      | 11/29 [00:07<00:11,  1.58it/s] 41%|████▏     | 12/29 [00:08<00:10,  1.66it/s] 45%|████▍     | 13/29 [00:08<00:09,  1.64it/s] 48%|████▊     | 14/29 [00:09<00:09,  1.63it/s] 52%|█████▏    | 15/29 [00:10<00:08,  1.59it/s] 55%|█████▌    | 16/29 [00:10<00:08,  1.48it/s] 59%|█████▊    | 17/29 [00:11<00:07,  1.51it/s] 62%|██████▏   | 18/29 [00:12<00:07,  1.39it/s] 66%|██████▌   | 19/29 [00:12<00:06,  1.47it/s] 69%|██████▉   | 20/29 [00:13<00:05,  1.54it/s] 72%|███████▏  | 21/29 [00:14<00:05,  1.54it/s] 76%|███████▌  | 22/29 [00:14<00:04,  1.51it/s] 79%|███████▉  | 23/29 [00:15<00:03,  1.51it/s] 83%|████████▎ | 24/29 [00:16<00:03,  1.56it/s] 86%|████████▌ | 25/29 [00:16<00:02,  1.62it/s] 90%|████████▉ | 26/29 [00:17<00:01,  1.67it/s] 93%|█████████▎| 27/29 [00:17<00:01,  1.57it/s] 97%|█████████▋| 28/29 [00:18<00:00,  1.60it/s]100%|██████████| 29/29 [00:18<00:00,  2.08it/s]100%|██████████| 29/29 [00:18<00:00,  1.54it/s]
replacing val labels with victim labels
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.16s/it] 50%|█████     | 2/4 [00:01<00:01,  1.25it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.62it/s]100%|██████████| 4/4 [00:02<00:00,  1.78it/s]Validation set distribution: 
Number of samples  100

{0: 16, 1: 21, 2: 63}
Labeled set distribution: 
Number of samples  900
{0: 102, 1: 220, 2: 578}
odict_keys(['global_branch.net.conv1.weight', 'global_branch.net.bn1.weight', 'global_branch.net.bn1.bias', 'global_branch.net.bn1.running_mean', 'global_branch.net.bn1.running_var', 'global_branch.net.bn1.num_batches_tracked', 'global_branch.net.layer1.0.conv1.weight', 'global_branch.net.layer1.0.bn1.weight', 'global_branch.net.layer1.0.bn1.bias', 'global_branch.net.layer1.0.bn1.running_mean', 'global_branch.net.layer1.0.bn1.running_var', 'global_branch.net.layer1.0.bn1.num_batches_tracked', 'global_branch.net.layer1.0.conv2.weight', 'global_branch.net.layer1.0.bn2.weight', 'global_branch.net.layer1.0.bn2.bias', 'global_branch.net.layer1.0.bn2.running_mean', 'global_branch.net.layer1.0.bn2.running_var', 'global_branch.net.layer1.0.bn2.num_batches_tracked', 'global_branch.net.layer1.0.conv3.weight', 'global_branch.net.layer1.0.bn3.weight', 'global_branch.net.layer1.0.bn3.bias', 'global_branch.net.layer1.0.bn3.running_mean', 'global_branch.net.layer1.0.bn3.running_var', 'global_branch.net.layer1.0.bn3.num_batches_tracked', 'global_branch.net.layer1.0.downsample.0.weight', 'global_branch.net.layer1.0.downsample.1.weight', 'global_branch.net.layer1.0.downsample.1.bias', 'global_branch.net.layer1.0.downsample.1.running_mean', 'global_branch.net.layer1.0.downsample.1.running_var', 'global_branch.net.layer1.0.downsample.1.num_batches_tracked', 'global_branch.net.layer1.1.conv1.weight', 'global_branch.net.layer1.1.bn1.weight', 'global_branch.net.layer1.1.bn1.bias', 'global_branch.net.layer1.1.bn1.running_mean', 'global_branch.net.layer1.1.bn1.running_var', 'global_branch.net.layer1.1.bn1.num_batches_tracked', 'global_branch.net.layer1.1.conv2.weight', 'global_branch.net.layer1.1.bn2.weight', 'global_branch.net.layer1.1.bn2.bias', 'global_branch.net.layer1.1.bn2.running_mean', 'global_branch.net.layer1.1.bn2.running_var', 'global_branch.net.layer1.1.bn2.num_batches_tracked', 'global_branch.net.layer1.1.conv3.weight', 'global_branch.net.layer1.1.bn3.weight', 'global_branch.net.layer1.1.bn3.bias', 'global_branch.net.layer1.1.bn3.running_mean', 'global_branch.net.layer1.1.bn3.running_var', 'global_branch.net.layer1.1.bn3.num_batches_tracked', 'global_branch.net.layer1.2.conv1.weight', 'global_branch.net.layer1.2.bn1.weight', 'global_branch.net.layer1.2.bn1.bias', 'global_branch.net.layer1.2.bn1.running_mean', 'global_branch.net.layer1.2.bn1.running_var', 'global_branch.net.layer1.2.bn1.num_batches_tracked', 'global_branch.net.layer1.2.conv2.weight', 'global_branch.net.layer1.2.bn2.weight', 'global_branch.net.layer1.2.bn2.bias', 'global_branch.net.layer1.2.bn2.running_mean', 'global_branch.net.layer1.2.bn2.running_var', 'global_branch.net.layer1.2.bn2.num_batches_tracked', 'global_branch.net.layer1.2.conv3.weight', 'global_branch.net.layer1.2.bn3.weight', 'global_branch.net.layer1.2.bn3.bias', 'global_branch.net.layer1.2.bn3.running_mean', 'global_branch.net.layer1.2.bn3.running_var', 'global_branch.net.layer1.2.bn3.num_batches_tracked', 'global_branch.net.layer2.0.conv1.weight', 'global_branch.net.layer2.0.bn1.weight', 'global_branch.net.layer2.0.bn1.bias', 'global_branch.net.layer2.0.bn1.running_mean', 'global_branch.net.layer2.0.bn1.running_var', 'global_branch.net.layer2.0.bn1.num_batches_tracked', 'global_branch.net.layer2.0.conv2.weight', 'global_branch.net.layer2.0.bn2.weight', 'global_branch.net.layer2.0.bn2.bias', 'global_branch.net.layer2.0.bn2.running_mean', 'global_branch.net.layer2.0.bn2.running_var', 'global_branch.net.layer2.0.bn2.num_batches_tracked', 'global_branch.net.layer2.0.conv3.weight', 'global_branch.net.layer2.0.bn3.weight', 'global_branch.net.layer2.0.bn3.bias', 'global_branch.net.layer2.0.bn3.running_mean', 'global_branch.net.layer2.0.bn3.running_var', 'global_branch.net.layer2.0.bn3.num_batches_tracked', 'global_branch.net.layer2.0.downsample.0.weight', 'global_branch.net.layer2.0.downsample.1.weight', 'global_branch.net.layer2.0.downsample.1.bias', 'global_branch.net.layer2.0.downsample.1.running_mean', 'global_branch.net.layer2.0.downsample.1.running_var', 'global_branch.net.layer2.0.downsample.1.num_batches_tracked', 'global_branch.net.layer2.1.conv1.weight', 'global_branch.net.layer2.1.bn1.weight', 'global_branch.net.layer2.1.bn1.bias', 'global_branch.net.layer2.1.bn1.running_mean', 'global_branch.net.layer2.1.bn1.running_var', 'global_branch.net.layer2.1.bn1.num_batches_tracked', 'global_branch.net.layer2.1.conv2.weight', 'global_branch.net.layer2.1.bn2.weight', 'global_branch.net.layer2.1.bn2.bias', 'global_branch.net.layer2.1.bn2.running_mean', 'global_branch.net.layer2.1.bn2.running_var', 'global_branch.net.layer2.1.bn2.num_batches_tracked', 'global_branch.net.layer2.1.conv3.weight', 'global_branch.net.layer2.1.bn3.weight', 'global_branch.net.layer2.1.bn3.bias', 'global_branch.net.layer2.1.bn3.running_mean', 'global_branch.net.layer2.1.bn3.running_var', 'global_branch.net.layer2.1.bn3.num_batches_tracked', 'global_branch.net.layer2.2.conv1.weight', 'global_branch.net.layer2.2.bn1.weight', 'global_branch.net.layer2.2.bn1.bias', 'global_branch.net.layer2.2.bn1.running_mean', 'global_branch.net.layer2.2.bn1.running_var', 'global_branch.net.layer2.2.bn1.num_batches_tracked', 'global_branch.net.layer2.2.conv2.weight', 'global_branch.net.layer2.2.bn2.weight', 'global_branch.net.layer2.2.bn2.bias', 'global_branch.net.layer2.2.bn2.running_mean', 'global_branch.net.layer2.2.bn2.running_var', 'global_branch.net.layer2.2.bn2.num_batches_tracked', 'global_branch.net.layer2.2.conv3.weight', 'global_branch.net.layer2.2.bn3.weight', 'global_branch.net.layer2.2.bn3.bias', 'global_branch.net.layer2.2.bn3.running_mean', 'global_branch.net.layer2.2.bn3.running_var', 'global_branch.net.layer2.2.bn3.num_batches_tracked', 'global_branch.net.layer2.3.conv1.weight', 'global_branch.net.layer2.3.bn1.weight', 'global_branch.net.layer2.3.bn1.bias', 'global_branch.net.layer2.3.bn1.running_mean', 'global_branch.net.layer2.3.bn1.running_var', 'global_branch.net.layer2.3.bn1.num_batches_tracked', 'global_branch.net.layer2.3.conv2.weight', 'global_branch.net.layer2.3.bn2.weight', 'global_branch.net.layer2.3.bn2.bias', 'global_branch.net.layer2.3.bn2.running_mean', 'global_branch.net.layer2.3.bn2.running_var', 'global_branch.net.layer2.3.bn2.num_batches_tracked', 'global_branch.net.layer2.3.conv3.weight', 'global_branch.net.layer2.3.bn3.weight', 'global_branch.net.layer2.3.bn3.bias', 'global_branch.net.layer2.3.bn3.running_mean', 'global_branch.net.layer2.3.bn3.running_var', 'global_branch.net.layer2.3.bn3.num_batches_tracked', 'global_branch.net.layer3.0.conv1.weight', 'global_branch.net.layer3.0.bn1.weight', 'global_branch.net.layer3.0.bn1.bias', 'global_branch.net.layer3.0.bn1.running_mean', 'global_branch.net.layer3.0.bn1.running_var', 'global_branch.net.layer3.0.bn1.num_batches_tracked', 'global_branch.net.layer3.0.conv2.weight', 'global_branch.net.layer3.0.bn2.weight', 'global_branch.net.layer3.0.bn2.bias', 'global_branch.net.layer3.0.bn2.running_mean', 'global_branch.net.layer3.0.bn2.running_var', 'global_branch.net.layer3.0.bn2.num_batches_tracked', 'global_branch.net.layer3.0.conv3.weight', 'global_branch.net.layer3.0.bn3.weight', 'global_branch.net.layer3.0.bn3.bias', 'global_branch.net.layer3.0.bn3.running_mean', 'global_branch.net.layer3.0.bn3.running_var', 'global_branch.net.layer3.0.bn3.num_batches_tracked', 'global_branch.net.layer3.0.downsample.0.weight', 'global_branch.net.layer3.0.downsample.1.weight', 'global_branch.net.layer3.0.downsample.1.bias', 'global_branch.net.layer3.0.downsample.1.running_mean', 'global_branch.net.layer3.0.downsample.1.running_var', 'global_branch.net.layer3.0.downsample.1.num_batches_tracked', 'global_branch.net.layer3.1.conv1.weight', 'global_branch.net.layer3.1.bn1.weight', 'global_branch.net.layer3.1.bn1.bias', 'global_branch.net.layer3.1.bn1.running_mean', 'global_branch.net.layer3.1.bn1.running_var', 'global_branch.net.layer3.1.bn1.num_batches_tracked', 'global_branch.net.layer3.1.conv2.weight', 'global_branch.net.layer3.1.bn2.weight', 'global_branch.net.layer3.1.bn2.bias', 'global_branch.net.layer3.1.bn2.running_mean', 'global_branch.net.layer3.1.bn2.running_var', 'global_branch.net.layer3.1.bn2.num_batches_tracked', 'global_branch.net.layer3.1.conv3.weight', 'global_branch.net.layer3.1.bn3.weight', 'global_branch.net.layer3.1.bn3.bias', 'global_branch.net.layer3.1.bn3.running_mean', 'global_branch.net.layer3.1.bn3.running_var', 'global_branch.net.layer3.1.bn3.num_batches_tracked', 'global_branch.net.layer3.2.conv1.weight', 'global_branch.net.layer3.2.bn1.weight', 'global_branch.net.layer3.2.bn1.bias', 'global_branch.net.layer3.2.bn1.running_mean', 'global_branch.net.layer3.2.bn1.running_var', 'global_branch.net.layer3.2.bn1.num_batches_tracked', 'global_branch.net.layer3.2.conv2.weight', 'global_branch.net.layer3.2.bn2.weight', 'global_branch.net.layer3.2.bn2.bias', 'global_branch.net.layer3.2.bn2.running_mean', 'global_branch.net.layer3.2.bn2.running_var', 'global_branch.net.layer3.2.bn2.num_batches_tracked', 'global_branch.net.layer3.2.conv3.weight', 'global_branch.net.layer3.2.bn3.weight', 'global_branch.net.layer3.2.bn3.bias', 'global_branch.net.layer3.2.bn3.running_mean', 'global_branch.net.layer3.2.bn3.running_var', 'global_branch.net.layer3.2.bn3.num_batches_tracked', 'global_branch.net.layer3.3.conv1.weight', 'global_branch.net.layer3.3.bn1.weight', 'global_branch.net.layer3.3.bn1.bias', 'global_branch.net.layer3.3.bn1.running_mean', 'global_branch.net.layer3.3.bn1.running_var', 'global_branch.net.layer3.3.bn1.num_batches_tracked', 'global_branch.net.layer3.3.conv2.weight', 'global_branch.net.layer3.3.bn2.weight', 'global_branch.net.layer3.3.bn2.bias', 'global_branch.net.layer3.3.bn2.running_mean', 'global_branch.net.layer3.3.bn2.running_var', 'global_branch.net.layer3.3.bn2.num_batches_tracked', 'global_branch.net.layer3.3.conv3.weight', 'global_branch.net.layer3.3.bn3.weight', 'global_branch.net.layer3.3.bn3.bias', 'global_branch.net.layer3.3.bn3.running_mean', 'global_branch.net.layer3.3.bn3.running_var', 'global_branch.net.layer3.3.bn3.num_batches_tracked', 'global_branch.net.layer3.4.conv1.weight', 'global_branch.net.layer3.4.bn1.weight', 'global_branch.net.layer3.4.bn1.bias', 'global_branch.net.layer3.4.bn1.running_mean', 'global_branch.net.layer3.4.bn1.running_var', 'global_branch.net.layer3.4.bn1.num_batches_tracked', 'global_branch.net.layer3.4.conv2.weight', 'global_branch.net.layer3.4.bn2.weight', 'global_branch.net.layer3.4.bn2.bias', 'global_branch.net.layer3.4.bn2.running_mean', 'global_branch.net.layer3.4.bn2.running_var', 'global_branch.net.layer3.4.bn2.num_batches_tracked', 'global_branch.net.layer3.4.conv3.weight', 'global_branch.net.layer3.4.bn3.weight', 'global_branch.net.layer3.4.bn3.bias', 'global_branch.net.layer3.4.bn3.running_mean', 'global_branch.net.layer3.4.bn3.running_var', 'global_branch.net.layer3.4.bn3.num_batches_tracked', 'global_branch.net.layer3.5.conv1.weight', 'global_branch.net.layer3.5.bn1.weight', 'global_branch.net.layer3.5.bn1.bias', 'global_branch.net.layer3.5.bn1.running_mean', 'global_branch.net.layer3.5.bn1.running_var', 'global_branch.net.layer3.5.bn1.num_batches_tracked', 'global_branch.net.layer3.5.conv2.weight', 'global_branch.net.layer3.5.bn2.weight', 'global_branch.net.layer3.5.bn2.bias', 'global_branch.net.layer3.5.bn2.running_mean', 'global_branch.net.layer3.5.bn2.running_var', 'global_branch.net.layer3.5.bn2.num_batches_tracked', 'global_branch.net.layer3.5.conv3.weight', 'global_branch.net.layer3.5.bn3.weight', 'global_branch.net.layer3.5.bn3.bias', 'global_branch.net.layer3.5.bn3.running_mean', 'global_branch.net.layer3.5.bn3.running_var', 'global_branch.net.layer3.5.bn3.num_batches_tracked', 'global_branch.net.layer4.0.conv1.weight', 'global_branch.net.layer4.0.bn1.weight', 'global_branch.net.layer4.0.bn1.bias', 'global_branch.net.layer4.0.bn1.running_mean', 'global_branch.net.layer4.0.bn1.running_var', 'global_branch.net.layer4.0.bn1.num_batches_tracked', 'global_branch.net.layer4.0.conv2.weight', 'global_branch.net.layer4.0.bn2.weight', 'global_branch.net.layer4.0.bn2.bias', 'global_branch.net.layer4.0.bn2.running_mean', 'global_branch.net.layer4.0.bn2.running_var', 'global_branch.net.layer4.0.bn2.num_batches_tracked', 'global_branch.net.layer4.0.conv3.weight', 'global_branch.net.layer4.0.bn3.weight', 'global_branch.net.layer4.0.bn3.bias', 'global_branch.net.layer4.0.bn3.running_mean', 'global_branch.net.layer4.0.bn3.running_var', 'global_branch.net.layer4.0.bn3.num_batches_tracked', 'global_branch.net.layer4.0.downsample.0.weight', 'global_branch.net.layer4.0.downsample.1.weight', 'global_branch.net.layer4.0.downsample.1.bias', 'global_branch.net.layer4.0.downsample.1.running_mean', 'global_branch.net.layer4.0.downsample.1.running_var', 'global_branch.net.layer4.0.downsample.1.num_batches_tracked', 'global_branch.net.layer4.1.conv1.weight', 'global_branch.net.layer4.1.bn1.weight', 'global_branch.net.layer4.1.bn1.bias', 'global_branch.net.layer4.1.bn1.running_mean', 'global_branch.net.layer4.1.bn1.running_var', 'global_branch.net.layer4.1.bn1.num_batches_tracked', 'global_branch.net.layer4.1.conv2.weight', 'global_branch.net.layer4.1.bn2.weight', 'global_branch.net.layer4.1.bn2.bias', 'global_branch.net.layer4.1.bn2.running_mean', 'global_branch.net.layer4.1.bn2.running_var', 'global_branch.net.layer4.1.bn2.num_batches_tracked', 'global_branch.net.layer4.1.conv3.weight', 'global_branch.net.layer4.1.bn3.weight', 'global_branch.net.layer4.1.bn3.bias', 'global_branch.net.layer4.1.bn3.running_mean', 'global_branch.net.layer4.1.bn3.running_var', 'global_branch.net.layer4.1.bn3.num_batches_tracked', 'global_branch.net.layer4.2.conv1.weight', 'global_branch.net.layer4.2.bn1.weight', 'global_branch.net.layer4.2.bn1.bias', 'global_branch.net.layer4.2.bn1.running_mean', 'global_branch.net.layer4.2.bn1.running_var', 'global_branch.net.layer4.2.bn1.num_batches_tracked', 'global_branch.net.layer4.2.conv2.weight', 'global_branch.net.layer4.2.bn2.weight', 'global_branch.net.layer4.2.bn2.bias', 'global_branch.net.layer4.2.bn2.running_mean', 'global_branch.net.layer4.2.bn2.running_var', 'global_branch.net.layer4.2.bn2.num_batches_tracked', 'global_branch.net.layer4.2.conv3.weight', 'global_branch.net.layer4.2.bn3.weight', 'global_branch.net.layer4.2.bn3.bias', 'global_branch.net.layer4.2.bn3.running_mean', 'global_branch.net.layer4.2.bn3.running_var', 'global_branch.net.layer4.2.bn3.num_batches_tracked', 'global_branch.net.fc.weight', 'global_branch.net.fc.bias', 'local_branch.conv1.weight', 'local_branch.conv2.weight', 'local_branch.bn1.weight', 'local_branch.bn1.bias', 'local_branch.bn1.running_mean', 'local_branch.bn1.running_var', 'local_branch.bn1.num_batches_tracked', 'local_branch.layer1.0.conv1.weight', 'local_branch.layer1.0.bn1.weight', 'local_branch.layer1.0.bn1.bias', 'local_branch.layer1.0.bn1.running_mean', 'local_branch.layer1.0.bn1.running_var', 'local_branch.layer1.0.bn1.num_batches_tracked', 'local_branch.layer1.0.conv2.weight', 'local_branch.layer1.0.bn2.weight', 'local_branch.layer1.0.bn2.bias', 'local_branch.layer1.0.bn2.running_mean', 'local_branch.layer1.0.bn2.running_var', 'local_branch.layer1.0.bn2.num_batches_tracked', 'local_branch.layer1.0.conv3.weight', 'local_branch.layer1.0.bn3.weight', 'local_branch.layer1.0.bn3.bias', 'local_branch.layer1.0.bn3.running_mean', 'local_branch.layer1.0.bn3.running_var', 'local_branch.layer1.0.bn3.num_batches_tracked', 'local_branch.layer1.0.downsample.0.weight', 'local_branch.layer1.0.downsample.1.weight', 'local_branch.layer1.0.downsample.1.bias', 'local_branch.layer1.0.downsample.1.running_mean', 'local_branch.layer1.0.downsample.1.running_var', 'local_branch.layer1.0.downsample.1.num_batches_tracked', 'local_branch.layer1.1.conv1.weight', 'local_branch.layer1.1.bn1.weight', 'local_branch.layer1.1.bn1.bias', 'local_branch.layer1.1.bn1.running_mean', 'local_branch.layer1.1.bn1.running_var', 'local_branch.layer1.1.bn1.num_batches_tracked', 'local_branch.layer1.1.conv2.weight', 'local_branch.layer1.1.bn2.weight', 'local_branch.layer1.1.bn2.bias', 'local_branch.layer1.1.bn2.running_mean', 'local_branch.layer1.1.bn2.running_var', 'local_branch.layer1.1.bn2.num_batches_tracked', 'local_branch.layer1.1.conv3.weight', 'local_branch.layer1.1.bn3.weight', 'local_branch.layer1.1.bn3.bias', 'local_branch.layer1.1.bn3.running_mean', 'local_branch.layer1.1.bn3.running_var', 'local_branch.layer1.1.bn3.num_batches_tracked', 'local_branch.layer1.2.conv1.weight', 'local_branch.layer1.2.bn1.weight', 'local_branch.layer1.2.bn1.bias', 'local_branch.layer1.2.bn1.running_mean', 'local_branch.layer1.2.bn1.running_var', 'local_branch.layer1.2.bn1.num_batches_tracked', 'local_branch.layer1.2.conv2.weight', 'local_branch.layer1.2.bn2.weight', 'local_branch.layer1.2.bn2.bias', 'local_branch.layer1.2.bn2.running_mean', 'local_branch.layer1.2.bn2.running_var', 'local_branch.layer1.2.bn2.num_batches_tracked', 'local_branch.layer1.2.conv3.weight', 'local_branch.layer1.2.bn3.weight', 'local_branch.layer1.2.bn3.bias', 'local_branch.layer1.2.bn3.running_mean', 'local_branch.layer1.2.bn3.running_var', 'local_branch.layer1.2.bn3.num_batches_tracked', 'local_branch.layer2.0.conv1.weight', 'local_branch.layer2.0.bn1.weight', 'local_branch.layer2.0.bn1.bias', 'local_branch.layer2.0.bn1.running_mean', 'local_branch.layer2.0.bn1.running_var', 'local_branch.layer2.0.bn1.num_batches_tracked', 'local_branch.layer2.0.conv2.weight', 'local_branch.layer2.0.bn2.weight', 'local_branch.layer2.0.bn2.bias', 'local_branch.layer2.0.bn2.running_mean', 'local_branch.layer2.0.bn2.running_var', 'local_branch.layer2.0.bn2.num_batches_tracked', 'local_branch.layer2.0.conv3.weight', 'local_branch.layer2.0.bn3.weight', 'local_branch.layer2.0.bn3.bias', 'local_branch.layer2.0.bn3.running_mean', 'local_branch.layer2.0.bn3.running_var', 'local_branch.layer2.0.bn3.num_batches_tracked', 'local_branch.layer2.0.downsample.0.weight', 'local_branch.layer2.0.downsample.1.weight', 'local_branch.layer2.0.downsample.1.bias', 'local_branch.layer2.0.downsample.1.running_mean', 'local_branch.layer2.0.downsample.1.running_var', 'local_branch.layer2.0.downsample.1.num_batches_tracked', 'local_branch.layer2.1.conv1.weight', 'local_branch.layer2.1.bn1.weight', 'local_branch.layer2.1.bn1.bias', 'local_branch.layer2.1.bn1.running_mean', 'local_branch.layer2.1.bn1.running_var', 'local_branch.layer2.1.bn1.num_batches_tracked', 'local_branch.layer2.1.conv2.weight', 'local_branch.layer2.1.bn2.weight', 'local_branch.layer2.1.bn2.bias', 'local_branch.layer2.1.bn2.running_mean', 'local_branch.layer2.1.bn2.running_var', 'local_branch.layer2.1.bn2.num_batches_tracked', 'local_branch.layer2.1.conv3.weight', 'local_branch.layer2.1.bn3.weight', 'local_branch.layer2.1.bn3.bias', 'local_branch.layer2.1.bn3.running_mean', 'local_branch.layer2.1.bn3.running_var', 'local_branch.layer2.1.bn3.num_batches_tracked', 'local_branch.layer2.2.conv1.weight', 'local_branch.layer2.2.bn1.weight', 'local_branch.layer2.2.bn1.bias', 'local_branch.layer2.2.bn1.running_mean', 'local_branch.layer2.2.bn1.running_var', 'local_branch.layer2.2.bn1.num_batches_tracked', 'local_branch.layer2.2.conv2.weight', 'local_branch.layer2.2.bn2.weight', 'local_branch.layer2.2.bn2.bias', 'local_branch.layer2.2.bn2.running_mean', 'local_branch.layer2.2.bn2.running_var', 'local_branch.layer2.2.bn2.num_batches_tracked', 'local_branch.layer2.2.conv3.weight', 'local_branch.layer2.2.bn3.weight', 'local_branch.layer2.2.bn3.bias', 'local_branch.layer2.2.bn3.running_mean', 'local_branch.layer2.2.bn3.running_var', 'local_branch.layer2.2.bn3.num_batches_tracked', 'local_branch.layer2.3.conv1.weight', 'local_branch.layer2.3.bn1.weight', 'local_branch.layer2.3.bn1.bias', 'local_branch.layer2.3.bn1.running_mean', 'local_branch.layer2.3.bn1.running_var', 'local_branch.layer2.3.bn1.num_batches_tracked', 'local_branch.layer2.3.conv2.weight', 'local_branch.layer2.3.bn2.weight', 'local_branch.layer2.3.bn2.bias', 'local_branch.layer2.3.bn2.running_mean', 'local_branch.layer2.3.bn2.running_var', 'local_branch.layer2.3.bn2.num_batches_tracked', 'local_branch.layer2.3.conv3.weight', 'local_branch.layer2.3.bn3.weight', 'local_branch.layer2.3.bn3.bias', 'local_branch.layer2.3.bn3.running_mean', 'local_branch.layer2.3.bn3.running_var', 'local_branch.layer2.3.bn3.num_batches_tracked', 'local_branch.layer3.0.conv1.weight', 'local_branch.layer3.0.bn1.weight', 'local_branch.layer3.0.bn1.bias', 'local_branch.layer3.0.bn1.running_mean', 'local_branch.layer3.0.bn1.running_var', 'local_branch.layer3.0.bn1.num_batches_tracked', 'local_branch.layer3.0.conv2.weight', 'local_branch.layer3.0.bn2.weight', 'local_branch.layer3.0.bn2.bias', 'local_branch.layer3.0.bn2.running_mean', 'local_branch.layer3.0.bn2.running_var', 'local_branch.layer3.0.bn2.num_batches_tracked', 'local_branch.layer3.0.conv3.weight', 'local_branch.layer3.0.bn3.weight', 'local_branch.layer3.0.bn3.bias', 'local_branch.layer3.0.bn3.running_mean', 'local_branch.layer3.0.bn3.running_var', 'local_branch.layer3.0.bn3.num_batches_tracked', 'local_branch.layer3.0.downsample.0.weight', 'local_branch.layer3.0.downsample.1.weight', 'local_branch.layer3.0.downsample.1.bias', 'local_branch.layer3.0.downsample.1.running_mean', 'local_branch.layer3.0.downsample.1.running_var', 'local_branch.layer3.0.downsample.1.num_batches_tracked', 'local_branch.layer3.1.conv1.weight', 'local_branch.layer3.1.bn1.weight', 'local_branch.layer3.1.bn1.bias', 'local_branch.layer3.1.bn1.running_mean', 'local_branch.layer3.1.bn1.running_var', 'local_branch.layer3.1.bn1.num_batches_tracked', 'local_branch.layer3.1.conv2.weight', 'local_branch.layer3.1.bn2.weight', 'local_branch.layer3.1.bn2.bias', 'local_branch.layer3.1.bn2.running_mean', 'local_branch.layer3.1.bn2.running_var', 'local_branch.layer3.1.bn2.num_batches_tracked', 'local_branch.layer3.1.conv3.weight', 'local_branch.layer3.1.bn3.weight', 'local_branch.layer3.1.bn3.bias', 'local_branch.layer3.1.bn3.running_mean', 'local_branch.layer3.1.bn3.running_var', 'local_branch.layer3.1.bn3.num_batches_tracked', 'local_branch.layer3.2.conv1.weight', 'local_branch.layer3.2.bn1.weight', 'local_branch.layer3.2.bn1.bias', 'local_branch.layer3.2.bn1.running_mean', 'local_branch.layer3.2.bn1.running_var', 'local_branch.layer3.2.bn1.num_batches_tracked', 'local_branch.layer3.2.conv2.weight', 'local_branch.layer3.2.bn2.weight', 'local_branch.layer3.2.bn2.bias', 'local_branch.layer3.2.bn2.running_mean', 'local_branch.layer3.2.bn2.running_var', 'local_branch.layer3.2.bn2.num_batches_tracked', 'local_branch.layer3.2.conv3.weight', 'local_branch.layer3.2.bn3.weight', 'local_branch.layer3.2.bn3.bias', 'local_branch.layer3.2.bn3.running_mean', 'local_branch.layer3.2.bn3.running_var', 'local_branch.layer3.2.bn3.num_batches_tracked', 'local_branch.layer3.3.conv1.weight', 'local_branch.layer3.3.bn1.weight', 'local_branch.layer3.3.bn1.bias', 'local_branch.layer3.3.bn1.running_mean', 'local_branch.layer3.3.bn1.running_var', 'local_branch.layer3.3.bn1.num_batches_tracked', 'local_branch.layer3.3.conv2.weight', 'local_branch.layer3.3.bn2.weight', 'local_branch.layer3.3.bn2.bias', 'local_branch.layer3.3.bn2.running_mean', 'local_branch.layer3.3.bn2.running_var', 'local_branch.layer3.3.bn2.num_batches_tracked', 'local_branch.layer3.3.conv3.weight', 'local_branch.layer3.3.bn3.weight', 'local_branch.layer3.3.bn3.bias', 'local_branch.layer3.3.bn3.running_mean', 'local_branch.layer3.3.bn3.running_var', 'local_branch.layer3.3.bn3.num_batches_tracked', 'local_branch.layer3.4.conv1.weight', 'local_branch.layer3.4.bn1.weight', 'local_branch.layer3.4.bn1.bias', 'local_branch.layer3.4.bn1.running_mean', 'local_branch.layer3.4.bn1.running_var', 'local_branch.layer3.4.bn1.num_batches_tracked', 'local_branch.layer3.4.conv2.weight', 'local_branch.layer3.4.bn2.weight', 'local_branch.layer3.4.bn2.bias', 'local_branch.layer3.4.bn2.running_mean', 'local_branch.layer3.4.bn2.running_var', 'local_branch.layer3.4.bn2.num_batches_tracked', 'local_branch.layer3.4.conv3.weight', 'local_branch.layer3.4.bn3.weight', 'local_branch.layer3.4.bn3.bias', 'local_branch.layer3.4.bn3.running_mean', 'local_branch.layer3.4.bn3.running_var', 'local_branch.layer3.4.bn3.num_batches_tracked', 'local_branch.layer3.5.conv1.weight', 'local_branch.layer3.5.bn1.weight', 'local_branch.layer3.5.bn1.bias', 'local_branch.layer3.5.bn1.running_mean', 'local_branch.layer3.5.bn1.running_var', 'local_branch.layer3.5.bn1.num_batches_tracked', 'local_branch.layer3.5.conv2.weight', 'local_branch.layer3.5.bn2.weight', 'local_branch.layer3.5.bn2.bias', 'local_branch.layer3.5.bn2.running_mean', 'local_branch.layer3.5.bn2.running_var', 'local_branch.layer3.5.bn2.num_batches_tracked', 'local_branch.layer3.5.conv3.weight', 'local_branch.layer3.5.bn3.weight', 'local_branch.layer3.5.bn3.bias', 'local_branch.layer3.5.bn3.running_mean', 'local_branch.layer3.5.bn3.running_var', 'local_branch.layer3.5.bn3.num_batches_tracked', 'local_branch.layer4.0.conv1.weight', 'local_branch.layer4.0.bn1.weight', 'local_branch.layer4.0.bn1.bias', 'local_branch.layer4.0.bn1.running_mean', 'local_branch.layer4.0.bn1.running_var', 'local_branch.layer4.0.bn1.num_batches_tracked', 'local_branch.layer4.0.conv2.weight', 'local_branch.layer4.0.bn2.weight', 'local_branch.layer4.0.bn2.bias', 'local_branch.layer4.0.bn2.running_mean', 'local_branch.layer4.0.bn2.running_var', 'local_branch.layer4.0.bn2.num_batches_tracked', 'local_branch.layer4.0.conv3.weight', 'local_branch.layer4.0.bn3.weight', 'local_branch.layer4.0.bn3.bias', 'local_branch.layer4.0.bn3.running_mean', 'local_branch.layer4.0.bn3.running_var', 'local_branch.layer4.0.bn3.num_batches_tracked', 'local_branch.layer4.0.downsample.0.weight', 'local_branch.layer4.0.downsample.1.weight', 'local_branch.layer4.0.downsample.1.bias', 'local_branch.layer4.0.downsample.1.running_mean', 'local_branch.layer4.0.downsample.1.running_var', 'local_branch.layer4.0.downsample.1.num_batches_tracked', 'local_branch.layer4.1.conv1.weight', 'local_branch.layer4.1.bn1.weight', 'local_branch.layer4.1.bn1.bias', 'local_branch.layer4.1.bn1.running_mean', 'local_branch.layer4.1.bn1.running_var', 'local_branch.layer4.1.bn1.num_batches_tracked', 'local_branch.layer4.1.conv2.weight', 'local_branch.layer4.1.bn2.weight', 'local_branch.layer4.1.bn2.bias', 'local_branch.layer4.1.bn2.running_mean', 'local_branch.layer4.1.bn2.running_var', 'local_branch.layer4.1.bn2.num_batches_tracked', 'local_branch.layer4.1.conv3.weight', 'local_branch.layer4.1.bn3.weight', 'local_branch.layer4.1.bn3.bias', 'local_branch.layer4.1.bn3.running_mean', 'local_branch.layer4.1.bn3.running_var', 'local_branch.layer4.1.bn3.num_batches_tracked', 'local_branch.layer4.2.conv1.weight', 'local_branch.layer4.2.bn1.weight', 'local_branch.layer4.2.bn1.bias', 'local_branch.layer4.2.bn1.running_mean', 'local_branch.layer4.2.bn1.running_var', 'local_branch.layer4.2.bn1.num_batches_tracked', 'local_branch.layer4.2.conv2.weight', 'local_branch.layer4.2.bn2.weight', 'local_branch.layer4.2.bn2.bias', 'local_branch.layer4.2.bn2.running_mean', 'local_branch.layer4.2.bn2.running_var', 'local_branch.layer4.2.bn2.num_batches_tracked', 'local_branch.layer4.2.conv3.weight', 'local_branch.layer4.2.bn3.weight', 'local_branch.layer4.2.bn3.bias', 'local_branch.layer4.2.bn3.running_mean', 'local_branch.layer4.2.bn3.running_var', 'local_branch.layer4.2.bn3.num_batches_tracked', 'local_branch.fc.weight', 'local_branch.fc.bias', 'fusion_branch.encoder.enc_layers.0.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.0.layernorm1.weight', 'fusion_branch.encoder.enc_layers.0.layernorm1.bias', 'fusion_branch.encoder.enc_layers.0.layernorm2.weight', 'fusion_branch.encoder.enc_layers.0.layernorm2.bias', 'fusion_branch.encoder.enc_layers.1.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.1.layernorm1.weight', 'fusion_branch.encoder.enc_layers.1.layernorm1.bias', 'fusion_branch.encoder.enc_layers.1.layernorm2.weight', 'fusion_branch.encoder.enc_layers.1.layernorm2.bias', 'fusion_branch.encoder.enc_layers.2.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.2.layernorm1.weight', 'fusion_branch.encoder.enc_layers.2.layernorm1.bias', 'fusion_branch.encoder.enc_layers.2.layernorm2.weight', 'fusion_branch.encoder.enc_layers.2.layernorm2.bias', 'fusion_branch.encoder.enc_layers.3.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.3.layernorm1.weight', 'fusion_branch.encoder.enc_layers.3.layernorm1.bias', 'fusion_branch.encoder.enc_layers.3.layernorm2.weight', 'fusion_branch.encoder.enc_layers.3.layernorm2.bias', 'fusion_branch.dense.weight', 'fusion_branch.dense.bias'])
thief state:  None
pretrained state:  dict_keys([])
Thief model initialized successfully
specificity = 80/80
sensitivity = 0/42
Initial model on target dataset: acc = 0.4016, agreement = 0.3770, f1 = 0.1910, spec = 1.0000, sens = 0.0000
specificity = 37/37
sensitivity = 0/63
Initial model on validation dataset: acc = 0.2100, agreement = 0.2100, f1 = 0.1157, spec = 1.0000, sens = 0.0000
la:  None
>> Train a Model.
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:27<22:45, 27.87s/it]  4%|▍         | 2/50 [00:59<23:59, 30.00s/it]  6%|▌         | 3/50 [01:28<23:03, 29.43s/it]  8%|▊         | 4/50 [02:02<23:59, 31.29s/it] 10%|█         | 5/50 [03:12<33:57, 45.28s/it]Epoch 5: Train acc/f1 = 0.7178 / 0.5932 / 0.5311 / 0.9066 
                Val acc/f1/spec/sens = 0.7500 / 0.5849 / 0.3514 / 1.0000
                Test acc/f1/spec/sens = 0.6230 / 0.6136 / 0.4750 / 0.9286
 12%|█▏        | 6/50 [03:57<33:13, 45.30s/it] 14%|█▍        | 7/50 [04:32<30:07, 42.03s/it] 16%|█▌        | 8/50 [05:11<28:43, 41.03s/it] 18%|█▊        | 9/50 [05:46<26:45, 39.16s/it] 20%|██        | 10/50 [07:21<37:28, 56.22s/it]Epoch 10: Train acc/f1 = 0.7667 / 0.6849 / 0.6988 / 0.8875 
                Val acc/f1/spec/sens = 0.8700 / 0.8247 / 0.7568 / 0.9683
                Test acc/f1/spec/sens = 0.7131 / 0.7275 / 0.6125 / 0.9286
 22%|██▏       | 11/50 [07:57<32:28, 49.97s/it] 24%|██▍       | 12/50 [08:36<29:35, 46.72s/it] 26%|██▌       | 13/50 [09:11<26:37, 43.17s/it] 28%|██▊       | 14/50 [09:48<24:48, 41.34s/it] 30%|███       | 15/50 [11:08<30:56, 53.03s/it]Epoch 15: Train acc/f1 = 0.7667 / 0.6605 / 0.5839 / 0.9394 
                Val acc/f1/spec/sens = 0.8700 / 0.8157 / 0.7027 / 1.0000
                Test acc/f1/spec/sens = 0.6475 / 0.6500 / 0.5125 / 0.9286
 32%|███▏      | 16/50 [11:48<27:51, 49.15s/it] 34%|███▍      | 17/50 [12:19<24:01, 43.69s/it] 36%|███▌      | 18/50 [12:56<22:11, 41.62s/it] 38%|███▊      | 19/50 [13:28<19:55, 38.57s/it] 40%|████      | 20/50 [14:39<24:09, 48.31s/it]Epoch 20: Train acc/f1 = 0.7889 / 0.7051 / 0.6832 / 0.9152 
                Val acc/f1/spec/sens = 0.8600 / 0.8109 / 0.7297 / 0.9683
                Test acc/f1/spec/sens = 0.6967 / 0.7093 / 0.5875 / 0.9286
 42%|████▏     | 21/50 [15:10<20:57, 43.37s/it] 44%|████▍     | 22/50 [15:44<18:53, 40.49s/it] 46%|████▌     | 23/50 [16:16<17:03, 37.91s/it] 48%|████▊     | 24/50 [16:51<16:02, 37.03s/it] 50%|█████     | 25/50 [18:01<19:30, 46.84s/it]Epoch 25: Train acc/f1 = 0.7733 / 0.6770 / 0.6708 / 0.9135 
                Val acc/f1/spec/sens = 0.8600 / 0.8109 / 0.7297 / 0.9683
                Test acc/f1/spec/sens = 0.6639 / 0.6746 / 0.5500 / 0.9048
 52%|█████▏    | 26/50 [18:34<17:08, 42.86s/it] 54%|█████▍    | 27/50 [19:07<15:12, 39.68s/it] 56%|█████▌    | 28/50 [19:41<14:00, 38.20s/it] 58%|█████▊    | 29/50 [20:12<12:36, 36.02s/it] 60%|██████    | 30/50 [21:33<16:26, 49.31s/it]Epoch 30: Train acc/f1 = 0.8033 / 0.7332 / 0.6739 / 0.9308 
                Val acc/f1/spec/sens = 0.8500 / 0.7924 / 0.7297 / 0.9683
                Test acc/f1/spec/sens = 0.6557 / 0.6628 / 0.5375 / 0.9286
 62%|██████▏   | 31/50 [22:05<13:58, 44.12s/it] 64%|██████▍   | 32/50 [22:44<12:49, 42.74s/it] 66%|██████▌   | 33/50 [23:15<11:05, 39.13s/it] 68%|██████▊   | 34/50 [23:51<10:09, 38.09s/it] 70%|███████   | 35/50 [25:05<12:15, 49.05s/it]Epoch 35: Train acc/f1 = 0.8011 / 0.7276 / 0.7019 / 0.9221 
                Val acc/f1/spec/sens = 0.8600 / 0.8067 / 0.7568 / 0.9683
                Test acc/f1/spec/sens = 0.7131 / 0.7299 / 0.6250 / 0.9048
 72%|███████▏  | 36/50 [25:58<11:41, 50.12s/it] 74%|███████▍  | 37/50 [26:41<10:23, 47.97s/it] 76%|███████▌  | 38/50 [27:27<09:29, 47.48s/it] 78%|███████▊  | 39/50 [28:11<08:30, 46.45s/it] 80%|████████  | 40/50 [29:59<10:48, 64.90s/it]Epoch 40: Train acc/f1 = 0.7756 / 0.6941 / 0.7267 / 0.8858 
                Val acc/f1/spec/sens = 0.8500 / 0.7924 / 0.7297 / 0.9683
                Test acc/f1/spec/sens = 0.6885 / 0.7030 / 0.5875 / 0.9048
 82%|████████▏ | 41/50 [30:43<08:46, 58.50s/it] 84%|████████▍ | 42/50 [31:33<07:28, 56.08s/it] 86%|████████▌ | 43/50 [32:05<05:41, 48.84s/it] 88%|████████▊ | 44/50 [32:42<04:31, 45.21s/it] 90%|█████████ | 45/50 [33:49<04:18, 51.72s/it]Epoch 45: Train acc/f1 = 0.7922 / 0.7192 / 0.6304 / 0.9291 
                Val acc/f1/spec/sens = 0.8600 / 0.8109 / 0.7297 / 0.9683
                Test acc/f1/spec/sens = 0.6148 / 0.6161 / 0.4750 / 0.9286
 92%|█████████▏| 46/50 [34:25<03:07, 46.98s/it] 94%|█████████▍| 47/50 [34:56<02:06, 42.27s/it] 96%|█████████▌| 48/50 [35:29<01:19, 39.67s/it] 98%|█████████▊| 49/50 [36:01<00:37, 37.25s/it]100%|██████████| 50/50 [37:20<00:00, 49.81s/it]                                               Epoch 50: Train acc/f1 = 0.7911 / 0.7134 / 0.7360 / 0.8997 
                Val acc/f1/spec/sens = 0.8500 / 0.7978 / 0.7568 / 0.9524
                Test acc/f1/spec/sens = 0.7049 / 0.7195 / 0.6250 / 0.9286
specificity = 229/322
sensitivity = 514/578
specificity = 28/37
sensitivity = 60/63
specificity = 50/80
sensitivity = 39/42
Trial 2, Cycle 1
Train acc/f1/spec/sens = 0.7722 / 0.6848 / 0.7112 / 0.8893
Val acc/f1/spec/sens = 0.8500 / 0.7978 / 0.7568 / 0.9524
Test acc/f1/spec/sens = 0.7049 / 0.7195 / 0.6250 / 0.9286
>> Finished.
specificity = 50/80
sensitivity = 39/42
Acc, agreement for latest model:  0.7049180327868853 0.7377049180327869
Load best checkpoint for thief model
specificity = 49/80
sensitivity = 39/42
Acc, agreement for best model:  0.7131147540983607 0.7459016393442623
Trial 1/5 || Cycle 1/1 || Label set size 900 || Test acc 0.7131 || Test agreement 0.7459 || Spec 0.6125 || Sens 0.9286
**************************************************************************************************** 

specificity = 49/80
sensitivity = 39/42
Number of samples  900
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:01<00:44,  1.58s/it]  7%|▋         | 2/29 [00:02<00:27,  1.04s/it] 10%|█         | 3/29 [00:03<00:26,  1.04s/it] 14%|█▍        | 4/29 [00:03<00:22,  1.11it/s] 17%|█▋        | 5/29 [00:04<00:18,  1.30it/s] 21%|██        | 6/29 [00:05<00:17,  1.34it/s] 24%|██▍       | 7/29 [00:05<00:16,  1.33it/s] 28%|██▊       | 8/29 [00:06<00:16,  1.29it/s] 31%|███       | 9/29 [00:07<00:16,  1.23it/s] 34%|███▍      | 10/29 [00:08<00:16,  1.18it/s] 38%|███▊      | 11/29 [00:09<00:15,  1.15it/s] 41%|████▏     | 12/29 [00:10<00:14,  1.18it/s] 45%|████▍     | 13/29 [00:10<00:12,  1.27it/s] 48%|████▊     | 14/29 [00:11<00:12,  1.23it/s] 52%|█████▏    | 15/29 [00:12<00:10,  1.28it/s] 55%|█████▌    | 16/29 [00:13<00:09,  1.43it/s] 59%|█████▊    | 17/29 [00:13<00:08,  1.45it/s] 62%|██████▏   | 18/29 [00:14<00:07,  1.57it/s] 66%|██████▌   | 19/29 [00:14<00:06,  1.65it/s] 69%|██████▉   | 20/29 [00:15<00:05,  1.73it/s] 72%|███████▏  | 21/29 [00:15<00:04,  1.86it/s] 76%|███████▌  | 22/29 [00:16<00:03,  1.86it/s] 79%|███████▉  | 23/29 [00:16<00:03,  1.90it/s] 83%|████████▎ | 24/29 [00:17<00:02,  1.86it/s] 86%|████████▌ | 25/29 [00:17<00:02,  1.84it/s] 90%|████████▉ | 26/29 [00:18<00:01,  1.83it/s] 93%|█████████▎| 27/29 [00:19<00:01,  1.64it/s] 97%|█████████▋| 28/29 [00:19<00:00,  1.65it/s]100%|██████████| 29/29 [00:20<00:00,  1.44it/s]
replacing val labels with victim labels
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.65s/it] 50%|█████     | 2/4 [00:02<00:02,  1.05s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.14it/s]100%|██████████| 4/4 [00:03<00:00,  1.70it/s]100%|██████████| 4/4 [00:03<00:00,  1.22it/s]Validation set distribution: 
Number of samples  100

{0: 13, 1: 19, 2: 68}
Labeled set distribution: 
Number of samples  900
{0: 98, 1: 215, 2: 587}
odict_keys(['global_branch.net.conv1.weight', 'global_branch.net.bn1.weight', 'global_branch.net.bn1.bias', 'global_branch.net.bn1.running_mean', 'global_branch.net.bn1.running_var', 'global_branch.net.bn1.num_batches_tracked', 'global_branch.net.layer1.0.conv1.weight', 'global_branch.net.layer1.0.bn1.weight', 'global_branch.net.layer1.0.bn1.bias', 'global_branch.net.layer1.0.bn1.running_mean', 'global_branch.net.layer1.0.bn1.running_var', 'global_branch.net.layer1.0.bn1.num_batches_tracked', 'global_branch.net.layer1.0.conv2.weight', 'global_branch.net.layer1.0.bn2.weight', 'global_branch.net.layer1.0.bn2.bias', 'global_branch.net.layer1.0.bn2.running_mean', 'global_branch.net.layer1.0.bn2.running_var', 'global_branch.net.layer1.0.bn2.num_batches_tracked', 'global_branch.net.layer1.0.conv3.weight', 'global_branch.net.layer1.0.bn3.weight', 'global_branch.net.layer1.0.bn3.bias', 'global_branch.net.layer1.0.bn3.running_mean', 'global_branch.net.layer1.0.bn3.running_var', 'global_branch.net.layer1.0.bn3.num_batches_tracked', 'global_branch.net.layer1.0.downsample.0.weight', 'global_branch.net.layer1.0.downsample.1.weight', 'global_branch.net.layer1.0.downsample.1.bias', 'global_branch.net.layer1.0.downsample.1.running_mean', 'global_branch.net.layer1.0.downsample.1.running_var', 'global_branch.net.layer1.0.downsample.1.num_batches_tracked', 'global_branch.net.layer1.1.conv1.weight', 'global_branch.net.layer1.1.bn1.weight', 'global_branch.net.layer1.1.bn1.bias', 'global_branch.net.layer1.1.bn1.running_mean', 'global_branch.net.layer1.1.bn1.running_var', 'global_branch.net.layer1.1.bn1.num_batches_tracked', 'global_branch.net.layer1.1.conv2.weight', 'global_branch.net.layer1.1.bn2.weight', 'global_branch.net.layer1.1.bn2.bias', 'global_branch.net.layer1.1.bn2.running_mean', 'global_branch.net.layer1.1.bn2.running_var', 'global_branch.net.layer1.1.bn2.num_batches_tracked', 'global_branch.net.layer1.1.conv3.weight', 'global_branch.net.layer1.1.bn3.weight', 'global_branch.net.layer1.1.bn3.bias', 'global_branch.net.layer1.1.bn3.running_mean', 'global_branch.net.layer1.1.bn3.running_var', 'global_branch.net.layer1.1.bn3.num_batches_tracked', 'global_branch.net.layer1.2.conv1.weight', 'global_branch.net.layer1.2.bn1.weight', 'global_branch.net.layer1.2.bn1.bias', 'global_branch.net.layer1.2.bn1.running_mean', 'global_branch.net.layer1.2.bn1.running_var', 'global_branch.net.layer1.2.bn1.num_batches_tracked', 'global_branch.net.layer1.2.conv2.weight', 'global_branch.net.layer1.2.bn2.weight', 'global_branch.net.layer1.2.bn2.bias', 'global_branch.net.layer1.2.bn2.running_mean', 'global_branch.net.layer1.2.bn2.running_var', 'global_branch.net.layer1.2.bn2.num_batches_tracked', 'global_branch.net.layer1.2.conv3.weight', 'global_branch.net.layer1.2.bn3.weight', 'global_branch.net.layer1.2.bn3.bias', 'global_branch.net.layer1.2.bn3.running_mean', 'global_branch.net.layer1.2.bn3.running_var', 'global_branch.net.layer1.2.bn3.num_batches_tracked', 'global_branch.net.layer2.0.conv1.weight', 'global_branch.net.layer2.0.bn1.weight', 'global_branch.net.layer2.0.bn1.bias', 'global_branch.net.layer2.0.bn1.running_mean', 'global_branch.net.layer2.0.bn1.running_var', 'global_branch.net.layer2.0.bn1.num_batches_tracked', 'global_branch.net.layer2.0.conv2.weight', 'global_branch.net.layer2.0.bn2.weight', 'global_branch.net.layer2.0.bn2.bias', 'global_branch.net.layer2.0.bn2.running_mean', 'global_branch.net.layer2.0.bn2.running_var', 'global_branch.net.layer2.0.bn2.num_batches_tracked', 'global_branch.net.layer2.0.conv3.weight', 'global_branch.net.layer2.0.bn3.weight', 'global_branch.net.layer2.0.bn3.bias', 'global_branch.net.layer2.0.bn3.running_mean', 'global_branch.net.layer2.0.bn3.running_var', 'global_branch.net.layer2.0.bn3.num_batches_tracked', 'global_branch.net.layer2.0.downsample.0.weight', 'global_branch.net.layer2.0.downsample.1.weight', 'global_branch.net.layer2.0.downsample.1.bias', 'global_branch.net.layer2.0.downsample.1.running_mean', 'global_branch.net.layer2.0.downsample.1.running_var', 'global_branch.net.layer2.0.downsample.1.num_batches_tracked', 'global_branch.net.layer2.1.conv1.weight', 'global_branch.net.layer2.1.bn1.weight', 'global_branch.net.layer2.1.bn1.bias', 'global_branch.net.layer2.1.bn1.running_mean', 'global_branch.net.layer2.1.bn1.running_var', 'global_branch.net.layer2.1.bn1.num_batches_tracked', 'global_branch.net.layer2.1.conv2.weight', 'global_branch.net.layer2.1.bn2.weight', 'global_branch.net.layer2.1.bn2.bias', 'global_branch.net.layer2.1.bn2.running_mean', 'global_branch.net.layer2.1.bn2.running_var', 'global_branch.net.layer2.1.bn2.num_batches_tracked', 'global_branch.net.layer2.1.conv3.weight', 'global_branch.net.layer2.1.bn3.weight', 'global_branch.net.layer2.1.bn3.bias', 'global_branch.net.layer2.1.bn3.running_mean', 'global_branch.net.layer2.1.bn3.running_var', 'global_branch.net.layer2.1.bn3.num_batches_tracked', 'global_branch.net.layer2.2.conv1.weight', 'global_branch.net.layer2.2.bn1.weight', 'global_branch.net.layer2.2.bn1.bias', 'global_branch.net.layer2.2.bn1.running_mean', 'global_branch.net.layer2.2.bn1.running_var', 'global_branch.net.layer2.2.bn1.num_batches_tracked', 'global_branch.net.layer2.2.conv2.weight', 'global_branch.net.layer2.2.bn2.weight', 'global_branch.net.layer2.2.bn2.bias', 'global_branch.net.layer2.2.bn2.running_mean', 'global_branch.net.layer2.2.bn2.running_var', 'global_branch.net.layer2.2.bn2.num_batches_tracked', 'global_branch.net.layer2.2.conv3.weight', 'global_branch.net.layer2.2.bn3.weight', 'global_branch.net.layer2.2.bn3.bias', 'global_branch.net.layer2.2.bn3.running_mean', 'global_branch.net.layer2.2.bn3.running_var', 'global_branch.net.layer2.2.bn3.num_batches_tracked', 'global_branch.net.layer2.3.conv1.weight', 'global_branch.net.layer2.3.bn1.weight', 'global_branch.net.layer2.3.bn1.bias', 'global_branch.net.layer2.3.bn1.running_mean', 'global_branch.net.layer2.3.bn1.running_var', 'global_branch.net.layer2.3.bn1.num_batches_tracked', 'global_branch.net.layer2.3.conv2.weight', 'global_branch.net.layer2.3.bn2.weight', 'global_branch.net.layer2.3.bn2.bias', 'global_branch.net.layer2.3.bn2.running_mean', 'global_branch.net.layer2.3.bn2.running_var', 'global_branch.net.layer2.3.bn2.num_batches_tracked', 'global_branch.net.layer2.3.conv3.weight', 'global_branch.net.layer2.3.bn3.weight', 'global_branch.net.layer2.3.bn3.bias', 'global_branch.net.layer2.3.bn3.running_mean', 'global_branch.net.layer2.3.bn3.running_var', 'global_branch.net.layer2.3.bn3.num_batches_tracked', 'global_branch.net.layer3.0.conv1.weight', 'global_branch.net.layer3.0.bn1.weight', 'global_branch.net.layer3.0.bn1.bias', 'global_branch.net.layer3.0.bn1.running_mean', 'global_branch.net.layer3.0.bn1.running_var', 'global_branch.net.layer3.0.bn1.num_batches_tracked', 'global_branch.net.layer3.0.conv2.weight', 'global_branch.net.layer3.0.bn2.weight', 'global_branch.net.layer3.0.bn2.bias', 'global_branch.net.layer3.0.bn2.running_mean', 'global_branch.net.layer3.0.bn2.running_var', 'global_branch.net.layer3.0.bn2.num_batches_tracked', 'global_branch.net.layer3.0.conv3.weight', 'global_branch.net.layer3.0.bn3.weight', 'global_branch.net.layer3.0.bn3.bias', 'global_branch.net.layer3.0.bn3.running_mean', 'global_branch.net.layer3.0.bn3.running_var', 'global_branch.net.layer3.0.bn3.num_batches_tracked', 'global_branch.net.layer3.0.downsample.0.weight', 'global_branch.net.layer3.0.downsample.1.weight', 'global_branch.net.layer3.0.downsample.1.bias', 'global_branch.net.layer3.0.downsample.1.running_mean', 'global_branch.net.layer3.0.downsample.1.running_var', 'global_branch.net.layer3.0.downsample.1.num_batches_tracked', 'global_branch.net.layer3.1.conv1.weight', 'global_branch.net.layer3.1.bn1.weight', 'global_branch.net.layer3.1.bn1.bias', 'global_branch.net.layer3.1.bn1.running_mean', 'global_branch.net.layer3.1.bn1.running_var', 'global_branch.net.layer3.1.bn1.num_batches_tracked', 'global_branch.net.layer3.1.conv2.weight', 'global_branch.net.layer3.1.bn2.weight', 'global_branch.net.layer3.1.bn2.bias', 'global_branch.net.layer3.1.bn2.running_mean', 'global_branch.net.layer3.1.bn2.running_var', 'global_branch.net.layer3.1.bn2.num_batches_tracked', 'global_branch.net.layer3.1.conv3.weight', 'global_branch.net.layer3.1.bn3.weight', 'global_branch.net.layer3.1.bn3.bias', 'global_branch.net.layer3.1.bn3.running_mean', 'global_branch.net.layer3.1.bn3.running_var', 'global_branch.net.layer3.1.bn3.num_batches_tracked', 'global_branch.net.layer3.2.conv1.weight', 'global_branch.net.layer3.2.bn1.weight', 'global_branch.net.layer3.2.bn1.bias', 'global_branch.net.layer3.2.bn1.running_mean', 'global_branch.net.layer3.2.bn1.running_var', 'global_branch.net.layer3.2.bn1.num_batches_tracked', 'global_branch.net.layer3.2.conv2.weight', 'global_branch.net.layer3.2.bn2.weight', 'global_branch.net.layer3.2.bn2.bias', 'global_branch.net.layer3.2.bn2.running_mean', 'global_branch.net.layer3.2.bn2.running_var', 'global_branch.net.layer3.2.bn2.num_batches_tracked', 'global_branch.net.layer3.2.conv3.weight', 'global_branch.net.layer3.2.bn3.weight', 'global_branch.net.layer3.2.bn3.bias', 'global_branch.net.layer3.2.bn3.running_mean', 'global_branch.net.layer3.2.bn3.running_var', 'global_branch.net.layer3.2.bn3.num_batches_tracked', 'global_branch.net.layer3.3.conv1.weight', 'global_branch.net.layer3.3.bn1.weight', 'global_branch.net.layer3.3.bn1.bias', 'global_branch.net.layer3.3.bn1.running_mean', 'global_branch.net.layer3.3.bn1.running_var', 'global_branch.net.layer3.3.bn1.num_batches_tracked', 'global_branch.net.layer3.3.conv2.weight', 'global_branch.net.layer3.3.bn2.weight', 'global_branch.net.layer3.3.bn2.bias', 'global_branch.net.layer3.3.bn2.running_mean', 'global_branch.net.layer3.3.bn2.running_var', 'global_branch.net.layer3.3.bn2.num_batches_tracked', 'global_branch.net.layer3.3.conv3.weight', 'global_branch.net.layer3.3.bn3.weight', 'global_branch.net.layer3.3.bn3.bias', 'global_branch.net.layer3.3.bn3.running_mean', 'global_branch.net.layer3.3.bn3.running_var', 'global_branch.net.layer3.3.bn3.num_batches_tracked', 'global_branch.net.layer3.4.conv1.weight', 'global_branch.net.layer3.4.bn1.weight', 'global_branch.net.layer3.4.bn1.bias', 'global_branch.net.layer3.4.bn1.running_mean', 'global_branch.net.layer3.4.bn1.running_var', 'global_branch.net.layer3.4.bn1.num_batches_tracked', 'global_branch.net.layer3.4.conv2.weight', 'global_branch.net.layer3.4.bn2.weight', 'global_branch.net.layer3.4.bn2.bias', 'global_branch.net.layer3.4.bn2.running_mean', 'global_branch.net.layer3.4.bn2.running_var', 'global_branch.net.layer3.4.bn2.num_batches_tracked', 'global_branch.net.layer3.4.conv3.weight', 'global_branch.net.layer3.4.bn3.weight', 'global_branch.net.layer3.4.bn3.bias', 'global_branch.net.layer3.4.bn3.running_mean', 'global_branch.net.layer3.4.bn3.running_var', 'global_branch.net.layer3.4.bn3.num_batches_tracked', 'global_branch.net.layer3.5.conv1.weight', 'global_branch.net.layer3.5.bn1.weight', 'global_branch.net.layer3.5.bn1.bias', 'global_branch.net.layer3.5.bn1.running_mean', 'global_branch.net.layer3.5.bn1.running_var', 'global_branch.net.layer3.5.bn1.num_batches_tracked', 'global_branch.net.layer3.5.conv2.weight', 'global_branch.net.layer3.5.bn2.weight', 'global_branch.net.layer3.5.bn2.bias', 'global_branch.net.layer3.5.bn2.running_mean', 'global_branch.net.layer3.5.bn2.running_var', 'global_branch.net.layer3.5.bn2.num_batches_tracked', 'global_branch.net.layer3.5.conv3.weight', 'global_branch.net.layer3.5.bn3.weight', 'global_branch.net.layer3.5.bn3.bias', 'global_branch.net.layer3.5.bn3.running_mean', 'global_branch.net.layer3.5.bn3.running_var', 'global_branch.net.layer3.5.bn3.num_batches_tracked', 'global_branch.net.layer4.0.conv1.weight', 'global_branch.net.layer4.0.bn1.weight', 'global_branch.net.layer4.0.bn1.bias', 'global_branch.net.layer4.0.bn1.running_mean', 'global_branch.net.layer4.0.bn1.running_var', 'global_branch.net.layer4.0.bn1.num_batches_tracked', 'global_branch.net.layer4.0.conv2.weight', 'global_branch.net.layer4.0.bn2.weight', 'global_branch.net.layer4.0.bn2.bias', 'global_branch.net.layer4.0.bn2.running_mean', 'global_branch.net.layer4.0.bn2.running_var', 'global_branch.net.layer4.0.bn2.num_batches_tracked', 'global_branch.net.layer4.0.conv3.weight', 'global_branch.net.layer4.0.bn3.weight', 'global_branch.net.layer4.0.bn3.bias', 'global_branch.net.layer4.0.bn3.running_mean', 'global_branch.net.layer4.0.bn3.running_var', 'global_branch.net.layer4.0.bn3.num_batches_tracked', 'global_branch.net.layer4.0.downsample.0.weight', 'global_branch.net.layer4.0.downsample.1.weight', 'global_branch.net.layer4.0.downsample.1.bias', 'global_branch.net.layer4.0.downsample.1.running_mean', 'global_branch.net.layer4.0.downsample.1.running_var', 'global_branch.net.layer4.0.downsample.1.num_batches_tracked', 'global_branch.net.layer4.1.conv1.weight', 'global_branch.net.layer4.1.bn1.weight', 'global_branch.net.layer4.1.bn1.bias', 'global_branch.net.layer4.1.bn1.running_mean', 'global_branch.net.layer4.1.bn1.running_var', 'global_branch.net.layer4.1.bn1.num_batches_tracked', 'global_branch.net.layer4.1.conv2.weight', 'global_branch.net.layer4.1.bn2.weight', 'global_branch.net.layer4.1.bn2.bias', 'global_branch.net.layer4.1.bn2.running_mean', 'global_branch.net.layer4.1.bn2.running_var', 'global_branch.net.layer4.1.bn2.num_batches_tracked', 'global_branch.net.layer4.1.conv3.weight', 'global_branch.net.layer4.1.bn3.weight', 'global_branch.net.layer4.1.bn3.bias', 'global_branch.net.layer4.1.bn3.running_mean', 'global_branch.net.layer4.1.bn3.running_var', 'global_branch.net.layer4.1.bn3.num_batches_tracked', 'global_branch.net.layer4.2.conv1.weight', 'global_branch.net.layer4.2.bn1.weight', 'global_branch.net.layer4.2.bn1.bias', 'global_branch.net.layer4.2.bn1.running_mean', 'global_branch.net.layer4.2.bn1.running_var', 'global_branch.net.layer4.2.bn1.num_batches_tracked', 'global_branch.net.layer4.2.conv2.weight', 'global_branch.net.layer4.2.bn2.weight', 'global_branch.net.layer4.2.bn2.bias', 'global_branch.net.layer4.2.bn2.running_mean', 'global_branch.net.layer4.2.bn2.running_var', 'global_branch.net.layer4.2.bn2.num_batches_tracked', 'global_branch.net.layer4.2.conv3.weight', 'global_branch.net.layer4.2.bn3.weight', 'global_branch.net.layer4.2.bn3.bias', 'global_branch.net.layer4.2.bn3.running_mean', 'global_branch.net.layer4.2.bn3.running_var', 'global_branch.net.layer4.2.bn3.num_batches_tracked', 'global_branch.net.fc.weight', 'global_branch.net.fc.bias', 'local_branch.conv1.weight', 'local_branch.conv2.weight', 'local_branch.bn1.weight', 'local_branch.bn1.bias', 'local_branch.bn1.running_mean', 'local_branch.bn1.running_var', 'local_branch.bn1.num_batches_tracked', 'local_branch.layer1.0.conv1.weight', 'local_branch.layer1.0.bn1.weight', 'local_branch.layer1.0.bn1.bias', 'local_branch.layer1.0.bn1.running_mean', 'local_branch.layer1.0.bn1.running_var', 'local_branch.layer1.0.bn1.num_batches_tracked', 'local_branch.layer1.0.conv2.weight', 'local_branch.layer1.0.bn2.weight', 'local_branch.layer1.0.bn2.bias', 'local_branch.layer1.0.bn2.running_mean', 'local_branch.layer1.0.bn2.running_var', 'local_branch.layer1.0.bn2.num_batches_tracked', 'local_branch.layer1.0.conv3.weight', 'local_branch.layer1.0.bn3.weight', 'local_branch.layer1.0.bn3.bias', 'local_branch.layer1.0.bn3.running_mean', 'local_branch.layer1.0.bn3.running_var', 'local_branch.layer1.0.bn3.num_batches_tracked', 'local_branch.layer1.0.downsample.0.weight', 'local_branch.layer1.0.downsample.1.weight', 'local_branch.layer1.0.downsample.1.bias', 'local_branch.layer1.0.downsample.1.running_mean', 'local_branch.layer1.0.downsample.1.running_var', 'local_branch.layer1.0.downsample.1.num_batches_tracked', 'local_branch.layer1.1.conv1.weight', 'local_branch.layer1.1.bn1.weight', 'local_branch.layer1.1.bn1.bias', 'local_branch.layer1.1.bn1.running_mean', 'local_branch.layer1.1.bn1.running_var', 'local_branch.layer1.1.bn1.num_batches_tracked', 'local_branch.layer1.1.conv2.weight', 'local_branch.layer1.1.bn2.weight', 'local_branch.layer1.1.bn2.bias', 'local_branch.layer1.1.bn2.running_mean', 'local_branch.layer1.1.bn2.running_var', 'local_branch.layer1.1.bn2.num_batches_tracked', 'local_branch.layer1.1.conv3.weight', 'local_branch.layer1.1.bn3.weight', 'local_branch.layer1.1.bn3.bias', 'local_branch.layer1.1.bn3.running_mean', 'local_branch.layer1.1.bn3.running_var', 'local_branch.layer1.1.bn3.num_batches_tracked', 'local_branch.layer1.2.conv1.weight', 'local_branch.layer1.2.bn1.weight', 'local_branch.layer1.2.bn1.bias', 'local_branch.layer1.2.bn1.running_mean', 'local_branch.layer1.2.bn1.running_var', 'local_branch.layer1.2.bn1.num_batches_tracked', 'local_branch.layer1.2.conv2.weight', 'local_branch.layer1.2.bn2.weight', 'local_branch.layer1.2.bn2.bias', 'local_branch.layer1.2.bn2.running_mean', 'local_branch.layer1.2.bn2.running_var', 'local_branch.layer1.2.bn2.num_batches_tracked', 'local_branch.layer1.2.conv3.weight', 'local_branch.layer1.2.bn3.weight', 'local_branch.layer1.2.bn3.bias', 'local_branch.layer1.2.bn3.running_mean', 'local_branch.layer1.2.bn3.running_var', 'local_branch.layer1.2.bn3.num_batches_tracked', 'local_branch.layer2.0.conv1.weight', 'local_branch.layer2.0.bn1.weight', 'local_branch.layer2.0.bn1.bias', 'local_branch.layer2.0.bn1.running_mean', 'local_branch.layer2.0.bn1.running_var', 'local_branch.layer2.0.bn1.num_batches_tracked', 'local_branch.layer2.0.conv2.weight', 'local_branch.layer2.0.bn2.weight', 'local_branch.layer2.0.bn2.bias', 'local_branch.layer2.0.bn2.running_mean', 'local_branch.layer2.0.bn2.running_var', 'local_branch.layer2.0.bn2.num_batches_tracked', 'local_branch.layer2.0.conv3.weight', 'local_branch.layer2.0.bn3.weight', 'local_branch.layer2.0.bn3.bias', 'local_branch.layer2.0.bn3.running_mean', 'local_branch.layer2.0.bn3.running_var', 'local_branch.layer2.0.bn3.num_batches_tracked', 'local_branch.layer2.0.downsample.0.weight', 'local_branch.layer2.0.downsample.1.weight', 'local_branch.layer2.0.downsample.1.bias', 'local_branch.layer2.0.downsample.1.running_mean', 'local_branch.layer2.0.downsample.1.running_var', 'local_branch.layer2.0.downsample.1.num_batches_tracked', 'local_branch.layer2.1.conv1.weight', 'local_branch.layer2.1.bn1.weight', 'local_branch.layer2.1.bn1.bias', 'local_branch.layer2.1.bn1.running_mean', 'local_branch.layer2.1.bn1.running_var', 'local_branch.layer2.1.bn1.num_batches_tracked', 'local_branch.layer2.1.conv2.weight', 'local_branch.layer2.1.bn2.weight', 'local_branch.layer2.1.bn2.bias', 'local_branch.layer2.1.bn2.running_mean', 'local_branch.layer2.1.bn2.running_var', 'local_branch.layer2.1.bn2.num_batches_tracked', 'local_branch.layer2.1.conv3.weight', 'local_branch.layer2.1.bn3.weight', 'local_branch.layer2.1.bn3.bias', 'local_branch.layer2.1.bn3.running_mean', 'local_branch.layer2.1.bn3.running_var', 'local_branch.layer2.1.bn3.num_batches_tracked', 'local_branch.layer2.2.conv1.weight', 'local_branch.layer2.2.bn1.weight', 'local_branch.layer2.2.bn1.bias', 'local_branch.layer2.2.bn1.running_mean', 'local_branch.layer2.2.bn1.running_var', 'local_branch.layer2.2.bn1.num_batches_tracked', 'local_branch.layer2.2.conv2.weight', 'local_branch.layer2.2.bn2.weight', 'local_branch.layer2.2.bn2.bias', 'local_branch.layer2.2.bn2.running_mean', 'local_branch.layer2.2.bn2.running_var', 'local_branch.layer2.2.bn2.num_batches_tracked', 'local_branch.layer2.2.conv3.weight', 'local_branch.layer2.2.bn3.weight', 'local_branch.layer2.2.bn3.bias', 'local_branch.layer2.2.bn3.running_mean', 'local_branch.layer2.2.bn3.running_var', 'local_branch.layer2.2.bn3.num_batches_tracked', 'local_branch.layer2.3.conv1.weight', 'local_branch.layer2.3.bn1.weight', 'local_branch.layer2.3.bn1.bias', 'local_branch.layer2.3.bn1.running_mean', 'local_branch.layer2.3.bn1.running_var', 'local_branch.layer2.3.bn1.num_batches_tracked', 'local_branch.layer2.3.conv2.weight', 'local_branch.layer2.3.bn2.weight', 'local_branch.layer2.3.bn2.bias', 'local_branch.layer2.3.bn2.running_mean', 'local_branch.layer2.3.bn2.running_var', 'local_branch.layer2.3.bn2.num_batches_tracked', 'local_branch.layer2.3.conv3.weight', 'local_branch.layer2.3.bn3.weight', 'local_branch.layer2.3.bn3.bias', 'local_branch.layer2.3.bn3.running_mean', 'local_branch.layer2.3.bn3.running_var', 'local_branch.layer2.3.bn3.num_batches_tracked', 'local_branch.layer3.0.conv1.weight', 'local_branch.layer3.0.bn1.weight', 'local_branch.layer3.0.bn1.bias', 'local_branch.layer3.0.bn1.running_mean', 'local_branch.layer3.0.bn1.running_var', 'local_branch.layer3.0.bn1.num_batches_tracked', 'local_branch.layer3.0.conv2.weight', 'local_branch.layer3.0.bn2.weight', 'local_branch.layer3.0.bn2.bias', 'local_branch.layer3.0.bn2.running_mean', 'local_branch.layer3.0.bn2.running_var', 'local_branch.layer3.0.bn2.num_batches_tracked', 'local_branch.layer3.0.conv3.weight', 'local_branch.layer3.0.bn3.weight', 'local_branch.layer3.0.bn3.bias', 'local_branch.layer3.0.bn3.running_mean', 'local_branch.layer3.0.bn3.running_var', 'local_branch.layer3.0.bn3.num_batches_tracked', 'local_branch.layer3.0.downsample.0.weight', 'local_branch.layer3.0.downsample.1.weight', 'local_branch.layer3.0.downsample.1.bias', 'local_branch.layer3.0.downsample.1.running_mean', 'local_branch.layer3.0.downsample.1.running_var', 'local_branch.layer3.0.downsample.1.num_batches_tracked', 'local_branch.layer3.1.conv1.weight', 'local_branch.layer3.1.bn1.weight', 'local_branch.layer3.1.bn1.bias', 'local_branch.layer3.1.bn1.running_mean', 'local_branch.layer3.1.bn1.running_var', 'local_branch.layer3.1.bn1.num_batches_tracked', 'local_branch.layer3.1.conv2.weight', 'local_branch.layer3.1.bn2.weight', 'local_branch.layer3.1.bn2.bias', 'local_branch.layer3.1.bn2.running_mean', 'local_branch.layer3.1.bn2.running_var', 'local_branch.layer3.1.bn2.num_batches_tracked', 'local_branch.layer3.1.conv3.weight', 'local_branch.layer3.1.bn3.weight', 'local_branch.layer3.1.bn3.bias', 'local_branch.layer3.1.bn3.running_mean', 'local_branch.layer3.1.bn3.running_var', 'local_branch.layer3.1.bn3.num_batches_tracked', 'local_branch.layer3.2.conv1.weight', 'local_branch.layer3.2.bn1.weight', 'local_branch.layer3.2.bn1.bias', 'local_branch.layer3.2.bn1.running_mean', 'local_branch.layer3.2.bn1.running_var', 'local_branch.layer3.2.bn1.num_batches_tracked', 'local_branch.layer3.2.conv2.weight', 'local_branch.layer3.2.bn2.weight', 'local_branch.layer3.2.bn2.bias', 'local_branch.layer3.2.bn2.running_mean', 'local_branch.layer3.2.bn2.running_var', 'local_branch.layer3.2.bn2.num_batches_tracked', 'local_branch.layer3.2.conv3.weight', 'local_branch.layer3.2.bn3.weight', 'local_branch.layer3.2.bn3.bias', 'local_branch.layer3.2.bn3.running_mean', 'local_branch.layer3.2.bn3.running_var', 'local_branch.layer3.2.bn3.num_batches_tracked', 'local_branch.layer3.3.conv1.weight', 'local_branch.layer3.3.bn1.weight', 'local_branch.layer3.3.bn1.bias', 'local_branch.layer3.3.bn1.running_mean', 'local_branch.layer3.3.bn1.running_var', 'local_branch.layer3.3.bn1.num_batches_tracked', 'local_branch.layer3.3.conv2.weight', 'local_branch.layer3.3.bn2.weight', 'local_branch.layer3.3.bn2.bias', 'local_branch.layer3.3.bn2.running_mean', 'local_branch.layer3.3.bn2.running_var', 'local_branch.layer3.3.bn2.num_batches_tracked', 'local_branch.layer3.3.conv3.weight', 'local_branch.layer3.3.bn3.weight', 'local_branch.layer3.3.bn3.bias', 'local_branch.layer3.3.bn3.running_mean', 'local_branch.layer3.3.bn3.running_var', 'local_branch.layer3.3.bn3.num_batches_tracked', 'local_branch.layer3.4.conv1.weight', 'local_branch.layer3.4.bn1.weight', 'local_branch.layer3.4.bn1.bias', 'local_branch.layer3.4.bn1.running_mean', 'local_branch.layer3.4.bn1.running_var', 'local_branch.layer3.4.bn1.num_batches_tracked', 'local_branch.layer3.4.conv2.weight', 'local_branch.layer3.4.bn2.weight', 'local_branch.layer3.4.bn2.bias', 'local_branch.layer3.4.bn2.running_mean', 'local_branch.layer3.4.bn2.running_var', 'local_branch.layer3.4.bn2.num_batches_tracked', 'local_branch.layer3.4.conv3.weight', 'local_branch.layer3.4.bn3.weight', 'local_branch.layer3.4.bn3.bias', 'local_branch.layer3.4.bn3.running_mean', 'local_branch.layer3.4.bn3.running_var', 'local_branch.layer3.4.bn3.num_batches_tracked', 'local_branch.layer3.5.conv1.weight', 'local_branch.layer3.5.bn1.weight', 'local_branch.layer3.5.bn1.bias', 'local_branch.layer3.5.bn1.running_mean', 'local_branch.layer3.5.bn1.running_var', 'local_branch.layer3.5.bn1.num_batches_tracked', 'local_branch.layer3.5.conv2.weight', 'local_branch.layer3.5.bn2.weight', 'local_branch.layer3.5.bn2.bias', 'local_branch.layer3.5.bn2.running_mean', 'local_branch.layer3.5.bn2.running_var', 'local_branch.layer3.5.bn2.num_batches_tracked', 'local_branch.layer3.5.conv3.weight', 'local_branch.layer3.5.bn3.weight', 'local_branch.layer3.5.bn3.bias', 'local_branch.layer3.5.bn3.running_mean', 'local_branch.layer3.5.bn3.running_var', 'local_branch.layer3.5.bn3.num_batches_tracked', 'local_branch.layer4.0.conv1.weight', 'local_branch.layer4.0.bn1.weight', 'local_branch.layer4.0.bn1.bias', 'local_branch.layer4.0.bn1.running_mean', 'local_branch.layer4.0.bn1.running_var', 'local_branch.layer4.0.bn1.num_batches_tracked', 'local_branch.layer4.0.conv2.weight', 'local_branch.layer4.0.bn2.weight', 'local_branch.layer4.0.bn2.bias', 'local_branch.layer4.0.bn2.running_mean', 'local_branch.layer4.0.bn2.running_var', 'local_branch.layer4.0.bn2.num_batches_tracked', 'local_branch.layer4.0.conv3.weight', 'local_branch.layer4.0.bn3.weight', 'local_branch.layer4.0.bn3.bias', 'local_branch.layer4.0.bn3.running_mean', 'local_branch.layer4.0.bn3.running_var', 'local_branch.layer4.0.bn3.num_batches_tracked', 'local_branch.layer4.0.downsample.0.weight', 'local_branch.layer4.0.downsample.1.weight', 'local_branch.layer4.0.downsample.1.bias', 'local_branch.layer4.0.downsample.1.running_mean', 'local_branch.layer4.0.downsample.1.running_var', 'local_branch.layer4.0.downsample.1.num_batches_tracked', 'local_branch.layer4.1.conv1.weight', 'local_branch.layer4.1.bn1.weight', 'local_branch.layer4.1.bn1.bias', 'local_branch.layer4.1.bn1.running_mean', 'local_branch.layer4.1.bn1.running_var', 'local_branch.layer4.1.bn1.num_batches_tracked', 'local_branch.layer4.1.conv2.weight', 'local_branch.layer4.1.bn2.weight', 'local_branch.layer4.1.bn2.bias', 'local_branch.layer4.1.bn2.running_mean', 'local_branch.layer4.1.bn2.running_var', 'local_branch.layer4.1.bn2.num_batches_tracked', 'local_branch.layer4.1.conv3.weight', 'local_branch.layer4.1.bn3.weight', 'local_branch.layer4.1.bn3.bias', 'local_branch.layer4.1.bn3.running_mean', 'local_branch.layer4.1.bn3.running_var', 'local_branch.layer4.1.bn3.num_batches_tracked', 'local_branch.layer4.2.conv1.weight', 'local_branch.layer4.2.bn1.weight', 'local_branch.layer4.2.bn1.bias', 'local_branch.layer4.2.bn1.running_mean', 'local_branch.layer4.2.bn1.running_var', 'local_branch.layer4.2.bn1.num_batches_tracked', 'local_branch.layer4.2.conv2.weight', 'local_branch.layer4.2.bn2.weight', 'local_branch.layer4.2.bn2.bias', 'local_branch.layer4.2.bn2.running_mean', 'local_branch.layer4.2.bn2.running_var', 'local_branch.layer4.2.bn2.num_batches_tracked', 'local_branch.layer4.2.conv3.weight', 'local_branch.layer4.2.bn3.weight', 'local_branch.layer4.2.bn3.bias', 'local_branch.layer4.2.bn3.running_mean', 'local_branch.layer4.2.bn3.running_var', 'local_branch.layer4.2.bn3.num_batches_tracked', 'local_branch.fc.weight', 'local_branch.fc.bias', 'fusion_branch.encoder.enc_layers.0.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.0.layernorm1.weight', 'fusion_branch.encoder.enc_layers.0.layernorm1.bias', 'fusion_branch.encoder.enc_layers.0.layernorm2.weight', 'fusion_branch.encoder.enc_layers.0.layernorm2.bias', 'fusion_branch.encoder.enc_layers.1.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.1.layernorm1.weight', 'fusion_branch.encoder.enc_layers.1.layernorm1.bias', 'fusion_branch.encoder.enc_layers.1.layernorm2.weight', 'fusion_branch.encoder.enc_layers.1.layernorm2.bias', 'fusion_branch.encoder.enc_layers.2.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.2.layernorm1.weight', 'fusion_branch.encoder.enc_layers.2.layernorm1.bias', 'fusion_branch.encoder.enc_layers.2.layernorm2.weight', 'fusion_branch.encoder.enc_layers.2.layernorm2.bias', 'fusion_branch.encoder.enc_layers.3.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.3.layernorm1.weight', 'fusion_branch.encoder.enc_layers.3.layernorm1.bias', 'fusion_branch.encoder.enc_layers.3.layernorm2.weight', 'fusion_branch.encoder.enc_layers.3.layernorm2.bias', 'fusion_branch.dense.weight', 'fusion_branch.dense.bias'])
thief state:  None
pretrained state:  dict_keys([])
Thief model initialized successfully
specificity = 4/80
sensitivity = 42/42
Initial model on target dataset: acc = 0.3443, agreement = 0.3852, f1 = 0.1750, spec = 0.0500, sens = 1.0000
specificity = 2/32
sensitivity = 67/68
Initial model on validation dataset: acc = 0.6700, agreement = 0.6700, f1 = 0.2707, spec = 0.0625, sens = 0.9853
la:  None
>> Train a Model.
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:30<25:17, 30.96s/it]  4%|▍         | 2/50 [01:07<27:33, 34.44s/it]  6%|▌         | 3/50 [01:38<25:29, 32.53s/it]  8%|▊         | 4/50 [02:13<25:41, 33.50s/it] 10%|█         | 5/50 [03:24<35:24, 47.22s/it]Epoch 5: Train acc/f1 = 0.6522 / 0.2632 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.6800 / 0.2698 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
 12%|█▏        | 6/50 [03:59<31:27, 42.89s/it] 14%|█▍        | 7/50 [04:30<28:01, 39.11s/it] 16%|█▌        | 8/50 [05:04<26:11, 37.43s/it] 18%|█▊        | 9/50 [05:35<24:16, 35.53s/it] 20%|██        | 10/50 [06:51<31:58, 47.95s/it]Epoch 10: Train acc/f1 = 0.6522 / 0.2632 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.6800 / 0.2698 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
 22%|██▏       | 11/50 [07:22<27:49, 42.80s/it] 24%|██▍       | 12/50 [07:56<25:27, 40.20s/it] 26%|██▌       | 13/50 [08:27<23:04, 37.43s/it] 28%|██▊       | 14/50 [09:04<22:14, 37.07s/it] 30%|███       | 15/50 [10:12<27:03, 46.38s/it]Epoch 15: Train acc/f1 = 0.6522 / 0.2632 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.6800 / 0.2698 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
 32%|███▏      | 16/50 [10:45<24:01, 42.41s/it] 34%|███▍      | 17/50 [11:16<21:30, 39.12s/it] 36%|███▌      | 18/50 [11:52<20:19, 38.10s/it] 38%|███▊      | 19/50 [12:23<18:35, 35.99s/it] 40%|████      | 20/50 [13:41<24:14, 48.50s/it]Epoch 20: Train acc/f1 = 0.6522 / 0.2632 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.6800 / 0.2698 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
 42%|████▏     | 21/50 [14:12<20:55, 43.28s/it] 44%|████▍     | 22/50 [14:45<18:51, 40.40s/it] 46%|████▌     | 23/50 [15:18<17:06, 38.01s/it] 48%|████▊     | 24/50 [15:53<16:04, 37.11s/it] 50%|█████     | 25/50 [17:04<19:46, 47.47s/it]Epoch 25: Train acc/f1 = 0.6522 / 0.2632 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.6800 / 0.2698 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
 52%|█████▏    | 26/50 [17:38<17:20, 43.36s/it] 54%|█████▍    | 27/50 [18:18<16:14, 42.37s/it] 56%|█████▌    | 28/50 [19:06<16:10, 44.09s/it] 58%|█████▊    | 29/50 [19:45<14:53, 42.56s/it] 60%|██████    | 30/50 [21:18<19:13, 57.66s/it]Epoch 30: Train acc/f1 = 0.6522 / 0.2632 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.6800 / 0.2698 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
 62%|██████▏   | 31/50 [21:55<16:13, 51.22s/it] 64%|██████▍   | 32/50 [22:38<14:38, 48.80s/it] 66%|██████▌   | 33/50 [23:17<13:00, 45.94s/it] 68%|██████▊   | 34/50 [24:00<12:02, 45.14s/it] 70%|███████   | 35/50 [25:10<13:08, 52.56s/it]Epoch 35: Train acc/f1 = 0.6522 / 0.2632 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.6800 / 0.2698 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
 72%|███████▏  | 36/50 [25:45<11:02, 47.30s/it] 74%|███████▍  | 37/50 [26:16<09:11, 42.45s/it] 76%|███████▌  | 38/50 [26:54<08:11, 40.92s/it] 78%|███████▊  | 39/50 [27:24<06:55, 37.76s/it] 80%|████████  | 40/50 [28:38<08:05, 48.50s/it]Epoch 40: Train acc/f1 = 0.6522 / 0.2632 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.6800 / 0.2698 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
 82%|████████▏ | 41/50 [29:09<06:31, 43.45s/it] 84%|████████▍ | 42/50 [29:42<05:22, 40.36s/it] 86%|████████▌ | 43/50 [30:15<04:25, 37.98s/it] 88%|████████▊ | 44/50 [30:49<03:40, 36.79s/it] 90%|█████████ | 45/50 [31:56<03:49, 45.84s/it]Epoch 45: Train acc/f1 = 0.6522 / 0.2632 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.6800 / 0.2698 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
 92%|█████████▏| 46/50 [32:30<02:49, 42.38s/it] 94%|█████████▍| 47/50 [33:01<01:56, 38.89s/it] 96%|█████████▌| 48/50 [33:38<01:17, 38.52s/it] 98%|█████████▊| 49/50 [34:11<00:36, 36.59s/it]100%|██████████| 50/50 [35:25<00:00, 48.08s/it]                                               Epoch 50: Train acc/f1 = 0.6522 / 0.2632 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.6800 / 0.2698 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
specificity = 0/313
sensitivity = 587/587
specificity = 0/32
sensitivity = 68/68
specificity = 0/80
sensitivity = 42/42
Trial 3, Cycle 1
Train acc/f1/spec/sens = 0.6522 / 0.2632 / 0.0000 / 1.0000
Val acc/f1/spec/sens = 0.6800 / 0.2698 / 0.0000 / 1.0000
Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
>> Finished.
specificity = 0/80
sensitivity = 42/42
Acc, agreement for latest model:  0.3442622950819672 0.38524590163934425
Load best checkpoint for thief model
specificity = 0/80
sensitivity = 42/42
Acc, agreement for best model:  0.3442622950819672 0.38524590163934425
Trial 2/5 || Cycle 1/1 || Label set size 900 || Test acc 0.3443 || Test agreement 0.3852 || Spec 0.0000 || Sens 1.0000
**************************************************************************************************** 

specificity = 0/80
sensitivity = 42/42
Number of samples  900
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:02<01:17,  2.77s/it]  7%|▋         | 2/29 [00:04<01:01,  2.26s/it] 10%|█         | 3/29 [00:06<00:49,  1.89s/it] 14%|█▍        | 4/29 [00:07<00:40,  1.63s/it] 17%|█▋        | 5/29 [00:08<00:34,  1.42s/it] 21%|██        | 6/29 [00:09<00:32,  1.42s/it] 24%|██▍       | 7/29 [00:10<00:28,  1.28s/it] 28%|██▊       | 8/29 [00:11<00:26,  1.24s/it] 31%|███       | 9/29 [00:13<00:24,  1.20s/it] 34%|███▍      | 10/29 [00:14<00:21,  1.15s/it] 38%|███▊      | 11/29 [00:15<00:19,  1.09s/it] 41%|████▏     | 12/29 [00:15<00:16,  1.01it/s] 45%|████▍     | 13/29 [00:16<00:14,  1.12it/s] 48%|████▊     | 14/29 [00:18<00:16,  1.10s/it] 52%|█████▏    | 15/29 [00:19<00:17,  1.24s/it] 55%|█████▌    | 16/29 [00:21<00:16,  1.29s/it] 59%|█████▊    | 17/29 [00:22<00:14,  1.20s/it] 62%|██████▏   | 18/29 [00:23<00:14,  1.33s/it] 66%|██████▌   | 19/29 [00:24<00:12,  1.20s/it] 69%|██████▉   | 20/29 [00:25<00:10,  1.17s/it] 72%|███████▏  | 21/29 [00:26<00:09,  1.20s/it] 76%|███████▌  | 22/29 [00:27<00:07,  1.08s/it] 79%|███████▉  | 23/29 [00:28<00:05,  1.05it/s] 83%|████████▎ | 24/29 [00:29<00:04,  1.17it/s] 86%|████████▌ | 25/29 [00:29<00:03,  1.22it/s] 90%|████████▉ | 26/29 [00:30<00:02,  1.27it/s] 93%|█████████▎| 27/29 [00:31<00:01,  1.22it/s] 97%|█████████▋| 28/29 [00:32<00:00,  1.14it/s]100%|██████████| 29/29 [00:32<00:00,  1.52it/s]100%|██████████| 29/29 [00:32<00:00,  1.13s/it]
replacing val labels with victim labels
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.17s/it] 50%|█████     | 2/4 [00:01<00:01,  1.20it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.41it/s]100%|██████████| 4/4 [00:02<00:00,  1.58it/s]Validation set distribution: 
Number of samples  100

{0: 19, 1: 24, 2: 57}
Labeled set distribution: 
Number of samples  900
{0: 114, 1: 210, 2: 576}
odict_keys(['global_branch.net.conv1.weight', 'global_branch.net.bn1.weight', 'global_branch.net.bn1.bias', 'global_branch.net.bn1.running_mean', 'global_branch.net.bn1.running_var', 'global_branch.net.bn1.num_batches_tracked', 'global_branch.net.layer1.0.conv1.weight', 'global_branch.net.layer1.0.bn1.weight', 'global_branch.net.layer1.0.bn1.bias', 'global_branch.net.layer1.0.bn1.running_mean', 'global_branch.net.layer1.0.bn1.running_var', 'global_branch.net.layer1.0.bn1.num_batches_tracked', 'global_branch.net.layer1.0.conv2.weight', 'global_branch.net.layer1.0.bn2.weight', 'global_branch.net.layer1.0.bn2.bias', 'global_branch.net.layer1.0.bn2.running_mean', 'global_branch.net.layer1.0.bn2.running_var', 'global_branch.net.layer1.0.bn2.num_batches_tracked', 'global_branch.net.layer1.0.conv3.weight', 'global_branch.net.layer1.0.bn3.weight', 'global_branch.net.layer1.0.bn3.bias', 'global_branch.net.layer1.0.bn3.running_mean', 'global_branch.net.layer1.0.bn3.running_var', 'global_branch.net.layer1.0.bn3.num_batches_tracked', 'global_branch.net.layer1.0.downsample.0.weight', 'global_branch.net.layer1.0.downsample.1.weight', 'global_branch.net.layer1.0.downsample.1.bias', 'global_branch.net.layer1.0.downsample.1.running_mean', 'global_branch.net.layer1.0.downsample.1.running_var', 'global_branch.net.layer1.0.downsample.1.num_batches_tracked', 'global_branch.net.layer1.1.conv1.weight', 'global_branch.net.layer1.1.bn1.weight', 'global_branch.net.layer1.1.bn1.bias', 'global_branch.net.layer1.1.bn1.running_mean', 'global_branch.net.layer1.1.bn1.running_var', 'global_branch.net.layer1.1.bn1.num_batches_tracked', 'global_branch.net.layer1.1.conv2.weight', 'global_branch.net.layer1.1.bn2.weight', 'global_branch.net.layer1.1.bn2.bias', 'global_branch.net.layer1.1.bn2.running_mean', 'global_branch.net.layer1.1.bn2.running_var', 'global_branch.net.layer1.1.bn2.num_batches_tracked', 'global_branch.net.layer1.1.conv3.weight', 'global_branch.net.layer1.1.bn3.weight', 'global_branch.net.layer1.1.bn3.bias', 'global_branch.net.layer1.1.bn3.running_mean', 'global_branch.net.layer1.1.bn3.running_var', 'global_branch.net.layer1.1.bn3.num_batches_tracked', 'global_branch.net.layer1.2.conv1.weight', 'global_branch.net.layer1.2.bn1.weight', 'global_branch.net.layer1.2.bn1.bias', 'global_branch.net.layer1.2.bn1.running_mean', 'global_branch.net.layer1.2.bn1.running_var', 'global_branch.net.layer1.2.bn1.num_batches_tracked', 'global_branch.net.layer1.2.conv2.weight', 'global_branch.net.layer1.2.bn2.weight', 'global_branch.net.layer1.2.bn2.bias', 'global_branch.net.layer1.2.bn2.running_mean', 'global_branch.net.layer1.2.bn2.running_var', 'global_branch.net.layer1.2.bn2.num_batches_tracked', 'global_branch.net.layer1.2.conv3.weight', 'global_branch.net.layer1.2.bn3.weight', 'global_branch.net.layer1.2.bn3.bias', 'global_branch.net.layer1.2.bn3.running_mean', 'global_branch.net.layer1.2.bn3.running_var', 'global_branch.net.layer1.2.bn3.num_batches_tracked', 'global_branch.net.layer2.0.conv1.weight', 'global_branch.net.layer2.0.bn1.weight', 'global_branch.net.layer2.0.bn1.bias', 'global_branch.net.layer2.0.bn1.running_mean', 'global_branch.net.layer2.0.bn1.running_var', 'global_branch.net.layer2.0.bn1.num_batches_tracked', 'global_branch.net.layer2.0.conv2.weight', 'global_branch.net.layer2.0.bn2.weight', 'global_branch.net.layer2.0.bn2.bias', 'global_branch.net.layer2.0.bn2.running_mean', 'global_branch.net.layer2.0.bn2.running_var', 'global_branch.net.layer2.0.bn2.num_batches_tracked', 'global_branch.net.layer2.0.conv3.weight', 'global_branch.net.layer2.0.bn3.weight', 'global_branch.net.layer2.0.bn3.bias', 'global_branch.net.layer2.0.bn3.running_mean', 'global_branch.net.layer2.0.bn3.running_var', 'global_branch.net.layer2.0.bn3.num_batches_tracked', 'global_branch.net.layer2.0.downsample.0.weight', 'global_branch.net.layer2.0.downsample.1.weight', 'global_branch.net.layer2.0.downsample.1.bias', 'global_branch.net.layer2.0.downsample.1.running_mean', 'global_branch.net.layer2.0.downsample.1.running_var', 'global_branch.net.layer2.0.downsample.1.num_batches_tracked', 'global_branch.net.layer2.1.conv1.weight', 'global_branch.net.layer2.1.bn1.weight', 'global_branch.net.layer2.1.bn1.bias', 'global_branch.net.layer2.1.bn1.running_mean', 'global_branch.net.layer2.1.bn1.running_var', 'global_branch.net.layer2.1.bn1.num_batches_tracked', 'global_branch.net.layer2.1.conv2.weight', 'global_branch.net.layer2.1.bn2.weight', 'global_branch.net.layer2.1.bn2.bias', 'global_branch.net.layer2.1.bn2.running_mean', 'global_branch.net.layer2.1.bn2.running_var', 'global_branch.net.layer2.1.bn2.num_batches_tracked', 'global_branch.net.layer2.1.conv3.weight', 'global_branch.net.layer2.1.bn3.weight', 'global_branch.net.layer2.1.bn3.bias', 'global_branch.net.layer2.1.bn3.running_mean', 'global_branch.net.layer2.1.bn3.running_var', 'global_branch.net.layer2.1.bn3.num_batches_tracked', 'global_branch.net.layer2.2.conv1.weight', 'global_branch.net.layer2.2.bn1.weight', 'global_branch.net.layer2.2.bn1.bias', 'global_branch.net.layer2.2.bn1.running_mean', 'global_branch.net.layer2.2.bn1.running_var', 'global_branch.net.layer2.2.bn1.num_batches_tracked', 'global_branch.net.layer2.2.conv2.weight', 'global_branch.net.layer2.2.bn2.weight', 'global_branch.net.layer2.2.bn2.bias', 'global_branch.net.layer2.2.bn2.running_mean', 'global_branch.net.layer2.2.bn2.running_var', 'global_branch.net.layer2.2.bn2.num_batches_tracked', 'global_branch.net.layer2.2.conv3.weight', 'global_branch.net.layer2.2.bn3.weight', 'global_branch.net.layer2.2.bn3.bias', 'global_branch.net.layer2.2.bn3.running_mean', 'global_branch.net.layer2.2.bn3.running_var', 'global_branch.net.layer2.2.bn3.num_batches_tracked', 'global_branch.net.layer2.3.conv1.weight', 'global_branch.net.layer2.3.bn1.weight', 'global_branch.net.layer2.3.bn1.bias', 'global_branch.net.layer2.3.bn1.running_mean', 'global_branch.net.layer2.3.bn1.running_var', 'global_branch.net.layer2.3.bn1.num_batches_tracked', 'global_branch.net.layer2.3.conv2.weight', 'global_branch.net.layer2.3.bn2.weight', 'global_branch.net.layer2.3.bn2.bias', 'global_branch.net.layer2.3.bn2.running_mean', 'global_branch.net.layer2.3.bn2.running_var', 'global_branch.net.layer2.3.bn2.num_batches_tracked', 'global_branch.net.layer2.3.conv3.weight', 'global_branch.net.layer2.3.bn3.weight', 'global_branch.net.layer2.3.bn3.bias', 'global_branch.net.layer2.3.bn3.running_mean', 'global_branch.net.layer2.3.bn3.running_var', 'global_branch.net.layer2.3.bn3.num_batches_tracked', 'global_branch.net.layer3.0.conv1.weight', 'global_branch.net.layer3.0.bn1.weight', 'global_branch.net.layer3.0.bn1.bias', 'global_branch.net.layer3.0.bn1.running_mean', 'global_branch.net.layer3.0.bn1.running_var', 'global_branch.net.layer3.0.bn1.num_batches_tracked', 'global_branch.net.layer3.0.conv2.weight', 'global_branch.net.layer3.0.bn2.weight', 'global_branch.net.layer3.0.bn2.bias', 'global_branch.net.layer3.0.bn2.running_mean', 'global_branch.net.layer3.0.bn2.running_var', 'global_branch.net.layer3.0.bn2.num_batches_tracked', 'global_branch.net.layer3.0.conv3.weight', 'global_branch.net.layer3.0.bn3.weight', 'global_branch.net.layer3.0.bn3.bias', 'global_branch.net.layer3.0.bn3.running_mean', 'global_branch.net.layer3.0.bn3.running_var', 'global_branch.net.layer3.0.bn3.num_batches_tracked', 'global_branch.net.layer3.0.downsample.0.weight', 'global_branch.net.layer3.0.downsample.1.weight', 'global_branch.net.layer3.0.downsample.1.bias', 'global_branch.net.layer3.0.downsample.1.running_mean', 'global_branch.net.layer3.0.downsample.1.running_var', 'global_branch.net.layer3.0.downsample.1.num_batches_tracked', 'global_branch.net.layer3.1.conv1.weight', 'global_branch.net.layer3.1.bn1.weight', 'global_branch.net.layer3.1.bn1.bias', 'global_branch.net.layer3.1.bn1.running_mean', 'global_branch.net.layer3.1.bn1.running_var', 'global_branch.net.layer3.1.bn1.num_batches_tracked', 'global_branch.net.layer3.1.conv2.weight', 'global_branch.net.layer3.1.bn2.weight', 'global_branch.net.layer3.1.bn2.bias', 'global_branch.net.layer3.1.bn2.running_mean', 'global_branch.net.layer3.1.bn2.running_var', 'global_branch.net.layer3.1.bn2.num_batches_tracked', 'global_branch.net.layer3.1.conv3.weight', 'global_branch.net.layer3.1.bn3.weight', 'global_branch.net.layer3.1.bn3.bias', 'global_branch.net.layer3.1.bn3.running_mean', 'global_branch.net.layer3.1.bn3.running_var', 'global_branch.net.layer3.1.bn3.num_batches_tracked', 'global_branch.net.layer3.2.conv1.weight', 'global_branch.net.layer3.2.bn1.weight', 'global_branch.net.layer3.2.bn1.bias', 'global_branch.net.layer3.2.bn1.running_mean', 'global_branch.net.layer3.2.bn1.running_var', 'global_branch.net.layer3.2.bn1.num_batches_tracked', 'global_branch.net.layer3.2.conv2.weight', 'global_branch.net.layer3.2.bn2.weight', 'global_branch.net.layer3.2.bn2.bias', 'global_branch.net.layer3.2.bn2.running_mean', 'global_branch.net.layer3.2.bn2.running_var', 'global_branch.net.layer3.2.bn2.num_batches_tracked', 'global_branch.net.layer3.2.conv3.weight', 'global_branch.net.layer3.2.bn3.weight', 'global_branch.net.layer3.2.bn3.bias', 'global_branch.net.layer3.2.bn3.running_mean', 'global_branch.net.layer3.2.bn3.running_var', 'global_branch.net.layer3.2.bn3.num_batches_tracked', 'global_branch.net.layer3.3.conv1.weight', 'global_branch.net.layer3.3.bn1.weight', 'global_branch.net.layer3.3.bn1.bias', 'global_branch.net.layer3.3.bn1.running_mean', 'global_branch.net.layer3.3.bn1.running_var', 'global_branch.net.layer3.3.bn1.num_batches_tracked', 'global_branch.net.layer3.3.conv2.weight', 'global_branch.net.layer3.3.bn2.weight', 'global_branch.net.layer3.3.bn2.bias', 'global_branch.net.layer3.3.bn2.running_mean', 'global_branch.net.layer3.3.bn2.running_var', 'global_branch.net.layer3.3.bn2.num_batches_tracked', 'global_branch.net.layer3.3.conv3.weight', 'global_branch.net.layer3.3.bn3.weight', 'global_branch.net.layer3.3.bn3.bias', 'global_branch.net.layer3.3.bn3.running_mean', 'global_branch.net.layer3.3.bn3.running_var', 'global_branch.net.layer3.3.bn3.num_batches_tracked', 'global_branch.net.layer3.4.conv1.weight', 'global_branch.net.layer3.4.bn1.weight', 'global_branch.net.layer3.4.bn1.bias', 'global_branch.net.layer3.4.bn1.running_mean', 'global_branch.net.layer3.4.bn1.running_var', 'global_branch.net.layer3.4.bn1.num_batches_tracked', 'global_branch.net.layer3.4.conv2.weight', 'global_branch.net.layer3.4.bn2.weight', 'global_branch.net.layer3.4.bn2.bias', 'global_branch.net.layer3.4.bn2.running_mean', 'global_branch.net.layer3.4.bn2.running_var', 'global_branch.net.layer3.4.bn2.num_batches_tracked', 'global_branch.net.layer3.4.conv3.weight', 'global_branch.net.layer3.4.bn3.weight', 'global_branch.net.layer3.4.bn3.bias', 'global_branch.net.layer3.4.bn3.running_mean', 'global_branch.net.layer3.4.bn3.running_var', 'global_branch.net.layer3.4.bn3.num_batches_tracked', 'global_branch.net.layer3.5.conv1.weight', 'global_branch.net.layer3.5.bn1.weight', 'global_branch.net.layer3.5.bn1.bias', 'global_branch.net.layer3.5.bn1.running_mean', 'global_branch.net.layer3.5.bn1.running_var', 'global_branch.net.layer3.5.bn1.num_batches_tracked', 'global_branch.net.layer3.5.conv2.weight', 'global_branch.net.layer3.5.bn2.weight', 'global_branch.net.layer3.5.bn2.bias', 'global_branch.net.layer3.5.bn2.running_mean', 'global_branch.net.layer3.5.bn2.running_var', 'global_branch.net.layer3.5.bn2.num_batches_tracked', 'global_branch.net.layer3.5.conv3.weight', 'global_branch.net.layer3.5.bn3.weight', 'global_branch.net.layer3.5.bn3.bias', 'global_branch.net.layer3.5.bn3.running_mean', 'global_branch.net.layer3.5.bn3.running_var', 'global_branch.net.layer3.5.bn3.num_batches_tracked', 'global_branch.net.layer4.0.conv1.weight', 'global_branch.net.layer4.0.bn1.weight', 'global_branch.net.layer4.0.bn1.bias', 'global_branch.net.layer4.0.bn1.running_mean', 'global_branch.net.layer4.0.bn1.running_var', 'global_branch.net.layer4.0.bn1.num_batches_tracked', 'global_branch.net.layer4.0.conv2.weight', 'global_branch.net.layer4.0.bn2.weight', 'global_branch.net.layer4.0.bn2.bias', 'global_branch.net.layer4.0.bn2.running_mean', 'global_branch.net.layer4.0.bn2.running_var', 'global_branch.net.layer4.0.bn2.num_batches_tracked', 'global_branch.net.layer4.0.conv3.weight', 'global_branch.net.layer4.0.bn3.weight', 'global_branch.net.layer4.0.bn3.bias', 'global_branch.net.layer4.0.bn3.running_mean', 'global_branch.net.layer4.0.bn3.running_var', 'global_branch.net.layer4.0.bn3.num_batches_tracked', 'global_branch.net.layer4.0.downsample.0.weight', 'global_branch.net.layer4.0.downsample.1.weight', 'global_branch.net.layer4.0.downsample.1.bias', 'global_branch.net.layer4.0.downsample.1.running_mean', 'global_branch.net.layer4.0.downsample.1.running_var', 'global_branch.net.layer4.0.downsample.1.num_batches_tracked', 'global_branch.net.layer4.1.conv1.weight', 'global_branch.net.layer4.1.bn1.weight', 'global_branch.net.layer4.1.bn1.bias', 'global_branch.net.layer4.1.bn1.running_mean', 'global_branch.net.layer4.1.bn1.running_var', 'global_branch.net.layer4.1.bn1.num_batches_tracked', 'global_branch.net.layer4.1.conv2.weight', 'global_branch.net.layer4.1.bn2.weight', 'global_branch.net.layer4.1.bn2.bias', 'global_branch.net.layer4.1.bn2.running_mean', 'global_branch.net.layer4.1.bn2.running_var', 'global_branch.net.layer4.1.bn2.num_batches_tracked', 'global_branch.net.layer4.1.conv3.weight', 'global_branch.net.layer4.1.bn3.weight', 'global_branch.net.layer4.1.bn3.bias', 'global_branch.net.layer4.1.bn3.running_mean', 'global_branch.net.layer4.1.bn3.running_var', 'global_branch.net.layer4.1.bn3.num_batches_tracked', 'global_branch.net.layer4.2.conv1.weight', 'global_branch.net.layer4.2.bn1.weight', 'global_branch.net.layer4.2.bn1.bias', 'global_branch.net.layer4.2.bn1.running_mean', 'global_branch.net.layer4.2.bn1.running_var', 'global_branch.net.layer4.2.bn1.num_batches_tracked', 'global_branch.net.layer4.2.conv2.weight', 'global_branch.net.layer4.2.bn2.weight', 'global_branch.net.layer4.2.bn2.bias', 'global_branch.net.layer4.2.bn2.running_mean', 'global_branch.net.layer4.2.bn2.running_var', 'global_branch.net.layer4.2.bn2.num_batches_tracked', 'global_branch.net.layer4.2.conv3.weight', 'global_branch.net.layer4.2.bn3.weight', 'global_branch.net.layer4.2.bn3.bias', 'global_branch.net.layer4.2.bn3.running_mean', 'global_branch.net.layer4.2.bn3.running_var', 'global_branch.net.layer4.2.bn3.num_batches_tracked', 'global_branch.net.fc.weight', 'global_branch.net.fc.bias', 'local_branch.conv1.weight', 'local_branch.conv2.weight', 'local_branch.bn1.weight', 'local_branch.bn1.bias', 'local_branch.bn1.running_mean', 'local_branch.bn1.running_var', 'local_branch.bn1.num_batches_tracked', 'local_branch.layer1.0.conv1.weight', 'local_branch.layer1.0.bn1.weight', 'local_branch.layer1.0.bn1.bias', 'local_branch.layer1.0.bn1.running_mean', 'local_branch.layer1.0.bn1.running_var', 'local_branch.layer1.0.bn1.num_batches_tracked', 'local_branch.layer1.0.conv2.weight', 'local_branch.layer1.0.bn2.weight', 'local_branch.layer1.0.bn2.bias', 'local_branch.layer1.0.bn2.running_mean', 'local_branch.layer1.0.bn2.running_var', 'local_branch.layer1.0.bn2.num_batches_tracked', 'local_branch.layer1.0.conv3.weight', 'local_branch.layer1.0.bn3.weight', 'local_branch.layer1.0.bn3.bias', 'local_branch.layer1.0.bn3.running_mean', 'local_branch.layer1.0.bn3.running_var', 'local_branch.layer1.0.bn3.num_batches_tracked', 'local_branch.layer1.0.downsample.0.weight', 'local_branch.layer1.0.downsample.1.weight', 'local_branch.layer1.0.downsample.1.bias', 'local_branch.layer1.0.downsample.1.running_mean', 'local_branch.layer1.0.downsample.1.running_var', 'local_branch.layer1.0.downsample.1.num_batches_tracked', 'local_branch.layer1.1.conv1.weight', 'local_branch.layer1.1.bn1.weight', 'local_branch.layer1.1.bn1.bias', 'local_branch.layer1.1.bn1.running_mean', 'local_branch.layer1.1.bn1.running_var', 'local_branch.layer1.1.bn1.num_batches_tracked', 'local_branch.layer1.1.conv2.weight', 'local_branch.layer1.1.bn2.weight', 'local_branch.layer1.1.bn2.bias', 'local_branch.layer1.1.bn2.running_mean', 'local_branch.layer1.1.bn2.running_var', 'local_branch.layer1.1.bn2.num_batches_tracked', 'local_branch.layer1.1.conv3.weight', 'local_branch.layer1.1.bn3.weight', 'local_branch.layer1.1.bn3.bias', 'local_branch.layer1.1.bn3.running_mean', 'local_branch.layer1.1.bn3.running_var', 'local_branch.layer1.1.bn3.num_batches_tracked', 'local_branch.layer1.2.conv1.weight', 'local_branch.layer1.2.bn1.weight', 'local_branch.layer1.2.bn1.bias', 'local_branch.layer1.2.bn1.running_mean', 'local_branch.layer1.2.bn1.running_var', 'local_branch.layer1.2.bn1.num_batches_tracked', 'local_branch.layer1.2.conv2.weight', 'local_branch.layer1.2.bn2.weight', 'local_branch.layer1.2.bn2.bias', 'local_branch.layer1.2.bn2.running_mean', 'local_branch.layer1.2.bn2.running_var', 'local_branch.layer1.2.bn2.num_batches_tracked', 'local_branch.layer1.2.conv3.weight', 'local_branch.layer1.2.bn3.weight', 'local_branch.layer1.2.bn3.bias', 'local_branch.layer1.2.bn3.running_mean', 'local_branch.layer1.2.bn3.running_var', 'local_branch.layer1.2.bn3.num_batches_tracked', 'local_branch.layer2.0.conv1.weight', 'local_branch.layer2.0.bn1.weight', 'local_branch.layer2.0.bn1.bias', 'local_branch.layer2.0.bn1.running_mean', 'local_branch.layer2.0.bn1.running_var', 'local_branch.layer2.0.bn1.num_batches_tracked', 'local_branch.layer2.0.conv2.weight', 'local_branch.layer2.0.bn2.weight', 'local_branch.layer2.0.bn2.bias', 'local_branch.layer2.0.bn2.running_mean', 'local_branch.layer2.0.bn2.running_var', 'local_branch.layer2.0.bn2.num_batches_tracked', 'local_branch.layer2.0.conv3.weight', 'local_branch.layer2.0.bn3.weight', 'local_branch.layer2.0.bn3.bias', 'local_branch.layer2.0.bn3.running_mean', 'local_branch.layer2.0.bn3.running_var', 'local_branch.layer2.0.bn3.num_batches_tracked', 'local_branch.layer2.0.downsample.0.weight', 'local_branch.layer2.0.downsample.1.weight', 'local_branch.layer2.0.downsample.1.bias', 'local_branch.layer2.0.downsample.1.running_mean', 'local_branch.layer2.0.downsample.1.running_var', 'local_branch.layer2.0.downsample.1.num_batches_tracked', 'local_branch.layer2.1.conv1.weight', 'local_branch.layer2.1.bn1.weight', 'local_branch.layer2.1.bn1.bias', 'local_branch.layer2.1.bn1.running_mean', 'local_branch.layer2.1.bn1.running_var', 'local_branch.layer2.1.bn1.num_batches_tracked', 'local_branch.layer2.1.conv2.weight', 'local_branch.layer2.1.bn2.weight', 'local_branch.layer2.1.bn2.bias', 'local_branch.layer2.1.bn2.running_mean', 'local_branch.layer2.1.bn2.running_var', 'local_branch.layer2.1.bn2.num_batches_tracked', 'local_branch.layer2.1.conv3.weight', 'local_branch.layer2.1.bn3.weight', 'local_branch.layer2.1.bn3.bias', 'local_branch.layer2.1.bn3.running_mean', 'local_branch.layer2.1.bn3.running_var', 'local_branch.layer2.1.bn3.num_batches_tracked', 'local_branch.layer2.2.conv1.weight', 'local_branch.layer2.2.bn1.weight', 'local_branch.layer2.2.bn1.bias', 'local_branch.layer2.2.bn1.running_mean', 'local_branch.layer2.2.bn1.running_var', 'local_branch.layer2.2.bn1.num_batches_tracked', 'local_branch.layer2.2.conv2.weight', 'local_branch.layer2.2.bn2.weight', 'local_branch.layer2.2.bn2.bias', 'local_branch.layer2.2.bn2.running_mean', 'local_branch.layer2.2.bn2.running_var', 'local_branch.layer2.2.bn2.num_batches_tracked', 'local_branch.layer2.2.conv3.weight', 'local_branch.layer2.2.bn3.weight', 'local_branch.layer2.2.bn3.bias', 'local_branch.layer2.2.bn3.running_mean', 'local_branch.layer2.2.bn3.running_var', 'local_branch.layer2.2.bn3.num_batches_tracked', 'local_branch.layer2.3.conv1.weight', 'local_branch.layer2.3.bn1.weight', 'local_branch.layer2.3.bn1.bias', 'local_branch.layer2.3.bn1.running_mean', 'local_branch.layer2.3.bn1.running_var', 'local_branch.layer2.3.bn1.num_batches_tracked', 'local_branch.layer2.3.conv2.weight', 'local_branch.layer2.3.bn2.weight', 'local_branch.layer2.3.bn2.bias', 'local_branch.layer2.3.bn2.running_mean', 'local_branch.layer2.3.bn2.running_var', 'local_branch.layer2.3.bn2.num_batches_tracked', 'local_branch.layer2.3.conv3.weight', 'local_branch.layer2.3.bn3.weight', 'local_branch.layer2.3.bn3.bias', 'local_branch.layer2.3.bn3.running_mean', 'local_branch.layer2.3.bn3.running_var', 'local_branch.layer2.3.bn3.num_batches_tracked', 'local_branch.layer3.0.conv1.weight', 'local_branch.layer3.0.bn1.weight', 'local_branch.layer3.0.bn1.bias', 'local_branch.layer3.0.bn1.running_mean', 'local_branch.layer3.0.bn1.running_var', 'local_branch.layer3.0.bn1.num_batches_tracked', 'local_branch.layer3.0.conv2.weight', 'local_branch.layer3.0.bn2.weight', 'local_branch.layer3.0.bn2.bias', 'local_branch.layer3.0.bn2.running_mean', 'local_branch.layer3.0.bn2.running_var', 'local_branch.layer3.0.bn2.num_batches_tracked', 'local_branch.layer3.0.conv3.weight', 'local_branch.layer3.0.bn3.weight', 'local_branch.layer3.0.bn3.bias', 'local_branch.layer3.0.bn3.running_mean', 'local_branch.layer3.0.bn3.running_var', 'local_branch.layer3.0.bn3.num_batches_tracked', 'local_branch.layer3.0.downsample.0.weight', 'local_branch.layer3.0.downsample.1.weight', 'local_branch.layer3.0.downsample.1.bias', 'local_branch.layer3.0.downsample.1.running_mean', 'local_branch.layer3.0.downsample.1.running_var', 'local_branch.layer3.0.downsample.1.num_batches_tracked', 'local_branch.layer3.1.conv1.weight', 'local_branch.layer3.1.bn1.weight', 'local_branch.layer3.1.bn1.bias', 'local_branch.layer3.1.bn1.running_mean', 'local_branch.layer3.1.bn1.running_var', 'local_branch.layer3.1.bn1.num_batches_tracked', 'local_branch.layer3.1.conv2.weight', 'local_branch.layer3.1.bn2.weight', 'local_branch.layer3.1.bn2.bias', 'local_branch.layer3.1.bn2.running_mean', 'local_branch.layer3.1.bn2.running_var', 'local_branch.layer3.1.bn2.num_batches_tracked', 'local_branch.layer3.1.conv3.weight', 'local_branch.layer3.1.bn3.weight', 'local_branch.layer3.1.bn3.bias', 'local_branch.layer3.1.bn3.running_mean', 'local_branch.layer3.1.bn3.running_var', 'local_branch.layer3.1.bn3.num_batches_tracked', 'local_branch.layer3.2.conv1.weight', 'local_branch.layer3.2.bn1.weight', 'local_branch.layer3.2.bn1.bias', 'local_branch.layer3.2.bn1.running_mean', 'local_branch.layer3.2.bn1.running_var', 'local_branch.layer3.2.bn1.num_batches_tracked', 'local_branch.layer3.2.conv2.weight', 'local_branch.layer3.2.bn2.weight', 'local_branch.layer3.2.bn2.bias', 'local_branch.layer3.2.bn2.running_mean', 'local_branch.layer3.2.bn2.running_var', 'local_branch.layer3.2.bn2.num_batches_tracked', 'local_branch.layer3.2.conv3.weight', 'local_branch.layer3.2.bn3.weight', 'local_branch.layer3.2.bn3.bias', 'local_branch.layer3.2.bn3.running_mean', 'local_branch.layer3.2.bn3.running_var', 'local_branch.layer3.2.bn3.num_batches_tracked', 'local_branch.layer3.3.conv1.weight', 'local_branch.layer3.3.bn1.weight', 'local_branch.layer3.3.bn1.bias', 'local_branch.layer3.3.bn1.running_mean', 'local_branch.layer3.3.bn1.running_var', 'local_branch.layer3.3.bn1.num_batches_tracked', 'local_branch.layer3.3.conv2.weight', 'local_branch.layer3.3.bn2.weight', 'local_branch.layer3.3.bn2.bias', 'local_branch.layer3.3.bn2.running_mean', 'local_branch.layer3.3.bn2.running_var', 'local_branch.layer3.3.bn2.num_batches_tracked', 'local_branch.layer3.3.conv3.weight', 'local_branch.layer3.3.bn3.weight', 'local_branch.layer3.3.bn3.bias', 'local_branch.layer3.3.bn3.running_mean', 'local_branch.layer3.3.bn3.running_var', 'local_branch.layer3.3.bn3.num_batches_tracked', 'local_branch.layer3.4.conv1.weight', 'local_branch.layer3.4.bn1.weight', 'local_branch.layer3.4.bn1.bias', 'local_branch.layer3.4.bn1.running_mean', 'local_branch.layer3.4.bn1.running_var', 'local_branch.layer3.4.bn1.num_batches_tracked', 'local_branch.layer3.4.conv2.weight', 'local_branch.layer3.4.bn2.weight', 'local_branch.layer3.4.bn2.bias', 'local_branch.layer3.4.bn2.running_mean', 'local_branch.layer3.4.bn2.running_var', 'local_branch.layer3.4.bn2.num_batches_tracked', 'local_branch.layer3.4.conv3.weight', 'local_branch.layer3.4.bn3.weight', 'local_branch.layer3.4.bn3.bias', 'local_branch.layer3.4.bn3.running_mean', 'local_branch.layer3.4.bn3.running_var', 'local_branch.layer3.4.bn3.num_batches_tracked', 'local_branch.layer3.5.conv1.weight', 'local_branch.layer3.5.bn1.weight', 'local_branch.layer3.5.bn1.bias', 'local_branch.layer3.5.bn1.running_mean', 'local_branch.layer3.5.bn1.running_var', 'local_branch.layer3.5.bn1.num_batches_tracked', 'local_branch.layer3.5.conv2.weight', 'local_branch.layer3.5.bn2.weight', 'local_branch.layer3.5.bn2.bias', 'local_branch.layer3.5.bn2.running_mean', 'local_branch.layer3.5.bn2.running_var', 'local_branch.layer3.5.bn2.num_batches_tracked', 'local_branch.layer3.5.conv3.weight', 'local_branch.layer3.5.bn3.weight', 'local_branch.layer3.5.bn3.bias', 'local_branch.layer3.5.bn3.running_mean', 'local_branch.layer3.5.bn3.running_var', 'local_branch.layer3.5.bn3.num_batches_tracked', 'local_branch.layer4.0.conv1.weight', 'local_branch.layer4.0.bn1.weight', 'local_branch.layer4.0.bn1.bias', 'local_branch.layer4.0.bn1.running_mean', 'local_branch.layer4.0.bn1.running_var', 'local_branch.layer4.0.bn1.num_batches_tracked', 'local_branch.layer4.0.conv2.weight', 'local_branch.layer4.0.bn2.weight', 'local_branch.layer4.0.bn2.bias', 'local_branch.layer4.0.bn2.running_mean', 'local_branch.layer4.0.bn2.running_var', 'local_branch.layer4.0.bn2.num_batches_tracked', 'local_branch.layer4.0.conv3.weight', 'local_branch.layer4.0.bn3.weight', 'local_branch.layer4.0.bn3.bias', 'local_branch.layer4.0.bn3.running_mean', 'local_branch.layer4.0.bn3.running_var', 'local_branch.layer4.0.bn3.num_batches_tracked', 'local_branch.layer4.0.downsample.0.weight', 'local_branch.layer4.0.downsample.1.weight', 'local_branch.layer4.0.downsample.1.bias', 'local_branch.layer4.0.downsample.1.running_mean', 'local_branch.layer4.0.downsample.1.running_var', 'local_branch.layer4.0.downsample.1.num_batches_tracked', 'local_branch.layer4.1.conv1.weight', 'local_branch.layer4.1.bn1.weight', 'local_branch.layer4.1.bn1.bias', 'local_branch.layer4.1.bn1.running_mean', 'local_branch.layer4.1.bn1.running_var', 'local_branch.layer4.1.bn1.num_batches_tracked', 'local_branch.layer4.1.conv2.weight', 'local_branch.layer4.1.bn2.weight', 'local_branch.layer4.1.bn2.bias', 'local_branch.layer4.1.bn2.running_mean', 'local_branch.layer4.1.bn2.running_var', 'local_branch.layer4.1.bn2.num_batches_tracked', 'local_branch.layer4.1.conv3.weight', 'local_branch.layer4.1.bn3.weight', 'local_branch.layer4.1.bn3.bias', 'local_branch.layer4.1.bn3.running_mean', 'local_branch.layer4.1.bn3.running_var', 'local_branch.layer4.1.bn3.num_batches_tracked', 'local_branch.layer4.2.conv1.weight', 'local_branch.layer4.2.bn1.weight', 'local_branch.layer4.2.bn1.bias', 'local_branch.layer4.2.bn1.running_mean', 'local_branch.layer4.2.bn1.running_var', 'local_branch.layer4.2.bn1.num_batches_tracked', 'local_branch.layer4.2.conv2.weight', 'local_branch.layer4.2.bn2.weight', 'local_branch.layer4.2.bn2.bias', 'local_branch.layer4.2.bn2.running_mean', 'local_branch.layer4.2.bn2.running_var', 'local_branch.layer4.2.bn2.num_batches_tracked', 'local_branch.layer4.2.conv3.weight', 'local_branch.layer4.2.bn3.weight', 'local_branch.layer4.2.bn3.bias', 'local_branch.layer4.2.bn3.running_mean', 'local_branch.layer4.2.bn3.running_var', 'local_branch.layer4.2.bn3.num_batches_tracked', 'local_branch.fc.weight', 'local_branch.fc.bias', 'fusion_branch.encoder.enc_layers.0.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.0.layernorm1.weight', 'fusion_branch.encoder.enc_layers.0.layernorm1.bias', 'fusion_branch.encoder.enc_layers.0.layernorm2.weight', 'fusion_branch.encoder.enc_layers.0.layernorm2.bias', 'fusion_branch.encoder.enc_layers.1.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.1.layernorm1.weight', 'fusion_branch.encoder.enc_layers.1.layernorm1.bias', 'fusion_branch.encoder.enc_layers.1.layernorm2.weight', 'fusion_branch.encoder.enc_layers.1.layernorm2.bias', 'fusion_branch.encoder.enc_layers.2.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.2.layernorm1.weight', 'fusion_branch.encoder.enc_layers.2.layernorm1.bias', 'fusion_branch.encoder.enc_layers.2.layernorm2.weight', 'fusion_branch.encoder.enc_layers.2.layernorm2.bias', 'fusion_branch.encoder.enc_layers.3.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.3.layernorm1.weight', 'fusion_branch.encoder.enc_layers.3.layernorm1.bias', 'fusion_branch.encoder.enc_layers.3.layernorm2.weight', 'fusion_branch.encoder.enc_layers.3.layernorm2.bias', 'fusion_branch.dense.weight', 'fusion_branch.dense.bias'])
thief state:  None
pretrained state:  dict_keys([])
Thief model initialized successfully
specificity = 80/80
sensitivity = 0/42
Initial model on target dataset: acc = 0.3197, agreement = 0.3115, f1 = 0.2231, spec = 1.0000, sens = 0.0000
specificity = 43/43
sensitivity = 2/57
Initial model on validation dataset: acc = 0.2200, agreement = 0.2200, f1 = 0.1366, spec = 1.0000, sens = 0.0351
la:  None
>> Train a Model.
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:40<33:02, 40.46s/it]  4%|▍         | 2/50 [01:23<33:42, 42.14s/it]  6%|▌         | 3/50 [02:03<32:09, 41.05s/it]  8%|▊         | 4/50 [02:45<31:39, 41.29s/it] 10%|█         | 5/50 [03:54<38:35, 51.45s/it]Epoch 5: Train acc/f1 = 0.6400 / 0.2602 / 0.0000 / 1.0000 
                Val acc/f1/spec/sens = 0.5700 / 0.2420 / 0.0000 / 1.0000
                Test acc/f1/spec/sens = 0.3443 / 0.1707 / 0.0000 / 1.0000
 12%|█▏        | 6/50 [04:28<33:22, 45.52s/it] 14%|█▍        | 7/50 [04:59<29:04, 40.57s/it] 16%|█▌        | 8/50 [05:34<27:14, 38.92s/it] 18%|█▊        | 9/50 [06:07<25:16, 36.98s/it] 20%|██        | 10/50 [07:18<31:42, 47.57s/it]Epoch 10: Train acc/f1 = 0.7000 / 0.4900 / 0.2840 / 0.9653 
                Val acc/f1/spec/sens = 0.6500 / 0.4716 / 0.3721 / 0.9123
                Test acc/f1/spec/sens = 0.5656 / 0.5110 / 0.3500 / 1.0000
 22%|██▏       | 11/50 [07:49<27:37, 42.51s/it] 24%|██▍       | 12/50 [08:26<25:56, 40.96s/it] 26%|██▌       | 13/50 [08:59<23:44, 38.50s/it] 28%|██▊       | 14/50 [09:34<22:25, 37.37s/it] 30%|███       | 15/50 [10:42<27:15, 46.73s/it]Epoch 15: Train acc/f1 = 0.6911 / 0.4846 / 0.2654 / 0.9514 
                Val acc/f1/spec/sens = 0.6500 / 0.4753 / 0.3488 / 0.9123
                Test acc/f1/spec/sens = 0.5738 / 0.5173 / 0.3750 / 0.9762
 32%|███▏      | 16/50 [11:16<24:16, 42.85s/it] 34%|███▍      | 17/50 [11:47<21:38, 39.36s/it] 36%|███▌      | 18/50 [12:21<20:05, 37.66s/it] 38%|███▊      | 19/50 [12:53<18:28, 35.77s/it] 40%|████      | 20/50 [14:02<23:00, 46.00s/it]Epoch 20: Train acc/f1 = 0.7000 / 0.4911 / 0.2932 / 0.9618 
                Val acc/f1/spec/sens = 0.6600 / 0.4949 / 0.4186 / 0.8772
                Test acc/f1/spec/sens = 0.5574 / 0.5025 / 0.3500 / 0.9762
 42%|████▏     | 21/50 [14:34<20:06, 41.61s/it] 44%|████▍     | 22/50 [15:07<18:16, 39.17s/it] 46%|████▌     | 23/50 [15:38<16:29, 36.66s/it] 48%|████▊     | 24/50 [16:14<15:44, 36.33s/it] 50%|█████     | 25/50 [17:20<18:54, 45.39s/it]Epoch 25: Train acc/f1 = 0.7000 / 0.4887 / 0.2685 / 0.9705 
                Val acc/f1/spec/sens = 0.6600 / 0.4882 / 0.3721 / 0.9123
                Test acc/f1/spec/sens = 0.5574 / 0.5070 / 0.3250 / 1.0000
 52%|█████▏    | 26/50 [17:56<17:03, 42.63s/it] 54%|█████▍    | 27/50 [18:27<14:56, 38.96s/it] 56%|█████▌    | 28/50 [19:02<13:51, 37.81s/it] 58%|█████▊    | 29/50 [19:32<12:26, 35.53s/it] 60%|██████    | 30/50 [20:43<15:20, 46.02s/it]Epoch 30: Train acc/f1 = 0.7000 / 0.4926 / 0.2870 / 0.9618 
                Val acc/f1/spec/sens = 0.6500 / 0.4832 / 0.3953 / 0.8772
                Test acc/f1/spec/sens = 0.5492 / 0.4948 / 0.3375 / 0.9762
 62%|██████▏   | 31/50 [21:13<13:06, 41.38s/it] 64%|██████▍   | 32/50 [21:47<11:42, 39.03s/it] 66%|██████▌   | 33/50 [22:19<10:28, 36.96s/it] 68%|██████▊   | 34/50 [22:53<09:40, 36.25s/it] 70%|███████   | 35/50 [24:04<11:39, 46.66s/it]Epoch 35: Train acc/f1 = 0.7000 / 0.4886 / 0.2623 / 0.9722 
                Val acc/f1/spec/sens = 0.6700 / 0.5028 / 0.4651 / 0.8772
                Test acc/f1/spec/sens = 0.5492 / 0.4991 / 0.3125 / 1.0000
 72%|███████▏  | 36/50 [24:40<10:05, 43.22s/it] 74%|███████▍  | 37/50 [25:12<08:41, 40.10s/it] 76%|███████▌  | 38/50 [25:48<07:43, 38.65s/it] 78%|███████▊  | 39/50 [26:19<06:41, 36.49s/it] 80%|████████  | 40/50 [27:31<07:52, 47.22s/it]Epoch 40: Train acc/f1 = 0.6989 / 0.4884 / 0.2994 / 0.9601 
                Val acc/f1/spec/sens = 0.6700 / 0.5037 / 0.4186 / 0.8947
                Test acc/f1/spec/sens = 0.5738 / 0.5173 / 0.3750 / 0.9762
 82%|████████▏ | 41/50 [28:05<06:28, 43.13s/it] 84%|████████▍ | 42/50 [28:40<05:26, 40.76s/it] 86%|████████▌ | 43/50 [29:13<04:28, 38.37s/it] 88%|████████▊ | 44/50 [29:47<03:42, 37.15s/it] 90%|█████████ | 45/50 [30:53<03:48, 45.80s/it]Epoch 45: Train acc/f1 = 0.7067 / 0.5069 / 0.2870 / 0.9653 
                Val acc/f1/spec/sens = 0.6300 / 0.4533 / 0.3256 / 0.8947
                Test acc/f1/spec/sens = 0.5656 / 0.5136 / 0.3500 / 0.9762
 92%|█████████▏| 46/50 [31:33<02:55, 43.98s/it] 94%|█████████▍| 47/50 [32:08<02:04, 41.35s/it] 96%|█████████▌| 48/50 [32:43<01:19, 39.54s/it] 98%|█████████▊| 49/50 [33:17<00:37, 37.67s/it]100%|██████████| 50/50 [34:25<00:00, 46.70s/it]                                               Epoch 50: Train acc/f1 = 0.6967 / 0.4846 / 0.2840 / 0.9618 
                Val acc/f1/spec/sens = 0.6600 / 0.4949 / 0.4186 / 0.8772
                Test acc/f1/spec/sens = 0.5656 / 0.5100 / 0.3625 / 0.9762
specificity = 98/324
sensitivity = 556/576
specificity = 18/43
sensitivity = 50/57
specificity = 29/80
sensitivity = 41/42
Trial 4, Cycle 1
Train acc/f1/spec/sens = 0.7067 / 0.5028 / 0.3025 / 0.9653
Val acc/f1/spec/sens = 0.6600 / 0.4949 / 0.4186 / 0.8772
Test acc/f1/spec/sens = 0.5656 / 0.5100 / 0.3625 / 0.9762
>> Finished.
specificity = 29/80
sensitivity = 41/42
Acc, agreement for latest model:  0.5655737704918032 0.5819672131147541
Load best checkpoint for thief model
specificity = 29/80
sensitivity = 41/42
Acc, agreement for best model:  0.5655737704918032 0.5819672131147541
Trial 3/5 || Cycle 1/1 || Label set size 900 || Test acc 0.5656 || Test agreement 0.5820 || Spec 0.3625 || Sens 0.9762
**************************************************************************************************** 

specificity = 29/80
sensitivity = 41/42
Number of samples  900
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
/home/deepankar/scratch/MSA_Medical/all_names.pkl
Num of videos 64 frames 15800
replacing labeled set labels with victim labels
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:01<00:41,  1.48s/it]  7%|▋         | 2/29 [00:02<00:25,  1.06it/s] 10%|█         | 3/29 [00:02<00:22,  1.16it/s] 14%|█▍        | 4/29 [00:03<00:20,  1.20it/s] 17%|█▋        | 5/29 [00:04<00:20,  1.15it/s] 21%|██        | 6/29 [00:05<00:21,  1.05it/s] 24%|██▍       | 7/29 [00:06<00:18,  1.20it/s] 28%|██▊       | 8/29 [00:07<00:17,  1.23it/s] 31%|███       | 9/29 [00:07<00:16,  1.18it/s] 34%|███▍      | 10/29 [00:08<00:15,  1.19it/s] 38%|███▊      | 11/29 [00:09<00:14,  1.24it/s] 41%|████▏     | 12/29 [00:10<00:14,  1.20it/s] 45%|████▍     | 13/29 [00:10<00:12,  1.33it/s] 48%|████▊     | 14/29 [00:11<00:11,  1.34it/s] 52%|█████▏    | 15/29 [00:12<00:10,  1.36it/s] 55%|█████▌    | 16/29 [00:13<00:11,  1.18it/s] 59%|█████▊    | 17/29 [00:14<00:10,  1.15it/s] 62%|██████▏   | 18/29 [00:15<00:09,  1.21it/s] 66%|██████▌   | 19/29 [00:16<00:08,  1.19it/s] 69%|██████▉   | 20/29 [00:16<00:06,  1.30it/s] 72%|███████▏  | 21/29 [00:17<00:05,  1.35it/s] 76%|███████▌  | 22/29 [00:18<00:05,  1.32it/s] 79%|███████▉  | 23/29 [00:19<00:04,  1.22it/s] 83%|████████▎ | 24/29 [00:19<00:04,  1.17it/s] 86%|████████▌ | 25/29 [00:20<00:03,  1.19it/s] 90%|████████▉ | 26/29 [00:21<00:02,  1.18it/s] 93%|█████████▎| 27/29 [00:22<00:01,  1.18it/s] 97%|█████████▋| 28/29 [00:23<00:00,  1.21it/s]100%|██████████| 29/29 [00:23<00:00,  1.60it/s]100%|██████████| 29/29 [00:23<00:00,  1.23it/s]
replacing val labels with victim labels
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.44s/it] 50%|█████     | 2/4 [00:02<00:02,  1.05s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.17it/s]100%|██████████| 4/4 [00:03<00:00,  1.28it/s]Validation set distribution: 
Number of samples  100

{0: 11, 1: 20, 2: 69}
Labeled set distribution: 
Number of samples  900
{0: 101, 1: 218, 2: 581}
odict_keys(['global_branch.net.conv1.weight', 'global_branch.net.bn1.weight', 'global_branch.net.bn1.bias', 'global_branch.net.bn1.running_mean', 'global_branch.net.bn1.running_var', 'global_branch.net.bn1.num_batches_tracked', 'global_branch.net.layer1.0.conv1.weight', 'global_branch.net.layer1.0.bn1.weight', 'global_branch.net.layer1.0.bn1.bias', 'global_branch.net.layer1.0.bn1.running_mean', 'global_branch.net.layer1.0.bn1.running_var', 'global_branch.net.layer1.0.bn1.num_batches_tracked', 'global_branch.net.layer1.0.conv2.weight', 'global_branch.net.layer1.0.bn2.weight', 'global_branch.net.layer1.0.bn2.bias', 'global_branch.net.layer1.0.bn2.running_mean', 'global_branch.net.layer1.0.bn2.running_var', 'global_branch.net.layer1.0.bn2.num_batches_tracked', 'global_branch.net.layer1.0.conv3.weight', 'global_branch.net.layer1.0.bn3.weight', 'global_branch.net.layer1.0.bn3.bias', 'global_branch.net.layer1.0.bn3.running_mean', 'global_branch.net.layer1.0.bn3.running_var', 'global_branch.net.layer1.0.bn3.num_batches_tracked', 'global_branch.net.layer1.0.downsample.0.weight', 'global_branch.net.layer1.0.downsample.1.weight', 'global_branch.net.layer1.0.downsample.1.bias', 'global_branch.net.layer1.0.downsample.1.running_mean', 'global_branch.net.layer1.0.downsample.1.running_var', 'global_branch.net.layer1.0.downsample.1.num_batches_tracked', 'global_branch.net.layer1.1.conv1.weight', 'global_branch.net.layer1.1.bn1.weight', 'global_branch.net.layer1.1.bn1.bias', 'global_branch.net.layer1.1.bn1.running_mean', 'global_branch.net.layer1.1.bn1.running_var', 'global_branch.net.layer1.1.bn1.num_batches_tracked', 'global_branch.net.layer1.1.conv2.weight', 'global_branch.net.layer1.1.bn2.weight', 'global_branch.net.layer1.1.bn2.bias', 'global_branch.net.layer1.1.bn2.running_mean', 'global_branch.net.layer1.1.bn2.running_var', 'global_branch.net.layer1.1.bn2.num_batches_tracked', 'global_branch.net.layer1.1.conv3.weight', 'global_branch.net.layer1.1.bn3.weight', 'global_branch.net.layer1.1.bn3.bias', 'global_branch.net.layer1.1.bn3.running_mean', 'global_branch.net.layer1.1.bn3.running_var', 'global_branch.net.layer1.1.bn3.num_batches_tracked', 'global_branch.net.layer1.2.conv1.weight', 'global_branch.net.layer1.2.bn1.weight', 'global_branch.net.layer1.2.bn1.bias', 'global_branch.net.layer1.2.bn1.running_mean', 'global_branch.net.layer1.2.bn1.running_var', 'global_branch.net.layer1.2.bn1.num_batches_tracked', 'global_branch.net.layer1.2.conv2.weight', 'global_branch.net.layer1.2.bn2.weight', 'global_branch.net.layer1.2.bn2.bias', 'global_branch.net.layer1.2.bn2.running_mean', 'global_branch.net.layer1.2.bn2.running_var', 'global_branch.net.layer1.2.bn2.num_batches_tracked', 'global_branch.net.layer1.2.conv3.weight', 'global_branch.net.layer1.2.bn3.weight', 'global_branch.net.layer1.2.bn3.bias', 'global_branch.net.layer1.2.bn3.running_mean', 'global_branch.net.layer1.2.bn3.running_var', 'global_branch.net.layer1.2.bn3.num_batches_tracked', 'global_branch.net.layer2.0.conv1.weight', 'global_branch.net.layer2.0.bn1.weight', 'global_branch.net.layer2.0.bn1.bias', 'global_branch.net.layer2.0.bn1.running_mean', 'global_branch.net.layer2.0.bn1.running_var', 'global_branch.net.layer2.0.bn1.num_batches_tracked', 'global_branch.net.layer2.0.conv2.weight', 'global_branch.net.layer2.0.bn2.weight', 'global_branch.net.layer2.0.bn2.bias', 'global_branch.net.layer2.0.bn2.running_mean', 'global_branch.net.layer2.0.bn2.running_var', 'global_branch.net.layer2.0.bn2.num_batches_tracked', 'global_branch.net.layer2.0.conv3.weight', 'global_branch.net.layer2.0.bn3.weight', 'global_branch.net.layer2.0.bn3.bias', 'global_branch.net.layer2.0.bn3.running_mean', 'global_branch.net.layer2.0.bn3.running_var', 'global_branch.net.layer2.0.bn3.num_batches_tracked', 'global_branch.net.layer2.0.downsample.0.weight', 'global_branch.net.layer2.0.downsample.1.weight', 'global_branch.net.layer2.0.downsample.1.bias', 'global_branch.net.layer2.0.downsample.1.running_mean', 'global_branch.net.layer2.0.downsample.1.running_var', 'global_branch.net.layer2.0.downsample.1.num_batches_tracked', 'global_branch.net.layer2.1.conv1.weight', 'global_branch.net.layer2.1.bn1.weight', 'global_branch.net.layer2.1.bn1.bias', 'global_branch.net.layer2.1.bn1.running_mean', 'global_branch.net.layer2.1.bn1.running_var', 'global_branch.net.layer2.1.bn1.num_batches_tracked', 'global_branch.net.layer2.1.conv2.weight', 'global_branch.net.layer2.1.bn2.weight', 'global_branch.net.layer2.1.bn2.bias', 'global_branch.net.layer2.1.bn2.running_mean', 'global_branch.net.layer2.1.bn2.running_var', 'global_branch.net.layer2.1.bn2.num_batches_tracked', 'global_branch.net.layer2.1.conv3.weight', 'global_branch.net.layer2.1.bn3.weight', 'global_branch.net.layer2.1.bn3.bias', 'global_branch.net.layer2.1.bn3.running_mean', 'global_branch.net.layer2.1.bn3.running_var', 'global_branch.net.layer2.1.bn3.num_batches_tracked', 'global_branch.net.layer2.2.conv1.weight', 'global_branch.net.layer2.2.bn1.weight', 'global_branch.net.layer2.2.bn1.bias', 'global_branch.net.layer2.2.bn1.running_mean', 'global_branch.net.layer2.2.bn1.running_var', 'global_branch.net.layer2.2.bn1.num_batches_tracked', 'global_branch.net.layer2.2.conv2.weight', 'global_branch.net.layer2.2.bn2.weight', 'global_branch.net.layer2.2.bn2.bias', 'global_branch.net.layer2.2.bn2.running_mean', 'global_branch.net.layer2.2.bn2.running_var', 'global_branch.net.layer2.2.bn2.num_batches_tracked', 'global_branch.net.layer2.2.conv3.weight', 'global_branch.net.layer2.2.bn3.weight', 'global_branch.net.layer2.2.bn3.bias', 'global_branch.net.layer2.2.bn3.running_mean', 'global_branch.net.layer2.2.bn3.running_var', 'global_branch.net.layer2.2.bn3.num_batches_tracked', 'global_branch.net.layer2.3.conv1.weight', 'global_branch.net.layer2.3.bn1.weight', 'global_branch.net.layer2.3.bn1.bias', 'global_branch.net.layer2.3.bn1.running_mean', 'global_branch.net.layer2.3.bn1.running_var', 'global_branch.net.layer2.3.bn1.num_batches_tracked', 'global_branch.net.layer2.3.conv2.weight', 'global_branch.net.layer2.3.bn2.weight', 'global_branch.net.layer2.3.bn2.bias', 'global_branch.net.layer2.3.bn2.running_mean', 'global_branch.net.layer2.3.bn2.running_var', 'global_branch.net.layer2.3.bn2.num_batches_tracked', 'global_branch.net.layer2.3.conv3.weight', 'global_branch.net.layer2.3.bn3.weight', 'global_branch.net.layer2.3.bn3.bias', 'global_branch.net.layer2.3.bn3.running_mean', 'global_branch.net.layer2.3.bn3.running_var', 'global_branch.net.layer2.3.bn3.num_batches_tracked', 'global_branch.net.layer3.0.conv1.weight', 'global_branch.net.layer3.0.bn1.weight', 'global_branch.net.layer3.0.bn1.bias', 'global_branch.net.layer3.0.bn1.running_mean', 'global_branch.net.layer3.0.bn1.running_var', 'global_branch.net.layer3.0.bn1.num_batches_tracked', 'global_branch.net.layer3.0.conv2.weight', 'global_branch.net.layer3.0.bn2.weight', 'global_branch.net.layer3.0.bn2.bias', 'global_branch.net.layer3.0.bn2.running_mean', 'global_branch.net.layer3.0.bn2.running_var', 'global_branch.net.layer3.0.bn2.num_batches_tracked', 'global_branch.net.layer3.0.conv3.weight', 'global_branch.net.layer3.0.bn3.weight', 'global_branch.net.layer3.0.bn3.bias', 'global_branch.net.layer3.0.bn3.running_mean', 'global_branch.net.layer3.0.bn3.running_var', 'global_branch.net.layer3.0.bn3.num_batches_tracked', 'global_branch.net.layer3.0.downsample.0.weight', 'global_branch.net.layer3.0.downsample.1.weight', 'global_branch.net.layer3.0.downsample.1.bias', 'global_branch.net.layer3.0.downsample.1.running_mean', 'global_branch.net.layer3.0.downsample.1.running_var', 'global_branch.net.layer3.0.downsample.1.num_batches_tracked', 'global_branch.net.layer3.1.conv1.weight', 'global_branch.net.layer3.1.bn1.weight', 'global_branch.net.layer3.1.bn1.bias', 'global_branch.net.layer3.1.bn1.running_mean', 'global_branch.net.layer3.1.bn1.running_var', 'global_branch.net.layer3.1.bn1.num_batches_tracked', 'global_branch.net.layer3.1.conv2.weight', 'global_branch.net.layer3.1.bn2.weight', 'global_branch.net.layer3.1.bn2.bias', 'global_branch.net.layer3.1.bn2.running_mean', 'global_branch.net.layer3.1.bn2.running_var', 'global_branch.net.layer3.1.bn2.num_batches_tracked', 'global_branch.net.layer3.1.conv3.weight', 'global_branch.net.layer3.1.bn3.weight', 'global_branch.net.layer3.1.bn3.bias', 'global_branch.net.layer3.1.bn3.running_mean', 'global_branch.net.layer3.1.bn3.running_var', 'global_branch.net.layer3.1.bn3.num_batches_tracked', 'global_branch.net.layer3.2.conv1.weight', 'global_branch.net.layer3.2.bn1.weight', 'global_branch.net.layer3.2.bn1.bias', 'global_branch.net.layer3.2.bn1.running_mean', 'global_branch.net.layer3.2.bn1.running_var', 'global_branch.net.layer3.2.bn1.num_batches_tracked', 'global_branch.net.layer3.2.conv2.weight', 'global_branch.net.layer3.2.bn2.weight', 'global_branch.net.layer3.2.bn2.bias', 'global_branch.net.layer3.2.bn2.running_mean', 'global_branch.net.layer3.2.bn2.running_var', 'global_branch.net.layer3.2.bn2.num_batches_tracked', 'global_branch.net.layer3.2.conv3.weight', 'global_branch.net.layer3.2.bn3.weight', 'global_branch.net.layer3.2.bn3.bias', 'global_branch.net.layer3.2.bn3.running_mean', 'global_branch.net.layer3.2.bn3.running_var', 'global_branch.net.layer3.2.bn3.num_batches_tracked', 'global_branch.net.layer3.3.conv1.weight', 'global_branch.net.layer3.3.bn1.weight', 'global_branch.net.layer3.3.bn1.bias', 'global_branch.net.layer3.3.bn1.running_mean', 'global_branch.net.layer3.3.bn1.running_var', 'global_branch.net.layer3.3.bn1.num_batches_tracked', 'global_branch.net.layer3.3.conv2.weight', 'global_branch.net.layer3.3.bn2.weight', 'global_branch.net.layer3.3.bn2.bias', 'global_branch.net.layer3.3.bn2.running_mean', 'global_branch.net.layer3.3.bn2.running_var', 'global_branch.net.layer3.3.bn2.num_batches_tracked', 'global_branch.net.layer3.3.conv3.weight', 'global_branch.net.layer3.3.bn3.weight', 'global_branch.net.layer3.3.bn3.bias', 'global_branch.net.layer3.3.bn3.running_mean', 'global_branch.net.layer3.3.bn3.running_var', 'global_branch.net.layer3.3.bn3.num_batches_tracked', 'global_branch.net.layer3.4.conv1.weight', 'global_branch.net.layer3.4.bn1.weight', 'global_branch.net.layer3.4.bn1.bias', 'global_branch.net.layer3.4.bn1.running_mean', 'global_branch.net.layer3.4.bn1.running_var', 'global_branch.net.layer3.4.bn1.num_batches_tracked', 'global_branch.net.layer3.4.conv2.weight', 'global_branch.net.layer3.4.bn2.weight', 'global_branch.net.layer3.4.bn2.bias', 'global_branch.net.layer3.4.bn2.running_mean', 'global_branch.net.layer3.4.bn2.running_var', 'global_branch.net.layer3.4.bn2.num_batches_tracked', 'global_branch.net.layer3.4.conv3.weight', 'global_branch.net.layer3.4.bn3.weight', 'global_branch.net.layer3.4.bn3.bias', 'global_branch.net.layer3.4.bn3.running_mean', 'global_branch.net.layer3.4.bn3.running_var', 'global_branch.net.layer3.4.bn3.num_batches_tracked', 'global_branch.net.layer3.5.conv1.weight', 'global_branch.net.layer3.5.bn1.weight', 'global_branch.net.layer3.5.bn1.bias', 'global_branch.net.layer3.5.bn1.running_mean', 'global_branch.net.layer3.5.bn1.running_var', 'global_branch.net.layer3.5.bn1.num_batches_tracked', 'global_branch.net.layer3.5.conv2.weight', 'global_branch.net.layer3.5.bn2.weight', 'global_branch.net.layer3.5.bn2.bias', 'global_branch.net.layer3.5.bn2.running_mean', 'global_branch.net.layer3.5.bn2.running_var', 'global_branch.net.layer3.5.bn2.num_batches_tracked', 'global_branch.net.layer3.5.conv3.weight', 'global_branch.net.layer3.5.bn3.weight', 'global_branch.net.layer3.5.bn3.bias', 'global_branch.net.layer3.5.bn3.running_mean', 'global_branch.net.layer3.5.bn3.running_var', 'global_branch.net.layer3.5.bn3.num_batches_tracked', 'global_branch.net.layer4.0.conv1.weight', 'global_branch.net.layer4.0.bn1.weight', 'global_branch.net.layer4.0.bn1.bias', 'global_branch.net.layer4.0.bn1.running_mean', 'global_branch.net.layer4.0.bn1.running_var', 'global_branch.net.layer4.0.bn1.num_batches_tracked', 'global_branch.net.layer4.0.conv2.weight', 'global_branch.net.layer4.0.bn2.weight', 'global_branch.net.layer4.0.bn2.bias', 'global_branch.net.layer4.0.bn2.running_mean', 'global_branch.net.layer4.0.bn2.running_var', 'global_branch.net.layer4.0.bn2.num_batches_tracked', 'global_branch.net.layer4.0.conv3.weight', 'global_branch.net.layer4.0.bn3.weight', 'global_branch.net.layer4.0.bn3.bias', 'global_branch.net.layer4.0.bn3.running_mean', 'global_branch.net.layer4.0.bn3.running_var', 'global_branch.net.layer4.0.bn3.num_batches_tracked', 'global_branch.net.layer4.0.downsample.0.weight', 'global_branch.net.layer4.0.downsample.1.weight', 'global_branch.net.layer4.0.downsample.1.bias', 'global_branch.net.layer4.0.downsample.1.running_mean', 'global_branch.net.layer4.0.downsample.1.running_var', 'global_branch.net.layer4.0.downsample.1.num_batches_tracked', 'global_branch.net.layer4.1.conv1.weight', 'global_branch.net.layer4.1.bn1.weight', 'global_branch.net.layer4.1.bn1.bias', 'global_branch.net.layer4.1.bn1.running_mean', 'global_branch.net.layer4.1.bn1.running_var', 'global_branch.net.layer4.1.bn1.num_batches_tracked', 'global_branch.net.layer4.1.conv2.weight', 'global_branch.net.layer4.1.bn2.weight', 'global_branch.net.layer4.1.bn2.bias', 'global_branch.net.layer4.1.bn2.running_mean', 'global_branch.net.layer4.1.bn2.running_var', 'global_branch.net.layer4.1.bn2.num_batches_tracked', 'global_branch.net.layer4.1.conv3.weight', 'global_branch.net.layer4.1.bn3.weight', 'global_branch.net.layer4.1.bn3.bias', 'global_branch.net.layer4.1.bn3.running_mean', 'global_branch.net.layer4.1.bn3.running_var', 'global_branch.net.layer4.1.bn3.num_batches_tracked', 'global_branch.net.layer4.2.conv1.weight', 'global_branch.net.layer4.2.bn1.weight', 'global_branch.net.layer4.2.bn1.bias', 'global_branch.net.layer4.2.bn1.running_mean', 'global_branch.net.layer4.2.bn1.running_var', 'global_branch.net.layer4.2.bn1.num_batches_tracked', 'global_branch.net.layer4.2.conv2.weight', 'global_branch.net.layer4.2.bn2.weight', 'global_branch.net.layer4.2.bn2.bias', 'global_branch.net.layer4.2.bn2.running_mean', 'global_branch.net.layer4.2.bn2.running_var', 'global_branch.net.layer4.2.bn2.num_batches_tracked', 'global_branch.net.layer4.2.conv3.weight', 'global_branch.net.layer4.2.bn3.weight', 'global_branch.net.layer4.2.bn3.bias', 'global_branch.net.layer4.2.bn3.running_mean', 'global_branch.net.layer4.2.bn3.running_var', 'global_branch.net.layer4.2.bn3.num_batches_tracked', 'global_branch.net.fc.weight', 'global_branch.net.fc.bias', 'local_branch.conv1.weight', 'local_branch.conv2.weight', 'local_branch.bn1.weight', 'local_branch.bn1.bias', 'local_branch.bn1.running_mean', 'local_branch.bn1.running_var', 'local_branch.bn1.num_batches_tracked', 'local_branch.layer1.0.conv1.weight', 'local_branch.layer1.0.bn1.weight', 'local_branch.layer1.0.bn1.bias', 'local_branch.layer1.0.bn1.running_mean', 'local_branch.layer1.0.bn1.running_var', 'local_branch.layer1.0.bn1.num_batches_tracked', 'local_branch.layer1.0.conv2.weight', 'local_branch.layer1.0.bn2.weight', 'local_branch.layer1.0.bn2.bias', 'local_branch.layer1.0.bn2.running_mean', 'local_branch.layer1.0.bn2.running_var', 'local_branch.layer1.0.bn2.num_batches_tracked', 'local_branch.layer1.0.conv3.weight', 'local_branch.layer1.0.bn3.weight', 'local_branch.layer1.0.bn3.bias', 'local_branch.layer1.0.bn3.running_mean', 'local_branch.layer1.0.bn3.running_var', 'local_branch.layer1.0.bn3.num_batches_tracked', 'local_branch.layer1.0.downsample.0.weight', 'local_branch.layer1.0.downsample.1.weight', 'local_branch.layer1.0.downsample.1.bias', 'local_branch.layer1.0.downsample.1.running_mean', 'local_branch.layer1.0.downsample.1.running_var', 'local_branch.layer1.0.downsample.1.num_batches_tracked', 'local_branch.layer1.1.conv1.weight', 'local_branch.layer1.1.bn1.weight', 'local_branch.layer1.1.bn1.bias', 'local_branch.layer1.1.bn1.running_mean', 'local_branch.layer1.1.bn1.running_var', 'local_branch.layer1.1.bn1.num_batches_tracked', 'local_branch.layer1.1.conv2.weight', 'local_branch.layer1.1.bn2.weight', 'local_branch.layer1.1.bn2.bias', 'local_branch.layer1.1.bn2.running_mean', 'local_branch.layer1.1.bn2.running_var', 'local_branch.layer1.1.bn2.num_batches_tracked', 'local_branch.layer1.1.conv3.weight', 'local_branch.layer1.1.bn3.weight', 'local_branch.layer1.1.bn3.bias', 'local_branch.layer1.1.bn3.running_mean', 'local_branch.layer1.1.bn3.running_var', 'local_branch.layer1.1.bn3.num_batches_tracked', 'local_branch.layer1.2.conv1.weight', 'local_branch.layer1.2.bn1.weight', 'local_branch.layer1.2.bn1.bias', 'local_branch.layer1.2.bn1.running_mean', 'local_branch.layer1.2.bn1.running_var', 'local_branch.layer1.2.bn1.num_batches_tracked', 'local_branch.layer1.2.conv2.weight', 'local_branch.layer1.2.bn2.weight', 'local_branch.layer1.2.bn2.bias', 'local_branch.layer1.2.bn2.running_mean', 'local_branch.layer1.2.bn2.running_var', 'local_branch.layer1.2.bn2.num_batches_tracked', 'local_branch.layer1.2.conv3.weight', 'local_branch.layer1.2.bn3.weight', 'local_branch.layer1.2.bn3.bias', 'local_branch.layer1.2.bn3.running_mean', 'local_branch.layer1.2.bn3.running_var', 'local_branch.layer1.2.bn3.num_batches_tracked', 'local_branch.layer2.0.conv1.weight', 'local_branch.layer2.0.bn1.weight', 'local_branch.layer2.0.bn1.bias', 'local_branch.layer2.0.bn1.running_mean', 'local_branch.layer2.0.bn1.running_var', 'local_branch.layer2.0.bn1.num_batches_tracked', 'local_branch.layer2.0.conv2.weight', 'local_branch.layer2.0.bn2.weight', 'local_branch.layer2.0.bn2.bias', 'local_branch.layer2.0.bn2.running_mean', 'local_branch.layer2.0.bn2.running_var', 'local_branch.layer2.0.bn2.num_batches_tracked', 'local_branch.layer2.0.conv3.weight', 'local_branch.layer2.0.bn3.weight', 'local_branch.layer2.0.bn3.bias', 'local_branch.layer2.0.bn3.running_mean', 'local_branch.layer2.0.bn3.running_var', 'local_branch.layer2.0.bn3.num_batches_tracked', 'local_branch.layer2.0.downsample.0.weight', 'local_branch.layer2.0.downsample.1.weight', 'local_branch.layer2.0.downsample.1.bias', 'local_branch.layer2.0.downsample.1.running_mean', 'local_branch.layer2.0.downsample.1.running_var', 'local_branch.layer2.0.downsample.1.num_batches_tracked', 'local_branch.layer2.1.conv1.weight', 'local_branch.layer2.1.bn1.weight', 'local_branch.layer2.1.bn1.bias', 'local_branch.layer2.1.bn1.running_mean', 'local_branch.layer2.1.bn1.running_var', 'local_branch.layer2.1.bn1.num_batches_tracked', 'local_branch.layer2.1.conv2.weight', 'local_branch.layer2.1.bn2.weight', 'local_branch.layer2.1.bn2.bias', 'local_branch.layer2.1.bn2.running_mean', 'local_branch.layer2.1.bn2.running_var', 'local_branch.layer2.1.bn2.num_batches_tracked', 'local_branch.layer2.1.conv3.weight', 'local_branch.layer2.1.bn3.weight', 'local_branch.layer2.1.bn3.bias', 'local_branch.layer2.1.bn3.running_mean', 'local_branch.layer2.1.bn3.running_var', 'local_branch.layer2.1.bn3.num_batches_tracked', 'local_branch.layer2.2.conv1.weight', 'local_branch.layer2.2.bn1.weight', 'local_branch.layer2.2.bn1.bias', 'local_branch.layer2.2.bn1.running_mean', 'local_branch.layer2.2.bn1.running_var', 'local_branch.layer2.2.bn1.num_batches_tracked', 'local_branch.layer2.2.conv2.weight', 'local_branch.layer2.2.bn2.weight', 'local_branch.layer2.2.bn2.bias', 'local_branch.layer2.2.bn2.running_mean', 'local_branch.layer2.2.bn2.running_var', 'local_branch.layer2.2.bn2.num_batches_tracked', 'local_branch.layer2.2.conv3.weight', 'local_branch.layer2.2.bn3.weight', 'local_branch.layer2.2.bn3.bias', 'local_branch.layer2.2.bn3.running_mean', 'local_branch.layer2.2.bn3.running_var', 'local_branch.layer2.2.bn3.num_batches_tracked', 'local_branch.layer2.3.conv1.weight', 'local_branch.layer2.3.bn1.weight', 'local_branch.layer2.3.bn1.bias', 'local_branch.layer2.3.bn1.running_mean', 'local_branch.layer2.3.bn1.running_var', 'local_branch.layer2.3.bn1.num_batches_tracked', 'local_branch.layer2.3.conv2.weight', 'local_branch.layer2.3.bn2.weight', 'local_branch.layer2.3.bn2.bias', 'local_branch.layer2.3.bn2.running_mean', 'local_branch.layer2.3.bn2.running_var', 'local_branch.layer2.3.bn2.num_batches_tracked', 'local_branch.layer2.3.conv3.weight', 'local_branch.layer2.3.bn3.weight', 'local_branch.layer2.3.bn3.bias', 'local_branch.layer2.3.bn3.running_mean', 'local_branch.layer2.3.bn3.running_var', 'local_branch.layer2.3.bn3.num_batches_tracked', 'local_branch.layer3.0.conv1.weight', 'local_branch.layer3.0.bn1.weight', 'local_branch.layer3.0.bn1.bias', 'local_branch.layer3.0.bn1.running_mean', 'local_branch.layer3.0.bn1.running_var', 'local_branch.layer3.0.bn1.num_batches_tracked', 'local_branch.layer3.0.conv2.weight', 'local_branch.layer3.0.bn2.weight', 'local_branch.layer3.0.bn2.bias', 'local_branch.layer3.0.bn2.running_mean', 'local_branch.layer3.0.bn2.running_var', 'local_branch.layer3.0.bn2.num_batches_tracked', 'local_branch.layer3.0.conv3.weight', 'local_branch.layer3.0.bn3.weight', 'local_branch.layer3.0.bn3.bias', 'local_branch.layer3.0.bn3.running_mean', 'local_branch.layer3.0.bn3.running_var', 'local_branch.layer3.0.bn3.num_batches_tracked', 'local_branch.layer3.0.downsample.0.weight', 'local_branch.layer3.0.downsample.1.weight', 'local_branch.layer3.0.downsample.1.bias', 'local_branch.layer3.0.downsample.1.running_mean', 'local_branch.layer3.0.downsample.1.running_var', 'local_branch.layer3.0.downsample.1.num_batches_tracked', 'local_branch.layer3.1.conv1.weight', 'local_branch.layer3.1.bn1.weight', 'local_branch.layer3.1.bn1.bias', 'local_branch.layer3.1.bn1.running_mean', 'local_branch.layer3.1.bn1.running_var', 'local_branch.layer3.1.bn1.num_batches_tracked', 'local_branch.layer3.1.conv2.weight', 'local_branch.layer3.1.bn2.weight', 'local_branch.layer3.1.bn2.bias', 'local_branch.layer3.1.bn2.running_mean', 'local_branch.layer3.1.bn2.running_var', 'local_branch.layer3.1.bn2.num_batches_tracked', 'local_branch.layer3.1.conv3.weight', 'local_branch.layer3.1.bn3.weight', 'local_branch.layer3.1.bn3.bias', 'local_branch.layer3.1.bn3.running_mean', 'local_branch.layer3.1.bn3.running_var', 'local_branch.layer3.1.bn3.num_batches_tracked', 'local_branch.layer3.2.conv1.weight', 'local_branch.layer3.2.bn1.weight', 'local_branch.layer3.2.bn1.bias', 'local_branch.layer3.2.bn1.running_mean', 'local_branch.layer3.2.bn1.running_var', 'local_branch.layer3.2.bn1.num_batches_tracked', 'local_branch.layer3.2.conv2.weight', 'local_branch.layer3.2.bn2.weight', 'local_branch.layer3.2.bn2.bias', 'local_branch.layer3.2.bn2.running_mean', 'local_branch.layer3.2.bn2.running_var', 'local_branch.layer3.2.bn2.num_batches_tracked', 'local_branch.layer3.2.conv3.weight', 'local_branch.layer3.2.bn3.weight', 'local_branch.layer3.2.bn3.bias', 'local_branch.layer3.2.bn3.running_mean', 'local_branch.layer3.2.bn3.running_var', 'local_branch.layer3.2.bn3.num_batches_tracked', 'local_branch.layer3.3.conv1.weight', 'local_branch.layer3.3.bn1.weight', 'local_branch.layer3.3.bn1.bias', 'local_branch.layer3.3.bn1.running_mean', 'local_branch.layer3.3.bn1.running_var', 'local_branch.layer3.3.bn1.num_batches_tracked', 'local_branch.layer3.3.conv2.weight', 'local_branch.layer3.3.bn2.weight', 'local_branch.layer3.3.bn2.bias', 'local_branch.layer3.3.bn2.running_mean', 'local_branch.layer3.3.bn2.running_var', 'local_branch.layer3.3.bn2.num_batches_tracked', 'local_branch.layer3.3.conv3.weight', 'local_branch.layer3.3.bn3.weight', 'local_branch.layer3.3.bn3.bias', 'local_branch.layer3.3.bn3.running_mean', 'local_branch.layer3.3.bn3.running_var', 'local_branch.layer3.3.bn3.num_batches_tracked', 'local_branch.layer3.4.conv1.weight', 'local_branch.layer3.4.bn1.weight', 'local_branch.layer3.4.bn1.bias', 'local_branch.layer3.4.bn1.running_mean', 'local_branch.layer3.4.bn1.running_var', 'local_branch.layer3.4.bn1.num_batches_tracked', 'local_branch.layer3.4.conv2.weight', 'local_branch.layer3.4.bn2.weight', 'local_branch.layer3.4.bn2.bias', 'local_branch.layer3.4.bn2.running_mean', 'local_branch.layer3.4.bn2.running_var', 'local_branch.layer3.4.bn2.num_batches_tracked', 'local_branch.layer3.4.conv3.weight', 'local_branch.layer3.4.bn3.weight', 'local_branch.layer3.4.bn3.bias', 'local_branch.layer3.4.bn3.running_mean', 'local_branch.layer3.4.bn3.running_var', 'local_branch.layer3.4.bn3.num_batches_tracked', 'local_branch.layer3.5.conv1.weight', 'local_branch.layer3.5.bn1.weight', 'local_branch.layer3.5.bn1.bias', 'local_branch.layer3.5.bn1.running_mean', 'local_branch.layer3.5.bn1.running_var', 'local_branch.layer3.5.bn1.num_batches_tracked', 'local_branch.layer3.5.conv2.weight', 'local_branch.layer3.5.bn2.weight', 'local_branch.layer3.5.bn2.bias', 'local_branch.layer3.5.bn2.running_mean', 'local_branch.layer3.5.bn2.running_var', 'local_branch.layer3.5.bn2.num_batches_tracked', 'local_branch.layer3.5.conv3.weight', 'local_branch.layer3.5.bn3.weight', 'local_branch.layer3.5.bn3.bias', 'local_branch.layer3.5.bn3.running_mean', 'local_branch.layer3.5.bn3.running_var', 'local_branch.layer3.5.bn3.num_batches_tracked', 'local_branch.layer4.0.conv1.weight', 'local_branch.layer4.0.bn1.weight', 'local_branch.layer4.0.bn1.bias', 'local_branch.layer4.0.bn1.running_mean', 'local_branch.layer4.0.bn1.running_var', 'local_branch.layer4.0.bn1.num_batches_tracked', 'local_branch.layer4.0.conv2.weight', 'local_branch.layer4.0.bn2.weight', 'local_branch.layer4.0.bn2.bias', 'local_branch.layer4.0.bn2.running_mean', 'local_branch.layer4.0.bn2.running_var', 'local_branch.layer4.0.bn2.num_batches_tracked', 'local_branch.layer4.0.conv3.weight', 'local_branch.layer4.0.bn3.weight', 'local_branch.layer4.0.bn3.bias', 'local_branch.layer4.0.bn3.running_mean', 'local_branch.layer4.0.bn3.running_var', 'local_branch.layer4.0.bn3.num_batches_tracked', 'local_branch.layer4.0.downsample.0.weight', 'local_branch.layer4.0.downsample.1.weight', 'local_branch.layer4.0.downsample.1.bias', 'local_branch.layer4.0.downsample.1.running_mean', 'local_branch.layer4.0.downsample.1.running_var', 'local_branch.layer4.0.downsample.1.num_batches_tracked', 'local_branch.layer4.1.conv1.weight', 'local_branch.layer4.1.bn1.weight', 'local_branch.layer4.1.bn1.bias', 'local_branch.layer4.1.bn1.running_mean', 'local_branch.layer4.1.bn1.running_var', 'local_branch.layer4.1.bn1.num_batches_tracked', 'local_branch.layer4.1.conv2.weight', 'local_branch.layer4.1.bn2.weight', 'local_branch.layer4.1.bn2.bias', 'local_branch.layer4.1.bn2.running_mean', 'local_branch.layer4.1.bn2.running_var', 'local_branch.layer4.1.bn2.num_batches_tracked', 'local_branch.layer4.1.conv3.weight', 'local_branch.layer4.1.bn3.weight', 'local_branch.layer4.1.bn3.bias', 'local_branch.layer4.1.bn3.running_mean', 'local_branch.layer4.1.bn3.running_var', 'local_branch.layer4.1.bn3.num_batches_tracked', 'local_branch.layer4.2.conv1.weight', 'local_branch.layer4.2.bn1.weight', 'local_branch.layer4.2.bn1.bias', 'local_branch.layer4.2.bn1.running_mean', 'local_branch.layer4.2.bn1.running_var', 'local_branch.layer4.2.bn1.num_batches_tracked', 'local_branch.layer4.2.conv2.weight', 'local_branch.layer4.2.bn2.weight', 'local_branch.layer4.2.bn2.bias', 'local_branch.layer4.2.bn2.running_mean', 'local_branch.layer4.2.bn2.running_var', 'local_branch.layer4.2.bn2.num_batches_tracked', 'local_branch.layer4.2.conv3.weight', 'local_branch.layer4.2.bn3.weight', 'local_branch.layer4.2.bn3.bias', 'local_branch.layer4.2.bn3.running_mean', 'local_branch.layer4.2.bn3.running_var', 'local_branch.layer4.2.bn3.num_batches_tracked', 'local_branch.fc.weight', 'local_branch.fc.bias', 'fusion_branch.encoder.enc_layers.0.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.0.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.0.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.0.layernorm1.weight', 'fusion_branch.encoder.enc_layers.0.layernorm1.bias', 'fusion_branch.encoder.enc_layers.0.layernorm2.weight', 'fusion_branch.encoder.enc_layers.0.layernorm2.bias', 'fusion_branch.encoder.enc_layers.1.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.1.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.1.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.1.layernorm1.weight', 'fusion_branch.encoder.enc_layers.1.layernorm1.bias', 'fusion_branch.encoder.enc_layers.1.layernorm2.weight', 'fusion_branch.encoder.enc_layers.1.layernorm2.bias', 'fusion_branch.encoder.enc_layers.2.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.2.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.2.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.2.layernorm1.weight', 'fusion_branch.encoder.enc_layers.2.layernorm1.bias', 'fusion_branch.encoder.enc_layers.2.layernorm2.weight', 'fusion_branch.encoder.enc_layers.2.layernorm2.bias', 'fusion_branch.encoder.enc_layers.3.mha.W_q.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_k.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_v.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_h.weight', 'fusion_branch.encoder.enc_layers.3.mha.W_h.bias', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL1.weight', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL1.bias', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL2.weight', 'fusion_branch.encoder.enc_layers.3.cnn.k1convL2.bias', 'fusion_branch.encoder.enc_layers.3.layernorm1.weight', 'fusion_branch.encoder.enc_layers.3.layernorm1.bias', 'fusion_branch.encoder.enc_layers.3.layernorm2.weight', 'fusion_branch.encoder.enc_layers.3.layernorm2.bias', 'fusion_branch.dense.weight', 'fusion_branch.dense.bias'])
thief state:  None
pretrained state:  dict_keys([])
Thief model initialized successfully
specificity = 0/80
sensitivity = 42/42
Initial model on target dataset: acc = 0.3443, agreement = 0.3852, f1 = 0.1707, spec = 0.0000, sens = 1.0000
specificity = 0/31
sensitivity = 69/69
Initial model on validation dataset: acc = 0.6900, agreement = 0.6900, f1 = 0.2722, spec = 0.0000, sens = 1.0000
la:  None
>> Train a Model.
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:40<33:12, 40.67s/it]  4%|▍         | 2/50 [01:16<30:18, 37.88s/it]  6%|▌         | 3/50 [02:11<35:42, 45.58s/it]  8%|▊         | 4/50 [03:10<39:12, 51.14s/it] 10%|█         | 5/50 [05:07<56:08, 74.85s/it]Epoch 5: Train acc/f1 = 0.7756 / 0.7057 / 0.7492 / 0.8692 
                Val acc/f1/spec/sens = 0.7800 / 0.6280 / 0.4516 / 0.9565
                Test acc/f1/spec/sens = 0.7705 / 0.7840 / 0.7375 / 0.8810
 12%|█▏        | 6/50 [06:10<51:49, 70.68s/it] 14%|█▍        | 7/50 [06:55<44:37, 62.28s/it] 16%|█▌        | 8/50 [07:44<40:38, 58.06s/it] 18%|█▊        | 9/50 [08:19<34:50, 50.98s/it] 20%|██        | 10/50 [09:21<36:11, 54.30s/it]Epoch 10: Train acc/f1 = 0.8044 / 0.7368 / 0.7429 / 0.9019 
                Val acc/f1/spec/sens = 0.8500 / 0.7510 / 0.7742 / 0.9420
                Test acc/f1/spec/sens = 0.7787 / 0.7915 / 0.7250 / 0.9048
 22%|██▏       | 11/50 [09:51<30:25, 46.80s/it] 24%|██▍       | 12/50 [10:24<26:56, 42.54s/it] 26%|██▌       | 13/50 [10:53<23:48, 38.61s/it] 28%|██▊       | 14/50 [11:26<22:06, 36.85s/it] 30%|███       | 15/50 [12:27<25:45, 44.15s/it]Epoch 15: Train acc/f1 = 0.8178 / 0.7638 / 0.7304 / 0.9139 
                Val acc/f1/spec/sens = 0.8500 / 0.7563 / 0.7097 / 0.9565
                Test acc/f1/spec/sens = 0.7623 / 0.7786 / 0.6875 / 0.9286
 32%|███▏      | 16/50 [13:00<23:09, 40.87s/it] 34%|███▍      | 17/50 [13:29<20:29, 37.26s/it] 36%|███▌      | 18/50 [14:02<19:06, 35.82s/it] 38%|███▊      | 19/50 [14:32<17:35, 34.03s/it] 40%|████      | 20/50 [15:32<20:58, 41.94s/it]Epoch 20: Train acc/f1 = 0.8256 / 0.7650 / 0.6928 / 0.9415 
                Val acc/f1/spec/sens = 0.8300 / 0.7299 / 0.6129 / 0.9565
                Test acc/f1/spec/sens = 0.6967 / 0.7080 / 0.5875 / 0.9286
 42%|████▏     | 21/50 [16:02<18:31, 38.33s/it] 44%|████▍     | 22/50 [16:34<16:59, 36.43s/it] 46%|████▌     | 23/50 [17:03<15:22, 34.18s/it] 48%|████▊     | 24/50 [17:36<14:42, 33.96s/it] 50%|█████     | 25/50 [18:35<17:12, 41.31s/it]Epoch 25: Train acc/f1 = 0.8178 / 0.7573 / 0.7241 / 0.9208 
                Val acc/f1/spec/sens = 0.8600 / 0.7754 / 0.7097 / 0.9565
                Test acc/f1/spec/sens = 0.7541 / 0.7706 / 0.6750 / 0.9286
 52%|█████▏    | 26/50 [19:08<15:37, 39.05s/it] 54%|█████▍    | 27/50 [19:37<13:45, 35.90s/it] 56%|█████▌    | 28/50 [20:10<12:51, 35.05s/it] 58%|█████▊    | 29/50 [20:40<11:41, 33.41s/it] 60%|██████    | 30/50 [21:41<13:52, 41.64s/it]Epoch 30: Train acc/f1 = 0.8289 / 0.7592 / 0.7649 / 0.9312 
                Val acc/f1/spec/sens = 0.8600 / 0.7746 / 0.6774 / 0.9710
                Test acc/f1/spec/sens = 0.7295 / 0.7457 / 0.6375 / 0.9286
 62%|██████▏   | 31/50 [22:10<12:00, 37.90s/it] 64%|██████▍   | 32/50 [22:42<10:53, 36.32s/it] 66%|██████▌   | 33/50 [23:11<09:38, 34.03s/it] 68%|██████▊   | 34/50 [23:45<09:02, 33.89s/it] 70%|███████   | 35/50 [24:42<10:14, 40.97s/it]Epoch 35: Train acc/f1 = 0.8189 / 0.7542 / 0.6771 / 0.9432 
                Val acc/f1/spec/sens = 0.8300 / 0.7299 / 0.6129 / 0.9565
                Test acc/f1/spec/sens = 0.6639 / 0.6729 / 0.5375 / 0.9286
 72%|███████▏  | 36/50 [25:15<08:57, 38.43s/it] 74%|███████▍  | 37/50 [25:43<07:42, 35.56s/it] 76%|███████▌  | 38/50 [26:18<07:01, 35.16s/it] 78%|███████▊  | 39/50 [26:47<06:06, 33.34s/it] 80%|████████  | 40/50 [27:48<06:58, 41.81s/it]Epoch 40: Train acc/f1 = 0.8233 / 0.7698 / 0.7586 / 0.9088 
                Val acc/f1/spec/sens = 0.8500 / 0.7563 / 0.7097 / 0.9565
                Test acc/f1/spec/sens = 0.7377 / 0.7518 / 0.6500 / 0.9286
 82%|████████▏ | 41/50 [28:18<05:43, 38.19s/it] 84%|████████▍ | 42/50 [28:50<04:49, 36.20s/it] 86%|████████▌ | 43/50 [29:19<03:59, 34.26s/it] 88%|████████▊ | 44/50 [29:52<03:22, 33.68s/it] 90%|█████████ | 45/50 [30:49<03:23, 40.71s/it]Epoch 45: Train acc/f1 = 0.8178 / 0.7542 / 0.6834 / 0.9363 
                Val acc/f1/spec/sens = 0.8400 / 0.7458 / 0.6452 / 0.9565
                Test acc/f1/spec/sens = 0.6803 / 0.6921 / 0.5625 / 0.9286
 92%|█████████▏| 46/50 [31:21<02:33, 38.29s/it] 94%|█████████▍| 47/50 [31:51<01:46, 35.62s/it] 96%|█████████▌| 48/50 [32:24<01:09, 34.98s/it] 98%|█████████▊| 49/50 [32:53<00:33, 33.10s/it]100%|██████████| 50/50 [33:56<00:00, 42.15s/it]                                               Epoch 50: Train acc/f1 = 0.8467 / 0.7982 / 0.7492 / 0.9398 
                Val acc/f1/spec/sens = 0.8500 / 0.7563 / 0.7097 / 0.9565
                Test acc/f1/spec/sens = 0.7459 / 0.7624 / 0.6625 / 0.9286
specificity = 236/319
sensitivity = 537/581
specificity = 22/31
sensitivity = 66/69
specificity = 53/80
sensitivity = 39/42
Trial 5, Cycle 1
Train acc/f1/spec/sens = 0.8344 / 0.7901 / 0.7398 / 0.9243
Val acc/f1/spec/sens = 0.8500 / 0.7563 / 0.7097 / 0.9565
Test acc/f1/spec/sens = 0.7459 / 0.7624 / 0.6625 / 0.9286
>> Finished.
specificity = 53/80
sensitivity = 39/42
Acc, agreement for latest model:  0.7459016393442623 0.7295081967213115
Load best checkpoint for thief model
specificity = 59/80
sensitivity = 38/42
Acc, agreement for best model:  0.7786885245901639 0.7704918032786885
Trial 4/5 || Cycle 1/1 || Label set size 900 || Test acc 0.7787 || Test agreement 0.7705 || Spec 0.7375 || Sens 0.9048
**************************************************************************************************** 

specificity = 59/80
sensitivity = 38/42
Number of samples  900
0.6262295081967213 0.1382891587472993
        acc       agr    spec      sens                label dist
0  0.631148  0.647541  0.4750  0.952381  {0: 111, 1: 200, 2: 589}
1  0.713115  0.745902  0.6125  0.928571  {0: 102, 1: 220, 2: 578}
2  0.344262  0.385246  0.0000  1.000000   {0: 98, 1: 215, 2: 587}
3  0.565574  0.581967  0.3625  0.976190  {0: 114, 1: 210, 2: 576}
4  0.778689  0.770492  0.7375  0.904762  {0: 101, 1: 218, 2: 581}
Results saved to  /home/deepankar/scratch/MSA_Medical/results_1k/gbusg_radformer/GBUSV_radformer/SGD/1000_val100/random_v1_transforms
