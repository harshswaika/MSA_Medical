nohup: ignoring input
[24/03/07 11:54:09] [conf.py:  298]: PyTorch Version: torch=1.11.0, cuda=11.3, cudnn=8200
[24/03/07 11:54:09] [conf.py:  300]: ACTIVE:
  ADDENDUM: 0
  ALPHA: 0.2
  AUGMENT: None
  BETA: 1.0
  BUDGET: 1000
  CUTMIX_PROB: 0.0
  CYCLES: 1
  INITIAL: 900
  LA: False
  METHOD: random
  PRETRAINED_PATH: /home/ankita/scratch/data_msa_medical/ckpts/resnet50-imagenet1k.pth
  TEMP: 1.0
  TRO: 1.0
  USE_PRETRAINED: True
  VAL: 100
AM:
  SGR: 1000
  THRESHOLD: 0.5
CUDNN_BENCHMARK: True
DS_SEED: 123
EDM:
  HASH: /home/harsh_s/scratch/msacopy/exp/hash/alpha.pt
  NUM_MODELS: 5
  PATH1: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T0.pt
  PATH2: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T1.pt
  PATH3: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T2.pt
  PATH4: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T3.pt
  PATH5: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T4.pt
GR:
  EPSILON: 0.1
  SUR_PATH: /home/harsh_s/scratch/msacopy/GRAD2/batch_training/outputs/trained_models/imagenet_cifar10_to_cifar10_surrogate_10epochs.pt
LOG_DEST: resnet18_resnet50_pocus_240307_115409.txt
LOG_TIME: 240307_115409
METHOD_NAME: v4
OUT_DIR: /home/ankita/scratch/data_msa_medical/results_ankita/
PL:
  CLASS_BLNC: 10
  ITERATIONS: 20
  KAPPA_N: 0.005
  KAPPA_P: 0.05
  NO_PROGRESS: False
  NO_UNCERTAINTY: False
  TAU_N: 0.05
  TAU_P: 0.7
  TEMP_NL: 2.0
RNG_SEED: 1
SAVE_DIR: /home/ankita/scratch/data_msa_medical/results_ankita//pocus_resnet18/butterfly_resnet50/SGD/1000_val100/random_v4
THIEF:
  ARCH: resnet50
  DATASET: butterfly
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/Butte
  HARD_LABELS: True
  NUM_TRAIN: 1281167
  SUBSET: 128116
TRAIN:
  BATCH: 16
  EPOCH: 100
  GAMMA: 0.1
  LR: 0.02
  MILESTONES: [20, 40, 60, 80]
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  WDECAY: 0.0005
TRIALS: 5
VICTIM:
  ARCH: resnet18
  DATASET: pocus
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/covid_5_fold
  HEIGHT: 224
  PATH: /home/ankita/scratch/data_msa_medical/victim_models/pocus_resnet18.pth.tar
  PATHIN: /home/harsh_s/scratch/msacopy/ckpts/cifar10-resnet32-inaccurate/checkpoint.pth.tar
  WIDTH: 224
Loaded target dataset of size 476 with 3 classes
target model keys:  122
checkpoint keys:  122

Target model acc = 0.8991596638655462
Val-Acc: 0.8992 Val-Spec: 0.9795 Val-Sens: 0.9224 Class Acc: [0.8343949  0.95402299 0.92241379]
replacing labeled set labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:39,  1.42it/s]  9%|▉         | 5/57 [00:00<00:07,  7.14it/s] 14%|█▍        | 8/57 [00:00<00:04, 10.89it/s] 18%|█▊        | 10/57 [00:01<00:03, 12.20it/s] 23%|██▎       | 13/57 [00:01<00:02, 15.04it/s] 28%|██▊       | 16/57 [00:01<00:02, 17.58it/s] 33%|███▎      | 19/57 [00:01<00:01, 20.40it/s] 39%|███▊      | 22/57 [00:01<00:01, 18.36it/s] 44%|████▍     | 25/57 [00:01<00:01, 16.91it/s] 51%|█████     | 29/57 [00:02<00:01, 18.32it/s] 58%|█████▊    | 33/57 [00:02<00:01, 20.61it/s] 65%|██████▍   | 37/57 [00:02<00:00, 21.48it/s] 72%|███████▏  | 41/57 [00:02<00:00, 23.16it/s] 79%|███████▉  | 45/57 [00:02<00:00, 23.13it/s] 84%|████████▍ | 48/57 [00:02<00:00, 22.10it/s] 89%|████████▉ | 51/57 [00:02<00:00, 22.31it/s] 96%|█████████▋| 55/57 [00:03<00:00, 23.40it/s]100%|██████████| 57/57 [00:03<00:00, 16.48it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.81it/s] 57%|█████▋    | 4/7 [00:00<00:00,  6.91it/s]100%|██████████| 7/7 [00:00<00:00,  7.74it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2243, -1.2400, -1.2166]), tensor([0.8476, 0.8431, 0.8505]))
Val set stats: mean/std =  (tensor([-1.1715, -1.1901, -1.1622]), tensor([0.8641, 0.8598, 0.8667]))
Validation set distribution: 
Number of samples  100
{0: 18, 1: 50, 2: 32}
Labeled set distribution: 
Number of samples  900
{0: 149, 1: 391, 2: 360}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.1975, agreement = 0.1933, f1 = 0.1590, spec = 0.6066, sens = 0.1595 Class Acc: [0.00636943 0.64367816 0.15948276]
Initial model on validation dataset: acc = 0.5300, agreement = 0.5300, f1 = 0.3449, spec = 0.9118, sens = 0.2812 Class Acc: [0.      0.88    0.28125]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:51,  3.55s/it]  2%|▏         | 2/100 [00:08<07:03,  4.33s/it]  3%|▎         | 3/100 [00:11<06:22,  3.95s/it]  4%|▍         | 4/100 [00:16<06:54,  4.32s/it]  5%|▌         | 5/100 [00:24<09:03,  5.72s/it]Epoch 5: Train acc/f1 = 0.9111 / 0.8856 / 0.9722 / 0.9389/ [0.8590604  0.90537084 0.93888889] 
                Val acc/f1/spec/sens = 0.8500 / 0.7859 / 0.8971 / 0.8750/ [0.5   0.96  0.875]
                Test acc/f1/spec/sens = 0.2563 / 0.2103 / 0.9221 / 0.1207/ [0.04458599 1.         0.12068966]
  6%|▌         | 6/100 [00:29<08:32,  5.45s/it]  7%|▋         | 7/100 [00:33<07:30,  4.84s/it]  8%|▊         | 8/100 [00:38<07:41,  5.01s/it]  9%|▉         | 9/100 [00:42<06:58,  4.60s/it] 10%|█         | 10/100 [00:52<09:09,  6.10s/it]Epoch 10: Train acc/f1 = 0.9522 / 0.9363 / 0.9852 / 0.9639/ [0.8590604  0.9769821  0.96388889] 
                Val acc/f1/spec/sens = 0.8500 / 0.7954 / 0.9412 / 0.8438/ [0.55555556 0.96       0.84375   ]
                Test acc/f1/spec/sens = 0.6134 / 0.5927 / 0.7951 / 0.6853/ [0.32484076 0.94252874 0.68534483]
 11%|█         | 11/100 [00:55<07:52,  5.30s/it] 12%|█▏        | 12/100 [01:00<07:29,  5.11s/it] 13%|█▎        | 13/100 [01:03<06:43,  4.64s/it] 14%|█▍        | 14/100 [01:08<06:40,  4.66s/it] 15%|█▌        | 15/100 [01:16<08:06,  5.72s/it]Epoch 15: Train acc/f1 = 0.9533 / 0.9406 / 0.9889 / 0.9556/ [0.85234899 0.98976982 0.95555556] 
                Val acc/f1/spec/sens = 0.8700 / 0.8228 / 0.9118 / 0.8125/ [0.66666667 0.98       0.8125    ]
                Test acc/f1/spec/sens = 0.1870 / 0.1237 / 0.8320 / 0.0043/ [0.01273885 0.98850575 0.00431034]
 16%|█▌        | 16/100 [01:21<07:41,  5.50s/it] 17%|█▋        | 17/100 [01:25<06:54,  4.99s/it] 18%|█▊        | 18/100 [01:30<06:38,  4.86s/it] 19%|█▉        | 19/100 [01:33<06:06,  4.53s/it] 20%|██        | 20/100 [01:42<07:51,  5.90s/it]Epoch 20: Train acc/f1 = 0.9756 / 0.9664 / 0.9759 / 0.9972/ [0.90604027 0.98209719 0.99722222] 
                Val acc/f1/spec/sens = 0.9200 / 0.8922 / 0.9559 / 0.9062/ [0.77777778 0.98       0.90625   ]
                Test acc/f1/spec/sens = 0.3487 / 0.3071 / 0.8648 / 0.2974/ [0.06369427 1.         0.29741379]
 21%|██        | 21/100 [01:46<06:51,  5.20s/it] 22%|██▏       | 22/100 [01:50<06:30,  5.00s/it] 23%|██▎       | 23/100 [01:54<05:52,  4.58s/it] 24%|██▍       | 24/100 [01:59<05:48,  4.59s/it] 25%|██▌       | 25/100 [02:07<07:03,  5.64s/it]Epoch 25: Train acc/f1 = 0.9989 / 0.9985 / 1.0000 / 1.0000/ [1.         0.99744246 1.        ] 
                Val acc/f1/spec/sens = 0.9200 / 0.8995 / 0.9853 / 0.8750/ [0.88888889 0.96       0.875     ]
                Test acc/f1/spec/sens = 0.5063 / 0.4396 / 0.8238 / 0.6207/ [0.06369427 1.         0.62068966]
 26%|██▌       | 26/100 [02:12<06:37,  5.37s/it] 27%|██▋       | 27/100 [02:15<05:53,  4.84s/it] 28%|██▊       | 28/100 [02:20<05:44,  4.78s/it] 29%|██▉       | 29/100 [02:23<05:13,  4.42s/it] 30%|███       | 30/100 [02:33<06:50,  5.86s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8867 / 0.9853 / 0.8438/ [0.88888889 0.96       0.84375   ]
                Test acc/f1/spec/sens = 0.5231 / 0.4665 / 0.8115 / 0.6379/ [0.10191083 0.97701149 0.63793103]
 31%|███       | 31/100 [02:36<05:57,  5.18s/it] 32%|███▏      | 32/100 [02:41<05:40,  5.01s/it] 33%|███▎      | 33/100 [02:44<05:04,  4.54s/it] 34%|███▍      | 34/100 [02:49<05:03,  4.60s/it] 35%|███▌      | 35/100 [02:57<06:13,  5.74s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8739 / 0.9853 / 0.8125/ [0.88888889 0.96       0.8125    ]
                Test acc/f1/spec/sens = 0.5231 / 0.4642 / 0.8197 / 0.6422/ [0.08917197 0.98850575 0.64224138]
 36%|███▌      | 36/100 [03:02<05:50,  5.48s/it] 37%|███▋      | 37/100 [03:06<05:09,  4.92s/it] 38%|███▊      | 38/100 [03:10<04:59,  4.84s/it] 39%|███▉      | 39/100 [03:14<04:33,  4.48s/it] 40%|████      | 40/100 [03:23<05:54,  5.90s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8842 / 0.9706 / 0.8750/ [0.83333333 0.96       0.875     ]
                Test acc/f1/spec/sens = 0.5525 / 0.5012 / 0.7951 / 0.6724/ [0.14012739 0.97701149 0.67241379]
 41%|████      | 41/100 [03:27<05:06,  5.20s/it] 42%|████▏     | 42/100 [03:32<04:59,  5.16s/it] 43%|████▎     | 43/100 [03:36<04:30,  4.74s/it] 44%|████▍     | 44/100 [03:41<04:26,  4.76s/it] 45%|████▌     | 45/100 [03:49<05:16,  5.75s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8995 / 0.9853 / 0.8750/ [0.88888889 0.96       0.875     ]
                Test acc/f1/spec/sens = 0.5147 / 0.4512 / 0.8238 / 0.6379/ [0.07006369 0.98850575 0.63793103]
 46%|████▌     | 46/100 [03:54<04:59,  5.55s/it] 47%|████▋     | 47/100 [03:58<04:32,  5.14s/it] 48%|████▊     | 48/100 [04:03<04:29,  5.19s/it] 49%|████▉     | 49/100 [04:07<04:05,  4.81s/it] 50%|█████     | 50/100 [04:17<05:09,  6.19s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9101 / 0.9853 / 0.8750/ [0.88888889 0.98       0.875     ]
                Test acc/f1/spec/sens = 0.5126 / 0.4514 / 0.8238 / 0.6336/ [0.07006369 0.98850575 0.63362069]
 51%|█████     | 51/100 [04:20<04:28,  5.48s/it] 52%|█████▏    | 52/100 [04:25<04:11,  5.25s/it] 53%|█████▎    | 53/100 [04:29<03:46,  4.82s/it] 54%|█████▍    | 54/100 [04:34<03:44,  4.87s/it] 55%|█████▌    | 55/100 [04:42<04:24,  5.87s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8922 / 0.9559 / 0.9062/ [0.77777778 0.98       0.90625   ]
                Test acc/f1/spec/sens = 0.5357 / 0.4738 / 0.8074 / 0.6681/ [0.08917197 0.98850575 0.66810345]
 56%|█████▌    | 56/100 [04:47<04:03,  5.53s/it] 57%|█████▋    | 57/100 [04:51<03:34,  4.99s/it] 58%|█████▊    | 58/100 [04:55<03:26,  4.92s/it] 59%|█████▉    | 59/100 [04:59<03:07,  4.58s/it] 60%|██████    | 60/100 [05:08<03:55,  5.88s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8995 / 0.9853 / 0.8750/ [0.88888889 0.96       0.875     ]
                Test acc/f1/spec/sens = 0.5189 / 0.4586 / 0.8238 / 0.6422/ [0.07643312 0.98850575 0.64224138]
 61%|██████    | 61/100 [05:12<03:23,  5.21s/it] 62%|██████▏   | 62/100 [05:17<03:14,  5.11s/it] 63%|██████▎   | 63/100 [05:20<02:56,  4.76s/it] 64%|██████▍   | 64/100 [05:25<02:52,  4.80s/it] 65%|██████▌   | 65/100 [05:34<03:24,  5.85s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8842 / 0.9706 / 0.8750/ [0.83333333 0.96       0.875     ]
                Test acc/f1/spec/sens = 0.5294 / 0.4726 / 0.8033 / 0.6466/ [0.10191083 0.98850575 0.64655172]
 66%|██████▌   | 66/100 [05:38<03:07,  5.51s/it] 67%|██████▋   | 67/100 [05:42<02:43,  4.95s/it] 68%|██████▊   | 68/100 [05:47<02:36,  4.90s/it] 69%|██████▉   | 69/100 [05:51<02:21,  4.55s/it] 70%|███████   | 70/100 [06:00<02:56,  5.90s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8995 / 0.9853 / 0.8750/ [0.88888889 0.96       0.875     ]
                Test acc/f1/spec/sens = 0.5189 / 0.4604 / 0.8197 / 0.6379/ [0.08280255 0.98850575 0.63793103]
 71%|███████   | 71/100 [06:03<02:33,  5.29s/it] 72%|███████▏  | 72/100 [06:08<02:22,  5.10s/it] 73%|███████▎  | 73/100 [06:12<02:06,  4.70s/it] 74%|███████▍  | 74/100 [06:17<02:03,  4.74s/it] 75%|███████▌  | 75/100 [06:25<02:21,  5.68s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8948 / 0.9706 / 0.8750/ [0.83333333 0.98       0.875     ]
                Test acc/f1/spec/sens = 0.5336 / 0.4868 / 0.7992 / 0.6379/ [0.13375796 0.97701149 0.63793103]
 76%|███████▌  | 76/100 [06:29<02:10,  5.42s/it] 77%|███████▋  | 77/100 [06:33<01:52,  4.91s/it] 78%|███████▊  | 78/100 [06:38<01:46,  4.85s/it] 79%|███████▉  | 79/100 [06:42<01:35,  4.56s/it] 80%|████████  | 80/100 [06:51<02:01,  6.08s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8685 / 0.9559 / 0.8750/ [0.77777778 0.96       0.875     ]
                Test acc/f1/spec/sens = 0.5420 / 0.4784 / 0.8033 / 0.6810/ [0.08917197 0.98850575 0.68103448]
 81%|████████  | 81/100 [06:55<01:43,  5.44s/it] 82%|████████▏ | 82/100 [07:00<01:36,  5.34s/it] 83%|████████▎ | 83/100 [07:04<01:24,  4.94s/it] 84%|████████▍ | 84/100 [07:09<01:19,  4.94s/it] 85%|████████▌ | 85/100 [07:18<01:30,  6.01s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8842 / 0.9706 / 0.8750/ [0.83333333 0.96       0.875     ]
                Test acc/f1/spec/sens = 0.5168 / 0.4529 / 0.8238 / 0.6422/ [0.07006369 0.98850575 0.64224138]
 86%|████████▌ | 86/100 [07:23<01:18,  5.62s/it] 87%|████████▋ | 87/100 [07:26<01:05,  5.04s/it] 88%|████████▊ | 88/100 [07:31<01:00,  5.02s/it] 89%|████████▉ | 89/100 [07:35<00:51,  4.66s/it] 90%|█████████ | 90/100 [07:45<01:01,  6.20s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8922 / 0.9559 / 0.9062/ [0.77777778 0.98       0.90625   ]
                Test acc/f1/spec/sens = 0.5378 / 0.4685 / 0.8033 / 0.6853/ [0.07006369 0.98850575 0.68534483]
 91%|█████████ | 91/100 [07:49<00:49,  5.54s/it] 92%|█████████▏| 92/100 [07:54<00:43,  5.40s/it] 93%|█████████▎| 93/100 [07:58<00:34,  4.88s/it] 94%|█████████▍| 94/100 [08:03<00:29,  4.94s/it] 95%|█████████▌| 95/100 [08:11<00:29,  5.93s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8842 / 0.9706 / 0.8750/ [0.83333333 0.96       0.875     ]
                Test acc/f1/spec/sens = 0.5168 / 0.4524 / 0.8238 / 0.6422/ [0.07006369 0.98850575 0.64224138]
 96%|█████████▌| 96/100 [08:16<00:22,  5.65s/it] 97%|█████████▋| 97/100 [08:20<00:15,  5.15s/it] 98%|█████████▊| 98/100 [08:25<00:10,  5.08s/it] 99%|█████████▉| 99/100 [08:29<00:04,  4.76s/it]100%|██████████| 100/100 [08:38<00:00,  6.13s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8948 / 0.9706 / 0.8750/ [0.83333333 0.98       0.875     ]
                Test acc/f1/spec/sens = 0.5399 / 0.4873 / 0.7992 / 0.6595/ [0.12101911 0.97701149 0.65948276]
Trial 1, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9200 / 0.8948 / 0.9706 / 0.8750/ [0.83333333 0.98       0.875     ]
Test acc/f1/spec/sens = 0.5399 / 0.4873 / 0.7992 / 0.6595/ [0.12101911 0.97701149 0.65948276]
>> Finished.
Acc, agreement for latest model:  0.5399159663865546 0.592436974789916 [0.12101911 0.97701149 0.65948276]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4852941176470588 0.5378151260504201 [0.24203822 0.97701149 0.46551724]
Trial 0/1 || Cycle 1/1 || Label set size 900 || Test acc 0.4853 || Test agreement 0.5378 || Spec 0.8156 || Sens 0.4655 Class Acc: [0.24203822 0.97701149 0.46551724]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:38,  1.44it/s]  7%|▋         | 4/57 [00:00<00:08,  6.04it/s] 12%|█▏        | 7/57 [00:01<00:05,  8.92it/s] 18%|█▊        | 10/57 [00:01<00:03, 12.73it/s] 23%|██▎       | 13/57 [00:01<00:03, 14.22it/s] 28%|██▊       | 16/57 [00:01<00:02, 16.85it/s] 33%|███▎      | 19/57 [00:01<00:02, 17.64it/s] 39%|███▊      | 22/57 [00:01<00:01, 18.37it/s] 44%|████▍     | 25/57 [00:01<00:01, 18.57it/s] 49%|████▉     | 28/57 [00:02<00:01, 17.61it/s] 54%|█████▍    | 31/57 [00:02<00:01, 16.38it/s] 61%|██████▏   | 35/57 [00:02<00:01, 17.89it/s] 68%|██████▊   | 39/57 [00:02<00:00, 19.08it/s] 72%|███████▏  | 41/57 [00:02<00:00, 19.25it/s] 75%|███████▌  | 43/57 [00:02<00:00, 17.98it/s] 82%|████████▏ | 47/57 [00:03<00:00, 18.43it/s] 89%|████████▉ | 51/57 [00:03<00:00, 19.21it/s] 96%|█████████▋| 55/57 [00:03<00:00, 20.18it/s]100%|██████████| 57/57 [00:03<00:00, 15.73it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.77it/s] 57%|█████▋    | 4/7 [00:00<00:00,  6.89it/s]100%|██████████| 7/7 [00:00<00:00,  7.79it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2076, -1.2227, -1.2003]), tensor([0.8539, 0.8498, 0.8565]))
Val set stats: mean/std =  (tensor([-1.2437, -1.2589, -1.2352]), tensor([0.8555, 0.8507, 0.8582]))
Validation set distribution: 
Number of samples  100
{0: 16, 1: 45, 2: 39}
Labeled set distribution: 
Number of samples  900
{0: 159, 1: 368, 2: 373}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.2815, agreement = 0.2689, f1 = 0.2712, spec = 0.7500, sens = 0.0560 Class Acc: [0.55414013 0.3908046  0.05603448]
Initial model on validation dataset: acc = 0.2700, agreement = 0.2700, f1 = 0.2656, spec = 0.9344, sens = 0.2051 Class Acc: [0.875      0.11111111 0.20512821]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:52,  3.56s/it]  2%|▏         | 2/100 [00:08<07:14,  4.43s/it]  3%|▎         | 3/100 [00:12<06:37,  4.10s/it]  4%|▍         | 4/100 [00:17<07:03,  4.41s/it]  5%|▌         | 5/100 [00:25<09:05,  5.74s/it]Epoch 5: Train acc/f1 = 0.8967 / 0.8608 / 0.9184 / 0.9517/ [0.66666667 0.94021739 0.95174263] 
                Val acc/f1/spec/sens = 0.8400 / 0.7334 / 0.8689 / 0.9744/ [0.3125     0.91111111 0.97435897]
                Test acc/f1/spec/sens = 0.5840 / 0.4868 / 0.8770 / 0.8621/ [0.12101911 0.67816092 0.86206897]
  6%|▌         | 6/100 [00:29<08:23,  5.36s/it]  7%|▋         | 7/100 [00:33<07:30,  4.85s/it]  8%|▊         | 8/100 [00:38<07:32,  4.92s/it]  9%|▉         | 9/100 [00:42<06:55,  4.56s/it] 10%|█         | 10/100 [00:52<09:07,  6.09s/it]Epoch 10: Train acc/f1 = 0.9522 / 0.9420 / 0.9981 / 0.9196/ [0.99371069 0.9673913  0.91957105] 
                Val acc/f1/spec/sens = 0.8700 / 0.8275 / 0.9344 / 0.8462/ [0.75       0.93333333 0.84615385]
                Test acc/f1/spec/sens = 0.4265 / 0.3720 / 0.8648 / 0.5819/ [0.07643312 0.64367816 0.58189655]
 11%|█         | 11/100 [00:55<08:01,  5.41s/it] 12%|█▏        | 12/100 [01:00<07:44,  5.28s/it] 13%|█▎        | 13/100 [01:04<06:58,  4.81s/it] 14%|█▍        | 14/100 [01:09<06:50,  4.77s/it] 15%|█▌        | 15/100 [01:17<08:13,  5.80s/it]Epoch 15: Train acc/f1 = 0.9878 / 0.9844 / 1.0000 / 0.9732/ [1.         0.99728261 0.97319035] 
                Val acc/f1/spec/sens = 0.9100 / 0.8780 / 0.9508 / 0.9744/ [0.8125     0.88888889 0.97435897]
                Test acc/f1/spec/sens = 0.4916 / 0.4427 / 0.9426 / 0.6293/ [0.10828025 0.81609195 0.62931034]
 16%|█▌        | 16/100 [01:22<07:34,  5.41s/it] 17%|█▋        | 17/100 [01:25<06:41,  4.84s/it] 18%|█▊        | 18/100 [01:30<06:27,  4.73s/it] 19%|█▉        | 19/100 [01:33<05:53,  4.36s/it] 20%|██        | 20/100 [01:43<08:02,  6.03s/it]Epoch 20: Train acc/f1 = 0.9822 / 0.9762 / 0.9734 / 1.0000/ [0.91823899 0.99184783 1.        ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8217 / 0.8689 / 1.0000/ [0.5        0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.5735 / 0.4589 / 0.8770 / 0.8405/ [0.05095541 0.8045977  0.84051724]
 21%|██        | 21/100 [01:47<07:06,  5.39s/it] 22%|██▏       | 22/100 [01:52<07:06,  5.47s/it] 23%|██▎       | 23/100 [01:57<06:29,  5.05s/it] 24%|██▍       | 24/100 [02:02<06:28,  5.12s/it] 25%|██▌       | 25/100 [02:11<07:47,  6.24s/it]Epoch 25: Train acc/f1 = 0.9978 / 0.9976 / 0.9981 / 1.0000/ [1.         0.99456522 1.        ] 
                Val acc/f1/spec/sens = 0.9500 / 0.9297 / 0.9672 / 1.0000/ [0.875      0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.5168 / 0.4474 / 0.9508 / 0.6810/ [0.07643312 0.87356322 0.68103448]
 26%|██▌       | 26/100 [02:16<07:18,  5.93s/it] 27%|██▋       | 27/100 [02:20<06:30,  5.35s/it] 28%|██▊       | 28/100 [02:25<06:24,  5.34s/it] 29%|██▉       | 29/100 [02:29<05:54,  4.99s/it] 30%|███       | 30/100 [02:39<07:33,  6.47s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4916 / 0.4314 / 0.9221 / 0.6336/ [0.08280255 0.85057471 0.63362069]
 31%|███       | 31/100 [02:43<06:36,  5.75s/it] 32%|███▏      | 32/100 [02:48<06:16,  5.54s/it] 33%|███▎      | 33/100 [02:53<05:42,  5.11s/it] 34%|███▍      | 34/100 [02:58<05:40,  5.16s/it] 35%|███▌      | 35/100 [03:07<06:50,  6.32s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4748 / 0.4201 / 0.9221 / 0.6034/ [0.08280255 0.83908046 0.60344828]
 36%|███▌      | 36/100 [03:12<06:24,  6.01s/it] 37%|███▋      | 37/100 [03:16<05:43,  5.45s/it] 38%|███▊      | 38/100 [03:22<05:35,  5.41s/it] 39%|███▉      | 39/100 [03:25<05:02,  4.96s/it] 40%|████      | 40/100 [03:36<06:29,  6.50s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4811 / 0.4258 / 0.9385 / 0.6078/ [0.08280255 0.86206897 0.60775862]
 41%|████      | 41/100 [03:40<05:38,  5.73s/it] 42%|████▏     | 42/100 [03:45<05:23,  5.58s/it] 43%|████▎     | 43/100 [03:49<04:52,  5.13s/it] 44%|████▍     | 44/100 [03:54<04:52,  5.22s/it] 45%|████▌     | 45/100 [04:03<05:45,  6.29s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4832 / 0.4219 / 0.8566 / 0.6466/ [0.0955414  0.74712644 0.64655172]
 46%|████▌     | 46/100 [04:08<05:22,  5.98s/it] 47%|████▋     | 47/100 [04:12<04:44,  5.37s/it] 48%|████▊     | 48/100 [04:18<04:39,  5.38s/it] 49%|████▉     | 49/100 [04:22<04:14,  4.99s/it] 50%|█████     | 50/100 [04:32<05:28,  6.57s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.5000 / 0.4354 / 0.8975 / 0.6595/ [0.0955414  0.8045977  0.65948276]
 51%|█████     | 51/100 [04:36<04:46,  5.84s/it] 52%|█████▏    | 52/100 [04:42<04:34,  5.72s/it] 53%|█████▎    | 53/100 [04:46<04:04,  5.21s/it] 54%|█████▍    | 54/100 [04:51<04:00,  5.23s/it] 55%|█████▌    | 55/100 [05:00<04:44,  6.33s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4412 / 0.4086 / 0.9467 / 0.5129/ [0.11464968 0.83908046 0.51293103]
 56%|█████▌    | 56/100 [05:05<04:25,  6.04s/it] 57%|█████▋    | 57/100 [05:09<03:52,  5.40s/it] 58%|█████▊    | 58/100 [05:14<03:44,  5.36s/it] 59%|█████▉    | 59/100 [05:18<03:23,  4.97s/it] 60%|██████    | 60/100 [05:28<04:18,  6.47s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4916 / 0.4311 / 0.9139 / 0.6379/ [0.08917197 0.82758621 0.63793103]
 61%|██████    | 61/100 [05:32<03:43,  5.73s/it] 62%|██████▏   | 62/100 [05:38<03:34,  5.64s/it] 63%|██████▎   | 63/100 [05:41<03:06,  5.04s/it] 64%|██████▍   | 64/100 [05:47<03:03,  5.09s/it] 65%|██████▌   | 65/100 [05:56<03:40,  6.31s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4685 / 0.4203 / 0.9467 / 0.5819/ [0.08917197 0.85057471 0.58189655]
 66%|██████▌   | 66/100 [06:01<03:24,  6.01s/it] 67%|██████▋   | 67/100 [06:05<02:59,  5.43s/it] 68%|██████▊   | 68/100 [06:10<02:52,  5.38s/it] 69%|██████▉   | 69/100 [06:15<02:35,  5.01s/it] 70%|███████   | 70/100 [06:24<03:14,  6.48s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4769 / 0.4243 / 0.9180 / 0.6034/ [0.0955414  0.82758621 0.60344828]
 71%|███████   | 71/100 [06:28<02:46,  5.75s/it] 72%|███████▏  | 72/100 [06:34<02:36,  5.60s/it] 73%|███████▎  | 73/100 [06:38<02:17,  5.09s/it] 74%|███████▍  | 74/100 [06:43<02:11,  5.06s/it] 75%|███████▌  | 75/100 [06:51<02:33,  6.14s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.5105 / 0.4374 / 0.9180 / 0.6810/ [0.07006369 0.85057471 0.68103448]
 76%|███████▌  | 76/100 [06:56<02:17,  5.75s/it] 77%|███████▋  | 77/100 [07:00<01:59,  5.19s/it] 78%|███████▊  | 78/100 [07:05<01:52,  5.09s/it] 79%|███████▉  | 79/100 [07:09<01:38,  4.71s/it] 80%|████████  | 80/100 [07:18<01:59,  5.96s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4853 / 0.4235 / 0.9139 / 0.6293/ [0.07643312 0.83908046 0.62931034]
 81%|████████  | 81/100 [07:21<01:40,  5.29s/it] 82%|████████▏ | 82/100 [07:26<01:32,  5.12s/it] 83%|████████▎ | 83/100 [07:30<01:19,  4.68s/it] 84%|████████▍ | 84/100 [07:35<01:16,  4.77s/it] 85%|████████▌ | 85/100 [07:43<01:26,  5.76s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4790 / 0.4336 / 0.9303 / 0.5991/ [0.12101911 0.8045977  0.59913793]
 86%|████████▌ | 86/100 [07:48<01:16,  5.49s/it] 87%|████████▋ | 87/100 [07:51<01:04,  4.96s/it] 88%|████████▊ | 88/100 [07:56<00:59,  4.93s/it] 89%|████████▉ | 89/100 [08:00<00:50,  4.57s/it] 90%|█████████ | 90/100 [08:09<00:58,  5.87s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4769 / 0.4195 / 0.9262 / 0.6078/ [0.07643312 0.85057471 0.60775862]
 91%|█████████ | 91/100 [08:12<00:46,  5.18s/it] 92%|█████████▏| 92/100 [08:17<00:40,  5.03s/it] 93%|█████████▎| 93/100 [08:21<00:32,  4.63s/it] 94%|█████████▍| 94/100 [08:26<00:28,  4.68s/it] 95%|█████████▌| 95/100 [08:33<00:28,  5.64s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.4874 / 0.4250 / 0.9262 / 0.6293/ [0.07643312 0.85057471 0.62931034]
 96%|█████████▌| 96/100 [08:38<00:21,  5.36s/it] 97%|█████████▋| 97/100 [08:42<00:14,  4.85s/it] 98%|█████████▊| 98/100 [08:46<00:09,  4.80s/it] 99%|█████████▉| 99/100 [08:50<00:04,  4.46s/it]100%|██████████| 100/100 [08:59<00:00,  5.87s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
                Test acc/f1/spec/sens = 0.5021 / 0.4342 / 0.9057 / 0.6724/ [0.08280255 0.8045977  0.67241379]
Trial 2, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9400 / 0.9137 / 0.9508 / 1.0000/ [0.8125     0.93333333 1.        ]
Test acc/f1/spec/sens = 0.5021 / 0.4342 / 0.9057 / 0.6724/ [0.08280255 0.8045977  0.67241379]
>> Finished.
Acc, agreement for latest model:  0.5021008403361344 0.5462184873949579 [0.08280255 0.8045977  0.67241379]
Load best checkpoint for thief model
Acc, agreement for best model:  0.5315126050420168 0.569327731092437 [0.07643312 0.87356322 0.7112069 ]
Trial 1/1 || Cycle 1/1 || Label set size 900 || Test acc 0.5315 || Test agreement 0.5693 || Spec 0.9344 || Sens 0.7112 Class Acc: [0.07643312 0.87356322 0.7112069 ]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:33,  1.69it/s]  9%|▉         | 5/57 [00:00<00:06,  8.25it/s] 16%|█▌        | 9/57 [00:00<00:03, 12.70it/s] 23%|██▎       | 13/57 [00:01<00:02, 16.45it/s] 30%|██▉       | 17/57 [00:01<00:02, 19.65it/s] 35%|███▌      | 20/57 [00:01<00:01, 20.89it/s] 42%|████▏     | 24/57 [00:01<00:01, 19.74it/s] 49%|████▉     | 28/57 [00:01<00:01, 21.74it/s] 56%|█████▌    | 32/57 [00:01<00:01, 23.39it/s] 61%|██████▏   | 35/57 [00:01<00:00, 22.55it/s] 67%|██████▋   | 38/57 [00:02<00:00, 19.16it/s] 74%|███████▎  | 42/57 [00:02<00:00, 20.65it/s] 81%|████████  | 46/57 [00:02<00:00, 19.72it/s] 88%|████████▊ | 50/57 [00:02<00:00, 19.59it/s] 95%|█████████▍| 54/57 [00:02<00:00, 20.22it/s]100%|██████████| 57/57 [00:03<00:00, 17.86it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.79it/s] 57%|█████▋    | 4/7 [00:00<00:00,  6.46it/s]100%|██████████| 7/7 [00:00<00:00,  7.18it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2155, -1.2318, -1.2075]), tensor([0.8523, 0.8476, 0.8552]))
Val set stats: mean/std =  (tensor([-1.2028, -1.2164, -1.1960]), tensor([0.8576, 0.8534, 0.8604]))
Validation set distribution: 
Number of samples  100
{0: 17, 1: 37, 2: 46}
Labeled set distribution: 
Number of samples  900
{0: 148, 1: 398, 2: 354}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.4853, agreement = 0.4811, f1 = 0.4445, spec = 0.6516, sens = 0.6034 Class Acc: [0.18471338 0.71264368 0.60344828]
Initial model on validation dataset: acc = 0.3100, agreement = 0.3100, f1 = 0.1986, spec = 0.7778, sens = 0.1087 Class Acc: [0.         0.7027027  0.10869565]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:53,  3.57s/it]  2%|▏         | 2/100 [00:08<07:03,  4.32s/it]  3%|▎         | 3/100 [00:11<06:24,  3.96s/it]  4%|▍         | 4/100 [00:16<06:56,  4.34s/it]  5%|▌         | 5/100 [00:24<08:56,  5.65s/it]Epoch 5: Train acc/f1 = 0.9356 / 0.9087 / 0.9615 / 0.9661/ [0.72297297 0.98743719 0.96610169] 
                Val acc/f1/spec/sens = 0.9000 / 0.8783 / 0.9630 / 0.8913/ [0.88235294 0.91891892 0.89130435]
                Test acc/f1/spec/sens = 0.5777 / 0.4852 / 0.7582 / 0.7716/ [0.05732484 1.         0.77155172]
  6%|▌         | 6/100 [00:29<08:32,  5.45s/it]  7%|▋         | 7/100 [00:33<07:32,  4.87s/it]  8%|▊         | 8/100 [00:38<07:29,  4.88s/it]  9%|▉         | 9/100 [00:42<06:50,  4.51s/it] 10%|█         | 10/100 [00:50<08:43,  5.82s/it]Epoch 10: Train acc/f1 = 0.9344 / 0.9144 / 0.9725 / 0.9294/ [0.87837838 0.95979899 0.92937853] 
                Val acc/f1/spec/sens = 0.9000 / 0.8796 / 0.9630 / 0.8478/ [0.88235294 0.97297297 0.84782609]
                Test acc/f1/spec/sens = 0.3214 / 0.3185 / 0.8525 / 0.2198/ [0.10191083 0.98850575 0.21982759]
 11%|█         | 11/100 [00:54<07:37,  5.14s/it] 12%|█▏        | 12/100 [00:59<07:23,  5.04s/it] 13%|█▎        | 13/100 [01:03<06:47,  4.68s/it] 14%|█▍        | 14/100 [01:08<06:53,  4.81s/it] 15%|█▌        | 15/100 [01:16<08:06,  5.72s/it]Epoch 15: Train acc/f1 = 0.9511 / 0.9328 / 0.9560 / 0.9944/ [0.85810811 0.94723618 0.99435028] 
                Val acc/f1/spec/sens = 0.9200 / 0.8976 / 0.9815 / 0.8913/ [0.82352941 1.         0.89130435]
                Test acc/f1/spec/sens = 0.4916 / 0.4271 / 0.8443 / 0.6767/ [0.06369427 0.77011494 0.67672414]
 16%|█▌        | 16/100 [01:21<07:43,  5.52s/it] 17%|█▋        | 17/100 [01:24<06:51,  4.95s/it] 18%|█▊        | 18/100 [01:29<06:43,  4.92s/it] 19%|█▉        | 19/100 [01:33<06:10,  4.57s/it] 20%|██        | 20/100 [01:42<07:49,  5.87s/it]Epoch 20: Train acc/f1 = 0.9922 / 0.9890 / 1.0000 / 0.9915/ [0.97297297 1.         0.99152542] 
                Val acc/f1/spec/sens = 0.8900 / 0.8604 / 0.9444 / 0.8696/ [0.76470588 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2542 / 0.2416 / 0.9385 / 0.0905/ [0.08280255 1.         0.09051724]
 21%|██        | 21/100 [01:46<06:54,  5.25s/it] 22%|██▏       | 22/100 [01:50<06:39,  5.12s/it] 23%|██▎       | 23/100 [01:54<06:01,  4.69s/it] 24%|██▍       | 24/100 [01:59<05:56,  4.69s/it] 25%|██▌       | 25/100 [02:07<07:06,  5.69s/it]Epoch 25: Train acc/f1 = 0.9989 / 0.9985 / 1.0000 / 1.0000/ [0.99324324 1.         1.        ] 
                Val acc/f1/spec/sens = 0.9100 / 0.8905 / 0.9630 / 0.8696/ [0.88235294 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2458 / 0.2314 / 0.9467 / 0.0905/ [0.05732484 1.         0.09051724]
 26%|██▌       | 26/100 [02:12<06:39,  5.39s/it] 27%|██▋       | 27/100 [02:15<05:52,  4.83s/it] 28%|██▊       | 28/100 [02:20<05:43,  4.77s/it] 29%|██▉       | 29/100 [02:23<05:14,  4.43s/it] 30%|███       | 30/100 [02:32<06:42,  5.75s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8905 / 0.9630 / 0.8696/ [0.88235294 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2626 / 0.2518 / 0.9303 / 0.1164/ [0.07006369 1.         0.11637931]
 31%|███       | 31/100 [02:36<05:52,  5.11s/it] 32%|███▏      | 32/100 [02:41<05:42,  5.03s/it] 33%|███▎      | 33/100 [02:44<05:07,  4.59s/it] 34%|███▍      | 34/100 [02:49<05:11,  4.73s/it] 35%|███▌      | 35/100 [02:58<06:17,  5.81s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9043 / 0.9815 / 0.8696/ [0.94117647 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2647 / 0.2517 / 0.9344 / 0.1250/ [0.06369427 1.         0.125     ]
 36%|███▌      | 36/100 [03:02<05:49,  5.46s/it] 37%|███▋      | 37/100 [03:06<05:09,  4.91s/it] 38%|███▊      | 38/100 [03:10<04:59,  4.83s/it] 39%|███▉      | 39/100 [03:14<04:31,  4.46s/it] 40%|████      | 40/100 [03:23<05:52,  5.87s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8905 / 0.9630 / 0.8696/ [0.88235294 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2626 / 0.2501 / 0.9344 / 0.1164/ [0.07006369 1.         0.11637931]
 41%|████      | 41/100 [03:27<05:09,  5.25s/it] 42%|████▏     | 42/100 [03:32<04:55,  5.10s/it] 43%|████▎     | 43/100 [03:36<04:28,  4.70s/it] 44%|████▍     | 44/100 [03:40<04:24,  4.72s/it] 45%|████▌     | 45/100 [03:48<05:11,  5.66s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8933 / 0.9815 / 0.8478/ [0.94117647 0.97297297 0.84782609]
                Test acc/f1/spec/sens = 0.2605 / 0.2466 / 0.9385 / 0.1164/ [0.06369427 1.         0.11637931]
 46%|████▌     | 46/100 [03:53<04:49,  5.36s/it] 47%|████▋     | 47/100 [03:56<04:16,  4.84s/it] 48%|████▊     | 48/100 [04:01<04:08,  4.79s/it] 49%|████▉     | 49/100 [04:05<03:45,  4.42s/it] 50%|█████     | 50/100 [04:14<04:49,  5.80s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8905 / 0.9630 / 0.8696/ [0.88235294 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2794 / 0.2753 / 0.9180 / 0.1250/ [0.10828025 1.         0.125     ]
 51%|█████     | 51/100 [04:17<04:13,  5.17s/it] 52%|█████▏    | 52/100 [04:22<04:01,  5.04s/it] 53%|█████▎    | 53/100 [04:26<03:37,  4.64s/it] 54%|█████▍    | 54/100 [04:31<03:34,  4.66s/it] 55%|█████▌    | 55/100 [04:39<04:14,  5.67s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8933 / 0.9815 / 0.8478/ [0.94117647 0.97297297 0.84782609]
                Test acc/f1/spec/sens = 0.2710 / 0.2614 / 0.9303 / 0.1293/ [0.07643312 1.         0.12931034]
 56%|█████▌    | 56/100 [04:43<03:55,  5.36s/it] 57%|█████▋    | 57/100 [04:47<03:30,  4.89s/it] 58%|█████▊    | 58/100 [04:52<03:22,  4.81s/it] 59%|█████▉    | 59/100 [04:55<03:05,  4.52s/it] 60%|██████    | 60/100 [05:04<03:54,  5.87s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9043 / 0.9815 / 0.8696/ [0.94117647 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2605 / 0.2486 / 0.9344 / 0.1121/ [0.07006369 1.         0.11206897]
 61%|██████    | 61/100 [05:08<03:23,  5.22s/it] 62%|██████▏   | 62/100 [05:13<03:12,  5.07s/it] 63%|██████▎   | 63/100 [05:17<02:51,  4.64s/it] 64%|██████▍   | 64/100 [05:21<02:47,  4.66s/it] 65%|██████▌   | 65/100 [05:29<03:18,  5.67s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8905 / 0.9630 / 0.8696/ [0.88235294 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2626 / 0.2453 / 0.9385 / 0.1250/ [0.05732484 1.         0.125     ]
 66%|██████▌   | 66/100 [05:34<03:03,  5.40s/it] 67%|██████▋   | 67/100 [05:38<02:41,  4.89s/it] 68%|██████▊   | 68/100 [05:43<02:35,  4.85s/it] 69%|██████▉   | 69/100 [05:46<02:20,  4.52s/it] 70%|███████   | 70/100 [05:55<02:56,  5.87s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8905 / 0.9630 / 0.8696/ [0.88235294 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2584 / 0.2349 / 0.9467 / 0.1207/ [0.05095541 1.         0.12068966]
 71%|███████   | 71/100 [05:59<02:31,  5.21s/it] 72%|███████▏  | 72/100 [06:04<02:23,  5.13s/it] 73%|███████▎  | 73/100 [06:08<02:06,  4.69s/it] 74%|███████▍  | 74/100 [06:13<02:04,  4.77s/it] 75%|███████▌  | 75/100 [06:20<02:22,  5.71s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8905 / 0.9630 / 0.8696/ [0.88235294 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2437 / 0.2256 / 0.9467 / 0.0862/ [0.05732484 1.         0.0862069 ]
 76%|███████▌  | 76/100 [06:25<02:10,  5.42s/it] 77%|███████▋  | 77/100 [06:29<01:52,  4.89s/it] 78%|███████▊  | 78/100 [06:34<01:46,  4.85s/it] 79%|███████▉  | 79/100 [06:37<01:34,  4.51s/it] 80%|████████  | 80/100 [06:46<01:58,  5.91s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8905 / 0.9630 / 0.8696/ [0.88235294 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2584 / 0.2446 / 0.9344 / 0.1121/ [0.06369427 1.         0.11206897]
 81%|████████  | 81/100 [06:50<01:40,  5.26s/it] 82%|████████▏ | 82/100 [06:55<01:31,  5.10s/it] 83%|████████▎ | 83/100 [06:59<01:19,  4.67s/it] 84%|████████▍ | 84/100 [07:04<01:15,  4.74s/it] 85%|████████▌ | 85/100 [07:12<01:25,  5.73s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8933 / 0.9815 / 0.8478/ [0.94117647 0.97297297 0.84782609]
                Test acc/f1/spec/sens = 0.2563 / 0.2421 / 0.9303 / 0.1078/ [0.06369427 1.         0.10775862]
 86%|████████▌ | 86/100 [07:16<01:15,  5.41s/it] 87%|████████▋ | 87/100 [07:20<01:03,  4.90s/it] 88%|████████▊ | 88/100 [07:25<00:57,  4.81s/it] 89%|████████▉ | 89/100 [07:28<00:49,  4.46s/it] 90%|█████████ | 90/100 [07:37<00:58,  5.85s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9043 / 0.9815 / 0.8696/ [0.94117647 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2605 / 0.2487 / 0.9385 / 0.0991/ [0.08917197 1.         0.09913793]
 91%|█████████ | 91/100 [07:41<00:46,  5.18s/it] 92%|█████████▏| 92/100 [07:46<00:40,  5.02s/it] 93%|█████████▎| 93/100 [07:49<00:32,  4.60s/it] 94%|█████████▍| 94/100 [07:54<00:27,  4.61s/it] 95%|█████████▌| 95/100 [08:02<00:27,  5.59s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8905 / 0.9630 / 0.8696/ [0.88235294 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2857 / 0.2763 / 0.9344 / 0.1509/ [0.08917197 1.         0.15086207]
 96%|█████████▌| 96/100 [08:06<00:21,  5.29s/it] 97%|█████████▋| 97/100 [08:10<00:14,  4.81s/it] 98%|█████████▊| 98/100 [08:15<00:09,  4.77s/it] 99%|█████████▉| 99/100 [08:18<00:04,  4.44s/it]100%|██████████| 100/100 [08:27<00:00,  5.82s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8905 / 0.9630 / 0.8696/ [0.88235294 0.97297297 0.86956522]
                Test acc/f1/spec/sens = 0.2752 / 0.2656 / 0.9344 / 0.1379/ [0.07643312 1.         0.13793103]
Trial 3, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9100 / 0.8905 / 0.9630 / 0.8696/ [0.88235294 0.97297297 0.86956522]
Test acc/f1/spec/sens = 0.2752 / 0.2656 / 0.9344 / 0.1379/ [0.07643312 1.         0.13793103]
>> Finished.
Acc, agreement for latest model:  0.27521008403361347 0.31932773109243695 [0.07643312 1.         0.13793103]
Load best checkpoint for thief model
Acc, agreement for best model:  0.2415966386554622 0.296218487394958 [0.06369427 1.         0.07758621]
Trial 2/1 || Cycle 1/1 || Label set size 900 || Test acc 0.2416 || Test agreement 0.2962 || Spec 0.9467 || Sens 0.0776 Class Acc: [0.06369427 1.         0.07758621]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:33,  1.67it/s]  9%|▉         | 5/57 [00:00<00:06,  7.78it/s] 16%|█▌        | 9/57 [00:00<00:04, 11.93it/s] 21%|██        | 12/57 [00:01<00:02, 15.21it/s] 28%|██▊       | 16/57 [00:01<00:02, 18.35it/s] 35%|███▌      | 20/57 [00:01<00:01, 19.44it/s] 42%|████▏     | 24/57 [00:01<00:01, 19.20it/s] 49%|████▉     | 28/57 [00:01<00:01, 19.82it/s] 56%|█████▌    | 32/57 [00:01<00:01, 21.82it/s] 63%|██████▎   | 36/57 [00:02<00:00, 22.05it/s] 70%|███████   | 40/57 [00:02<00:00, 22.46it/s] 77%|███████▋  | 44/57 [00:02<00:00, 21.00it/s] 84%|████████▍ | 48/57 [00:02<00:00, 22.73it/s] 91%|█████████ | 52/57 [00:02<00:00, 22.85it/s] 98%|█████████▊| 56/57 [00:03<00:00, 23.49it/s]100%|██████████| 57/57 [00:03<00:00, 17.91it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.78it/s] 57%|█████▋    | 4/7 [00:00<00:00,  7.32it/s] 86%|████████▌ | 6/7 [00:00<00:00,  9.87it/s]100%|██████████| 7/7 [00:01<00:00,  6.72it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2119, -1.2279, -1.2040]), tensor([0.8514, 0.8471, 0.8543]))
Val set stats: mean/std =  (tensor([-1.2709, -1.2825, -1.2655]), tensor([0.8425, 0.8374, 0.8453]))
Validation set distribution: 
Number of samples  100
{0: 14, 1: 39, 2: 47}
Labeled set distribution: 
Number of samples  900
{0: 162, 1: 392, 2: 346}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.6008, agreement = 0.5462, f1 = 0.4162, spec = 0.5205, sens = 0.9353 Class Acc: [0.43312102 0.01149425 0.93534483]
Initial model on validation dataset: acc = 0.4500, agreement = 0.4500, f1 = 0.2222, spec = 0.1887, sens = 0.9574 Class Acc: [0.         0.         0.95744681]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:54,  3.58s/it]  2%|▏         | 2/100 [00:08<07:05,  4.34s/it]  3%|▎         | 3/100 [00:12<06:35,  4.08s/it]  4%|▍         | 4/100 [00:17<07:23,  4.62s/it]  5%|▌         | 5/100 [00:26<09:27,  5.98s/it]Epoch 5: Train acc/f1 = 0.9022 / 0.8639 / 0.9675 / 0.9393/ [0.61111111 0.98979592 0.93930636] 
                Val acc/f1/spec/sens = 0.8700 / 0.8361 / 0.9057 / 0.9362/ [0.85714286 0.79487179 0.93617021]
                Test acc/f1/spec/sens = 0.2542 / 0.1946 / 0.9918 / 0.1466/ [0.         1.         0.14655172]
  6%|▌         | 6/100 [00:31<08:50,  5.64s/it]  7%|▋         | 7/100 [00:34<07:47,  5.02s/it]  8%|▊         | 8/100 [00:40<07:48,  5.10s/it]  9%|▉         | 9/100 [00:43<06:59,  4.61s/it] 10%|█         | 10/100 [00:52<09:06,  6.07s/it]Epoch 10: Train acc/f1 = 0.9656 / 0.9568 / 0.9747 / 0.9769/ [0.90123457 0.98214286 0.97687861] 
                Val acc/f1/spec/sens = 0.9200 / 0.8817 / 0.9434 / 0.9149/ [0.78571429 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.4895 / 0.4316 / 0.8361 / 0.5991/ [0.05095541 0.98850575 0.59913793]
 11%|█         | 11/100 [00:56<07:55,  5.34s/it] 12%|█▏        | 12/100 [01:01<07:43,  5.27s/it] 13%|█▎        | 13/100 [01:05<06:59,  4.82s/it] 14%|█▍        | 14/100 [01:10<06:58,  4.86s/it] 15%|█▌        | 15/100 [01:18<08:12,  5.80s/it]Epoch 15: Train acc/f1 = 0.9656 / 0.9565 / 0.9982 / 0.9509/ [0.98765432 0.96938776 0.95086705] 
                Val acc/f1/spec/sens = 0.6900 / 0.6000 / 0.9811 / 0.5957/ [0.21428571 0.97435897 0.59574468]
                Test acc/f1/spec/sens = 0.2395 / 0.2061 / 1.0000 / 0.0862/ [0.04458599 1.         0.0862069 ]
 16%|█▌        | 16/100 [01:23<07:40,  5.49s/it] 17%|█▋        | 17/100 [01:26<06:49,  4.94s/it] 18%|█▊        | 18/100 [01:31<06:38,  4.85s/it] 19%|█▉        | 19/100 [01:35<06:03,  4.48s/it] 20%|██        | 20/100 [01:44<07:44,  5.80s/it]Epoch 20: Train acc/f1 = 0.9100 / 0.8811 / 0.9278 / 1.0000/ [0.75925926 0.89285714 1.        ] 
                Val acc/f1/spec/sens = 0.8200 / 0.7421 / 0.8491 / 0.9362/ [0.5        0.79487179 0.93617021]
                Test acc/f1/spec/sens = 0.5546 / 0.4485 / 0.6967 / 0.8448/ [0.05095541 0.68965517 0.84482759]
 21%|██        | 21/100 [01:47<06:50,  5.19s/it] 22%|██▏       | 22/100 [01:52<06:30,  5.00s/it] 23%|██▎       | 23/100 [01:56<05:54,  4.60s/it] 24%|██▍       | 24/100 [02:00<05:56,  4.69s/it] 25%|██▌       | 25/100 [02:08<07:05,  5.67s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8979 / 0.9811 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3466 / 0.3338 / 0.9098 / 0.2974/ [0.05732484 1.         0.29741379]
 26%|██▌       | 26/100 [02:13<06:43,  5.46s/it] 27%|██▋       | 27/100 [02:17<06:00,  4.94s/it] 28%|██▊       | 28/100 [02:22<05:52,  4.89s/it] 29%|██▉       | 29/100 [02:26<05:22,  4.55s/it] 30%|███       | 30/100 [02:35<06:56,  5.94s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9149 / 0.9811 / 0.9149/ [0.92857143 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3298 / 0.3187 / 0.9221 / 0.2629/ [0.06369427 0.98850575 0.26293103]
 31%|███       | 31/100 [02:38<06:02,  5.25s/it] 32%|███▏      | 32/100 [02:43<05:45,  5.08s/it] 33%|███▎      | 33/100 [02:47<05:13,  4.68s/it] 34%|███▍      | 34/100 [02:52<05:13,  4.75s/it] 35%|███▌      | 35/100 [03:00<06:10,  5.71s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9149 / 0.9811 / 0.9149/ [0.92857143 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3109 / 0.2994 / 0.9221 / 0.2284/ [0.05732484 0.98850575 0.22844828]
 36%|███▌      | 36/100 [03:05<05:48,  5.45s/it] 37%|███▋      | 37/100 [03:08<05:06,  4.87s/it] 38%|███▊      | 38/100 [03:13<04:59,  4.84s/it] 39%|███▉      | 39/100 [03:17<04:36,  4.53s/it] 40%|████      | 40/100 [03:26<05:53,  5.89s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8979 / 0.9811 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3214 / 0.3085 / 0.9344 / 0.2457/ [0.05732484 1.         0.24568966]
 41%|████      | 41/100 [03:30<05:10,  5.27s/it] 42%|████▏     | 42/100 [03:34<04:55,  5.10s/it] 43%|████▎     | 43/100 [03:38<04:29,  4.73s/it] 44%|████▍     | 44/100 [03:43<04:29,  4.81s/it] 45%|████▌     | 45/100 [03:51<05:16,  5.76s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8979 / 0.9811 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3151 / 0.3002 / 0.9426 / 0.2328/ [0.05732484 1.         0.23275862]
 46%|████▌     | 46/100 [03:56<04:58,  5.53s/it] 47%|████▋     | 47/100 [04:00<04:21,  4.94s/it] 48%|████▊     | 48/100 [04:05<04:17,  4.94s/it] 49%|████▉     | 49/100 [04:08<03:53,  4.58s/it] 50%|█████     | 50/100 [04:17<04:55,  5.90s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8979 / 0.9811 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.2878 / 0.2741 / 0.9508 / 0.1724/ [0.06369427 1.         0.17241379]
 51%|█████     | 51/100 [04:21<04:17,  5.26s/it] 52%|█████▏    | 52/100 [04:26<04:08,  5.18s/it] 53%|█████▎    | 53/100 [04:30<03:42,  4.73s/it] 54%|█████▍    | 54/100 [04:35<03:41,  4.81s/it] 55%|█████▌    | 55/100 [04:43<04:18,  5.74s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8979 / 0.9811 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3067 / 0.2955 / 0.9426 / 0.2155/ [0.06369427 0.98850575 0.21551724]
 56%|█████▌    | 56/100 [04:48<04:02,  5.51s/it] 57%|█████▋    | 57/100 [04:51<03:31,  4.92s/it] 58%|█████▊    | 58/100 [04:56<03:23,  4.85s/it] 59%|█████▉    | 59/100 [05:00<03:05,  4.52s/it] 60%|██████    | 60/100 [05:09<03:54,  5.87s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8979 / 0.9811 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3487 / 0.3342 / 0.8525 / 0.3060/ [0.05095541 1.         0.30603448]
 61%|██████    | 61/100 [05:12<03:23,  5.22s/it] 62%|██████▏   | 62/100 [05:17<03:16,  5.18s/it] 63%|██████▎   | 63/100 [05:21<02:56,  4.76s/it] 64%|██████▍   | 64/100 [05:26<02:54,  4.83s/it] 65%|██████▌   | 65/100 [05:34<03:21,  5.77s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8979 / 0.9811 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3445 / 0.3325 / 0.8238 / 0.3017/ [0.05095541 0.98850575 0.30172414]
 66%|██████▌   | 66/100 [05:39<03:06,  5.47s/it] 67%|██████▋   | 67/100 [05:43<02:42,  4.94s/it] 68%|██████▊   | 68/100 [05:47<02:34,  4.82s/it] 69%|██████▉   | 69/100 [05:51<02:18,  4.47s/it] 70%|███████   | 70/100 [06:00<02:54,  5.81s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9149 / 0.9811 / 0.9149/ [0.92857143 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3298 / 0.3193 / 0.8361 / 0.2802/ [0.05095541 0.96551724 0.28017241]
 71%|███████   | 71/100 [06:03<02:29,  5.16s/it] 72%|███████▏  | 72/100 [06:08<02:20,  5.01s/it] 73%|███████▎  | 73/100 [06:12<02:03,  4.57s/it] 74%|███████▍  | 74/100 [06:16<01:59,  4.58s/it] 75%|███████▌  | 75/100 [06:24<02:18,  5.56s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8979 / 0.9811 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.2983 / 0.2867 / 0.9344 / 0.1983/ [0.06369427 0.98850575 0.19827586]
 76%|███████▌  | 76/100 [06:29<02:08,  5.37s/it] 77%|███████▋  | 77/100 [06:33<01:52,  4.87s/it] 78%|███████▊  | 78/100 [06:38<01:46,  4.86s/it] 79%|███████▉  | 79/100 [06:41<01:35,  4.53s/it] 80%|████████  | 80/100 [06:50<01:58,  5.91s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9149 / 0.9811 / 0.9149/ [0.92857143 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3109 / 0.2995 / 0.9139 / 0.2284/ [0.05732484 0.98850575 0.22844828]
 81%|████████  | 81/100 [06:54<01:39,  5.24s/it] 82%|████████▏ | 82/100 [06:59<01:31,  5.11s/it] 83%|████████▎ | 83/100 [07:03<01:19,  4.67s/it] 84%|████████▍ | 84/100 [07:07<01:16,  4.75s/it] 85%|████████▌ | 85/100 [07:15<01:25,  5.72s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9149 / 0.9811 / 0.9149/ [0.92857143 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3466 / 0.3332 / 0.8443 / 0.3017/ [0.05732484 0.98850575 0.30172414]
 86%|████████▌ | 86/100 [07:20<01:15,  5.41s/it] 87%|████████▋ | 87/100 [07:24<01:03,  4.87s/it] 88%|████████▊ | 88/100 [07:29<00:58,  4.91s/it] 89%|████████▉ | 89/100 [07:32<00:50,  4.56s/it] 90%|█████████ | 90/100 [07:43<01:03,  6.35s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9400 / 0.9149 / 0.9811 / 0.9149/ [0.92857143 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3214 / 0.3157 / 0.8443 / 0.2629/ [0.05732484 0.95402299 0.26293103]
 91%|█████████ | 91/100 [07:47<00:50,  5.62s/it] 92%|█████████▏| 92/100 [07:52<00:44,  5.51s/it] 93%|█████████▎| 93/100 [07:56<00:35,  5.09s/it] 94%|█████████▍| 94/100 [08:02<00:31,  5.17s/it] 95%|█████████▌| 95/100 [08:10<00:30,  6.19s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8979 / 0.9811 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3361 / 0.3227 / 0.8648 / 0.2845/ [0.05095541 0.98850575 0.28448276]
 96%|█████████▌| 96/100 [08:15<00:23,  5.86s/it] 97%|█████████▋| 97/100 [08:19<00:15,  5.30s/it] 98%|█████████▊| 98/100 [08:24<00:10,  5.17s/it] 99%|█████████▉| 99/100 [08:28<00:04,  4.85s/it]100%|██████████| 100/100 [08:39<00:00,  6.47s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8979 / 0.9811 / 0.9149/ [0.85714286 0.97435897 0.91489362]
                Test acc/f1/spec/sens = 0.3277 / 0.3109 / 0.9221 / 0.2629/ [0.05095541 1.         0.26293103]
Trial 4, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9300 / 0.8979 / 0.9811 / 0.9149/ [0.85714286 0.97435897 0.91489362]
Test acc/f1/spec/sens = 0.3277 / 0.3109 / 0.9221 / 0.2629/ [0.05095541 1.         0.26293103]
>> Finished.
Acc, agreement for latest model:  0.3277310924369748 0.3907563025210084 [0.05095541 1.         0.26293103]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3445378151260504 0.40756302521008403 [0.05732484 1.         0.29310345]
Trial 3/1 || Cycle 1/1 || Label set size 900 || Test acc 0.3445 || Test agreement 0.4076 || Spec 0.9508 || Sens 0.2931 Class Acc: [0.05732484 1.         0.29310345]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:35,  1.56it/s]  9%|▉         | 5/57 [00:00<00:06,  7.50it/s] 16%|█▌        | 9/57 [00:00<00:04, 11.84it/s] 23%|██▎       | 13/57 [00:01<00:02, 16.07it/s] 30%|██▉       | 17/57 [00:01<00:02, 18.64it/s] 37%|███▋      | 21/57 [00:01<00:01, 21.56it/s] 42%|████▏     | 24/57 [00:01<00:01, 22.29it/s] 47%|████▋     | 27/57 [00:01<00:01, 23.19it/s] 53%|█████▎    | 30/57 [00:01<00:01, 21.63it/s] 58%|█████▊    | 33/57 [00:02<00:01, 18.83it/s] 63%|██████▎   | 36/57 [00:02<00:01, 20.59it/s] 68%|██████▊   | 39/57 [00:02<00:00, 21.82it/s] 74%|███████▎  | 42/57 [00:02<00:00, 19.76it/s] 79%|███████▉  | 45/57 [00:02<00:00, 19.72it/s] 84%|████████▍ | 48/57 [00:02<00:00, 20.72it/s] 91%|█████████ | 52/57 [00:02<00:00, 23.40it/s] 96%|█████████▋| 55/57 [00:03<00:00, 21.43it/s]100%|██████████| 57/57 [00:03<00:00, 17.08it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.57it/s] 57%|█████▋    | 4/7 [00:00<00:00,  6.74it/s] 86%|████████▌ | 6/7 [00:00<00:00,  9.43it/s]100%|██████████| 7/7 [00:01<00:00,  6.83it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2143, -1.2311, -1.2063]), tensor([0.8511, 0.8463, 0.8541]))
Val set stats: mean/std =  (tensor([-1.2523, -1.2622, -1.2478]), tensor([0.8507, 0.8474, 0.8527]))
Validation set distribution: 
Number of samples  100
{0: 18, 1: 32, 2: 50}
Labeled set distribution: 
Number of samples  900
{0: 152, 1: 407, 2: 341}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
Thief model initialized successfully
Initial model on target dataset: acc = 0.3235, agreement = 0.2962, f1 = 0.1760, spec = 0.1189, sens = 0.6552 Class Acc: [0.         0.02298851 0.65517241]
Initial model on validation dataset: acc = 0.6000, agreement = 0.6000, f1 = 0.4195, spec = 0.2200, sens = 1.0000 Class Acc: [0.05555556 0.28125    1.        ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:51,  3.55s/it]  2%|▏         | 2/100 [00:08<07:05,  4.34s/it]  3%|▎         | 3/100 [00:12<06:27,  4.00s/it]  4%|▍         | 4/100 [00:17<07:03,  4.41s/it]  5%|▌         | 5/100 [00:24<08:58,  5.67s/it]Epoch 5: Train acc/f1 = 0.8633 / 0.7445 / 0.8927 / 0.9795/ [0.25       0.995086   0.97947214] 
                Val acc/f1/spec/sens = 0.9200 / 0.9063 / 0.9600 / 0.9200/ [0.94444444 0.90625    0.92      ]
                Test acc/f1/spec/sens = 0.6261 / 0.4955 / 0.9180 / 0.8879/ [0.03184713 1.         0.88793103]
  6%|▌         | 6/100 [00:29<08:18,  5.31s/it]  7%|▋         | 7/100 [00:33<07:22,  4.76s/it]  8%|▊         | 8/100 [00:37<07:13,  4.71s/it]  9%|▉         | 9/100 [00:41<06:38,  4.38s/it] 10%|█         | 10/100 [00:50<08:48,  5.87s/it]Epoch 10: Train acc/f1 = 0.9844 / 0.9794 / 0.9875 / 0.9883/ [0.96052632 0.99017199 0.98826979] 
                Val acc/f1/spec/sens = 0.8500 / 0.8318 / 0.9600 / 0.8200/ [0.88888889 0.875      0.82      ]
                Test acc/f1/spec/sens = 0.5210 / 0.4416 / 0.8484 / 0.7112/ [0.05095541 0.86206897 0.7112069 ]
 11%|█         | 11/100 [00:54<07:52,  5.31s/it] 12%|█▏        | 12/100 [00:59<07:31,  5.14s/it] 13%|█▎        | 13/100 [01:03<07:00,  4.83s/it] 14%|█▍        | 14/100 [01:08<06:56,  4.84s/it] 15%|█▌        | 15/100 [01:16<08:17,  5.86s/it]Epoch 15: Train acc/f1 = 0.9311 / 0.8985 / 0.9320 / 0.9883/ [0.69078947 0.97297297 0.98826979] 
                Val acc/f1/spec/sens = 0.9100 / 0.8934 / 0.9800 / 0.8800/ [0.88888889 0.96875    0.88      ]
                Test acc/f1/spec/sens = 0.5462 / 0.4320 / 0.8361 / 0.7802/ [0.01273885 0.88505747 0.78017241]
 16%|█▌        | 16/100 [01:21<07:53,  5.63s/it] 17%|█▋        | 17/100 [01:25<06:59,  5.06s/it] 18%|█▊        | 18/100 [01:30<06:47,  4.97s/it] 19%|█▉        | 19/100 [01:33<06:09,  4.57s/it] 20%|██        | 20/100 [01:42<07:52,  5.91s/it]Epoch 20: Train acc/f1 = 0.9700 / 0.9613 / 0.9893 / 0.9912/ [0.97368421 0.95085995 0.99120235] 
                Val acc/f1/spec/sens = 0.8800 / 0.8510 / 0.9400 / 0.9400/ [0.83333333 0.8125     0.94      ]
                Test acc/f1/spec/sens = 0.6429 / 0.5301 / 0.7869 / 0.9267/ [0.08917197 0.88505747 0.92672414]
 21%|██        | 21/100 [01:46<06:52,  5.22s/it] 22%|██▏       | 22/100 [01:51<06:42,  5.16s/it] 23%|██▎       | 23/100 [01:55<06:03,  4.72s/it] 24%|██▍       | 24/100 [02:00<05:59,  4.74s/it] 25%|██▌       | 25/100 [02:07<07:08,  5.71s/it]Epoch 25: Train acc/f1 = 0.9978 / 0.9969 / 1.0000 / 0.9971/ [1.         0.997543   0.99706745] 
                Val acc/f1/spec/sens = 0.8700 / 0.8447 / 0.9600 / 0.8800/ [0.83333333 0.875      0.88      ]
                Test acc/f1/spec/sens = 0.5882 / 0.4742 / 0.9221 / 0.8103/ [0.03184713 1.         0.81034483]
 26%|██▌       | 26/100 [02:12<06:42,  5.45s/it] 27%|██▋       | 27/100 [02:16<05:59,  4.92s/it] 28%|██▊       | 28/100 [02:21<05:56,  4.95s/it] 29%|██▉       | 29/100 [02:25<05:22,  4.55s/it] 30%|███       | 30/100 [02:34<06:51,  5.88s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8640 / 0.9600 / 0.9200/ [0.83333333 0.875      0.92      ]
                Test acc/f1/spec/sens = 0.5819 / 0.4742 / 0.9303 / 0.7974/ [0.03821656 0.98850575 0.79741379]
 31%|███       | 31/100 [02:37<06:00,  5.22s/it] 32%|███▏      | 32/100 [02:42<05:49,  5.14s/it] 33%|███▎      | 33/100 [02:46<05:16,  4.72s/it] 34%|███▍      | 34/100 [02:51<05:12,  4.73s/it] 35%|███▌      | 35/100 [02:59<06:11,  5.72s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8774 / 0.9800 / 0.9200/ [0.88888889 0.875      0.92      ]
                Test acc/f1/spec/sens = 0.6050 / 0.4884 / 0.9098 / 0.8405/ [0.03821656 1.         0.84051724]
 36%|███▌      | 36/100 [03:04<05:47,  5.43s/it] 37%|███▋      | 37/100 [03:07<05:10,  4.92s/it] 38%|███▊      | 38/100 [03:12<05:04,  4.91s/it] 39%|███▉      | 39/100 [03:16<04:35,  4.52s/it] 40%|████      | 40/100 [03:25<05:53,  5.88s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8556 / 0.9800 / 0.9000/ [0.88888889 0.84375    0.9       ]
                Test acc/f1/spec/sens = 0.6239 / 0.5127 / 0.9098 / 0.8664/ [0.07006369 0.97701149 0.86637931]
 41%|████      | 41/100 [03:29<05:08,  5.24s/it] 42%|████▏     | 42/100 [03:33<04:55,  5.10s/it] 43%|████▎     | 43/100 [03:37<04:29,  4.73s/it] 44%|████▍     | 44/100 [03:42<04:29,  4.81s/it] 45%|████▌     | 45/100 [03:50<05:18,  5.79s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8701 / 0.9800 / 0.9000/ [0.94444444 0.84375    0.9       ]
                Test acc/f1/spec/sens = 0.6303 / 0.5164 / 0.9057 / 0.8793/ [0.07006369 0.97701149 0.87931034]
 46%|████▌     | 46/100 [03:55<04:54,  5.46s/it] 47%|████▋     | 47/100 [03:59<04:18,  4.88s/it] 48%|████▊     | 48/100 [04:03<04:13,  4.88s/it] 49%|████▉     | 49/100 [04:07<03:52,  4.57s/it] 50%|█████     | 50/100 [04:16<04:57,  5.95s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8701 / 0.9800 / 0.9000/ [0.94444444 0.84375    0.9       ]
                Test acc/f1/spec/sens = 0.6218 / 0.5229 / 0.9180 / 0.8491/ [0.0955414  0.96551724 0.84913793]
 51%|█████     | 51/100 [04:20<04:19,  5.29s/it] 52%|█████▏    | 52/100 [04:25<04:07,  5.16s/it] 53%|█████▎    | 53/100 [04:29<03:41,  4.72s/it] 54%|█████▍    | 54/100 [04:34<03:43,  4.85s/it] 55%|█████▌    | 55/100 [04:43<04:34,  6.09s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8701 / 0.9800 / 0.9000/ [0.94444444 0.84375    0.9       ]
                Test acc/f1/spec/sens = 0.6092 / 0.5069 / 0.9098 / 0.8362/ [0.07643312 0.96551724 0.8362069 ]
 56%|█████▌    | 56/100 [04:48<04:16,  5.84s/it] 57%|█████▋    | 57/100 [04:52<03:42,  5.17s/it] 58%|█████▊    | 58/100 [04:57<03:33,  5.09s/it] 59%|█████▉    | 59/100 [05:00<03:10,  4.64s/it] 60%|██████    | 60/100 [05:10<04:09,  6.23s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8701 / 0.9800 / 0.9000/ [0.94444444 0.84375    0.9       ]
                Test acc/f1/spec/sens = 0.6555 / 0.5458 / 0.8730 / 0.9181/ [0.10191083 0.95402299 0.91810345]
 61%|██████    | 61/100 [05:14<03:32,  5.44s/it] 62%|██████▏   | 62/100 [05:19<03:20,  5.29s/it] 63%|██████▎   | 63/100 [05:23<03:05,  5.02s/it] 64%|██████▍   | 64/100 [05:28<03:02,  5.07s/it] 65%|██████▌   | 65/100 [05:37<03:37,  6.20s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8701 / 0.9800 / 0.9000/ [0.94444444 0.84375    0.9       ]
                Test acc/f1/spec/sens = 0.6050 / 0.4995 / 0.9180 / 0.8362/ [0.06369427 0.96551724 0.8362069 ]
 66%|██████▌   | 66/100 [05:42<03:20,  5.90s/it] 67%|██████▋   | 67/100 [05:46<02:57,  5.38s/it] 68%|██████▊   | 68/100 [05:51<02:47,  5.23s/it] 69%|██████▉   | 69/100 [05:55<02:26,  4.74s/it] 70%|███████   | 70/100 [06:04<03:04,  6.14s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8701 / 0.9800 / 0.9000/ [0.94444444 0.84375    0.9       ]
                Test acc/f1/spec/sens = 0.5903 / 0.4926 / 0.9262 / 0.8060/ [0.07006369 0.95402299 0.80603448]
 71%|███████   | 71/100 [06:08<02:37,  5.43s/it] 72%|███████▏  | 72/100 [06:13<02:26,  5.23s/it] 73%|███████▎  | 73/100 [06:17<02:10,  4.85s/it] 74%|███████▍  | 74/100 [06:22<02:07,  4.92s/it] 75%|███████▌  | 75/100 [06:31<02:35,  6.22s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8519 / 0.9600 / 0.9200/ [0.83333333 0.84375    0.92      ]
                Test acc/f1/spec/sens = 0.6134 / 0.5150 / 0.9180 / 0.8405/ [0.08917197 0.95402299 0.84051724]
 76%|███████▌  | 76/100 [06:37<02:25,  6.05s/it] 77%|███████▋  | 77/100 [06:41<02:06,  5.50s/it] 78%|███████▊  | 78/100 [06:47<02:00,  5.48s/it] 79%|███████▉  | 79/100 [06:51<01:46,  5.08s/it] 80%|████████  | 80/100 [07:02<02:18,  6.93s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8543 / 0.9600 / 0.9000/ [0.83333333 0.875      0.9       ]
                Test acc/f1/spec/sens = 0.6134 / 0.4989 / 0.9098 / 0.8491/ [0.05095541 1.         0.84913793]
 81%|████████  | 81/100 [07:06<01:56,  6.12s/it] 82%|████████▏ | 82/100 [07:12<01:47,  5.99s/it] 83%|████████▎ | 83/100 [07:16<01:31,  5.39s/it] 84%|████████▍ | 84/100 [07:21<01:26,  5.41s/it] 85%|████████▌ | 85/100 [07:31<01:39,  6.60s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8675 / 0.9800 / 0.9000/ [0.88888889 0.875      0.9       ]
                Test acc/f1/spec/sens = 0.5672 / 0.4711 / 0.9426 / 0.7543/ [0.05095541 1.         0.75431034]
 86%|████████▌ | 86/100 [07:36<01:27,  6.25s/it] 87%|████████▋ | 87/100 [07:40<01:12,  5.58s/it] 88%|████████▊ | 88/100 [07:45<01:05,  5.47s/it] 89%|████████▉ | 89/100 [07:49<00:55,  5.04s/it] 90%|█████████ | 90/100 [08:00<01:06,  6.64s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8606 / 0.9800 / 0.8800/ [0.94444444 0.84375    0.88      ]
                Test acc/f1/spec/sens = 0.6429 / 0.5498 / 0.8934 / 0.8836/ [0.14012739 0.90804598 0.88362069]
 91%|█████████ | 91/100 [08:04<00:52,  5.85s/it] 92%|█████████▏| 92/100 [08:09<00:45,  5.69s/it] 93%|█████████▎| 93/100 [08:13<00:36,  5.18s/it] 94%|█████████▍| 94/100 [08:18<00:31,  5.23s/it] 95%|█████████▌| 95/100 [08:28<00:32,  6.58s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8701 / 0.9800 / 0.9000/ [0.94444444 0.84375    0.9       ]
                Test acc/f1/spec/sens = 0.6197 / 0.5078 / 0.9057 / 0.8664/ [0.06369427 0.96551724 0.86637931]
 96%|█████████▌| 96/100 [08:34<00:25,  6.41s/it] 97%|█████████▋| 97/100 [08:40<00:18,  6.18s/it] 98%|█████████▊| 98/100 [08:46<00:12,  6.23s/it] 99%|█████████▉| 99/100 [08:51<00:05,  5.82s/it]100%|██████████| 100/100 [09:02<00:00,  7.52s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8762 / 0.9600 / 0.9200/ [0.83333333 0.90625    0.92      ]
                Test acc/f1/spec/sens = 0.6303 / 0.5053 / 0.8811 / 0.8922/ [0.04458599 0.98850575 0.89224138]
Trial 5, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9000 / 0.8762 / 0.9600 / 0.9200/ [0.83333333 0.90625    0.92      ]
Test acc/f1/spec/sens = 0.6303 / 0.5053 / 0.8811 / 0.8922/ [0.04458599 0.98850575 0.89224138]
>> Finished.
Acc, agreement for latest model:  0.6302521008403361 0.6596638655462185 [0.04458599 0.98850575 0.89224138]
Load best checkpoint for thief model
Acc, agreement for best model:  0.49789915966386555 0.5483193277310925 [0.05095541 0.97701149 0.62068966]
Trial 4/1 || Cycle 1/1 || Label set size 900 || Test acc 0.4979 || Test agreement 0.5483 || Spec 0.8811 || Sens 0.6207 Class Acc: [0.05095541 0.97701149 0.62068966]
**************************************************************************************************** 

Number of samples  900
0.4718487394957984 0.10457543434005184
        acc  ...                label dist
0  0.485294  ...  {0: 149, 1: 391, 2: 360}
1  0.531513  ...  {0: 159, 1: 368, 2: 373}
2  0.241597  ...  {0: 148, 1: 398, 2: 354}
3  0.344538  ...  {0: 162, 1: 392, 2: 346}
4  0.497899  ...  {0: 152, 1: 407, 2: 341}

[5 rows x 6 columns]
Results saved to  /home/ankita/scratch/data_msa_medical/results_ankita//pocus_resnet18/butterfly_resnet50/SGD/1000_val100/random_v4
