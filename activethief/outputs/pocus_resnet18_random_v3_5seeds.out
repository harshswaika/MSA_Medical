nohup: ignoring input
[24/03/07 03:02:25] [conf.py:  298]: PyTorch Version: torch=1.11.0, cuda=11.3, cudnn=8200
[24/03/07 03:02:25] [conf.py:  300]: ACTIVE:
  ADDENDUM: 0
  ALPHA: 0.2
  AUGMENT: None
  BETA: 1.0
  BUDGET: 1000
  CUTMIX_PROB: 0.0
  CYCLES: 1
  INITIAL: 900
  LA: False
  METHOD: random
  PRETRAINED_PATH: /home/ankita/scratch/data_msa_medical/ckpts/resnet50-imagenet1k.pth
  TEMP: 1.0
  TRO: 1.0
  USE_PRETRAINED: True
  VAL: 100
AM:
  SGR: 1000
  THRESHOLD: 0.5
CUDNN_BENCHMARK: True
DS_SEED: 123
EDM:
  HASH: /home/harsh_s/scratch/msacopy/exp/hash/alpha.pt
  NUM_MODELS: 5
  PATH1: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T0.pt
  PATH2: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T1.pt
  PATH3: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T2.pt
  PATH4: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T3.pt
  PATH5: /home/harsh_s/scratch/msacopy/exp/cifar10/alpha/T4.pt
GR:
  EPSILON: 0.1
  SUR_PATH: /home/harsh_s/scratch/msacopy/GRAD2/batch_training/outputs/trained_models/imagenet_cifar10_to_cifar10_surrogate_10epochs.pt
LOG_DEST: resnet18_resnet50_pocus_240307_030225.txt
LOG_TIME: 240307_030225
METHOD_NAME: v3_5seeds
OUT_DIR: /home/ankita/scratch/data_msa_medical/results_ankita/
PL:
  CLASS_BLNC: 10
  ITERATIONS: 20
  KAPPA_N: 0.005
  KAPPA_P: 0.05
  NO_PROGRESS: False
  NO_UNCERTAINTY: False
  TAU_N: 0.05
  TAU_P: 0.7
  TEMP_NL: 2.0
RNG_SEED: 5
SAVE_DIR: /home/ankita/scratch/data_msa_medical/results_ankita//pocus_resnet18/butterfly_resnet50/SGD/1000_val100/random_v3_5seeds
THIEF:
  ARCH: resnet50
  DATASET: butterfly
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/Butte
  HARD_LABELS: True
  NUM_TRAIN: 1281167
  SUBSET: 128116
TRAIN:
  BATCH: 16
  EPOCH: 100
  GAMMA: 0.1
  LR: 0.02
  MILESTONES: [20, 40, 60, 80]
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  WDECAY: 0.0005
VICTIM:
  ARCH: resnet18
  DATASET: pocus
  DATA_ROOT: /home/ankita/scratch/data_msa_medical/covid_5_fold
  HEIGHT: 224
  PATH: /home/ankita/scratch/data_msa_medical/victim_models/pocus_resnet18.pth.tar
  PATHIN: /home/harsh_s/scratch/msacopy/ckpts/cifar10-resnet32-inaccurate/checkpoint.pth.tar
  WIDTH: 224
Loaded target dataset of size 476 with 3 classes
target model keys:  122
checkpoint keys:  122

Target model acc = 0.8991596638655462
Val-Acc: 0.8992 Val-Spec: 0.9795 Val-Sens: 0.9224 Class Acc: [0.8343949  0.95402299 0.92241379]
replacing labeled set labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:35,  1.57it/s]  7%|▋         | 4/57 [00:00<00:07,  6.72it/s] 12%|█▏        | 7/57 [00:00<00:04, 11.01it/s] 18%|█▊        | 10/57 [00:01<00:03, 13.26it/s] 23%|██▎       | 13/57 [00:01<00:02, 15.27it/s] 28%|██▊       | 16/57 [00:01<00:02, 17.74it/s] 33%|███▎      | 19/57 [00:01<00:02, 16.96it/s] 37%|███▋      | 21/57 [00:01<00:02, 16.36it/s] 44%|████▍     | 25/57 [00:01<00:01, 18.80it/s] 51%|█████     | 29/57 [00:02<00:01, 18.55it/s] 58%|█████▊    | 33/57 [00:02<00:01, 19.12it/s] 65%|██████▍   | 37/57 [00:02<00:01, 19.72it/s] 72%|███████▏  | 41/57 [00:02<00:00, 19.55it/s] 79%|███████▉  | 45/57 [00:02<00:00, 18.60it/s] 86%|████████▌ | 49/57 [00:03<00:00, 19.17it/s] 93%|█████████▎| 53/57 [00:03<00:00, 18.59it/s]100%|██████████| 57/57 [00:03<00:00, 16.27it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.60it/s] 57%|█████▋    | 4/7 [00:00<00:00,  6.81it/s]100%|██████████| 7/7 [00:01<00:00,  6.49it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2057, -1.2217, -1.1979]), tensor([0.8564, 0.8517, 0.8594]))
Val set stats: mean/std =  (tensor([-1.2078, -1.2208, -1.2012]), tensor([0.8407, 0.8375, 0.8429]))
Validation set distribution: 
Number of samples  100
{0: 15, 1: 43, 2: 42}
Labeled set distribution: 
Number of samples  900
{0: 165, 1: 399, 2: 336}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.3466, agreement = 0.3487, f1 = 0.2606, spec = 0.2295, sens = 0.5776 Class Acc: [0.         0.35632184 0.57758621]
Initial model on validation dataset: acc = 0.1900, agreement = 0.1900, f1 = 0.1848, spec = 0.6207, sens = 0.0952 Class Acc: [0.26666667 0.25581395 0.0952381 ]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<06:45,  4.09s/it]  2%|▏         | 2/100 [00:09<07:46,  4.76s/it]  3%|▎         | 3/100 [00:13<06:59,  4.32s/it]  4%|▍         | 4/100 [00:18<07:28,  4.67s/it]  5%|▌         | 5/100 [00:26<09:39,  6.10s/it]Epoch 5: Train acc/f1 = 0.7433 / 0.7111 / 1.0000 / 0.4494/ [0.94545455 0.90726817 0.44940476] 
                Val acc/f1/spec/sens = 0.8300 / 0.7883 / 0.9828 / 0.6905/ [0.8        0.97674419 0.69047619]
                Test acc/f1/spec/sens = 0.1828 / 0.1867 / 0.9918 / 0.0474/ [0.0955414  0.70114943 0.04741379]
  6%|▌         | 6/100 [00:32<09:15,  5.91s/it]  7%|▋         | 7/100 [00:36<08:06,  5.23s/it]  8%|▊         | 8/100 [00:41<07:59,  5.21s/it]  9%|▉         | 9/100 [00:45<07:16,  4.80s/it] 10%|█         | 10/100 [00:55<09:31,  6.34s/it]Epoch 10: Train acc/f1 = 0.9656 / 0.9560 / 0.9947 / 0.9554/ [0.96969697 0.97243108 0.95535714] 
                Val acc/f1/spec/sens = 0.9400 / 0.9099 / 0.9828 / 0.9762/ [0.8        0.95348837 0.97619048]
                Test acc/f1/spec/sens = 0.2479 / 0.2447 / 0.9713 / 0.0991/ [0.06369427 0.97701149 0.09913793]
 11%|█         | 11/100 [00:59<08:22,  5.64s/it] 12%|█▏        | 12/100 [01:04<08:14,  5.62s/it] 13%|█▎        | 13/100 [01:08<07:22,  5.09s/it] 14%|█▍        | 14/100 [01:13<07:10,  5.01s/it] 15%|█▌        | 15/100 [01:22<08:38,  6.09s/it]Epoch 15: Train acc/f1 = 0.8978 / 0.8930 / 1.0000 / 0.7946/ [0.87272727 0.99498747 0.79464286] 
                Val acc/f1/spec/sens = 0.9400 / 0.9152 / 0.9483 / 0.9524/ [0.8        0.97674419 0.95238095]
                Test acc/f1/spec/sens = 0.2143 / 0.1935 / 1.0000 / 0.0388/ [0.07006369 0.94252874 0.0387931 ]
 16%|█▌        | 16/100 [01:27<08:09,  5.83s/it] 17%|█▋        | 17/100 [01:31<07:16,  5.25s/it] 18%|█▊        | 18/100 [01:36<07:07,  5.22s/it] 19%|█▉        | 19/100 [01:40<06:30,  4.82s/it] 20%|██        | 20/100 [01:50<08:30,  6.39s/it]Epoch 20: Train acc/f1 = 0.9078 / 0.8928 / 0.9982 / 0.8988/ [0.98181818 0.88471178 0.89880952] 
                Val acc/f1/spec/sens = 0.8600 / 0.8356 / 1.0000 / 0.8333/ [1.         0.8372093  0.83333333]
                Test acc/f1/spec/sens = 0.1975 / 0.1858 / 0.8934 / 0.0647/ [0.08280255 0.75862069 0.06465517]
 21%|██        | 21/100 [01:54<07:22,  5.60s/it] 22%|██▏       | 22/100 [01:59<07:02,  5.42s/it] 23%|██▎       | 23/100 [02:02<06:21,  4.96s/it] 24%|██▍       | 24/100 [02:07<06:16,  4.95s/it] 25%|██▌       | 25/100 [02:16<07:32,  6.03s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.3256 / 0.3054 / 0.9262 / 0.3147/ [0.05732484 0.83908046 0.31465517]
 26%|██▌       | 26/100 [02:21<07:04,  5.73s/it] 27%|██▋       | 27/100 [02:25<06:16,  5.15s/it] 28%|██▊       | 28/100 [02:30<06:11,  5.16s/it] 29%|██▉       | 29/100 [02:34<05:36,  4.74s/it] 30%|███       | 30/100 [02:43<07:09,  6.13s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.3004 / 0.2848 / 0.9713 / 0.2284/ [0.05732484 0.93103448 0.22844828]
 31%|███       | 31/100 [02:47<06:14,  5.42s/it] 32%|███▏      | 32/100 [02:52<06:01,  5.32s/it] 33%|███▎      | 33/100 [02:56<05:28,  4.90s/it] 34%|███▍      | 34/100 [03:01<05:22,  4.88s/it] 35%|███▌      | 35/100 [03:09<06:27,  5.97s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2794 / 0.2657 / 0.9631 / 0.1940/ [0.05732484 0.90804598 0.19396552]
 36%|███▌      | 36/100 [03:14<06:05,  5.72s/it] 37%|███▋      | 37/100 [03:18<05:25,  5.16s/it] 38%|███▊      | 38/100 [03:23<05:17,  5.11s/it] 39%|███▉      | 39/100 [03:27<04:49,  4.75s/it] 40%|████      | 40/100 [03:37<06:15,  6.26s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2668 / 0.2592 / 0.9508 / 0.1810/ [0.05732484 0.87356322 0.18103448]
 41%|████      | 41/100 [03:41<05:27,  5.55s/it] 42%|████▏     | 42/100 [03:46<05:12,  5.39s/it] 43%|████▎     | 43/100 [03:50<04:40,  4.92s/it] 44%|████▍     | 44/100 [03:55<04:41,  5.02s/it] 45%|████▌     | 45/100 [04:03<05:34,  6.08s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2458 / 0.2342 / 0.9590 / 0.1336/ [0.05732484 0.88505747 0.13362069]
 46%|████▌     | 46/100 [04:08<05:09,  5.72s/it] 47%|████▋     | 47/100 [04:12<04:32,  5.15s/it] 48%|████▊     | 48/100 [04:17<04:28,  5.16s/it] 49%|████▉     | 49/100 [04:21<04:03,  4.77s/it] 50%|█████     | 50/100 [04:31<05:11,  6.22s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.3193 / 0.3038 / 0.9590 / 0.2802/ [0.05732484 0.89655172 0.28017241]
 51%|█████     | 51/100 [04:35<04:31,  5.54s/it] 52%|█████▏    | 52/100 [04:40<04:16,  5.35s/it] 53%|█████▎    | 53/100 [04:43<03:50,  4.90s/it] 54%|█████▍    | 54/100 [04:48<03:46,  4.93s/it] 55%|█████▌    | 55/100 [04:57<04:32,  6.06s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2836 / 0.2767 / 0.9385 / 0.2241/ [0.05732484 0.85057471 0.22413793]
 56%|█████▌    | 56/100 [05:02<04:12,  5.74s/it] 57%|█████▋    | 57/100 [05:06<03:43,  5.21s/it] 58%|█████▊    | 58/100 [05:11<03:33,  5.09s/it] 59%|█████▉    | 59/100 [05:15<03:12,  4.69s/it] 60%|██████    | 60/100 [05:24<04:07,  6.18s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2752 / 0.2562 / 0.9959 / 0.1509/ [0.05732484 1.         0.15086207]
 61%|██████    | 61/100 [05:28<03:33,  5.48s/it] 62%|██████▏   | 62/100 [05:33<03:21,  5.30s/it] 63%|██████▎   | 63/100 [05:37<03:00,  4.87s/it] 64%|██████▍   | 64/100 [05:42<02:58,  4.96s/it] 65%|██████▌   | 65/100 [05:51<03:32,  6.07s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2857 / 0.2693 / 0.9836 / 0.1853/ [0.05732484 0.96551724 0.18534483]
 66%|██████▌   | 66/100 [05:56<03:16,  5.77s/it] 67%|██████▋   | 67/100 [06:00<02:51,  5.21s/it] 68%|██████▊   | 68/100 [06:05<02:44,  5.15s/it] 69%|██████▉   | 69/100 [06:09<02:27,  4.75s/it] 70%|███████   | 70/100 [06:18<03:06,  6.20s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2962 / 0.2848 / 0.9549 / 0.2371/ [0.05732484 0.88505747 0.23706897]
 71%|███████   | 71/100 [06:22<02:39,  5.50s/it] 72%|███████▏  | 72/100 [06:27<02:29,  5.33s/it] 73%|███████▎  | 73/100 [06:31<02:12,  4.89s/it] 74%|███████▍  | 74/100 [06:36<02:07,  4.90s/it] 75%|███████▌  | 75/100 [06:44<02:31,  6.05s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.3319 / 0.3132 / 0.9549 / 0.3103/ [0.05095541 0.89655172 0.31034483]
 76%|███████▌  | 76/100 [06:49<02:17,  5.73s/it] 77%|███████▋  | 77/100 [06:53<01:58,  5.16s/it] 78%|███████▊  | 78/100 [06:58<01:52,  5.12s/it] 79%|███████▉  | 79/100 [07:02<01:40,  4.78s/it] 80%|████████  | 80/100 [07:12<02:04,  6.22s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2668 / 0.2561 / 0.9590 / 0.1724/ [0.05732484 0.89655172 0.17241379]
 81%|████████  | 81/100 [07:16<01:43,  5.45s/it] 82%|████████▏ | 82/100 [07:20<01:35,  5.28s/it] 83%|████████▎ | 83/100 [07:24<01:21,  4.82s/it] 84%|████████▍ | 84/100 [07:29<01:17,  4.84s/it] 85%|████████▌ | 85/100 [07:38<01:29,  5.96s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2542 / 0.2376 / 0.9836 / 0.1207/ [0.05732484 0.96551724 0.12068966]
 86%|████████▌ | 86/100 [07:43<01:19,  5.69s/it] 87%|████████▋ | 87/100 [07:47<01:07,  5.16s/it] 88%|████████▊ | 88/100 [07:52<01:01,  5.13s/it] 89%|████████▉ | 89/100 [07:55<00:51,  4.72s/it] 90%|█████████ | 90/100 [08:05<01:01,  6.16s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2710 / 0.2559 / 0.9631 / 0.1767/ [0.05732484 0.90804598 0.17672414]
 91%|█████████ | 91/100 [08:09<00:49,  5.45s/it] 92%|█████████▏| 92/100 [08:14<00:42,  5.33s/it] 93%|█████████▎| 93/100 [08:18<00:34,  4.93s/it] 94%|█████████▍| 94/100 [08:23<00:29,  4.94s/it] 95%|█████████▌| 95/100 [08:31<00:29,  5.98s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.3235 / 0.3056 / 0.9631 / 0.2845/ [0.05095541 0.91954023 0.28448276]
 96%|█████████▌| 96/100 [08:36<00:22,  5.67s/it] 97%|█████████▋| 97/100 [08:40<00:15,  5.09s/it] 98%|█████████▊| 98/100 [08:45<00:10,  5.03s/it] 99%|█████████▉| 99/100 [08:49<00:04,  4.69s/it]100%|██████████| 100/100 [08:58<00:00,  6.15s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
                Test acc/f1/spec/sens = 0.2920 / 0.2792 / 0.9631 / 0.2198/ [0.05732484 0.90804598 0.21982759]
Trial 1, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9500 / 0.9345 / 0.9828 / 0.9524/ [0.93333333 0.95348837 0.95238095]
Test acc/f1/spec/sens = 0.2920 / 0.2792 / 0.9631 / 0.2198/ [0.05732484 0.90804598 0.21982759]
>> Finished.
Acc, agreement for latest model:  0.2920168067226891 0.34663865546218486 [0.05732484 0.90804598 0.21982759]
Load best checkpoint for thief model
Acc, agreement for best model:  0.21428571428571427 0.24579831932773108 [0.10191083 0.77011494 0.08189655]
Trial 0/5 || Cycle 1/1 || Label set size 900 || Test acc 0.2143 || Test agreement 0.2458 || Spec 0.8852 || Sens 0.0819 Class Acc: [0.10191083 0.77011494 0.08189655]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:35,  1.57it/s]  7%|▋         | 4/57 [00:00<00:07,  6.73it/s] 12%|█▏        | 7/57 [00:00<00:04, 10.28it/s] 16%|█▌        | 9/57 [00:01<00:03, 12.12it/s] 19%|█▉        | 11/57 [00:01<00:03, 13.79it/s] 25%|██▍       | 14/57 [00:01<00:02, 16.16it/s] 32%|███▏      | 18/57 [00:01<00:02, 18.63it/s] 39%|███▊      | 22/57 [00:01<00:01, 20.38it/s] 44%|████▍     | 25/57 [00:01<00:01, 21.62it/s] 49%|████▉     | 28/57 [00:01<00:01, 21.50it/s] 54%|█████▍    | 31/57 [00:02<00:01, 20.17it/s] 60%|█████▉    | 34/57 [00:02<00:01, 20.95it/s] 65%|██████▍   | 37/57 [00:02<00:00, 21.76it/s] 70%|███████   | 40/57 [00:02<00:00, 23.12it/s] 75%|███████▌  | 43/57 [00:02<00:00, 22.04it/s] 81%|████████  | 46/57 [00:02<00:00, 23.52it/s] 86%|████████▌ | 49/57 [00:02<00:00, 24.64it/s] 91%|█████████ | 52/57 [00:02<00:00, 24.41it/s] 96%|█████████▋| 55/57 [00:03<00:00, 23.36it/s]100%|██████████| 57/57 [00:03<00:00, 17.48it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:04,  1.44it/s] 71%|███████▏  | 5/7 [00:00<00:00,  7.26it/s]100%|██████████| 7/7 [00:01<00:00,  5.97it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2197, -1.2359, -1.2117]), tensor([0.8519, 0.8472, 0.8549]))
Val set stats: mean/std =  (tensor([-1.2302, -1.2481, -1.2211]), tensor([0.8397, 0.8347, 0.8430]))
Validation set distribution: 
Number of samples  100
{0: 15, 1: 48, 2: 37}
Labeled set distribution: 
Number of samples  900
{0: 156, 1: 384, 2: 360}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.4307, agreement = 0.4370, f1 = 0.3140, spec = 0.5451, sens = 0.5129 Class Acc: [0.5477707  0.         0.51293103]
Initial model on validation dataset: acc = 0.4100, agreement = 0.4100, f1 = 0.3035, spec = 0.2222, sens = 0.9459 Class Acc: [0.2        0.0625     0.94594595]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:24,  3.88s/it]  2%|▏         | 2/100 [00:09<07:40,  4.70s/it]  3%|▎         | 3/100 [00:12<06:56,  4.30s/it]  4%|▍         | 4/100 [00:18<07:36,  4.76s/it]  5%|▌         | 5/100 [00:26<09:40,  6.11s/it]Epoch 5: Train acc/f1 = 0.9344 / 0.9154 / 0.9481 / 0.9639/ [0.82692308 0.95052083 0.96388889] 
                Val acc/f1/spec/sens = 0.8800 / 0.8379 / 0.9683 / 0.8108/ [0.8        0.95833333 0.81081081]
                Test acc/f1/spec/sens = 0.3214 / 0.3132 / 0.9713 / 0.1466/ [0.21019108 0.98850575 0.14655172]
  6%|▌         | 6/100 [00:32<09:08,  5.83s/it]  7%|▋         | 7/100 [00:36<08:02,  5.19s/it]  8%|▊         | 8/100 [00:40<07:48,  5.09s/it]  9%|▉         | 9/100 [00:44<07:05,  4.67s/it] 10%|█         | 10/100 [00:54<09:30,  6.34s/it]Epoch 10: Train acc/f1 = 0.9700 / 0.9615 / 0.9870 / 0.9944/ [0.96794872 0.94791667 0.99444444] 
                Val acc/f1/spec/sens = 0.9300 / 0.8962 / 0.9683 / 0.9459/ [0.8        0.95833333 0.94594595]
                Test acc/f1/spec/sens = 0.2962 / 0.2751 / 0.9385 / 0.1983/ [0.05095541 1.         0.19827586]
 11%|█         | 11/100 [00:58<08:12,  5.53s/it] 12%|█▏        | 12/100 [01:03<07:47,  5.31s/it] 13%|█▎        | 13/100 [01:07<07:03,  4.87s/it] 14%|█▍        | 14/100 [01:12<07:11,  5.02s/it] 15%|█▌        | 15/100 [01:21<08:36,  6.08s/it]Epoch 15: Train acc/f1 = 0.9700 / 0.9597 / 0.9741 / 0.9944/ [0.8974359  0.9765625  0.99444444] 
                Val acc/f1/spec/sens = 0.9300 / 0.9014 / 0.9683 / 0.9459/ [0.8        0.95833333 0.94594595]
                Test acc/f1/spec/sens = 0.6303 / 0.5027 / 0.7459 / 0.9138/ [0.03821656 0.94252874 0.9137931 ]
 16%|█▌        | 16/100 [01:26<08:04,  5.76s/it] 17%|█▋        | 17/100 [01:29<07:11,  5.20s/it] 18%|█▊        | 18/100 [01:35<07:05,  5.18s/it] 19%|█▉        | 19/100 [01:39<06:28,  4.80s/it] 20%|██        | 20/100 [01:48<08:22,  6.29s/it]Epoch 20: Train acc/f1 = 0.9678 / 0.9578 / 0.9574 / 0.9972/ [0.87179487 0.97916667 0.99722222] 
                Val acc/f1/spec/sens = 0.9100 / 0.8665 / 0.9683 / 0.9189/ [0.73333333 0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.6176 / 0.5120 / 0.7869 / 0.8534/ [0.05732484 1.         0.85344828]
 21%|██        | 21/100 [01:52<07:18,  5.55s/it] 22%|██▏       | 22/100 [01:57<07:07,  5.48s/it] 23%|██▎       | 23/100 [02:01<06:25,  5.00s/it] 24%|██▍       | 24/100 [02:06<06:18,  4.98s/it] 25%|██▌       | 25/100 [02:15<07:33,  6.04s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8950 / 0.9683 / 0.9189/ [0.8        0.97916667 0.91891892]
                Test acc/f1/spec/sens = 0.3046 / 0.2843 / 0.9221 / 0.2112/ [0.06369427 0.98850575 0.2112069 ]
 26%|██▌       | 26/100 [02:20<07:03,  5.72s/it] 27%|██▋       | 27/100 [02:23<06:12,  5.10s/it] 28%|██▊       | 28/100 [02:28<06:04,  5.07s/it] 29%|██▉       | 29/100 [02:32<05:34,  4.71s/it] 30%|███       | 30/100 [02:42<07:14,  6.20s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8708 / 0.9683 / 0.8919/ [0.8        0.95833333 0.89189189]
                Test acc/f1/spec/sens = 0.3109 / 0.2886 / 0.9221 / 0.2241/ [0.06369427 0.98850575 0.22413793]
 31%|███       | 31/100 [02:46<06:18,  5.49s/it] 32%|███▏      | 32/100 [02:51<06:02,  5.33s/it] 33%|███▎      | 33/100 [02:55<05:29,  4.92s/it] 34%|███▍      | 34/100 [03:00<05:28,  4.98s/it] 35%|███▌      | 35/100 [03:08<06:35,  6.08s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8962 / 0.9683 / 0.9459/ [0.8        0.95833333 0.94594595]
                Test acc/f1/spec/sens = 0.3319 / 0.3098 / 0.8934 / 0.2716/ [0.05732484 0.98850575 0.27155172]
 36%|███▌      | 36/100 [03:14<06:10,  5.78s/it] 37%|███▋      | 37/100 [03:17<05:28,  5.22s/it] 38%|███▊      | 38/100 [03:22<05:18,  5.14s/it] 39%|███▉      | 39/100 [03:26<04:50,  4.76s/it] 40%|████      | 40/100 [03:36<06:11,  6.19s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.3025 / 0.2785 / 0.9262 / 0.2026/ [0.06369427 1.         0.20258621]
 41%|████      | 41/100 [03:40<05:24,  5.49s/it] 42%|████▏     | 42/100 [03:45<05:06,  5.29s/it] 43%|████▎     | 43/100 [03:48<04:36,  4.85s/it] 44%|████▍     | 44/100 [03:53<04:35,  4.92s/it] 45%|████▌     | 45/100 [04:02<05:29,  5.99s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8962 / 0.9683 / 0.9459/ [0.8        0.95833333 0.94594595]
                Test acc/f1/spec/sens = 0.3151 / 0.2922 / 0.9180 / 0.2328/ [0.05732484 1.         0.23275862]
 46%|████▌     | 46/100 [04:07<05:06,  5.68s/it] 47%|████▋     | 47/100 [04:11<04:32,  5.15s/it] 48%|████▊     | 48/100 [04:16<04:27,  5.14s/it] 49%|████▉     | 49/100 [04:20<04:02,  4.75s/it] 50%|█████     | 50/100 [04:30<05:13,  6.28s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.3193 / 0.2954 / 0.9262 / 0.2371/ [0.06369427 1.         0.23706897]
 51%|█████     | 51/100 [04:34<04:34,  5.60s/it] 52%|█████▏    | 52/100 [04:38<04:18,  5.39s/it] 53%|█████▎    | 53/100 [04:42<03:51,  4.94s/it] 54%|█████▍    | 54/100 [04:47<03:47,  4.94s/it] 55%|█████▌    | 55/100 [04:56<04:32,  6.06s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.2899 / 0.2689 / 0.9344 / 0.1767/ [0.06369427 1.         0.17672414]
 56%|█████▌    | 56/100 [05:01<04:12,  5.74s/it] 57%|█████▋    | 57/100 [05:05<03:42,  5.17s/it] 58%|█████▊    | 58/100 [05:10<03:33,  5.10s/it] 59%|█████▉    | 59/100 [05:14<03:14,  4.73s/it] 60%|██████    | 60/100 [05:23<04:10,  6.26s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.2941 / 0.2682 / 0.9426 / 0.1897/ [0.05732484 1.         0.18965517]
 61%|██████    | 61/100 [05:27<03:36,  5.55s/it] 62%|██████▏   | 62/100 [05:32<03:22,  5.32s/it] 63%|██████▎   | 63/100 [05:36<02:58,  4.83s/it] 64%|██████▍   | 64/100 [05:41<02:55,  4.86s/it] 65%|██████▌   | 65/100 [05:49<03:28,  5.96s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.3088 / 0.2879 / 0.9262 / 0.2155/ [0.06369427 1.         0.21551724]
 66%|██████▌   | 66/100 [05:54<03:11,  5.63s/it] 67%|██████▋   | 67/100 [05:58<02:46,  5.06s/it] 68%|██████▊   | 68/100 [06:03<02:42,  5.07s/it] 69%|██████▉   | 69/100 [06:07<02:24,  4.67s/it] 70%|███████   | 70/100 [06:16<03:05,  6.17s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.3214 / 0.2949 / 0.9221 / 0.2457/ [0.05732484 1.         0.24568966]
 71%|███████   | 71/100 [06:20<02:37,  5.45s/it] 72%|███████▏  | 72/100 [06:25<02:28,  5.29s/it] 73%|███████▎  | 73/100 [06:29<02:11,  4.86s/it] 74%|███████▍  | 74/100 [06:34<02:07,  4.91s/it] 75%|███████▌  | 75/100 [06:43<02:31,  6.06s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.2962 / 0.2760 / 0.9344 / 0.1897/ [0.06369427 1.         0.18965517]
 76%|███████▌  | 76/100 [06:48<02:17,  5.72s/it] 77%|███████▋  | 77/100 [06:51<01:58,  5.14s/it] 78%|███████▊  | 78/100 [06:56<01:51,  5.09s/it] 79%|███████▉  | 79/100 [07:00<01:38,  4.71s/it] 80%|████████  | 80/100 [07:10<02:03,  6.18s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.3067 / 0.2879 / 0.9221 / 0.2112/ [0.06369427 1.         0.2112069 ]
 81%|████████  | 81/100 [07:14<01:44,  5.47s/it] 82%|████████▏ | 82/100 [07:19<01:35,  5.31s/it] 83%|████████▎ | 83/100 [07:22<01:22,  4.84s/it] 84%|████████▍ | 84/100 [07:27<01:18,  4.91s/it] 85%|████████▌ | 85/100 [07:36<01:29,  5.96s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.8962 / 0.9683 / 0.9459/ [0.8        0.95833333 0.94594595]
                Test acc/f1/spec/sens = 0.3340 / 0.3090 / 0.9221 / 0.2672/ [0.06369427 1.         0.26724138]
 86%|████████▌ | 86/100 [07:41<01:19,  5.68s/it] 87%|████████▋ | 87/100 [07:45<01:06,  5.12s/it] 88%|████████▊ | 88/100 [07:49<01:00,  5.04s/it] 89%|████████▉ | 89/100 [07:53<00:51,  4.68s/it] 90%|█████████ | 90/100 [08:03<01:02,  6.20s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.3046 / 0.2837 / 0.9262 / 0.2069/ [0.06369427 1.         0.20689655]
 91%|█████████ | 91/100 [08:07<00:49,  5.50s/it] 92%|█████████▏| 92/100 [08:12<00:42,  5.29s/it] 93%|█████████▎| 93/100 [08:16<00:34,  4.87s/it] 94%|█████████▍| 94/100 [08:21<00:29,  4.91s/it] 95%|█████████▌| 95/100 [08:29<00:29,  5.96s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.3235 / 0.3016 / 0.9221 / 0.2457/ [0.06369427 1.         0.24568966]
 96%|█████████▌| 96/100 [08:34<00:22,  5.70s/it] 97%|█████████▋| 97/100 [08:38<00:15,  5.16s/it] 98%|█████████▊| 98/100 [08:43<00:10,  5.08s/it] 99%|█████████▉| 99/100 [08:47<00:04,  4.71s/it]100%|██████████| 100/100 [08:56<00:00,  6.19s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
                Test acc/f1/spec/sens = 0.2941 / 0.2727 / 0.9344 / 0.1853/ [0.06369427 1.         0.18534483]
Trial 2, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9200 / 0.8833 / 0.9683 / 0.9189/ [0.8        0.95833333 0.91891892]
Test acc/f1/spec/sens = 0.2941 / 0.2727 / 0.9344 / 0.1853/ [0.06369427 1.         0.18534483]
>> Finished.
Acc, agreement for latest model:  0.29411764705882354 0.36554621848739494 [0.06369427 1.         0.18534483]
Load best checkpoint for thief model
Acc, agreement for best model:  0.32983193277310924 0.38865546218487396 [0.05732484 1.         0.26293103]
Trial 1/5 || Cycle 1/1 || Label set size 900 || Test acc 0.3298 || Test agreement 0.3887 || Spec 0.8484 || Sens 0.2629 Class Acc: [0.05732484 1.         0.26293103]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:40,  1.38it/s]  9%|▉         | 5/57 [00:00<00:07,  6.52it/s] 16%|█▌        | 9/57 [00:01<00:04, 10.97it/s] 23%|██▎       | 13/57 [00:01<00:03, 14.67it/s] 30%|██▉       | 17/57 [00:01<00:02, 17.36it/s] 35%|███▌      | 20/57 [00:01<00:01, 19.68it/s] 42%|████▏     | 24/57 [00:01<00:01, 21.95it/s] 47%|████▋     | 27/57 [00:01<00:01, 23.42it/s] 53%|█████▎    | 30/57 [00:01<00:01, 21.34it/s] 58%|█████▊    | 33/57 [00:02<00:01, 19.97it/s] 63%|██████▎   | 36/57 [00:02<00:01, 20.01it/s] 70%|███████   | 40/57 [00:02<00:00, 19.57it/s] 77%|███████▋  | 44/57 [00:02<00:00, 19.88it/s] 84%|████████▍ | 48/57 [00:02<00:00, 20.33it/s] 91%|█████████ | 52/57 [00:03<00:00, 21.09it/s] 98%|█████████▊| 56/57 [00:03<00:00, 21.90it/s]100%|██████████| 57/57 [00:03<00:00, 16.41it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.54it/s] 57%|█████▋    | 4/7 [00:00<00:00,  5.45it/s]100%|██████████| 7/7 [00:01<00:00,  6.23it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2121, -1.2286, -1.2041]), tensor([0.8553, 0.8504, 0.8584]))
Val set stats: mean/std =  (tensor([-1.1749, -1.1935, -1.1652]), tensor([0.8706, 0.8670, 0.8731]))
Validation set distribution: 
Number of samples  100
{0: 21, 1: 38, 2: 41}
Labeled set distribution: 
Number of samples  900
{0: 146, 1: 403, 2: 351}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.3298, agreement = 0.3655, f1 = 0.2653, spec = 0.6967, sens = 0.4224 Class Acc: [0.00636943 0.66666667 0.42241379]
Initial model on validation dataset: acc = 0.3700, agreement = 0.3700, f1 = 0.2163, spec = 0.8814, sens = 0.0732 Class Acc: [0.         0.89473684 0.07317073]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:12,  3.77s/it]  2%|▏         | 2/100 [00:08<07:26,  4.56s/it]  3%|▎         | 3/100 [00:12<06:50,  4.23s/it]  4%|▍         | 4/100 [00:18<07:30,  4.70s/it]  5%|▌         | 5/100 [00:26<09:32,  6.02s/it]Epoch 5: Train acc/f1 = 0.9300 / 0.9110 / 0.9891 / 0.9003/ [0.96575342 0.94292804 0.9002849 ] 
                Val acc/f1/spec/sens = 0.8900 / 0.8799 / 0.9831 / 0.8780/ [0.95238095 0.86842105 0.87804878]
                Test acc/f1/spec/sens = 0.2815 / 0.2511 / 0.9672 / 0.1466/ [0.08280255 1.         0.14655172]
  6%|▌         | 6/100 [00:31<09:06,  5.81s/it]  7%|▋         | 7/100 [00:35<07:57,  5.13s/it]  8%|▊         | 8/100 [00:41<08:01,  5.23s/it]  9%|▉         | 9/100 [00:44<07:12,  4.76s/it] 10%|█         | 10/100 [00:54<09:19,  6.22s/it]Epoch 10: Train acc/f1 = 0.9333 / 0.9026 / 0.9290 / 0.9630/ [0.69863014 0.99255583 0.96296296] 
                Val acc/f1/spec/sens = 0.9000 / 0.8715 / 0.8983 / 1.0000/ [0.66666667 0.92105263 1.        ]
                Test acc/f1/spec/sens = 0.4706 / 0.4177 / 0.9262 / 0.5560/ [0.05095541 1.         0.55603448]
 11%|█         | 11/100 [00:57<08:04,  5.44s/it] 12%|█▏        | 12/100 [01:02<07:45,  5.29s/it] 13%|█▎        | 13/100 [01:06<07:01,  4.84s/it] 14%|█▍        | 14/100 [01:11<06:58,  4.87s/it] 15%|█▌        | 15/100 [01:20<08:34,  6.05s/it]Epoch 15: Train acc/f1 = 0.9733 / 0.9634 / 0.9763 / 0.9915/ [0.87671233 0.99255583 0.99145299] 
                Val acc/f1/spec/sens = 0.8900 / 0.8740 / 1.0000 / 0.8780/ [0.85714286 0.92105263 0.87804878]
                Test acc/f1/spec/sens = 0.6071 / 0.4968 / 0.8770 / 0.8362/ [0.05095541 1.         0.8362069 ]
 16%|█▌        | 16/100 [01:25<07:58,  5.69s/it] 17%|█▋        | 17/100 [01:29<07:04,  5.11s/it] 18%|█▊        | 18/100 [01:34<06:55,  5.07s/it] 19%|█▉        | 19/100 [01:37<06:20,  4.70s/it] 20%|██        | 20/100 [01:47<08:14,  6.19s/it]Epoch 20: Train acc/f1 = 0.9389 / 0.9218 / 0.9945 / 0.8860/ [0.97945205 0.97022333 0.88603989] 
                Val acc/f1/spec/sens = 0.9100 / 0.8989 / 1.0000 / 0.9024/ [0.95238095 0.89473684 0.90243902]
                Test acc/f1/spec/sens = 0.3067 / 0.2904 / 0.9549 / 0.1164/ [0.21019108 0.98850575 0.11637931]
 21%|██        | 21/100 [01:51<07:13,  5.48s/it] 22%|██▏       | 22/100 [01:56<06:58,  5.37s/it] 23%|██▎       | 23/100 [02:00<06:18,  4.91s/it] 24%|██▍       | 24/100 [02:05<06:12,  4.90s/it] 25%|██▌       | 25/100 [02:13<07:28,  5.98s/it]Epoch 25: Train acc/f1 = 0.9944 / 0.9934 / 0.9982 / 0.9886/ [1.         0.99751861 0.98860399] 
                Val acc/f1/spec/sens = 0.9000 / 0.8829 / 0.9661 / 0.9512/ [0.80952381 0.89473684 0.95121951]
                Test acc/f1/spec/sens = 0.3025 / 0.2723 / 0.9385 / 0.2026/ [0.06369427 1.         0.20258621]
 26%|██▌       | 26/100 [02:18<06:59,  5.67s/it] 27%|██▋       | 27/100 [02:22<06:12,  5.10s/it] 28%|██▊       | 28/100 [02:27<06:03,  5.05s/it] 29%|██▉       | 29/100 [02:31<05:31,  4.68s/it] 30%|███       | 30/100 [02:40<07:14,  6.21s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.2836 / 0.2482 / 0.9426 / 0.1595/ [0.07006369 1.         0.15948276]
 31%|███       | 31/100 [02:44<06:17,  5.47s/it] 32%|███▏      | 32/100 [02:49<06:02,  5.33s/it] 33%|███▎      | 33/100 [02:53<05:26,  4.88s/it] 34%|███▍      | 34/100 [02:58<05:23,  4.91s/it] 35%|███▌      | 35/100 [03:06<06:29,  5.99s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.2983 / 0.2625 / 0.9344 / 0.1940/ [0.06369427 1.         0.19396552]
 36%|███▌      | 36/100 [03:12<06:04,  5.70s/it] 37%|███▋      | 37/100 [03:16<05:29,  5.22s/it] 38%|███▊      | 38/100 [03:21<05:20,  5.16s/it] 39%|███▉      | 39/100 [03:24<04:50,  4.77s/it] 40%|████      | 40/100 [03:34<06:18,  6.31s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8916 / 0.9831 / 0.9512/ [0.80952381 0.92105263 0.95121951]
                Test acc/f1/spec/sens = 0.2668 / 0.2337 / 0.9467 / 0.0991/ [0.10828025 1.         0.09913793]
 41%|████      | 41/100 [03:38<05:29,  5.58s/it] 42%|████▏     | 42/100 [03:43<05:12,  5.39s/it] 43%|████▎     | 43/100 [03:47<04:41,  4.94s/it] 44%|████▍     | 44/100 [03:52<04:41,  5.03s/it] 45%|████▌     | 45/100 [04:01<05:31,  6.03s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.2878 / 0.2583 / 0.9426 / 0.1422/ [0.10828025 1.         0.14224138]
 46%|████▌     | 46/100 [04:05<05:05,  5.65s/it] 47%|████▋     | 47/100 [04:09<04:29,  5.08s/it] 48%|████▊     | 48/100 [04:14<04:20,  5.02s/it] 49%|████▉     | 49/100 [04:18<03:55,  4.63s/it] 50%|█████     | 50/100 [04:27<05:04,  6.09s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.3235 / 0.3033 / 0.9221 / 0.1897/ [0.14649682 1.         0.18965517]
 51%|█████     | 51/100 [04:31<04:23,  5.39s/it] 52%|█████▏    | 52/100 [04:36<04:12,  5.27s/it] 53%|█████▎    | 53/100 [04:40<03:46,  4.83s/it] 54%|█████▍    | 54/100 [04:45<03:44,  4.89s/it] 55%|█████▌    | 55/100 [04:53<04:28,  5.96s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.2668 / 0.2314 / 0.9467 / 0.1164/ [0.08280255 1.         0.11637931]
 56%|█████▌    | 56/100 [04:58<04:09,  5.67s/it] 57%|█████▋    | 57/100 [05:02<03:40,  5.12s/it] 58%|█████▊    | 58/100 [05:07<03:33,  5.08s/it] 59%|█████▉    | 59/100 [05:11<03:11,  4.68s/it] 60%|██████    | 60/100 [05:21<04:09,  6.24s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.2878 / 0.2585 / 0.9426 / 0.1422/ [0.10828025 1.         0.14224138]
 61%|██████    | 61/100 [05:25<03:36,  5.55s/it] 62%|██████▏   | 62/100 [05:30<03:25,  5.41s/it] 63%|██████▎   | 63/100 [05:34<03:03,  4.97s/it] 64%|██████▍   | 64/100 [05:39<02:59,  4.98s/it] 65%|██████▌   | 65/100 [05:47<03:32,  6.07s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.2710 / 0.2356 / 0.9467 / 0.1293/ [0.07643312 1.         0.12931034]
 66%|██████▌   | 66/100 [05:52<03:14,  5.73s/it] 67%|██████▋   | 67/100 [05:56<02:51,  5.18s/it] 68%|██████▊   | 68/100 [06:01<02:44,  5.13s/it] 69%|██████▉   | 69/100 [06:05<02:26,  4.72s/it] 70%|███████   | 70/100 [06:15<03:05,  6.17s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8916 / 0.9831 / 0.9512/ [0.80952381 0.92105263 0.95121951]
                Test acc/f1/spec/sens = 0.2815 / 0.2517 / 0.9467 / 0.1336/ [0.10191083 1.         0.13362069]
 71%|███████   | 71/100 [06:18<02:38,  5.47s/it] 72%|███████▏  | 72/100 [06:23<02:28,  5.32s/it] 73%|███████▎  | 73/100 [06:27<02:12,  4.90s/it] 74%|███████▍  | 74/100 [06:32<02:06,  4.87s/it] 75%|███████▌  | 75/100 [06:40<02:27,  5.92s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.2710 / 0.2354 / 0.9467 / 0.1250/ [0.08280255 1.         0.125     ]
 76%|███████▌  | 76/100 [06:45<02:14,  5.61s/it] 77%|███████▋  | 77/100 [06:49<01:56,  5.05s/it] 78%|███████▊  | 78/100 [06:54<01:50,  5.02s/it] 79%|███████▉  | 79/100 [06:58<01:37,  4.66s/it] 80%|████████  | 80/100 [07:07<02:02,  6.13s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.3193 / 0.2931 / 0.9221 / 0.2026/ [0.11464968 1.         0.20258621]
 81%|████████  | 81/100 [07:11<01:43,  5.47s/it] 82%|████████▏ | 82/100 [07:16<01:34,  5.26s/it] 83%|████████▎ | 83/100 [07:20<01:21,  4.79s/it] 84%|████████▍ | 84/100 [07:25<01:16,  4.80s/it] 85%|████████▌ | 85/100 [07:33<01:27,  5.81s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.3109 / 0.2863 / 0.9221 / 0.1767/ [0.12738854 1.         0.17672414]
 86%|████████▌ | 86/100 [07:38<01:18,  5.59s/it] 87%|████████▋ | 87/100 [07:42<01:05,  5.04s/it] 88%|████████▊ | 88/100 [07:47<01:00,  5.01s/it] 89%|████████▉ | 89/100 [07:50<00:51,  4.68s/it] 90%|█████████ | 90/100 [08:00<01:00,  6.08s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.2794 / 0.2471 / 0.9467 / 0.1336/ [0.0955414  1.         0.13362069]
 91%|█████████ | 91/100 [08:04<00:48,  5.42s/it] 92%|█████████▏| 92/100 [08:09<00:42,  5.29s/it] 93%|█████████▎| 93/100 [08:12<00:33,  4.83s/it] 94%|█████████▍| 94/100 [08:18<00:29,  4.91s/it] 95%|█████████▌| 95/100 [08:26<00:29,  5.94s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.9021 / 0.9831 / 0.9756/ [0.80952381 0.92105263 0.97560976]
                Test acc/f1/spec/sens = 0.2710 / 0.2405 / 0.9467 / 0.0991/ [0.12101911 1.         0.09913793]
 96%|█████████▌| 96/100 [08:31<00:22,  5.58s/it] 97%|█████████▋| 97/100 [08:34<00:15,  5.07s/it] 98%|█████████▊| 98/100 [08:39<00:10,  5.04s/it] 99%|█████████▉| 99/100 [08:43<00:04,  4.65s/it]100%|██████████| 100/100 [08:53<00:00,  6.08s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8916 / 0.9831 / 0.9512/ [0.80952381 0.92105263 0.95121951]
                Test acc/f1/spec/sens = 0.2941 / 0.2690 / 0.9385 / 0.1336/ [0.14012739 1.         0.13362069]
Trial 3, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9100 / 0.8916 / 0.9831 / 0.9512/ [0.80952381 0.92105263 0.95121951]
Test acc/f1/spec/sens = 0.2941 / 0.2690 / 0.9385 / 0.1336/ [0.14012739 1.         0.13362069]
>> Finished.
Acc, agreement for latest model:  0.29411764705882354 0.3592436974789916 [0.14012739 1.         0.13362069]
Load best checkpoint for thief model
Acc, agreement for best model:  0.3739495798319328 0.44537815126050423 [0.06369427 1.         0.34913793]
Trial 2/5 || Cycle 1/1 || Label set size 900 || Test acc 0.3739 || Test agreement 0.4454 || Spec 0.8934 || Sens 0.3491 Class Acc: [0.06369427 1.         0.34913793]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:36,  1.55it/s]  7%|▋         | 4/57 [00:00<00:08,  6.58it/s] 11%|█         | 6/57 [00:00<00:05,  8.94it/s] 16%|█▌        | 9/57 [00:01<00:03, 12.31it/s] 23%|██▎       | 13/57 [00:01<00:02, 15.13it/s] 30%|██▉       | 17/57 [00:01<00:02, 18.06it/s] 37%|███▋      | 21/57 [00:01<00:01, 21.40it/s] 44%|████▍     | 25/57 [00:01<00:01, 22.43it/s] 49%|████▉     | 28/57 [00:01<00:01, 23.49it/s] 54%|█████▍    | 31/57 [00:01<00:01, 20.92it/s] 60%|█████▉    | 34/57 [00:02<00:01, 21.67it/s] 65%|██████▍   | 37/57 [00:02<00:01, 19.18it/s] 70%|███████   | 40/57 [00:02<00:00, 20.89it/s] 75%|███████▌  | 43/57 [00:02<00:00, 19.20it/s] 82%|████████▏ | 47/57 [00:02<00:00, 19.73it/s] 89%|████████▉ | 51/57 [00:02<00:00, 21.10it/s] 96%|█████████▋| 55/57 [00:03<00:00, 21.73it/s]100%|██████████| 57/57 [00:03<00:00, 16.85it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:03,  1.52it/s] 71%|███████▏  | 5/7 [00:00<00:00,  7.33it/s]100%|██████████| 7/7 [00:01<00:00,  6.61it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2045, -1.2207, -1.1966]), tensor([0.8568, 0.8523, 0.8596]))
Val set stats: mean/std =  (tensor([-1.2455, -1.2585, -1.2387]), tensor([0.8356, 0.8314, 0.8385]))
Validation set distribution: 
Number of samples  100
{0: 15, 1: 40, 2: 45}
Labeled set distribution: 
Number of samples  900
{0: 151, 1: 395, 2: 354}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.3592, agreement = 0.3466, f1 = 0.2962, spec = 0.9262, sens = 0.1767 Class Acc: [0.76433121 0.11494253 0.17672414]
Initial model on validation dataset: acc = 0.5900, agreement = 0.5900, f1 = 0.5325, spec = 0.4364, sens = 0.9111 Class Acc: [0.6        0.225      0.91111111]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:09,  3.73s/it]  2%|▏         | 2/100 [00:08<07:30,  4.59s/it]  3%|▎         | 3/100 [00:12<06:52,  4.25s/it]  4%|▍         | 4/100 [00:18<07:30,  4.70s/it]  5%|▌         | 5/100 [00:26<09:43,  6.14s/it]Epoch 5: Train acc/f1 = 0.9311 / 0.9136 / 0.9615 / 0.9294/ [0.86092715 0.95949367 0.92937853] 
                Val acc/f1/spec/sens = 0.8800 / 0.8544 / 1.0000 / 0.8444/ [1.         0.875      0.84444444]
                Test acc/f1/spec/sens = 0.2584 / 0.2260 / 0.9508 / 0.0862/ [0.10191083 1.         0.0862069 ]
  6%|▌         | 6/100 [00:31<09:02,  5.77s/it]  7%|▋         | 7/100 [00:35<07:58,  5.14s/it]  8%|▊         | 8/100 [00:40<07:49,  5.10s/it]  9%|▉         | 9/100 [00:44<07:09,  4.72s/it] 10%|█         | 10/100 [00:54<09:34,  6.38s/it]Epoch 10: Train acc/f1 = 0.9222 / 0.9052 / 0.9890 / 0.8955/ [0.97350993 0.92658228 0.89548023] 
                Val acc/f1/spec/sens = 0.9300 / 0.9079 / 1.0000 / 0.9333/ [1.         0.9        0.93333333]
                Test acc/f1/spec/sens = 0.2626 / 0.2324 / 0.9713 / 0.0776/ [0.13375796 0.98850575 0.07758621]
 11%|█         | 11/100 [00:58<08:17,  5.59s/it] 12%|█▏        | 12/100 [01:03<08:06,  5.53s/it] 13%|█▎        | 13/100 [01:07<07:12,  4.97s/it] 14%|█▍        | 14/100 [01:12<07:07,  4.97s/it] 15%|█▌        | 15/100 [01:21<08:31,  6.01s/it]Epoch 15: Train acc/f1 = 0.9722 / 0.9636 / 0.9817 / 0.9746/ [0.92715232 0.98734177 0.97457627] 
                Val acc/f1/spec/sens = 0.9200 / 0.8893 / 0.9818 / 0.9333/ [0.86666667 0.925      0.93333333]
                Test acc/f1/spec/sens = 0.4538 / 0.3945 / 0.8402 / 0.6034/ [0.05732484 0.77011494 0.60344828]
 16%|█▌        | 16/100 [01:25<07:56,  5.67s/it] 17%|█▋        | 17/100 [01:29<07:04,  5.11s/it] 18%|█▊        | 18/100 [01:34<06:55,  5.06s/it] 19%|█▉        | 19/100 [01:38<06:22,  4.72s/it] 20%|██        | 20/100 [01:48<08:12,  6.16s/it]Epoch 20: Train acc/f1 = 0.9700 / 0.9639 / 0.9799 / 0.9774/ [0.96688742 0.96455696 0.97740113] 
                Val acc/f1/spec/sens = 0.9400 / 0.9236 / 0.9818 / 0.9556/ [1.         0.9        0.95555556]
                Test acc/f1/spec/sens = 0.3130 / 0.3033 / 0.8443 / 0.3147/ [0.05732484 0.77011494 0.31465517]
 21%|██        | 21/100 [01:51<07:06,  5.40s/it] 22%|██▏       | 22/100 [01:56<06:52,  5.29s/it] 23%|██▎       | 23/100 [02:00<06:12,  4.83s/it] 24%|██▍       | 24/100 [02:05<06:08,  4.85s/it] 25%|██▌       | 25/100 [02:13<07:23,  5.91s/it]Epoch 25: Train acc/f1 = 0.9989 / 0.9991 / 0.9982 / 1.0000/ [1.         0.99746835 1.        ] 
                Val acc/f1/spec/sens = 0.9000 / 0.8734 / 0.9818 / 0.9111/ [0.93333333 0.875      0.91111111]
                Test acc/f1/spec/sens = 0.3193 / 0.3027 / 0.9221 / 0.2414/ [0.05732484 1.         0.24137931]
 26%|██▌       | 26/100 [02:18<06:59,  5.66s/it] 27%|██▋       | 27/100 [02:22<06:13,  5.11s/it] 28%|██▊       | 28/100 [02:27<06:05,  5.07s/it] 29%|██▉       | 29/100 [02:31<05:33,  4.69s/it] 30%|███       | 30/100 [02:41<07:13,  6.19s/it]Epoch 30: Train acc/f1 = 0.9989 / 0.9985 / 1.0000 / 1.0000/ [0.99337748 1.         1.        ] 
                Val acc/f1/spec/sens = 0.9100 / 0.8856 / 0.9818 / 0.8889/ [0.93333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3151 / 0.3008 / 0.9221 / 0.2328/ [0.05732484 1.         0.23275862]
 31%|███       | 31/100 [02:45<06:18,  5.48s/it] 32%|███▏      | 32/100 [02:50<06:05,  5.38s/it] 33%|███▎      | 33/100 [02:54<05:30,  4.94s/it] 34%|███▍      | 34/100 [02:59<05:29,  4.99s/it] 35%|███▌      | 35/100 [03:07<06:28,  5.98s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8856 / 0.9818 / 0.8889/ [0.93333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3803 / 0.3551 / 0.8934 / 0.3922/ [0.05732484 0.93103448 0.39224138]
 36%|███▌      | 36/100 [03:12<06:05,  5.70s/it] 37%|███▋      | 37/100 [03:16<05:22,  5.12s/it] 38%|███▊      | 38/100 [03:21<05:11,  5.03s/it] 39%|███▉      | 39/100 [03:24<04:44,  4.66s/it] 40%|████      | 40/100 [03:34<06:04,  6.08s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8971 / 0.9818 / 0.9111/ [0.93333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.3592 / 0.3381 / 0.9221 / 0.3233/ [0.05732484 1.         0.32327586]
 41%|████      | 41/100 [03:38<05:18,  5.40s/it] 42%|████▏     | 42/100 [03:43<05:05,  5.27s/it] 43%|████▎     | 43/100 [03:46<04:36,  4.85s/it] 44%|████▍     | 44/100 [03:51<04:34,  4.90s/it] 45%|████▌     | 45/100 [04:00<05:28,  5.98s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8971 / 0.9818 / 0.9111/ [0.93333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.3445 / 0.3248 / 0.9221 / 0.2931/ [0.05732484 1.         0.29310345]
 46%|████▌     | 46/100 [04:05<05:05,  5.65s/it] 47%|████▋     | 47/100 [04:09<04:30,  5.10s/it] 48%|████▊     | 48/100 [04:14<04:22,  5.05s/it] 49%|████▉     | 49/100 [04:18<04:00,  4.72s/it] 50%|█████     | 50/100 [04:27<05:05,  6.11s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8971 / 0.9818 / 0.9111/ [0.93333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.3697 / 0.3478 / 0.9180 / 0.3448/ [0.05732484 1.         0.34482759]
 51%|█████     | 51/100 [04:31<04:25,  5.42s/it] 52%|█████▏    | 52/100 [04:36<04:13,  5.29s/it] 53%|█████▎    | 53/100 [04:40<03:49,  4.88s/it] 54%|█████▍    | 54/100 [04:44<03:44,  4.87s/it] 55%|█████▌    | 55/100 [04:53<04:30,  6.02s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8971 / 0.9818 / 0.9111/ [0.93333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.3403 / 0.3232 / 0.9221 / 0.2845/ [0.05732484 1.         0.28448276]
 56%|█████▌    | 56/100 [04:58<04:09,  5.68s/it] 57%|█████▋    | 57/100 [05:02<03:41,  5.15s/it] 58%|█████▊    | 58/100 [05:07<03:35,  5.12s/it] 59%|█████▉    | 59/100 [05:11<03:13,  4.73s/it] 60%|██████    | 60/100 [05:21<04:09,  6.24s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8856 / 0.9818 / 0.8889/ [0.93333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3634 / 0.3407 / 0.9221 / 0.3319/ [0.05732484 1.         0.33189655]
 61%|██████    | 61/100 [05:25<03:36,  5.55s/it] 62%|██████▏   | 62/100 [05:30<03:24,  5.38s/it] 63%|██████▎   | 63/100 [05:33<03:03,  4.95s/it] 64%|██████▍   | 64/100 [05:39<02:59,  4.99s/it] 65%|██████▌   | 65/100 [05:47<03:32,  6.07s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8856 / 0.9818 / 0.8889/ [0.93333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3634 / 0.3403 / 0.9180 / 0.3319/ [0.05732484 1.         0.33189655]
 66%|██████▌   | 66/100 [05:52<03:14,  5.72s/it] 67%|██████▋   | 67/100 [05:56<02:49,  5.13s/it] 68%|██████▊   | 68/100 [06:01<02:43,  5.11s/it] 69%|██████▉   | 69/100 [06:05<02:25,  4.70s/it] 70%|███████   | 70/100 [06:14<03:05,  6.18s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8971 / 0.9818 / 0.9111/ [0.93333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.3466 / 0.3280 / 0.9221 / 0.2974/ [0.05732484 1.         0.29741379]
 71%|███████   | 71/100 [06:18<02:38,  5.48s/it] 72%|███████▏  | 72/100 [06:23<02:28,  5.30s/it] 73%|███████▎  | 73/100 [06:27<02:10,  4.84s/it] 74%|███████▍  | 74/100 [06:32<02:06,  4.88s/it] 75%|███████▌  | 75/100 [06:40<02:30,  6.01s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9089 / 0.9818 / 0.9333/ [0.93333333 0.925      0.93333333]
                Test acc/f1/spec/sens = 0.3529 / 0.3302 / 0.9221 / 0.3103/ [0.05732484 1.         0.31034483]
 76%|███████▌  | 76/100 [06:45<02:16,  5.69s/it] 77%|███████▋  | 77/100 [06:49<01:58,  5.15s/it] 78%|███████▊  | 78/100 [06:54<01:52,  5.11s/it] 79%|███████▉  | 79/100 [06:58<01:38,  4.71s/it] 80%|████████  | 80/100 [07:08<02:04,  6.22s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8856 / 0.9818 / 0.8889/ [0.93333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3445 / 0.3234 / 0.9221 / 0.2931/ [0.05732484 1.         0.29310345]
 81%|████████  | 81/100 [07:12<01:44,  5.51s/it] 82%|████████▏ | 82/100 [07:17<01:37,  5.39s/it] 83%|████████▎ | 83/100 [07:21<01:24,  4.95s/it] 84%|████████▍ | 84/100 [07:26<01:19,  4.97s/it] 85%|████████▌ | 85/100 [07:34<01:29,  5.99s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9200 / 0.8971 / 0.9818 / 0.9111/ [0.93333333 0.925      0.91111111]
                Test acc/f1/spec/sens = 0.3466 / 0.3277 / 0.9221 / 0.2974/ [0.05732484 1.         0.29741379]
 86%|████████▌ | 86/100 [07:39<01:19,  5.70s/it] 87%|████████▋ | 87/100 [07:43<01:07,  5.16s/it] 88%|████████▊ | 88/100 [07:48<01:01,  5.13s/it] 89%|████████▉ | 89/100 [07:52<00:51,  4.72s/it] 90%|█████████ | 90/100 [08:02<01:02,  6.26s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8851 / 0.9818 / 0.9111/ [0.93333333 0.9        0.91111111]
                Test acc/f1/spec/sens = 0.3529 / 0.3327 / 0.8893 / 0.3405/ [0.05732484 0.91954023 0.34051724]
 91%|█████████ | 91/100 [08:05<00:49,  5.51s/it] 92%|█████████▏| 92/100 [08:10<00:42,  5.32s/it] 93%|█████████▎| 93/100 [08:14<00:33,  4.82s/it] 94%|█████████▍| 94/100 [08:19<00:29,  4.88s/it] 95%|█████████▌| 95/100 [08:27<00:29,  5.98s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8856 / 0.9818 / 0.8889/ [0.93333333 0.925      0.88888889]
                Test acc/f1/spec/sens = 0.3277 / 0.3149 / 0.9098 / 0.2672/ [0.05732484 0.97701149 0.26724138]
 96%|█████████▌| 96/100 [08:33<00:22,  5.72s/it] 97%|█████████▋| 97/100 [08:36<00:15,  5.14s/it] 98%|█████████▊| 98/100 [08:41<00:10,  5.11s/it] 99%|█████████▉| 99/100 [08:45<00:04,  4.76s/it]100%|██████████| 100/100 [08:55<00:00,  6.19s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9300 / 0.9089 / 0.9818 / 0.9333/ [0.93333333 0.925      0.93333333]
                Test acc/f1/spec/sens = 0.3571 / 0.3366 / 0.8975 / 0.3405/ [0.05732484 0.94252874 0.34051724]
Trial 4, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.9300 / 0.9089 / 0.9818 / 0.9333/ [0.93333333 0.925      0.93333333]
Test acc/f1/spec/sens = 0.3571 / 0.3366 / 0.8975 / 0.3405/ [0.05732484 0.94252874 0.34051724]
>> Finished.
Acc, agreement for latest model:  0.35714285714285715 0.4180672268907563 [0.05732484 0.94252874 0.34051724]
Load best checkpoint for thief model
Acc, agreement for best model:  0.4789915966386555 0.5315126050420168 [0.08280255 1.         0.55172414]
Trial 3/5 || Cycle 1/1 || Label set size 900 || Test acc 0.4790 || Test agreement 0.5315 || Spec 0.9262 || Sens 0.5517 Class Acc: [0.08280255 1.         0.55172414]
**************************************************************************************************** 

Number of samples  900
replacing labeled set labels with victim labels
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:37,  1.51it/s]  9%|▉         | 5/57 [00:00<00:06,  7.47it/s] 16%|█▌        | 9/57 [00:00<00:03, 12.63it/s] 21%|██        | 12/57 [00:01<00:03, 13.27it/s] 28%|██▊       | 16/57 [00:01<00:02, 16.51it/s] 33%|███▎      | 19/57 [00:01<00:02, 18.09it/s] 40%|████      | 23/57 [00:01<00:01, 20.93it/s] 46%|████▌     | 26/57 [00:01<00:01, 20.39it/s] 51%|█████     | 29/57 [00:01<00:01, 21.34it/s] 58%|█████▊    | 33/57 [00:02<00:01, 22.73it/s] 63%|██████▎   | 36/57 [00:02<00:00, 23.07it/s] 68%|██████▊   | 39/57 [00:02<00:00, 23.60it/s] 74%|███████▎  | 42/57 [00:02<00:00, 24.18it/s] 79%|███████▉  | 45/57 [00:02<00:00, 21.62it/s] 84%|████████▍ | 48/57 [00:02<00:00, 23.27it/s] 89%|████████▉ | 51/57 [00:02<00:00, 18.99it/s] 95%|█████████▍| 54/57 [00:03<00:00, 19.39it/s]100%|██████████| 57/57 [00:03<00:00, 17.12it/s]
replacing val labels with victim labels
  0%|          | 0/7 [00:00<?, ?it/s] 14%|█▍        | 1/7 [00:00<00:04,  1.50it/s] 71%|███████▏  | 5/7 [00:00<00:00,  7.40it/s]100%|██████████| 7/7 [00:01<00:00,  6.33it/s]
Test set stats: mean/std =  (tensor([-1.2593, -1.2577, -1.2463]), tensor([0.7453, 0.7491, 0.7672]))
Train set stats: mean/std =  (tensor([-1.2218, -1.2375, -1.2143]), tensor([0.8490, 0.8441, 0.8519]))
Val set stats: mean/std =  (tensor([-1.2072, -1.2252, -1.1987]), tensor([0.8647, 0.8585, 0.8686]))
Validation set distribution: 
Number of samples  100
{0: 18, 1: 43, 2: 39}
Labeled set distribution: 
Number of samples  900
{0: 154, 1: 386, 2: 360}
Test set distribution: 
Number of samples  476
{0: 157, 1: 87, 2: 232}
pretrained state:  dict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.bn3.num_batches_tracked', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.0.downsample.1.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.1.bn3.num_batches_tracked', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.bn1.num_batches_tracked', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.bn2.num_batches_tracked', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer1.2.bn3.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.bn3.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.1.bn3.num_batches_tracked', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.bn1.num_batches_tracked', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.bn2.num_batches_tracked', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.2.bn3.num_batches_tracked', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.bn1.num_batches_tracked', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.bn2.num_batches_tracked', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer2.3.bn3.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.bn3.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.1.bn3.num_batches_tracked', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.bn1.num_batches_tracked', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.bn2.num_batches_tracked', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.2.bn3.num_batches_tracked', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.bn1.num_batches_tracked', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.bn2.num_batches_tracked', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.3.bn3.num_batches_tracked', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.bn1.num_batches_tracked', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.bn2.num_batches_tracked', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.4.bn3.num_batches_tracked', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.bn1.num_batches_tracked', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.bn2.num_batches_tracked', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer3.5.bn3.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.bn3.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.1.bn3.num_batches_tracked', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.bn1.num_batches_tracked', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.bn2.num_batches_tracked', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'layer4.2.bn3.num_batches_tracked'])
Thief model initialized successfully
Initial model on target dataset: acc = 0.5861, agreement = 0.5651, f1 = 0.4482, spec = 0.4795, sens = 0.9698 Class Acc: [0.22292994 0.2183908  0.96982759]
Initial model on validation dataset: acc = 0.3700, agreement = 0.3700, f1 = 0.2561, spec = 0.2295, sens = 0.7179 Class Acc: [0.         0.20930233 0.71794872]
la:  None
>> Train a Model.
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:04,  3.69s/it]  2%|▏         | 2/100 [00:08<07:26,  4.55s/it]  3%|▎         | 3/100 [00:12<06:48,  4.21s/it]  4%|▍         | 4/100 [00:17<07:26,  4.65s/it]  5%|▌         | 5/100 [00:26<09:31,  6.01s/it]Epoch 5: Train acc/f1 = 0.9178 / 0.8844 / 0.9574 / 0.9500/ [0.68831169 0.97927461 0.95      ] 
                Val acc/f1/spec/sens = 0.8600 / 0.7937 / 0.9016 / 0.8974/ [0.44444444 1.         0.8974359 ]
                Test acc/f1/spec/sens = 0.3613 / 0.3139 / 0.9877 / 0.3448/ [0.03184713 1.         0.34482759]
  6%|▌         | 6/100 [00:31<08:49,  5.63s/it]  7%|▋         | 7/100 [00:35<07:48,  5.04s/it]  8%|▊         | 8/100 [00:40<07:50,  5.11s/it]  9%|▉         | 9/100 [00:44<07:06,  4.68s/it] 10%|█         | 10/100 [00:53<09:19,  6.22s/it]Epoch 10: Train acc/f1 = 0.9567 / 0.9389 / 0.9648 / 0.9861/ [0.81168831 0.98704663 0.98611111] 
                Val acc/f1/spec/sens = 0.8700 / 0.7886 / 0.8689 / 0.9487/ [0.38888889 1.         0.94871795]
                Test acc/f1/spec/sens = 0.2605 / 0.2177 / 0.9754 / 0.1293/ [0.05095541 0.98850575 0.12931034]
 11%|█         | 11/100 [00:57<08:10,  5.51s/it] 12%|█▏        | 12/100 [01:03<08:03,  5.49s/it] 13%|█▎        | 13/100 [01:06<07:12,  4.98s/it] 14%|█▍        | 14/100 [01:11<07:03,  4.92s/it] 15%|█▌        | 15/100 [01:20<08:27,  5.97s/it]Epoch 15: Train acc/f1 = 0.9689 / 0.9590 / 0.9852 / 0.9639/ [0.94805195 0.98186528 0.96388889] 
                Val acc/f1/spec/sens = 0.8700 / 0.7770 / 0.8852 / 1.0000/ [0.33333333 0.97674419 1.        ]
                Test acc/f1/spec/sens = 0.3550 / 0.3181 / 0.8893 / 0.3017/ [0.07643312 1.         0.30172414]
 16%|█▌        | 16/100 [01:25<07:58,  5.70s/it] 17%|█▋        | 17/100 [01:28<07:03,  5.11s/it] 18%|█▊        | 18/100 [01:33<06:57,  5.09s/it] 19%|█▉        | 19/100 [01:37<06:20,  4.70s/it] 20%|██        | 20/100 [01:47<08:11,  6.14s/it]Epoch 20: Train acc/f1 = 0.9856 / 0.9811 / 0.9981 / 0.9750/ [1.         0.98963731 0.975     ] 
                Val acc/f1/spec/sens = 0.8800 / 0.8532 / 0.9836 / 0.8462/ [0.83333333 0.93023256 0.84615385]
                Test acc/f1/spec/sens = 0.3655 / 0.3217 / 0.9303 / 0.3448/ [0.05095541 0.98850575 0.34482759]
 21%|██        | 21/100 [01:51<07:12,  5.47s/it] 22%|██▏       | 22/100 [01:56<06:57,  5.35s/it] 23%|██▎       | 23/100 [02:00<06:17,  4.90s/it] 24%|██▍       | 24/100 [02:05<06:16,  4.95s/it] 25%|██▌       | 25/100 [02:13<07:28,  5.98s/it]Epoch 25: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8666 / 0.9672 / 0.9231/ [0.72222222 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.4517 / 0.3848 / 0.9221 / 0.5259/ [0.04458599 0.98850575 0.52586207]
 26%|██▌       | 26/100 [02:18<07:05,  5.75s/it] 27%|██▋       | 27/100 [02:22<06:17,  5.18s/it] 28%|██▊       | 28/100 [02:27<06:08,  5.11s/it] 29%|██▉       | 29/100 [02:31<05:37,  4.76s/it] 30%|███       | 30/100 [02:41<07:17,  6.25s/it]Epoch 30: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8709 / 0.9836 / 0.8974/ [0.77777778 0.95348837 0.8974359 ]
                Test acc/f1/spec/sens = 0.4559 / 0.3876 / 0.9098 / 0.5388/ [0.04458599 0.97701149 0.5387931 ]
 31%|███       | 31/100 [02:45<06:20,  5.52s/it] 32%|███▏      | 32/100 [02:50<06:06,  5.39s/it] 33%|███▎      | 33/100 [02:53<05:29,  4.92s/it] 34%|███▍      | 34/100 [02:58<05:26,  4.94s/it] 35%|███▌      | 35/100 [03:07<06:33,  6.06s/it]Epoch 35: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8666 / 0.9672 / 0.9231/ [0.72222222 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.3971 / 0.3443 / 0.9426 / 0.4138/ [0.04458599 0.98850575 0.4137931 ]
 36%|███▌      | 36/100 [03:12<06:10,  5.79s/it] 37%|███▋      | 37/100 [03:16<05:25,  5.17s/it] 38%|███▊      | 38/100 [03:21<05:17,  5.12s/it] 39%|███▉      | 39/100 [03:25<04:49,  4.75s/it] 40%|████      | 40/100 [03:35<06:17,  6.30s/it]Epoch 40: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8270 / 0.9180 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.4328 / 0.3669 / 0.9016 / 0.4957/ [0.03821656 0.97701149 0.49568966]
 41%|████      | 41/100 [03:38<05:24,  5.51s/it] 42%|████▏     | 42/100 [03:43<05:10,  5.35s/it] 43%|████▎     | 43/100 [03:47<04:41,  4.93s/it] 44%|████▍     | 44/100 [03:52<04:36,  4.93s/it] 45%|████▌     | 45/100 [04:01<05:31,  6.03s/it]Epoch 45: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8666 / 0.9672 / 0.9231/ [0.72222222 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.4496 / 0.3799 / 0.9016 / 0.5302/ [0.03821656 0.97701149 0.53017241]
 46%|████▌     | 46/100 [04:06<05:07,  5.70s/it] 47%|████▋     | 47/100 [04:10<04:30,  5.10s/it] 48%|████▊     | 48/100 [04:15<04:23,  5.06s/it] 49%|████▉     | 49/100 [04:18<03:59,  4.70s/it] 50%|█████     | 50/100 [04:28<05:11,  6.23s/it]Epoch 50: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8504 / 0.9508 / 0.9231/ [0.66666667 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.4496 / 0.3843 / 0.8934 / 0.5302/ [0.05095541 0.95402299 0.53017241]
 51%|█████     | 51/100 [04:32<04:27,  5.45s/it] 52%|█████▏    | 52/100 [04:37<04:15,  5.32s/it] 53%|█████▎    | 53/100 [04:41<03:51,  4.93s/it] 54%|█████▍    | 54/100 [04:46<03:46,  4.93s/it] 55%|█████▌    | 55/100 [04:55<04:34,  6.11s/it]Epoch 55: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8700 / 0.8162 / 0.9180 / 0.9231/ [0.55555556 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.3887 / 0.3363 / 0.9180 / 0.4009/ [0.04458599 0.97701149 0.40086207]
 56%|█████▌    | 56/100 [05:00<04:15,  5.81s/it] 57%|█████▋    | 57/100 [05:04<03:44,  5.21s/it] 58%|█████▊    | 58/100 [05:08<03:35,  5.13s/it] 59%|█████▉    | 59/100 [05:12<03:15,  4.77s/it] 60%|██████    | 60/100 [05:22<04:11,  6.29s/it]Epoch 60: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8666 / 0.9672 / 0.9231/ [0.72222222 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.4202 / 0.3646 / 0.9303 / 0.4569/ [0.05095541 0.98850575 0.45689655]
 61%|██████    | 61/100 [05:26<03:36,  5.54s/it] 62%|██████▏   | 62/100 [05:31<03:22,  5.33s/it] 63%|██████▎   | 63/100 [05:35<03:00,  4.88s/it] 64%|██████▍   | 64/100 [05:40<02:55,  4.87s/it] 65%|██████▌   | 65/100 [05:48<03:30,  6.01s/it]Epoch 65: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8780 / 0.9672 / 0.9487/ [0.72222222 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.3445 / 0.2998 / 0.9467 / 0.3060/ [0.04458599 0.98850575 0.30603448]
 66%|██████▌   | 66/100 [05:53<03:15,  5.75s/it] 67%|██████▋   | 67/100 [05:57<02:50,  5.17s/it] 68%|██████▊   | 68/100 [06:02<02:44,  5.13s/it] 69%|██████▉   | 69/100 [06:06<02:28,  4.78s/it] 70%|███████   | 70/100 [06:16<03:07,  6.24s/it]Epoch 70: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9000 / 0.8617 / 0.9508 / 0.9487/ [0.66666667 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.4118 / 0.3575 / 0.9221 / 0.4440/ [0.05095541 0.97701149 0.44396552]
 71%|███████   | 71/100 [06:20<02:41,  5.56s/it] 72%|███████▏  | 72/100 [06:25<02:31,  5.42s/it] 73%|███████▎  | 73/100 [06:29<02:14,  4.98s/it] 74%|███████▍  | 74/100 [06:34<02:09,  4.98s/it] 75%|███████▌  | 75/100 [06:42<02:30,  6.02s/it]Epoch 75: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8780 / 0.9672 / 0.9487/ [0.72222222 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.3866 / 0.3347 / 0.9221 / 0.3966/ [0.04458599 0.97701149 0.39655172]
 76%|███████▌  | 76/100 [06:47<02:17,  5.73s/it] 77%|███████▋  | 77/100 [06:51<01:57,  5.13s/it] 78%|███████▊  | 78/100 [06:56<01:51,  5.06s/it] 79%|███████▉  | 79/100 [07:00<01:38,  4.70s/it] 80%|████████  | 80/100 [07:10<02:04,  6.25s/it]Epoch 80: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8270 / 0.9180 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.4433 / 0.3740 / 0.8934 / 0.5259/ [0.03821656 0.95402299 0.52586207]
 81%|████████  | 81/100 [07:13<01:44,  5.48s/it] 82%|████████▏ | 82/100 [07:18<01:35,  5.31s/it] 83%|████████▎ | 83/100 [07:22<01:22,  4.84s/it] 84%|████████▍ | 84/100 [07:27<01:18,  4.89s/it] 85%|████████▌ | 85/100 [07:35<01:28,  5.91s/it]Epoch 85: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8780 / 0.9672 / 0.9487/ [0.72222222 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.3887 / 0.3419 / 0.9344 / 0.3879/ [0.05732484 0.98850575 0.38793103]
 86%|████████▌ | 86/100 [07:40<01:18,  5.64s/it] 87%|████████▋ | 87/100 [07:44<01:06,  5.11s/it] 88%|████████▊ | 88/100 [07:49<01:01,  5.11s/it] 89%|████████▉ | 89/100 [07:53<00:51,  4.71s/it] 90%|█████████ | 90/100 [08:03<01:01,  6.20s/it]Epoch 90: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.9100 / 0.8780 / 0.9672 / 0.9487/ [0.72222222 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.4307 / 0.3718 / 0.9180 / 0.4828/ [0.05095541 0.97701149 0.48275862]
 91%|█████████ | 91/100 [08:07<00:49,  5.48s/it] 92%|█████████▏| 92/100 [08:12<00:42,  5.36s/it] 93%|█████████▎| 93/100 [08:15<00:34,  4.90s/it] 94%|█████████▍| 94/100 [08:21<00:29,  4.97s/it] 95%|█████████▌| 95/100 [08:29<00:29,  5.99s/it]Epoch 95: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8900 / 0.8504 / 0.9508 / 0.9231/ [0.66666667 0.95348837 0.92307692]
                Test acc/f1/spec/sens = 0.3214 / 0.2790 / 0.9590 / 0.2586/ [0.04458599 0.98850575 0.25862069]
 96%|█████████▌| 96/100 [08:34<00:22,  5.69s/it] 97%|█████████▋| 97/100 [08:38<00:15,  5.12s/it] 98%|█████████▊| 98/100 [08:43<00:10,  5.05s/it] 99%|█████████▉| 99/100 [08:47<00:04,  4.71s/it]100%|██████████| 100/100 [08:56<00:00,  6.17s/it]                                                 Epoch 100: Train acc/f1 = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.] 
                Val acc/f1/spec/sens = 0.8800 / 0.8270 / 0.9180 / 0.9487/ [0.55555556 0.95348837 0.94871795]
                Test acc/f1/spec/sens = 0.4370 / 0.3705 / 0.9098 / 0.5043/ [0.03821656 0.97701149 0.50431034]
Trial 5, Cycle 1
Train acc/f1/spec/sens = 1.0000 / 1.0000 / 1.0000 / 1.0000/ [1. 1. 1.]
Val acc/f1/spec/sens = 0.8800 / 0.8270 / 0.9180 / 0.9487/ [0.55555556 0.95348837 0.94871795]
Test acc/f1/spec/sens = 0.4370 / 0.3705 / 0.9098 / 0.5043/ [0.03821656 0.97701149 0.50431034]
>> Finished.
Acc, agreement for latest model:  0.4369747899159664 0.49369747899159666 [0.03821656 0.97701149 0.50431034]
Load best checkpoint for thief model
Acc, agreement for best model:  0.22058823529411764 0.2668067226890756 [0.02547771 1.         0.06034483]
Trial 4/5 || Cycle 1/1 || Label set size 900 || Test acc 0.2206 || Test agreement 0.2668 || Spec 0.9713 || Sens 0.0603 Class Acc: [0.02547771 1.         0.06034483]
**************************************************************************************************** 

Number of samples  900
0.37563025210084033 0.10773358326411661
        acc  ...                label dist
0  0.214286  ...  {0: 165, 1: 399, 2: 336}
1  0.329832  ...  {0: 156, 1: 384, 2: 360}
2  0.373950  ...  {0: 146, 1: 403, 2: 351}
3  0.478992  ...  {0: 151, 1: 395, 2: 354}
4  0.220588  ...  {0: 154, 1: 386, 2: 360}

[5 rows x 6 columns]
Results saved to  /home/ankita/scratch/data_msa_medical/results_ankita//pocus_resnet18/butterfly_resnet50/SGD/1000_val100/random_v3_5seeds
